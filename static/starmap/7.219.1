!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};e.m=t,e.c=n,e.p="",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var n=e.slice(1),i=t[e[0]];return function(t,e,r){i.apply(this,[t,e,r].concat(n))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,n){"use strict";var i=n(19).default,r=n(74).default,o=r(n(75)),a=r(n(78)),s=r(n(81));"Promise"in window||(window.Promise=n(19).default),n(433),n(435);var l=function(t,e){return function(){function t(t){return!t.startsWith("https://www.googletagmanager.com")&&(!function(t){return new URL(t,window.location.href).origin===window.location.origin}(t)&&!t.startsWith("blob:")&&!t.startsWith("data:"))}const e=Object.getOwnPropertyDescriptor(HTMLImageElement.prototype,"src").set;Object.defineProperty(HTMLImageElement.prototype,"src",{enumerable:!0,set:function(n){t(n)?void 0!==this.crossOrigin&&(this.crossOrigin=""):this.crossOrigin=void 0,e.call(this,n)}})}(),new i((function(n,i){return FontDetect.onFontLoaded(t,n,i,{msTimeout:e})}))};o.default.$=n(77),a.default.Renderer.render=function(t,e){return t.render(e)},o.default.$((function(){var t=new s.default({el:"#starmap-application",resourcePath:"https://cdn.robertsspaceindustries.com/static/starmap",apiBaseURL:""});t.on("start",(function(){o.default.history&&o.default.history.start({pushState:!0,root:location.pathname})})),l("Electrolize").then((function(){setTimeout((function(){t.start()}))})).catch((function(t){console.error(t)}))}))},,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports={default:n(20),__esModule:!0}},function(t,e,n){n(21),n(22),n(46),n(53),t.exports=n(30).Promise},function(t,e){},[436,23,26],[437,24,25],function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},[438,27,28,33,34,39,40,41,42,35,43],function(t,e){t.exports=!0},function(t,e,n){var i=n(29),r=n(30),o=n(31),a="prototype",s=function(t,e,n){var l,c,u,h=t&s.F,d=t&s.G,f=t&s.S,p=t&s.P,m=t&s.B,v=t&s.W,g=d?r:r[e]||(r[e]={}),y=d?i:f?i[e]:(i[e]||{})[a];for(l in d&&(n=e),n)(c=!h&&y&&l in y)&&l in g||(u=c?y[l]:n[l],g[l]=d&&"function"!=typeof y[l]?n[l]:m&&c?o(u,i):v&&y[l]==u?function(t){var e=function(e){return this instanceof t?new t(e):t(e)};return e[a]=t[a],e}(u):p&&"function"==typeof u?o(Function.call,u):u,p&&((g[a]||(g[a]={}))[l]=u))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){var n=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},[439,32],function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){t.exports=n(34)},[440,35,36,37],function(t,e){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},[441,38],function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){t.exports={}},[442,35,36,42,34,43],[443,35,39,43],[444,44,45,29],[445,29],function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){n(47);var i=n(40);i.NodeList=i.HTMLCollection=i.Array},[446,48,49,40,50,26],function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},[447,51,25],[448,52],function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},[449,35,27,29,31,54,28,55,56,32,57,58,63,64,43,65,66,37,71,42,72,30,73],[450,52,43],function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},[451,55],function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError(n+": use the 'new' operator!");return t}},[452,31,59,60,56,61,62],[453,56],[454,40,43],[455,24],[456,54,43,40,30],[457,35,55,56,31],function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},[458,56,32,43],[459,29,67,52],[460,31,68,69,70,29,52],function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},[461,29],[462,55,29],[463,33],function(t,e,n){"use strict";var i=n(30),r=n(35),o=n(37),a=n(43)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.setDesc(e,a,{configurable:!0,get:function(){return this}})}},[464,43],function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,n){var i,r;(function(o){!function(a){var s="object"==typeof self&&self.self==self&&self||"object"==typeof o&&o.global==o&&o;i=[n(76),n(77),e],r=function(t,e,n){s.Backbone=function(t,e,n,i){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.2.3",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=function(t,e,i){switch(t){case 1:return function(){return n[e](this[i])};case 2:return function(t){return n[e](this[i],t)};case 3:return function(t,r){return n[e](this[i],l(t,this),r)};case 4:return function(t,r,o){return n[e](this[i],l(t,this),r,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[i]),n[e].apply(n,t)}}},s=function(t,e,i){n.each(e,(function(e,r){n[r]&&(t.prototype[r]=a(e,r,i))}))},l=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?c(t):n.isString(t)?function(e){return e.get(t)}:t},c=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}},u=e.Events={},h=/\s+/,d=function(t,e,i,r,o){var a,s=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(a=n.keys(i);s<a.length;s++)e=d(t,e,a[s],i[a[s]],o)}else if(i&&h.test(i))for(a=i.split(h);s<a.length;s++)e=t(e,a[s],r,o);else e=t(e,i,r,o);return e};u.on=function(t,e,n){return f(this,t,e,n)};var f=function(t,e,n,i,r){(t._events=d(p,t._events||{},e,n,{context:i,ctx:t,listening:r}),r)&&((t._listeners||(t._listeners={}))[r.id]=r);return t};u.listenTo=function(t,e,i){if(!t)return this;var r=t._listenId||(t._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=o[r];if(!a){var s=this._listenId||(this._listenId=n.uniqueId("l"));a=o[r]={obj:t,objId:r,id:s,listeningTo:o,count:0}}return f(t,e,i,this,a),this};var p=function(t,e,n,i){if(n){var r=t[e]||(t[e]=[]),o=i.context,a=i.ctx,s=i.listening;s&&s.count++,r.push({callback:n,context:o,ctx:o||a,listening:s})}return t};u.off=function(t,e,n){return this._events?(this._events=d(m,this._events,t,e,{context:n,listeners:this._listeners}),this):this},u.stopListening=function(t,e,i){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:n.keys(r),a=0;a<o.length;a++){var s=r[o[a]];if(!s)break;s.obj.off(e,i,this)}return n.isEmpty(r)&&(this._listeningTo=void 0),this};var m=function(t,e,i,r){if(t){var o,a=0,s=r.context,l=r.listeners;if(e||i||s){for(var c=e?[e]:n.keys(t);a<c.length;a++){var u=t[e=c[a]];if(!u)break;for(var h=[],d=0;d<u.length;d++){var f=u[d];i&&i!==f.callback&&i!==f.callback._callback||s&&s!==f.context?h.push(f):(o=f.listening)&&0==--o.count&&(delete l[o.id],delete o.listeningTo[o.objId])}h.length?t[e]=h:delete t[e]}return n.size(t)?t:void 0}for(var p=n.keys(l);a<p.length;a++)delete l[(o=l[p[a]]).id],delete o.listeningTo[o.objId]}};u.once=function(t,e,i){var r=d(v,{},t,e,n.bind(this.off,this));return this.on(r,void 0,i)},u.listenToOnce=function(t,e,i){var r=d(v,{},e,i,n.bind(this.stopListening,this,t));return this.listenTo(t,r)};var v=function(t,e,i,r){if(i){var o=t[e]=n.once((function(){r(e,o),i.apply(this,arguments)}));o._callback=i}return t};u.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;e>i;i++)n[i]=arguments[i+1];return d(g,this._events,t,void 0,n),this};var g=function(t,e,n,i){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&y(r,i),o&&y(o,[e].concat(i))}return t},y=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}};u.bind=u.on,u.unbind=u.off,n.extend(e,u);var b=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var r;if("object"==typeof t?(r=t,i=e):(r={})[t]=e,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,a=i.silent,s=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in r)e=r[d],n.isEqual(c[d],e)||s.push(d),n.isEqual(h[d],e)?delete u[d]:u[d]=e,o?delete c[d]:c[d]=e;if(this.id=this.get(this.idAttribute),!a){s.length&&(this._pending=i);for(var f=0;f<s.length;f++)this.trigger("change:"+s[f],this,c[s[f]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,i={};for(var r in t){var o=t[r];n.isEqual(e[r],o)||(i[r]=o)}return!!n.size(i)&&i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var r=t.parse?e.parse(n,t):n;return!!e.set(r,t)&&(i&&i.call(t.context,e,n,t),void e.trigger("sync",e,n,t))},j(this,t),this.sync("read",this,t)},save:function(t,e,i){var r;null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e;var o=(i=n.extend({validate:!0,parse:!0},i)).wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var a=this,s=i.success,l=this.attributes;i.success=function(t){a.attributes=l;var e=i.parse?a.parse(t,i):t;return o&&(e=n.extend({},r,e)),!(e&&!a.set(e,i))&&(s&&s.call(i.context,a,t,i),void a.trigger("sync",a,t,i))},j(this,i),r&&o&&(this.attributes=n.extend({},l,r));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=r);var u=this.sync(c,this,i);return this.attributes=l,u},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){r&&o(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var a=!1;return this.isNew()?n.defer(t.success):(j(this,t),a=this.sync("delete",this,t)),r||o(),a},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||N();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.defaults({validate:!0},t))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}}),s(b,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var x=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},w={add:!0,remove:!0,merge:!0},_={add:!0,remove:!1},S=function(t,e,n){n=Math.min(Math.max(n,0),t.length);for(var i=Array(t.length-n),r=e.length,o=0;o<i.length;o++)i[o]=t[o+n];for(o=0;r>o;o++)t[o+n]=e[o];for(o=0;o<i.length;o++)t[o+r+n]=i[o]};n.extend(x.prototype,u,{model:b,initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,_))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:n.clone(t);var r=this._removeModels(t,e);return!e.silent&&r&&this.trigger("update",this,e),i?r[0]:r},set:function(t,e){if(null!=t){(e=n.defaults({},e,w)).parse&&!this._isModel(t)&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?[t]:t.slice();var r=e.at;null!=r&&(r=+r),0>r&&(r+=this.length+1);for(var o,a=[],s=[],l=[],c={},u=e.add,h=e.merge,d=e.remove,f=!1,p=this.comparator&&null==r&&!1!==e.sort,m=n.isString(this.comparator)?this.comparator:null,v=0;v<t.length;v++){o=t[v];var g=this.get(o);if(g){if(h&&o!==g){var y=this._isModel(o)?o.attributes:o;e.parse&&(y=g.parse(y,e)),g.set(y,e),p&&!f&&(f=g.hasChanged(m))}c[g.cid]||(c[g.cid]=!0,a.push(g)),t[v]=g}else u&&((o=t[v]=this._prepareModel(o,e))&&(s.push(o),this._addReference(o,e),c[o.cid]=!0,a.push(o)))}if(d){for(v=0;v<this.length;v++)c[(o=this.models[v]).cid]||l.push(o);l.length&&this._removeModels(l,e)}var b=!1,x=!p&&u&&d;if(a.length&&x?(b=this.length!=a.length||n.some(this.models,(function(t,e){return t!==a[e]})),this.models.length=0,S(this.models,a,0),this.length=this.models.length):s.length&&(p&&(f=!0),S(this.models,s,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!e.silent){for(v=0;v<s.length;v++)null!=r&&(e.index=r+v),(o=s[v]).trigger("add",o,this,e);(f||b)&&this.trigger("sort",this,e),(s.length||l.length)&&this.trigger("update",this,e)}return i?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t){var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]}},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var i=e.length;return n.isFunction(e)&&(e=n.bind(e,this)),1===i||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){var e=(t=n.extend({parse:!0},t)).success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},j(this,t),this.sync("read",this,t)},create:function(t,e){var i=(e=e?n.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;i||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,n){i&&r.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=this.get(t[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,e.silent||(e.index=o,r.trigger("remove",r,this,e)),n.push(r),this._removeReference(r,e)}}return!!n.length&&n},_isModel:function(t){return t instanceof b},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}}),s(x,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3},"models");var M=e.View=function(t){this.cid=n.uniqueId("view"),n.extend(this,n.pick(t,T)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];n.extend(M.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var r=e.match(C);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,i,r){var o=E[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||N()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1);var l=r.error;r.error=function(t,e,n){r.textStatus=e,r.errorThrown=n,l&&l.call(r.context,t,e,n)};var c=r.xhr=e.ajax(n.extend(a,r));return i.trigger("request",i,c,r),c};var E={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,P=/(\(\?)?:\w+/g,L=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(k.prototype,u,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,(function(n){var a=o._extractParameters(t,n);!1!==o.execute(r,a,i)&&(o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),e.history.trigger("route",o,i,a))})),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(O,"\\$&").replace(A,"(?:$1)?").replace(P,(function(t,e){return e?t:"([^/?]+)"})).replace(L,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,(function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null}))}});var R=e.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,B=/^\/+|\/+$/g,D=/#.*$/;R.started=!1,n.extend(R.prototype,u,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(F,"")},start:function(t){if(R.started)throw new Error("Backbone.history has already been started");if(R.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(B,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),R.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),n.some(this.handlers,(function(e){return e.route.test(t)?(e.callback(t),!0):void 0})))},navigate:function(t,e){if(!R.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;(""===t||"?"===t.charAt(0))&&(n=n.slice(0,-1)||"/");var i=n+t;if(t=this.decodeFragment(t.replace(D,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new R;var I=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};b.extend=x.extend=k.extend=M.extend=R.extend=I;var N=function(){throw new Error('A "url" property or function must be specified')},j=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e}(s,n,t,e)}.apply(e,i),void 0===r||(t.exports=r)}()}).call(e,function(){return this}())},function(t,e,n){var i;(function(){function n(t){return function(e,n,i,r){n=_(n,r,4);var o=!A(e)&&w.keys(e),a=(o||e).length,s=t>0?0:a-1;return arguments.length<3&&(i=e[o?o[s]:s],s+=t),function(e,n,i,r,o,a){for(;o>=0&&a>o;o+=t){var s=r?r[o]:o;i=n(i,e[s],s,e)}return i}(e,n,i,o,s,a)}}function r(t){return function(e,n,i){n=S(n,i);for(var r=k(e),o=t>0?0:r-1;o>=0&&r>o;o+=t)if(n(e[o],o,e))return o;return-1}}function o(t,e,n){return function(i,r,o){var a=0,s=k(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return i[o=n(i,r)]===r?o:-1;if(r!=r)return(o=e(f.call(i,a,s),w.isNaN))>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&s>o;o+=t)if(i[o]===r)return o;return-1}}function a(t,e){var n=F.length,i=t.constructor,r=w.isFunction(i)&&i.prototype||u,o="constructor";for(w.has(t,o)&&!w.contains(e,o)&&e.push(o);n--;)(o=F[n])in t&&t[o]!==r[o]&&!w.contains(e,o)&&e.push(o)}var s=this,l=s._,c=Array.prototype,u=Object.prototype,h=Function.prototype,d=c.push,f=c.slice,p=u.toString,m=u.hasOwnProperty,v=Array.isArray,g=Object.keys,y=h.bind,b=Object.create,x=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)};void 0!==t&&t.exports&&(e=t.exports=w),e._=w,w.VERSION="1.8.3";var _=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},S=function(t,e,n){return null==t?w.identity:w.isFunction(t)?_(t,e,n):w.isObject(t)?w.matcher(t):w.property(t)};w.iteratee=function(t,e){return S(t,e,1/0)};var M=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],a=t(o),s=a.length,l=0;s>l;l++){var c=a[l];e&&void 0!==n[c]||(n[c]=o[c])}return n}},C=function(t){if(!w.isObject(t))return{};if(b)return b(t);x.prototype=t;var e=new x;return x.prototype=null,e},T=function(t){return function(e){return null==e?void 0:e[t]}},E=Math.pow(2,53)-1,k=T("length"),A=function(t){var e=k(t);return"number"==typeof e&&e>=0&&E>=e};w.each=w.forEach=function(t,e,n){var i,r;if(e=_(e,n),A(t))for(i=0,r=t.length;r>i;i++)e(t[i],i,t);else{var o=w.keys(t);for(i=0,r=o.length;r>i;i++)e(t[o[i]],o[i],t)}return t},w.map=w.collect=function(t,e,n){e=S(e,n);for(var i=!A(t)&&w.keys(t),r=(i||t).length,o=Array(r),a=0;r>a;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o},w.reduce=w.foldl=w.inject=n(1),w.reduceRight=w.foldr=n(-1),w.find=w.detect=function(t,e,n){var i;return void 0!==(i=A(t)?w.findIndex(t,e,n):w.findKey(t,e,n))&&-1!==i?t[i]:void 0},w.filter=w.select=function(t,e,n){var i=[];return e=S(e,n),w.each(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i},w.reject=function(t,e,n){return w.filter(t,w.negate(S(e)),n)},w.every=w.all=function(t,e,n){e=S(e,n);for(var i=!A(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},w.some=w.any=function(t,e,n){e=S(e,n);for(var i=!A(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},w.contains=w.includes=w.include=function(t,e,n,i){return A(t)||(t=w.values(t)),("number"!=typeof n||i)&&(n=0),w.indexOf(t,e,n)>=0},w.invoke=function(t,e){var n=f.call(arguments,2),i=w.isFunction(e);return w.map(t,(function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)}))},w.pluck=function(t,e){return w.map(t,w.property(e))},w.where=function(t,e){return w.filter(t,w.matcher(e))},w.findWhere=function(t,e){return w.find(t,w.matcher(e))},w.max=function(t,e,n){var i,r,o=-1/0,a=-1/0;if(null==e&&null!=t)for(var s=0,l=(t=A(t)?t:w.values(t)).length;l>s;s++)(i=t[s])>o&&(o=i);else e=S(e,n),w.each(t,(function(t,n,i){((r=e(t,n,i))>a||r===-1/0&&o===-1/0)&&(o=t,a=r)}));return o},w.min=function(t,e,n){var i,r,o=1/0,a=1/0;if(null==e&&null!=t)for(var s=0,l=(t=A(t)?t:w.values(t)).length;l>s;s++)i=t[s],o>i&&(o=i);else e=S(e,n),w.each(t,(function(t,n,i){r=e(t,n,i),(a>r||r===1/0&&o===1/0)&&(o=t,a=r)}));return o},w.shuffle=function(t){for(var e,n=A(t)?t:w.values(t),i=n.length,r=Array(i),o=0;i>o;o++)(e=w.random(0,o))!==o&&(r[o]=r[e]),r[e]=n[o];return r},w.sample=function(t,e,n){return null==e||n?(A(t)||(t=w.values(t)),t[w.random(t.length-1)]):w.shuffle(t).slice(0,Math.max(0,e))},w.sortBy=function(t,e,n){return e=S(e,n),w.pluck(w.map(t,(function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}})).sort((function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index})),"value")};var P=function(t){return function(e,n,i){var r={};return n=S(n,i),w.each(e,(function(i,o){var a=n(i,o,e);t(r,i,a)})),r}};w.groupBy=P((function(t,e,n){w.has(t,n)?t[n].push(e):t[n]=[e]})),w.indexBy=P((function(t,e,n){t[n]=e})),w.countBy=P((function(t,e,n){w.has(t,n)?t[n]++:t[n]=1})),w.toArray=function(t){return t?w.isArray(t)?f.call(t):A(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:A(t)?t.length:w.keys(t).length},w.partition=function(t,e,n){e=S(e,n);var i=[],r=[];return w.each(t,(function(t,n,o){(e(t,n,o)?i:r).push(t)})),[i,r]},w.first=w.head=w.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:w.initial(t,t.length-e)},w.initial=function(t,e,n){return f.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},w.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:w.rest(t,Math.max(0,t.length-e))},w.rest=w.tail=w.drop=function(t,e,n){return f.call(t,null==e||n?1:e)},w.compact=function(t){return w.filter(t,w.identity)};var L=function(t,e,n,i){for(var r=[],o=0,a=i||0,s=k(t);s>a;a++){var l=t[a];if(A(l)&&(w.isArray(l)||w.isArguments(l))){e||(l=L(l,e,n));var c=0,u=l.length;for(r.length+=u;u>c;)r[o++]=l[c++]}else n||(r[o++]=l)}return r};w.flatten=function(t,e){return L(t,e,!1)},w.without=function(t){return w.difference(t,f.call(arguments,1))},w.uniq=w.unique=function(t,e,n,i){w.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=S(n,i));for(var r=[],o=[],a=0,s=k(t);s>a;a++){var l=t[a],c=n?n(l,a,t):l;e?(a&&o===c||r.push(l),o=c):n?w.contains(o,c)||(o.push(c),r.push(l)):w.contains(r,l)||r.push(l)}return r},w.union=function(){return w.uniq(L(arguments,!0,!0))},w.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=k(t);r>i;i++){var o=t[i];if(!w.contains(e,o)){for(var a=1;n>a&&w.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},w.difference=function(t){var e=L(arguments,!0,!0,1);return w.filter(t,(function(t){return!w.contains(e,t)}))},w.zip=function(){return w.unzip(arguments)},w.unzip=function(t){for(var e=t&&w.max(t,k).length||0,n=Array(e),i=0;e>i;i++)n[i]=w.pluck(t,i);return n},w.object=function(t,e){for(var n={},i=0,r=k(t);r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},w.findIndex=r(1),w.findLastIndex=r(-1),w.sortedIndex=function(t,e,n,i){for(var r=(n=S(n,i,1))(e),o=0,a=k(t);a>o;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o},w.indexOf=o(1,w.findIndex,w.sortedIndex),w.lastIndexOf=o(-1,w.findLastIndex),w.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;i>o;o++,t+=n)r[o]=t;return r};var O=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=C(t.prototype),a=t.apply(o,r);return w.isObject(a)?a:o};w.bind=function(t,e){if(y&&t.bind===y)return y.apply(t,f.call(arguments,1));if(!w.isFunction(t))throw new TypeError("Bind must be called on a function");var n=f.call(arguments,2),i=function(){return O(t,i,e,this,n.concat(f.call(arguments)))};return i},w.partial=function(t){var e=f.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),a=0;r>a;a++)o[a]=e[a]===w?arguments[i++]:e[a];for(;i<arguments.length;)o.push(arguments[i++]);return O(t,n,this,this,o)};return n},w.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)t[n=arguments[e]]=w.bind(t[n],t);return t},w.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return w.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},w.delay=function(t,e){var n=f.call(arguments,2);return setTimeout((function(){return t.apply(null,n)}),e)},w.defer=w.partial(w.delay,w,1),w.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:w.now(),a=null,o=t.apply(i,r),a||(i=r=null)};return function(){var c=w.now();s||!1!==n.leading||(s=c);var u=e-(c-s);return i=this,r=arguments,0>=u||u>e?(a&&(clearTimeout(a),a=null),s=c,o=t.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(l,u)),o}},w.debounce=function(t,e,n){var i,r,o,a,s,l=function(){var c=w.now()-a;e>c&&c>=0?i=setTimeout(l,e-c):(i=null,n||(s=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=w.now();var c=n&&!i;return i||(i=setTimeout(l,e)),c&&(s=t.apply(o,r),o=r=null),s}},w.wrap=function(t,e){return w.partial(e,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},w.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},w.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},w.once=w.partial(w.before,2);var R=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(t){if(!w.isObject(t))return[];if(g)return g(t);var e=[];for(var n in t)w.has(t,n)&&e.push(n);return R&&a(t,e),e},w.allKeys=function(t){if(!w.isObject(t))return[];var e=[];for(var n in t)e.push(n);return R&&a(t,e),e},w.values=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},w.mapObject=function(t,e,n){e=S(e,n);for(var i,r=w.keys(t),o=r.length,a={},s=0;o>s;s++)a[i=r[s]]=e(t[i],i,t);return a},w.pairs=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},w.invert=function(t){for(var e={},n=w.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},w.functions=w.methods=function(t){var e=[];for(var n in t)w.isFunction(t[n])&&e.push(n);return e.sort()},w.extend=M(w.allKeys),w.extendOwn=w.assign=M(w.keys),w.findKey=function(t,e,n){e=S(e,n);for(var i,r=w.keys(t),o=0,a=r.length;a>o;o++)if(e(t[i=r[o]],i,t))return i},w.pick=function(t,e,n){var i,r,o={},a=t;if(null==a)return o;w.isFunction(e)?(r=w.allKeys(a),i=_(e,n)):(r=L(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var s=0,l=r.length;l>s;s++){var c=r[s],u=a[c];i(u,c,a)&&(o[c]=u)}return o},w.omit=function(t,e,n){if(w.isFunction(e))e=w.negate(e);else{var i=w.map(L(arguments,!1,!1,1),String);e=function(t,e){return!w.contains(i,e)}}return w.pick(t,e,n)},w.defaults=M(w.allKeys,!0),w.create=function(t,e){var n=C(t);return e&&w.extendOwn(n,e),n},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isMatch=function(t,e){var n=w.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;i>o;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0};var B=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped);var r=p.call(t);if(r!==p.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var l=(n=n||[]).length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),o){if((l=t.length)!==e.length)return!1;for(;l--;)if(!B(t[l],e[l],n,i))return!1}else{var c,u=w.keys(t);if(l=u.length,w.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!w.has(e,c)||!B(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0};w.isEqual=function(t,e){return B(t,e)},w.isEmpty=function(t){return null==t||(A(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length)},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=v||function(t){return"[object Array]"===p.call(t)},w.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],(function(t){w["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}})),w.isArguments(arguments)||(w.isArguments=function(t){return w.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&t!==+t},w.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===p.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return null!=t&&m.call(t,e)},w.noConflict=function(){return s._=l,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=T,w.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(e){return w.isMatch(e,t)}},w.times=function(t,e,n){var i=Array(Math.max(0,t));e=_(e,n,1);for(var r=0;t>r;r++)i[r]=e(r);return i},w.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},w.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=w.invert(D),N=function(t){var e=function(e){return t[e]},n="(?:"+w.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};w.escape=N(D),w.unescape=N(I),w.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),w.isFunction(i)?i.call(t):i};var j=0;w.uniqueId=function(t){var e=++j+"";return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+z[t]};w.template=function(t,e,n){!e&&n&&(e=n),e=w.defaults({},e,w.templateSettings);var i=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,(function(e,n,i,a,s){return o+=t.slice(r,s).replace(U,H),r=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e})),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,w)},l=e.variable||"obj";return s.source="function("+l+"){\n"+o+"}",s},w.chain=function(t){var e=w(t);return e._chain=!0,e};var G=function(t,e){return t._chain?w(e).chain():e};w.mixin=function(t){w.each(w.functions(t),(function(e){var n=w[e]=t[e];w.prototype[e]=function(){var t=[this._wrapped];return d.apply(t,arguments),G(this,n.apply(w,t))}}))},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=c[t];w.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],G(this,n)}})),w.each(["concat","join","slice"],(function(t){var e=c[t];w.prototype[t]=function(){return G(this,e.apply(this._wrapped,arguments))}})),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},void 0===(i=function(){return w}.apply(e,[]))||(t.exports=i)}).call(this)},function(t,e,n){var i;
/*!
         * jQuery JavaScript Library v2.1.4
         * http://jquery.com/
         *
         * Includes Sizzle.js
         * http://sizzlejs.com/
         *
         * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
         * Released under the MIT license
         * http://jquery.org/license
         *
         * Date: 2015-04-28T16:01Z
         */!function(e,n){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(n,r){function o(t){var e="length"in t&&t.length,n=Q.type(t);return"function"!==n&&!Q.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t))}function a(t,e,n){if(Q.isFunction(e))return Q.grep(t,(function(t,i){return!!e.call(t,i,t)!==n}));if(e.nodeType)return Q.grep(t,(function(t){return t===e!==n}));if("string"==typeof e){if(ot.test(e))return Q.filter(e,t,n);e=Q.filter(e,t)}return Q.grep(t,(function(t){return G.call(e,t)>=0!==n}))}function s(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function l(){J.removeEventListener("DOMContentLoaded",l,!1),n.removeEventListener("load",l,!1),Q.ready()}function c(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+c.uid++}function u(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(yt,"-$1").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:gt.test(n)?Q.parseJSON(n):n)}catch(t){}vt.set(t,e,n)}else n=void 0;return n}function h(){return!0}function d(){return!1}function f(){try{return J.activeElement}catch(t){}}function p(t,e){return Q.nodeName(t,"table")&&Q.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function m(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function v(t){var e=Ft.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function g(t,e){for(var n=0,i=t.length;i>n;n++)mt.set(t[n],"globalEval",!e||mt.get(e[n],"globalEval"))}function y(t,e){var n,i,r,o,a,s,l,c;if(1===e.nodeType){if(mt.hasData(t)&&(o=mt.access(t),a=mt.set(e,o),c=o.events))for(r in delete a.handle,a.events={},c)for(n=0,i=c[r].length;i>n;n++)Q.event.add(e,r,c[r][n]);vt.hasData(t)&&(s=vt.access(t),l=Q.extend({},s),vt.set(e,l))}}function b(t,e){var n=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&Q.nodeName(t,e)?Q.merge([t],n):n}function x(t,e){var n=e.nodeName.toLowerCase();"input"===n&&_t.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}function w(t,e){var i,r=Q(e.createElement(t)).appendTo(e.body),o=n.getDefaultComputedStyle&&(i=n.getDefaultComputedStyle(r[0]))?i.display:Q.css(r[0],"display");return r.detach(),o}function _(t){var e=J,n=Nt[t];return n||("none"!==(n=w(t,e))&&n||((e=(It=(It||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),n=w(t,e),It.detach()),Nt[t]=n),n}function S(t,e,n){var i,r,o,a,s=t.style;return(n=n||zt(t))&&(a=n.getPropertyValue(e)||n[e]),n&&(""!==a||Q.contains(t.ownerDocument,t)||(a=Q.style(t,e)),Vt.test(a)&&jt.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function M(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function C(t,e){if(e in t)return e;for(var n=e[0].toUpperCase()+e.slice(1),i=e,r=Xt.length;r--;)if((e=Xt[r]+n)in t)return e;return i}function T(t,e,n){var i=Ht.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function E(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=Q.css(t,n+xt[o],!0,r)),i?("content"===n&&(a-=Q.css(t,"padding"+xt[o],!0,r)),"margin"!==n&&(a-=Q.css(t,"border"+xt[o]+"Width",!0,r))):(a+=Q.css(t,"padding"+xt[o],!0,r),"padding"!==n&&(a+=Q.css(t,"border"+xt[o]+"Width",!0,r)));return a}function k(t,e,n){var i=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=zt(t),a="border-box"===Q.css(t,"boxSizing",!1,o);if(0>=r||null==r){if((0>(r=S(t,e,o))||null==r)&&(r=t.style[e]),Vt.test(r))return r;i=a&&(Y.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+E(t,e,n||(a?"border":"content"),i,o)+"px"}function A(t,e){for(var n,i,r,o=[],a=0,s=t.length;s>a;a++)(i=t[a]).style&&(o[a]=mt.get(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&wt(i)&&(o[a]=mt.access(i,"olddisplay",_(i.nodeName)))):(r=wt(i),"none"===n&&r||mt.set(i,"olddisplay",r?n:Q.css(i,"display"))));for(a=0;s>a;a++)(i=t[a]).style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function P(t,e,n,i,r){return new P.prototype.init(t,e,n,i,r)}function L(){return setTimeout((function(){Yt=void 0})),Yt=Q.now()}function O(t,e){var n,i=0,r={height:t};for(e=e?1:0;4>i;i+=2-e)r["margin"+(n=xt[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function R(t,e,n){for(var i,r=(te[e]||[]).concat(te["*"]),o=0,a=r.length;a>o;o++)if(i=r[o].call(n,e,t))return i}function F(t,e,n){var i,r,o=0,a=$t.length,s=Q.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var e=Yt||L(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),o=0,a=c.tweens.length;a>o;o++)c.tweens[o].run(i);return s.notifyWith(t,[c,i,n]),1>i&&a?n:(s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:Q.extend({},e),opts:Q.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Yt||L(),duration:n.duration,tweens:[],createTween:function(e,n){var i=Q.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)c.tweens[n].run(1);return e?s.resolveWith(t,[c,e]):s.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,i,r,o,a;for(n in t)if(r=e[i=Q.camelCase(n)],o=t[n],Q.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(a=Q.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(u,c.opts.specialEasing);a>o;o++)if(i=$t[o].call(c,t,u,c.opts))return i;return Q.map(u,R,c),Q.isFunction(c.opts.start)&&c.opts.start.call(t,c),Q.fx.timer(Q.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function B(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(dt)||[];if(Q.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function D(t,e,n,i){function r(s){var l;return o[s]=!0,Q.each(t[s]||[],(function(t,s){var c=s(e,n,i);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(e.dataTypes.unshift(c),r(c),!1)})),l}var o={},a=t===me;return r(e.dataTypes[0])||!o["*"]&&r("*")}function I(t,e){var n,i,r=Q.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&Q.extend(!0,t,i),t}function N(t,e,n,i){var r;if(Q.isArray(e))Q.each(e,(function(e,r){n||xe.test(t)?i(t,r):N(t+"["+("object"==typeof r?e:"")+"]",r,n,i)}));else if(n||"object"!==Q.type(e))i(t,e);else for(r in e)N(t+"["+r+"]",e[r],n,i)}function j(t){return Q.isWindow(t)?t:9===t.nodeType&&t.defaultView}var V=[],z=V.slice,U=V.concat,H=V.push,G=V.indexOf,W={},q=W.toString,X=W.hasOwnProperty,Y={},J=n.document,Z="2.1.4",Q=function(t,e){return new Q.fn.init(t,e)},K=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,$=/^-ms-/,tt=/-([\da-z])/gi,et=function(t,e){return e.toUpperCase()};Q.fn=Q.prototype={jquery:Z,constructor:Q,selector:"",length:0,toArray:function(){return z.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:z.call(this)},pushStack:function(t){var e=Q.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return Q.each(this,t,e)},map:function(t){return this.pushStack(Q.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:H,sort:V.sort,splice:V.splice},Q.extend=Q.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||Q.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],a!==(i=t[e])&&(c&&i&&(Q.isPlainObject(i)||(r=Q.isArray(i)))?(r?(r=!1,o=n&&Q.isArray(n)?n:[]):o=n&&Q.isPlainObject(n)?n:{},a[e]=Q.extend(c,o,i)):void 0!==i&&(a[e]=i));return a},Q.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===Q.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!Q.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"===Q.type(t)&&!t.nodeType&&!Q.isWindow(t)&&!(t.constructor&&!X.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?W[q.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=Q.trim(t))&&(1===t.indexOf("use strict")?((e=J.createElement("script")).text=t,J.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace($,"ms-").replace(tt,et)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var i=0,r=t.length,a=o(t);if(n){if(a)for(;r>i&&!1!==e.apply(t[i],n);i++);else for(i in t)if(!1===e.apply(t[i],n))break}else if(a)for(;r>i&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(K,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(o(Object(t))?Q.merge(n,"string"==typeof t?[t]:t):H.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:G.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;n>i;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,a=!n;o>r;r++)!e(t[r],r)!==a&&i.push(t[r]);return i},map:function(t,e,n){var i,r=0,a=t.length,s=[];if(o(t))for(;a>r;r++)null!=(i=e(t[r],r,n))&&s.push(i);else for(r in t)null!=(i=e(t[r],r,n))&&s.push(i);return U.apply([],s)},guid:1,proxy:function(t,e){var n,i,r;return"string"==typeof e&&(n=t[e],e=t,t=n),Q.isFunction(t)?(i=z.call(arguments,2),r=function(){return t.apply(e||this,i.concat(z.call(arguments)))},r.guid=t.guid=t.guid||Q.guid++,r):void 0},now:Date.now,support:Y}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(t,e){W["[object "+e+"]"]=e.toLowerCase()}));var nt=
/*!
                 * Sizzle CSS Selector Engine v2.2.0-pre
                 * http://sizzlejs.com/
                 *
                 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
                 * Released under the MIT license
                 * http://jquery.org/license
                 *
                 * Date: 2014-12-16
                 */
function(t){function e(t,e,n,i){var r,o,a,s,l,c,h,f,p,m;if((e?e.ownerDocument||e:V)!==O&&L(e),n=n||[],s=(e=e||O).nodeType,"string"!=typeof t||!t||1!==s&&9!==s&&11!==s)return n;if(!i&&F){if(11!==s&&(r=yt.exec(t)))if(a=r[1]){if(9===s){if(!(o=e.getElementById(a))||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&N(e,o)&&o.id===a)return n.push(o),n}else{if(r[2])return K.apply(n,e.getElementsByTagName(t)),n;if((a=r[3])&&w.getElementsByClassName)return K.apply(n,e.getElementsByClassName(a)),n}if(w.qsa&&(!B||!B.test(t))){if(f=h=j,p=e,m=1!==s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(c=C(t),(h=e.getAttribute("id"))?f=h.replace(xt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+d(c[l]);p=bt.test(t)&&u(e.parentNode)||e,m=c.join(",")}if(m)try{return K.apply(n,p.querySelectorAll(m)),n}catch(t){}finally{h||e.removeAttribute("id")}}}return E(t.replace(lt,"$1"),e,n,i)}function n(){var t=[];return function e(n,i){return t.push(n+" ")>_.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function i(t){return t[j]=!0,t}function r(t){var e=O.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),i=t.length;i--;)_.attrHandle[n[i]]=e}function a(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function s(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function l(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function c(t){return i((function(e){return e=+e,i((function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}function u(t){return t&&void 0!==t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function f(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=U++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,l,c=[z,o];if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r){if((s=(l=e[j]||(e[j]={}))[i])&&s[0]===z&&s[1]===o)return c[2]=s[2];if(l[i]=c,c[2]=t(e,n,a))return!0}}}function p(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function m(t,n,i){for(var r=0,o=n.length;o>r;r++)e(t,n[r],i);return i}function v(t,e,n,i,r){for(var o,a=[],s=0,l=t.length,c=null!=e;l>s;s++)(o=t[s])&&(!n||n(o,i,r))&&(a.push(o),c&&e.push(s));return a}function g(t,e,n,r,o,a){return r&&!r[j]&&(r=g(r)),o&&!o[j]&&(o=g(o,a)),i((function(i,a,s,l){var c,u,h,d=[],f=[],p=a.length,g=i||m(e||"*",s.nodeType?[s]:s,[]),y=!t||!i&&e?g:v(g,d,t,s,l),b=n?o||(i?t:p||r)?[]:a:y;if(n&&n(y,b,s,l),r)for(c=v(b,f),r(c,[],s,l),u=c.length;u--;)(h=c[u])&&(b[f[u]]=!(y[f[u]]=h));if(i){if(o||t){if(o){for(c=[],u=b.length;u--;)(h=b[u])&&c.push(y[u]=h);o(null,b=[],c,l)}for(u=b.length;u--;)(h=b[u])&&(c=o?tt(i,h):d[u])>-1&&(i[c]=!(a[c]=h))}}else b=v(b===a?b.splice(p,b.length):b),o?o(null,a,b,l):K.apply(a,b)}))}function y(t){for(var e,n,i,r=t.length,o=_.relative[t[0].type],a=o||_.relative[" "],s=o?1:0,l=f((function(t){return t===e}),a,!0),c=f((function(t){return tt(e,t)>-1}),a,!0),u=[function(t,n,i){var r=!o&&(i||n!==k)||((e=n).nodeType?l(t,n,i):c(t,n,i));return e=null,r}];r>s;s++)if(n=_.relative[t[s].type])u=[f(p(u),n)];else{if((n=_.filter[t[s].type].apply(null,t[s].matches))[j]){for(i=++s;r>i&&!_.relative[t[i].type];i++);return g(s>1&&p(u),s>1&&d(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(lt,"$1"),n,i>s&&y(t.slice(s,i)),r>i&&y(t=t.slice(i)),r>i&&d(t))}u.push(n)}return p(u)}function b(t,n){var r=n.length>0,o=t.length>0,a=function(i,a,s,l,c){var u,h,d,f=0,p="0",m=i&&[],g=[],y=k,b=i||o&&_.find.TAG("*",c),x=z+=null==y?1:Math.random()||.1,w=b.length;for(c&&(k=a!==O&&a);p!==w&&null!=(u=b[p]);p++){if(o&&u){for(h=0;d=t[h++];)if(d(u,a,s)){l.push(u);break}c&&(z=x)}r&&((u=!d&&u)&&f--,i&&m.push(u))}if(f+=p,r&&p!==f){for(h=0;d=n[h++];)d(m,g,a,s);if(i){if(f>0)for(;p--;)m[p]||g[p]||(g[p]=Z.call(l));g=v(g)}K.apply(l,g),c&&!i&&g.length>0&&f+n.length>1&&e.uniqueSort(l)}return c&&(z=x,k=y),m};return r?i(a):a}var x,w,_,S,M,C,T,E,k,A,P,L,O,R,F,B,D,I,N,j="sizzle"+1*new Date,V=t.document,z=0,U=0,H=n(),G=n(),W=n(),q=function(t,e){return t===e&&(P=!0),0},X=1<<31,Y={}.hasOwnProperty,J=[],Z=J.pop,Q=J.push,K=J.push,$=J.slice,tt=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt=it.replace("w","w#"),ot="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+rt+"))|)"+nt+"*\\]",at=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",st=new RegExp(nt+"+","g"),lt=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=new RegExp("^"+nt+"*,"+nt+"*"),ut=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ht=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),dt=new RegExp(at),ft=new RegExp("^"+rt+"$"),pt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,vt=/^h\d$/i,gt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,xt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),_t=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},St=function(){L()};try{K.apply(J=$.call(V.childNodes),V.childNodes),J[V.childNodes.length].nodeType}catch(t){K={apply:J.length?function(t,e){Q.apply(t,$.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}for(x in w=e.support={},M=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},L=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:V;return i!==O&&9===i.nodeType&&i.documentElement?(O=i,R=i.documentElement,(n=i.defaultView)&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",St,!1):n.attachEvent&&n.attachEvent("onunload",St)),F=!M(i),w.attributes=r((function(t){return t.className="i",!t.getAttribute("className")})),w.getElementsByTagName=r((function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length})),w.getElementsByClassName=gt.test(i.getElementsByClassName),w.getById=r((function(t){return R.appendChild(t).id=j,!i.getElementsByName||!i.getElementsByName(j).length})),w.getById?(_.find.ID=function(t,e){if(void 0!==e.getElementById&&F){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){return t.getAttribute("id")===e}}):(delete _.find.ID,_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),_.find.TAG=w.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},_.find.CLASS=w.getElementsByClassName&&function(t,e){return F?e.getElementsByClassName(t):void 0},D=[],B=[],(w.qsa=gt.test(i.querySelectorAll))&&(r((function(t){R.appendChild(t).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&B.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||B.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+j+"-]").length||B.push("~="),t.querySelectorAll(":checked").length||B.push(":checked"),t.querySelectorAll("a#"+j+"+*").length||B.push(".#.+[+~]")})),r((function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&B.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||B.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),B.push(",.*:")}))),(w.matchesSelector=gt.test(I=R.matches||R.webkitMatchesSelector||R.mozMatchesSelector||R.oMatchesSelector||R.msMatchesSelector))&&r((function(t){w.disconnectedMatch=I.call(t,"div"),I.call(t,"[s!='']:x"),D.push("!=",at)})),B=B.length&&new RegExp(B.join("|")),D=D.length&&new RegExp(D.join("|")),e=gt.test(R.compareDocumentPosition),N=e||gt.test(R.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},q=e?function(t,e){if(t===e)return P=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!w.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===V&&N(V,t)?-1:e===i||e.ownerDocument===V&&N(V,e)?1:A?tt(A,t)-tt(A,e):0:4&n?-1:1)}:function(t,e){if(t===e)return P=!0,0;var n,r=0,o=t.parentNode,s=e.parentNode,l=[t],c=[e];if(!o||!s)return t===i?-1:e===i?1:o?-1:s?1:A?tt(A,t)-tt(A,e):0;if(o===s)return a(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[r]===c[r];)r++;return r?a(l[r],c[r]):l[r]===V?-1:c[r]===V?1:0},i):O},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==O&&L(t),n=n.replace(ht,"='$1']"),w.matchesSelector&&F&&(!D||!D.test(n))&&(!B||!B.test(n)))try{var i=I.call(t,n);if(i||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return e(n,O,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==O&&L(t),N(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==O&&L(t);var n=_.attrHandle[e.toLowerCase()],i=n&&Y.call(_.attrHandle,e.toLowerCase())?n(t,e,!F):void 0;return void 0!==i?i:w.attributes||!F?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,r=0;if(P=!w.detectDuplicates,A=!w.sortStable&&t.slice(0),t.sort(q),P){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return A=null,t},S=e.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=S(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=S(e);return n},_=e.selectors={cacheLength:50,createPseudo:i,match:pt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,_t),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,_t),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return pt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&dt.test(n)&&(e=C(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,_t).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&H(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,n,i){return function(r){var o=e.attr(r,t);return null==o?"!="===n:!n||(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(st," ")+" ").indexOf(i)>-1:"|="===n&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,f,p,m=o!==a?"nextSibling":"previousSibling",v=e.parentNode,g=s&&e.nodeName.toLowerCase(),y=!l&&!s;if(v){if(o){for(;m;){for(h=e;h=h[m];)if(s?h.nodeName.toLowerCase()===g:1===h.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?v.firstChild:v.lastChild],a&&y){for(f=(c=(u=v[j]||(v[j]={}))[t]||[])[0]===z&&c[1],d=c[0]===z&&c[2],h=f&&v.childNodes[f];h=++f&&h&&h[m]||(d=f=0)||p.pop();)if(1===h.nodeType&&++d&&h===e){u[t]=[z,f,d];break}}else if(y&&(c=(e[j]||(e[j]={}))[t])&&c[0]===z)d=c[1];else for(;(h=++f&&h&&h[m]||(d=f=0)||p.pop())&&((s?h.nodeName.toLowerCase()!==g:1!==h.nodeType)||!++d||(y&&((h[j]||(h[j]={}))[t]=[z,d]),h!==e)););return(d-=r)===i||d%i==0&&d/i>=0}}},PSEUDO:function(t,n){var r,o=_.pseudos[t]||_.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[j]?o(n):o.length>1?(r=[t,t,"",n],_.setFilters.hasOwnProperty(t.toLowerCase())?i((function(t,e){for(var i,r=o(t,n),a=r.length;a--;)t[i=tt(t,r[a])]=!(e[i]=r[a])})):function(t){return o(t,0,r)}):o}},pseudos:{not:i((function(t){var e=[],n=[],r=T(t.replace(lt,"$1"));return r[j]?i((function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))})):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}})),has:i((function(t){return function(n){return e(t,n).length>0}})),contains:i((function(t){return t=t.replace(wt,_t),function(e){return(e.textContent||e.innerText||S(e)).indexOf(t)>-1}})),lang:i((function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,_t).toLowerCase(),function(e){var n;do{if(n=F?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===R},focus:function(t){return t===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!_.pseudos.empty(t)},header:function(t){return vt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c((function(){return[0]})),last:c((function(t,e){return[e-1]})),eq:c((function(t,e,n){return[0>n?n+e:n]})),even:c((function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t})),odd:c((function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t})),lt:c((function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t})),gt:c((function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t}))}},_.pseudos.nth=_.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})_.pseudos[x]=l(x);return h.prototype=_.filters=_.pseudos,_.setFilters=new h,C=e.tokenize=function(t,n){var i,r,o,a,s,l,c,u=G[t+" "];if(u)return n?0:u.slice(0);for(s=t,l=[],c=_.preFilter;s;){for(a in(!i||(r=ct.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),i=!1,(r=ut.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(lt," ")}),s=s.slice(i.length)),_.filter)!(r=pt[a].exec(s))||c[a]&&!(r=c[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?e.error(t):G(t,l).slice(0)},T=e.compile=function(t,e){var n,i=[],r=[],o=W[t+" "];if(!o){for(e||(e=C(t)),n=e.length;n--;)(o=y(e[n]))[j]?i.push(o):r.push(o);(o=W(t,b(r,i))).selector=t}return o},E=e.select=function(t,e,n,i){var r,o,a,s,l,c="function"==typeof t&&t,h=!i&&C(t=c.selector||t);if(n=n||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&w.getById&&9===e.nodeType&&F&&_.relative[o[1].type]){if(!(e=(_.find.ID(a.matches[0].replace(wt,_t),e)||[])[0]))return n;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=pt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!_.relative[s=a.type]);)if((l=_.find[s])&&(i=l(a.matches[0].replace(wt,_t),bt.test(o[0].type)&&u(e.parentNode)||e))){if(o.splice(r,1),!(t=i.length&&d(o)))return K.apply(n,i),n;break}}return(c||T(t,h))(i,e,!F,n,bt.test(t)&&u(e.parentNode)||e),n},w.sortStable=j.split("").sort(q).join("")===j,w.detectDuplicates=!!P,L(),w.sortDetached=r((function(t){return 1&t.compareDocumentPosition(O.createElement("div"))})),r((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||o("type|href|height|width",(function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),w.attributes&&r((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||o("value",(function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue})),r((function(t){return null==t.getAttribute("disabled")}))||o(et,(function(t,e,n){var i;return n?void 0:!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),e}(n);Q.find=nt,Q.expr=nt.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=nt.uniqueSort,Q.text=nt.getText,Q.isXMLDoc=nt.isXML,Q.contains=nt.contains;var it=Q.expr.match.needsContext,rt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ot=/^.[^:#\[\.,]*$/;Q.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?Q.find.matchesSelector(i,t)?[i]:[]:Q.find.matches(t,Q.grep(e,(function(t){return 1===t.nodeType})))},Q.fn.extend({find:function(t){var e,n=this.length,i=[],r=this;if("string"!=typeof t)return this.pushStack(Q(t).filter((function(){for(e=0;n>e;e++)if(Q.contains(r[e],this))return!0})));for(e=0;n>e;e++)Q.find(t,r[e],i);return(i=this.pushStack(n>1?Q.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(a(this,t||[],!1))},not:function(t){return this.pushStack(a(this,t||[],!0))},is:function(t){return!!a(this,"string"==typeof t&&it.test(t)?Q(t):t||[],!1).length}});var at,st=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,lt=Q.fn.init=function(t,e){var n,i;if(!t)return this;if("string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:st.exec(t))||!n[1]&&e)return!e||e.jquery?(e||at).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof Q?e[0]:e,Q.merge(this,Q.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:J,!0)),rt.test(n[1])&&Q.isPlainObject(e))for(n in e)Q.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(i=J.getElementById(n[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=J,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):Q.isFunction(t)?void 0!==at.ready?at.ready(t):t(Q):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),Q.makeArray(t,this))};lt.prototype=Q.fn,at=Q(J);var ct=/^(?:parents|prev(?:Until|All))/,ut={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&Q(t).is(n))break;i.push(t)}return i},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}}),Q.fn.extend({has:function(t){var e=Q(t,this),n=e.length;return this.filter((function(){for(var t=0;n>t;t++)if(Q.contains(this,e[t]))return!0}))},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=it.test(t)||"string"!=typeof t?Q(t,e||this.context):0;r>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&Q.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?Q.unique(o):o)},index:function(t){return t?"string"==typeof t?G.call(Q(t),this[0]):G.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Q.unique(Q.merge(this.get(),Q(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Q.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Q.dir(t,"parentNode")},parentsUntil:function(t,e,n){return Q.dir(t,"parentNode",n)},next:function(t){return s(t,"nextSibling")},prev:function(t){return s(t,"previousSibling")},nextAll:function(t){return Q.dir(t,"nextSibling")},prevAll:function(t){return Q.dir(t,"previousSibling")},nextUntil:function(t,e,n){return Q.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return Q.dir(t,"previousSibling",n)},siblings:function(t){return Q.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return Q.sibling(t.firstChild)},contents:function(t){return t.contentDocument||Q.merge([],t.childNodes)}},(function(t,e){Q.fn[t]=function(n,i){var r=Q.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=Q.filter(i,r)),this.length>1&&(ut[t]||Q.unique(r),ct.test(t)&&r.reverse()),this.pushStack(r)}}));var ht,dt=/\S+/g,ft={};Q.Callbacks=function(t){t="string"==typeof t?ft[t]||function(t){var e=ft[t]={};return Q.each(t.match(dt)||[],(function(t,n){e[n]=!0})),e}(t):Q.extend({},t);var e,n,i,r,o,a,s=[],l=!t.once&&[],c=function(h){for(e=t.memory&&h,n=!0,a=r||0,r=0,o=s.length,i=!0;s&&o>a;a++)if(!1===s[a].apply(h[0],h[1])&&t.stopOnFalse){e=!1;break}i=!1,s&&(l?l.length&&c(l.shift()):e?s=[]:u.disable())},u={add:function(){if(s){var n=s.length;!function e(n){Q.each(n,(function(n,i){var r=Q.type(i);"function"===r?t.unique&&u.has(i)||s.push(i):i&&i.length&&"string"!==r&&e(i)}))}(arguments),i?o=s.length:e&&(r=n,c(e))}return this},remove:function(){return s&&Q.each(arguments,(function(t,e){for(var n;(n=Q.inArray(e,s,n))>-1;)s.splice(n,1),i&&(o>=n&&o--,a>=n&&a--)})),this},has:function(t){return t?Q.inArray(t,s)>-1:!(!s||!s.length)},empty:function(){return s=[],o=0,this},disable:function(){return s=l=e=void 0,this},disabled:function(){return!s},lock:function(){return l=void 0,e||u.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!s||n&&!l||(e=[t,(e=e||[]).slice?e.slice():e],i?l.push(e):c(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},Q.extend({Deferred:function(t){var e=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return Q.Deferred((function(n){Q.each(e,(function(e,o){var a=Q.isFunction(t[e])&&t[e];r[o[1]]((function(){var t=a&&a.apply(this,arguments);t&&Q.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,a?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?Q.extend(t,i):i}},r={};return i.pipe=i.then,Q.each(e,(function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add((function(){n=s}),e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith})),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=z.call(arguments),a=o.length,s=1!==a||t&&Q.isFunction(t.promise)?a:0,l=1===s?t:Q.Deferred(),c=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?z.call(arguments):r,i===e?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&Q.isFunction(o[r].promise)?o[r].promise().done(c(r,i,o)).fail(l.reject).progress(c(r,n,e)):--s;return s||l.resolveWith(i,o),l.promise()}}),Q.fn.ready=function(t){return Q.ready.promise().done(t),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(t){t?Q.readyWait++:Q.ready(!0)},ready:function(t){(!0===t?--Q.readyWait:Q.isReady)||(Q.isReady=!0,!0!==t&&--Q.readyWait>0||(ht.resolveWith(J,[Q]),Q.fn.triggerHandler&&(Q(J).triggerHandler("ready"),Q(J).off("ready"))))}}),Q.ready.promise=function(t){return ht||(ht=Q.Deferred(),"complete"===J.readyState?setTimeout(Q.ready):(J.addEventListener("DOMContentLoaded",l,!1),n.addEventListener("load",l,!1))),ht.promise(t)},Q.ready.promise();var pt=Q.access=function(t,e,n,i,r,o,a){var s=0,l=t.length,c=null==n;if("object"===Q.type(n))for(s in r=!0,n)Q.access(t,e,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,Q.isFunction(i)||(a=!0),c&&(a?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(Q(t),n)})),e))for(;l>s;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:c?e.call(t):l?e(t[0],n):o};Q.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},c.uid=1,c.accepts=Q.acceptData,c.prototype={key:function(t){if(!c.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=c.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,Q.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,r=this.key(t),o=this.cache[r];if("string"==typeof e)o[e]=n;else if(Q.isEmptyObject(o))Q.extend(this.cache[r],e);else for(i in e)o[i]=e[i];return o},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?void 0!==(i=this.get(t,e))?i:this.get(t,Q.camelCase(e)):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,r,o=this.key(t),a=this.cache[o];if(void 0===e)this.cache[o]={};else{Q.isArray(e)?i=e.concat(e.map(Q.camelCase)):(r=Q.camelCase(e),e in a?i=[e,r]:i=(i=r)in a?[i]:i.match(dt)||[]),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(t){return!Q.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var mt=new c,vt=new c,gt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,yt=/([A-Z])/g;Q.extend({hasData:function(t){return vt.hasData(t)||mt.hasData(t)},data:function(t,e,n){return vt.access(t,e,n)},removeData:function(t,e){vt.remove(t,e)},_data:function(t,e,n){return mt.access(t,e,n)},_removeData:function(t,e){mt.remove(t,e)}}),Q.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=vt.get(o),1===o.nodeType&&!mt.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(0===(i=a[n].name).indexOf("data-")&&(i=Q.camelCase(i.slice(5)),u(o,i,r[i])));mt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){vt.set(this,t)})):pt(this,(function(e){var n,i=Q.camelCase(t);if(o&&void 0===e){if(void 0!==(n=vt.get(o,t)))return n;if(void 0!==(n=vt.get(o,i)))return n;if(void 0!==(n=u(o,i,void 0)))return n}else this.each((function(){var n=vt.get(this,i);vt.set(this,i,e),-1!==t.indexOf("-")&&void 0!==n&&vt.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){vt.remove(this,t)}))}}),Q.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=mt.get(t,e),n&&(!i||Q.isArray(n)?i=mt.access(t,e,Q.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=Q.queue(t,e),i=n.length,r=n.shift(),o=Q._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,(function(){Q.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return mt.get(t,n)||mt.access(t,n,{empty:Q.Callbacks("once memory").add((function(){mt.remove(t,[e+"queue",n])}))})}}),Q.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?Q.queue(this[0],t):void 0===e?this:this.each((function(){var n=Q.queue(this,t,e);Q._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&Q.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){Q.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=Q.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=mt.get(o[a],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var bt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xt=["Top","Right","Bottom","Left"],wt=function(t,e){return t=e||t,"none"===Q.css(t,"display")||!Q.contains(t.ownerDocument,t)},_t=/^(?:checkbox|radio)$/i;!function(){var t=J.createDocumentFragment().appendChild(J.createElement("div")),e=J.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),Y.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var St="undefined";Y.focusinBubbles="onfocusin"in n;var Mt=/^key/,Ct=/^(?:mouse|pointer|contextmenu)|click/,Tt=/^(?:focusinfocus|focusoutblur)$/,Et=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(t,e,n,i,r){var o,a,s,l,c,u,h,d,f,p,m,v=mt.get(t);if(v)for(n.handler&&(n=(o=n).handler,r=o.selector),n.guid||(n.guid=Q.guid++),(l=v.events)||(l=v.events={}),(a=v.handle)||(a=v.handle=function(e){return typeof Q!==St&&Q.event.triggered!==e.type?Q.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(dt)||[""]).length;c--;)f=m=(s=Et.exec(e[c])||[])[1],p=(s[2]||"").split(".").sort(),f&&(h=Q.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=Q.event.special[f]||{},u=Q.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&Q.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,a)||t.addEventListener&&t.addEventListener(f,a,!1)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),Q.event.global[f]=!0)},remove:function(t,e,n,i,r){var o,a,s,l,c,u,h,d,f,p,m,v=mt.hasData(t)&&mt.get(t);if(v&&(l=v.events)){for(c=(e=(e||"").match(dt)||[""]).length;c--;)if(f=m=(s=Et.exec(e[c])||[])[1],p=(s[2]||"").split(".").sort(),f){for(h=Q.event.special[f]||{},d=l[f=(i?h.delegateType:h.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)u=d[o],!r&&m!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));a&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,v.handle)||Q.removeEvent(t,f,v.handle),delete l[f])}else for(f in l)Q.event.remove(t,f+e[c],n,i,!0);Q.isEmptyObject(l)&&(delete v.handle,mt.remove(t,"events"))}},trigger:function(t,e,i,r){var o,a,s,l,c,u,h,d=[i||J],f=X.call(t,"type")?t.type:t,p=X.call(t,"namespace")?t.namespace.split("."):[];if(a=s=i=i||J,3!==i.nodeType&&8!==i.nodeType&&!Tt.test(f+Q.event.triggered)&&(f.indexOf(".")>=0&&(p=f.split("."),f=p.shift(),p.sort()),c=f.indexOf(":")<0&&"on"+f,(t=t[Q.expando]?t:new Q.Event(f,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=p.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:Q.makeArray(e,[t]),h=Q.event.special[f]||{},r||!h.trigger||!1!==h.trigger.apply(i,e))){if(!r&&!h.noBubble&&!Q.isWindow(i)){for(l=h.delegateType||f,Tt.test(l+f)||(a=a.parentNode);a;a=a.parentNode)d.push(a),s=a;s===(i.ownerDocument||J)&&d.push(s.defaultView||s.parentWindow||n)}for(o=0;(a=d[o++])&&!t.isPropagationStopped();)t.type=o>1?l:h.bindType||f,(u=(mt.get(a,"events")||{})[t.type]&&mt.get(a,"handle"))&&u.apply(a,e),(u=c&&a[c])&&u.apply&&Q.acceptData(a)&&(t.result=u.apply(a,e),!1===t.result&&t.preventDefault());return t.type=f,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(d.pop(),e)||!Q.acceptData(i)||c&&Q.isFunction(i[f])&&!Q.isWindow(i)&&((s=i[c])&&(i[c]=null),Q.event.triggered=f,i[f](),Q.event.triggered=void 0,s&&(i[c]=s)),t.result}},dispatch:function(t){t=Q.event.fix(t);var e,n,i,r,o,a=[],s=z.call(arguments),l=(mt.get(this,"events")||{})[t.type]||[],c=Q.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=Q.event.handlers.call(this,t,l),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(o.namespace))&&(t.handleObj=o,t.data=o.data,void 0!==(i=((Q.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,r,o,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(i=[],n=0;s>n;n++)void 0===i[r=(o=e[n]).selector+" "]&&(i[r]=o.needsContext?Q(r,this).index(l)>=0:Q.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&a.push({elem:l,handlers:i})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=(n=t.target.ownerDocument||J).documentElement,r=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[Q.expando])return t;var e,n,i,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Ct.test(r)?this.mouseHooks:Mt.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new Q.Event(o),e=i.length;e--;)t[n=i[e]]=o[n];return t.target||(t.target=J),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==f()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return Q.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var r=Q.extend(new Q.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?Q.event.trigger(r,null,e):Q.event.dispatch.call(e,r),r.isDefaultPrevented()&&n.preventDefault()}},Q.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},Q.Event=function(t,e){return this instanceof Q.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?h:d):this.type=t,e&&Q.extend(this,e),this.timeStamp=t&&t.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(t,e)},Q.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=h,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=h,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=h,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){Q.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return(!i||i!==this&&!Q.contains(this,i))&&(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}})),Y.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){Q.event.simulate(e,t.target,Q.event.fix(t),!0)};Q.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=mt.access(i,e);r||i.addEventListener(t,n,!0),mt.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=mt.access(i,e)-1;r?mt.access(i,e,r):(i.removeEventListener(t,n,!0),mt.remove(i,e))}}})),Q.fn.extend({on:function(t,e,n,i,r){var o,a;if("object"==typeof t){for(a in"string"!=typeof e&&(n=n||e,e=void 0),t)this.on(a,e,n,t[a],r);return this}if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),!1===i)i=d;else if(!i)return this;return 1===r&&(o=i,i=function(t){return Q().off(t),o.apply(this,arguments)},i.guid=o.guid||(o.guid=Q.guid++)),this.each((function(){Q.event.add(this,t,i,n,e)}))},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,Q(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(!1===e||"function"==typeof e)&&(n=e,e=void 0),!1===n&&(n=d),this.each((function(){Q.event.remove(this,t,n,e)}))},trigger:function(t,e){return this.each((function(){Q.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];return n?Q.event.trigger(t,e,n,!0):void 0}});var kt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,At=/<([\w:]+)/,Pt=/<|&#?\w+;/,Lt=/<(?:script|style|link)/i,Ot=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^$|\/(?:java|ecma)script/i,Ft=/^true\/(.*)/,Bt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Dt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Dt.optgroup=Dt.option,Dt.tbody=Dt.tfoot=Dt.colgroup=Dt.caption=Dt.thead,Dt.th=Dt.td,Q.extend({clone:function(t,e,n){var i,r,o,a,s=t.cloneNode(!0),l=Q.contains(t.ownerDocument,t);if(!(Y.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Q.isXMLDoc(t)))for(a=b(s),i=0,r=(o=b(t)).length;r>i;i++)x(o[i],a[i]);if(e)if(n)for(o=o||b(t),a=a||b(s),i=0,r=o.length;r>i;i++)y(o[i],a[i]);else y(t,s);return(a=b(s,"script")).length>0&&g(a,!l&&b(t,"script")),s},buildFragment:function(t,e,n,i){for(var r,o,a,s,l,c,u=e.createDocumentFragment(),h=[],d=0,f=t.length;f>d;d++)if((r=t[d])||0===r)if("object"===Q.type(r))Q.merge(h,r.nodeType?[r]:r);else if(Pt.test(r)){for(o=o||u.appendChild(e.createElement("div")),a=(At.exec(r)||["",""])[1].toLowerCase(),s=Dt[a]||Dt._default,o.innerHTML=s[1]+r.replace(kt,"<$1></$2>")+s[2],c=s[0];c--;)o=o.lastChild;Q.merge(h,o.childNodes),(o=u.firstChild).textContent=""}else h.push(e.createTextNode(r));for(u.textContent="",d=0;r=h[d++];)if((!i||-1===Q.inArray(r,i))&&(l=Q.contains(r.ownerDocument,r),o=b(u.appendChild(r),"script"),l&&g(o),n))for(c=0;r=o[c++];)Rt.test(r.type||"")&&n.push(r);return u},cleanData:function(t){for(var e,n,i,r,o=Q.event.special,a=0;void 0!==(n=t[a]);a++){if(Q.acceptData(n)&&((r=n[mt.expando])&&(e=mt.cache[r]))){if(e.events)for(i in e.events)o[i]?Q.event.remove(n,i):Q.removeEvent(n,i,e.handle);mt.cache[r]&&delete mt.cache[r]}delete vt.cache[n[vt.expando]]}}}),Q.fn.extend({text:function(t){return pt(this,(function(t){return void 0===t?Q.text(this):this.empty().each((function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return this.domManip(arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||p(this,t).appendChild(t)}))},prepend:function(){return this.domManip(arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},remove:function(t,e){for(var n,i=t?Q.filter(t,this):this,r=0;null!=(n=i[r]);r++)e||1!==n.nodeType||Q.cleanData(b(n)),n.parentNode&&(e&&Q.contains(n.ownerDocument,n)&&g(b(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Q.cleanData(b(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return Q.clone(this,t,e)}))},html:function(t){return pt(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Lt.test(t)&&!Dt[(At.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(kt,"<$1></$2>");try{for(;i>n;n++)1===(e=this[n]||{}).nodeType&&(Q.cleanData(b(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,(function(e){t=this.parentNode,Q.cleanData(b(this)),t&&t.replaceChild(e,this)})),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=U.apply([],t);var n,i,r,o,a,s,l=0,c=this.length,u=this,h=c-1,d=t[0],f=Q.isFunction(d);if(f||c>1&&"string"==typeof d&&!Y.checkClone&&Ot.test(d))return this.each((function(n){var i=u.eq(n);f&&(t[0]=d.call(this,n,i.html())),i.domManip(t,e)}));if(c&&(i=(n=Q.buildFragment(t,this[0].ownerDocument,!1,this)).firstChild,1===n.childNodes.length&&(n=i),i)){for(o=(r=Q.map(b(n,"script"),m)).length;c>l;l++)a=n,l!==h&&(a=Q.clone(a,!0,!0),o&&Q.merge(r,b(a,"script"))),e.call(this[l],a,l);if(o)for(s=r[r.length-1].ownerDocument,Q.map(r,v),l=0;o>l;l++)a=r[l],Rt.test(a.type||"")&&!mt.access(a,"globalEval")&&Q.contains(s,a)&&(a.src?Q._evalUrl&&Q._evalUrl(a.src):Q.globalEval(a.textContent.replace(Bt,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){Q.fn[t]=function(t){for(var n,i=[],r=Q(t),o=r.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),Q(r[a])[e](n),H.apply(i,n.get());return this.pushStack(i)}}));var It,Nt={},jt=/^margin/,Vt=new RegExp("^("+bt+")(?!px)[a-z%]+$","i"),zt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):n.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",r.appendChild(o);var t=n.getComputedStyle(a,null);e="1%"!==t.top,i="4px"===t.width,r.removeChild(o)}var e,i,r=J.documentElement,o=J.createElement("div"),a=J.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),n.getComputedStyle&&Q.extend(Y,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,e=a.appendChild(J.createElement("div"));return e.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",a.style.width="1px",r.appendChild(o),t=!parseFloat(n.getComputedStyle(e,null).marginRight),r.removeChild(o),a.removeChild(e),t}}))}(),Q.swap=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=a[o];return r};var Ut=/^(none|table(?!-c[ea]).+)/,Ht=new RegExp("^("+bt+")(.*)$","i"),Gt=new RegExp("^([+-])=("+bt+")","i"),Wt={position:"absolute",visibility:"hidden",display:"block"},qt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=S(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=Q.camelCase(e),l=t.style;return e=Q.cssProps[s]||(Q.cssProps[s]=C(l,s)),a=Q.cssHooks[e]||Q.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(r=a.get(t,!1,i))?r:l[e]:("string"===(o=typeof n)&&(r=Gt.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(Q.css(t,e)),o="number"),void(null!=n&&n==n&&("number"!==o||Q.cssNumber[s]||(n+="px"),Y.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(l[e]=n))))}},css:function(t,e,n,i){var r,o,a,s=Q.camelCase(e);return e=Q.cssProps[s]||(Q.cssProps[s]=C(t.style,s)),(a=Q.cssHooks[e]||Q.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=S(t,e,i)),"normal"===r&&e in qt&&(r=qt[e]),""===n||n?(o=parseFloat(r),!0===n||Q.isNumeric(o)?o||0:r):r}}),Q.each(["height","width"],(function(t,e){Q.cssHooks[e]={get:function(t,n,i){return n?Ut.test(Q.css(t,"display"))&&0===t.offsetWidth?Q.swap(t,Wt,(function(){return k(t,e,i)})):k(t,e,i):void 0},set:function(t,n,i){var r=i&&zt(t);return T(0,n,i?E(t,e,i,"border-box"===Q.css(t,"boxSizing",!1,r),r):0)}}})),Q.cssHooks.marginRight=M(Y.reliableMarginRight,(function(t,e){return e?Q.swap(t,{display:"inline-block"},S,[t,"marginRight"]):void 0})),Q.each({margin:"",padding:"",border:"Width"},(function(t,e){Q.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[t+xt[i]+e]=o[i]||o[i-2]||o[0];return r}},jt.test(t)||(Q.cssHooks[t+e].set=T)})),Q.fn.extend({css:function(t,e){return pt(this,(function(t,e,n){var i,r,o={},a=0;if(Q.isArray(e)){for(i=zt(t),r=e.length;r>a;a++)o[e[a]]=Q.css(t,e[a],!1,i);return o}return void 0!==n?Q.style(t,e,n):Q.css(t,e)}),t,e,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){wt(this)?Q(this).show():Q(this).hide()}))}}),Q.Tween=P,P.prototype={constructor:P,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(Q.cssNumber[n]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,n=P.propHooks[this.prop];return this.options.duration?this.pos=e=Q.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=Q.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){Q.fx.step[t.prop]?Q.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[Q.cssProps[t.prop]]||Q.cssHooks[t.prop])?Q.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Q.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},Q.fx=P.prototype.init,Q.fx.step={};var Yt,Jt,Zt=/^(?:toggle|show|hide)$/,Qt=new RegExp("^(?:([+-])=|)("+bt+")([a-z%]*)$","i"),Kt=/queueHooks$/,$t=[function(t,e,n){var i,r,o,a,s,l,c,u=this,h={},d=t.style,f=t.nodeType&&wt(t),p=mt.get(t,"fxshow");for(i in n.queue||(null==(s=Q._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always((function(){u.always((function(){s.unqueued--,Q.queue(t,"fx").length||s.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(c=Q.css(t,"display"))?mt.get(t,"olddisplay")||_(t.nodeName):c)&&"none"===Q.css(t,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",u.always((function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}))),e)if(r=e[i],Zt.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!p||void 0===p[i])continue;f=!0}h[i]=p&&p[i]||Q.style(t,i)}else c=void 0;if(Q.isEmptyObject(h))"inline"===("none"===c?_(t.nodeName):c)&&(d.display=c);else for(i in p?"hidden"in p&&(f=p.hidden):p=mt.access(t,"fxshow",{}),o&&(p.hidden=!f),f?Q(t).show():u.done((function(){Q(t).hide()})),u.done((function(){var e;for(e in mt.remove(t,"fxshow"),h)Q.style(t,e,h[e])})),h)a=R(f?p[i]:0,i,u),i in p||(p[i]=a.start,f&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],te={"*":[function(t,e){var n=this.createTween(t,e),i=n.cur(),r=Qt.exec(e),o=r&&r[3]||(Q.cssNumber[t]?"":"px"),a=(Q.cssNumber[t]||"px"!==o&&+i)&&Qt.exec(Q.css(n.elem,t)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+i||1;do{a/=s=s||".5",Q.style(n.elem,t,a+o)}while(s!==(s=n.cur()/i)&&1!==s&&--l)}return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};Q.Animation=Q.extend(F,{tweener:function(t,e){Q.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,r=t.length;r>i;i++)n=t[i],te[n]=te[n]||[],te[n].unshift(e)},prefilter:function(t,e){e?$t.unshift(t):$t.push(t)}}),Q.speed=function(t,e,n){var i=t&&"object"==typeof t?Q.extend({},t):{complete:n||!n&&e||Q.isFunction(t)&&t,duration:t,easing:n&&e||e&&!Q.isFunction(e)&&e};return i.duration=Q.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in Q.fx.speeds?Q.fx.speeds[i.duration]:Q.fx.speeds._default,(null==i.queue||!0===i.queue)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Q.isFunction(i.old)&&i.old.call(this),i.queue&&Q.dequeue(this,i.queue)},i},Q.fn.extend({fadeTo:function(t,e,n,i){return this.filter(wt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=Q.isEmptyObject(t),o=Q.speed(e,n,i),a=function(){var e=F(this,Q.extend({},t),o);(r||mt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",o=Q.timers,a=mt.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&Kt.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));(e||!n)&&Q.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=mt.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=Q.timers,a=i?i.length:0;for(n.finish=!0,Q.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),Q.each(["toggle","show","hide"],(function(t,e){var n=Q.fn[e];Q.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(O(e,!0),t,i,r)}})),Q.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){Q.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),Q.timers=[],Q.fx.tick=function(){var t,e=0,n=Q.timers;for(Yt=Q.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||Q.fx.stop(),Yt=void 0},Q.fx.timer=function(t){Q.timers.push(t),t()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Jt||(Jt=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Jt),Jt=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(t,e){return t=Q.fx&&Q.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}}))},function(){var t=J.createElement("input"),e=J.createElement("select"),n=e.appendChild(J.createElement("option"));t.type="checkbox",Y.checkOn=""!==t.value,Y.optSelected=n.selected,e.disabled=!0,Y.optDisabled=!n.disabled,(t=J.createElement("input")).value="t",t.type="radio",Y.radioValue="t"===t.value}();var ee,ne=Q.expr.attrHandle;Q.fn.extend({attr:function(t,e){return pt(this,Q.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){Q.removeAttr(this,t)}))}}),Q.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===St?Q.prop(t,e,n):(1===o&&Q.isXMLDoc(t)||(e=e.toLowerCase(),i=Q.attrHooks[e]||(Q.expr.match.bool.test(e)?ee:undefined)),void 0===n?i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=Q.find.attr(t,e))?void 0:r:null!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):void Q.removeAttr(t,e))},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(dt);if(o&&1===t.nodeType)for(;n=o[r++];)i=Q.propFix[n]||n,Q.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!Y.radioValue&&"radio"===e&&Q.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}}}),ee={set:function(t,e,n){return!1===e?Q.removeAttr(t,n):t.setAttribute(n,n),n}},Q.each(Q.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ne[e]||Q.find.attr;ne[e]=function(t,e,i){var r,o;return i||(o=ne[e],ne[e]=r,r=null!=n(t,e,i)?e.toLowerCase():null,ne[e]=o),r}}));var ie=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(t,e){return pt(this,Q.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[Q.propFix[t]||t]}))}}),Q.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,n){var i,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return(1!==o||!Q.isXMLDoc(t))&&(e=Q.propFix[e]||e,r=Q.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||ie.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),Y.optSelected||(Q.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){Q.propFix[this.toLowerCase()]=this}));var re=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(t){var e,n,i,r,o,a,s="string"==typeof t&&t,l=0,c=this.length;if(Q.isFunction(t))return this.each((function(e){Q(this).addClass(t.call(this,e,this.className))}));if(s)for(e=(t||"").match(dt)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(re," "):" ")){for(o=0;r=e[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");a=Q.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(t){var e,n,i,r,o,a,s=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(Q.isFunction(t))return this.each((function(e){Q(this).removeClass(t.call(this,e,this.className))}));if(s)for(e=(t||"").match(dt)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(re," "):"")){for(o=0;r=e[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");a=t?Q.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):Q.isFunction(t)?this.each((function(n){Q(this).toggleClass(t.call(this,n,this.className,e),e)})):this.each((function(){if("string"===n)for(var e,i=0,r=Q(this),o=t.match(dt)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(n===St||"boolean"===n)&&(this.className&&mt.set(this,"__className__",this.className),this.className=this.className||!1===t?"":mt.get(this,"__className__")||"")}))},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(re," ").indexOf(e)>=0)return!0;return!1}});var oe=/\r/g;Q.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=Q.isFunction(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,Q(this).val()):t)?r="":"number"==typeof r?r+="":Q.isArray(r)&&(r=Q.map(r,(function(t){return null==t?"":t+""}))),(e=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=Q.valHooks[r.type]||Q.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(oe,""):null==n?"":n:void 0}}),Q.extend({valHooks:{option:{get:function(t){var e=Q.find.attr(t,"value");return null!=e?e:Q.trim(Q.text(t))}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:i.length,l=0>r?s:o?r:0;s>l;l++)if(((n=i[l]).selected||l===r)&&(Y.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!Q.nodeName(n.parentNode,"optgroup"))){if(e=Q(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=Q.makeArray(e),a=r.length;a--;)((i=r[a]).selected=Q.inArray(i.value,o)>=0)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),Q.each(["radio","checkbox"],(function(){Q.valHooks[this]={set:function(t,e){return Q.isArray(e)?t.checked=Q.inArray(Q(t).val(),e)>=0:void 0}},Y.checkOn||(Q.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){Q.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),Q.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var ae=Q.now(),se=/\?/;Q.parseJSON=function(t){return JSON.parse(t+"")},Q.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+t),e};var le=/#.*$/,ce=/([?&])_=[^&]*/,ue=/^(.*?):[ \t]*([^\r\n]*)$/gm,he=/^(?:GET|HEAD)$/,de=/^\/\//,fe=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,pe={},me={},ve="*/".concat("*"),ge=n.location.href,ye=fe.exec(ge.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ge,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ye[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ve,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?I(I(t,Q.ajaxSettings),e):I(Q.ajaxSettings,t)},ajaxPrefilter:B(pe),ajaxTransport:B(me),ajax:function(t,e){function n(t,e,n,a){var l,u,g,y,x,_=e;2!==b&&(b=2,s&&clearTimeout(s),i=void 0,o=a||"",w.readyState=t>0?4:0,l=t>=200&&300>t||304===t,n&&(y=function(t,e,n){for(var i,r,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}(h,w,n)),y=function(t,e,n,i){var r,o,a,s,l,c={},u=t.dataTypes.slice();if(u[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=u.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(h,y,w,l),l?(h.ifModified&&((x=w.getResponseHeader("Last-Modified"))&&(Q.lastModified[r]=x),(x=w.getResponseHeader("etag"))&&(Q.etag[r]=x)),204===t||"HEAD"===h.type?_="nocontent":304===t?_="notmodified":(_=y.state,u=y.data,l=!(g=y.error))):(g=_,(t||!_)&&(_="error",0>t&&(t=0))),w.status=t,w.statusText=(e||_)+"",l?p.resolveWith(d,[u,_,w]):p.rejectWith(d,[w,_,g]),w.statusCode(v),v=void 0,c&&f.trigger(l?"ajaxSuccess":"ajaxError",[w,h,l?u:g]),m.fireWith(d,[w,_]),c&&(f.trigger("ajaxComplete",[w,h]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,a,s,l,c,u,h=Q.ajaxSetup({},e),d=h.context||h,f=h.context&&(d.nodeType||d.jquery)?Q(d):Q.event,p=Q.Deferred(),m=Q.Callbacks("once memory"),v=h.statusCode||{},g={},y={},b=0,x="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!a)for(a={};e=ue.exec(o);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return b||(t=y[n]=y[n]||t,g[t]=e),this},overrideMimeType:function(t){return b||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)v[e]=[v[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||x;return i&&i.abort(e),n(0,e),this}};if(p.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,h.url=((t||h.url||ge)+"").replace(le,"").replace(de,ye[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=Q.trim(h.dataType||"*").toLowerCase().match(dt)||[""],null==h.crossDomain&&(l=fe.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===ye[1]&&l[2]===ye[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(ye[3]||("http:"===ye[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=Q.param(h.data,h.traditional)),D(pe,h,e,w),2===b)return w;for(u in(c=Q.event&&h.global)&&0==Q.active++&&Q.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!he.test(h.type),r=h.url,h.hasContent||(h.data&&(r=h.url+=(se.test(r)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=ce.test(r)?r.replace(ce,"$1_="+ae++):r+(se.test(r)?"&":"?")+"_="+ae++)),h.ifModified&&(Q.lastModified[r]&&w.setRequestHeader("If-Modified-Since",Q.lastModified[r]),Q.etag[r]&&w.setRequestHeader("If-None-Match",Q.etag[r])),(h.data&&h.hasContent&&!1!==h.contentType||e.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+ve+"; q=0.01":""):h.accepts["*"]),h.headers)w.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(!1===h.beforeSend.call(d,w,h)||2===b))return w.abort();for(u in x="abort",{success:1,error:1,complete:1})w[u](h[u]);if(i=D(me,h,e,w)){w.readyState=1,c&&f.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(s=setTimeout((function(){w.abort("timeout")}),h.timeout));try{b=1,i.send(g,n)}catch(t){if(!(2>b))throw t;n(-1,t)}}else n(-1,"No Transport");return w},getJSON:function(t,e,n){return Q.get(t,e,n,"json")},getScript:function(t,e){return Q.get(t,void 0,e,"script")}}),Q.each(["get","post"],(function(t,e){Q[e]=function(t,n,i,r){return Q.isFunction(n)&&(r=r||i,i=n,n=void 0),Q.ajax({url:t,type:e,dataType:r,data:n,success:i})}})),Q._evalUrl=function(t){return Q.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},Q.fn.extend({wrapAll:function(t){var e;return Q.isFunction(t)?this.each((function(e){Q(this).wrapAll(t.call(this,e))})):(this[0]&&(e=Q(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this)},wrapInner:function(t){return Q.isFunction(t)?this.each((function(e){Q(this).wrapInner(t.call(this,e))})):this.each((function(){var e=Q(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=Q.isFunction(t);return this.each((function(n){Q(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(){return this.parent().each((function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)})).end()}}),Q.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},Q.expr.filters.visible=function(t){return!Q.expr.filters.hidden(t)};var be=/%20/g,xe=/\[\]$/,we=/\r?\n/g,_e=/^(?:submit|button|image|reset|file)$/i,Se=/^(?:input|select|textarea|keygen)/i;Q.param=function(t,e){var n,i=[],r=function(t,e){e=Q.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(t)||t.jquery&&!Q.isPlainObject(t))Q.each(t,(function(){r(this.name,this.value)}));else for(n in t)N(n,t[n],e,r);return i.join("&").replace(be,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=Q.prop(this,"elements");return t?Q.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!Q(this).is(":disabled")&&Se.test(this.nodeName)&&!_e.test(t)&&(this.checked||!_t.test(t))})).map((function(t,e){var n=Q(this).val();return null==n?null:Q.isArray(n)?Q.map(n,(function(t){return{name:e.name,value:t.replace(we,"\r\n")}})):{name:e.name,value:n.replace(we,"\r\n")}})).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Me=0,Ce={},Te={0:200,1223:204},Ee=Q.ajaxSettings.xhr();n.attachEvent&&n.attachEvent("onunload",(function(){for(var t in Ce)Ce[t]()})),Y.cors=!!Ee&&"withCredentials"in Ee,Y.ajax=Ee=!!Ee,Q.ajaxTransport((function(t){var e;return Y.cors||Ee&&!t.crossDomain?{send:function(n,i){var r,o=t.xhr(),a=++Me;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];for(r in t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)o.setRequestHeader(r,n[r]);e=function(t){return function(){e&&(delete Ce[a],e=o.onload=o.onerror=null,"abort"===t?o.abort():"error"===t?i(o.status,o.statusText):i(Te[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=e(),o.onerror=e("error"),e=Ce[a]=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}:void 0})),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return Q.globalEval(t),t}}}),Q.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),Q.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain)return{send:function(i,r){e=Q("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),J.head.appendChild(e[0])},abort:function(){n&&n()}}}));var ke=[],Ae=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ke.pop()||Q.expando+"_"+ae++;return this[t]=!0,t}}),Q.ajaxPrefilter("json jsonp",(function(t,e,i){var r,o,a,s=!1!==t.jsonp&&(Ae.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ae.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ae,"$1"+r):!1!==t.jsonp&&(t.url+=(se.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||Q.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){a=arguments},i.always((function(){n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,ke.push(r)),a&&Q.isFunction(o)&&o(a[0]),a=o=void 0})),"script"):void 0})),Q.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||J;var i=rt.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=Q.buildFragment([t],e,r),r&&r.length&&Q(r).remove(),Q.merge([],i.childNodes))};var Pe=Q.fn.load;Q.fn.load=function(t,e,n){if("string"!=typeof t&&Pe)return Pe.apply(this,arguments);var i,r,o,a=this,s=t.indexOf(" ");return s>=0&&(i=Q.trim(t.slice(s)),t=t.slice(0,s)),Q.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&Q.ajax({url:t,type:r,dataType:"html",data:e}).done((function(t){o=arguments,a.html(i?Q("<div>").append(Q.parseHTML(t)).find(i):t)})).complete(n&&function(t,e){a.each(n,o||[t.responseText,e,t])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){Q.fn[e]=function(t){return this.on(e,t)}})),Q.expr.filters.animated=function(t){return Q.grep(Q.timers,(function(e){return t===e.elem})).length};var Le=n.document.documentElement;Q.offset={setOffset:function(t,e,n){var i,r,o,a,s,l,c=Q.css(t,"position"),u=Q(t),h={};"static"===c&&(t.style.position="relative"),s=u.offset(),o=Q.css(t,"top"),l=Q.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(a=(i=u.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),Q.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+r),"using"in e?e.using.call(t,h):u.css(h)}},Q.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){Q.offset.setOffset(this,t,e)}));var e,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(e=o.documentElement,Q.contains(e,i)?(typeof i.getBoundingClientRect!==St&&(r=i.getBoundingClientRect()),n=j(o),{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===Q.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),Q.nodeName(t[0],"html")||(i=t.offset()),i.top+=Q.css(t[0],"borderTopWidth",!0),i.left+=Q.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-Q.css(n,"marginTop",!0),left:e.left-i.left-Q.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent||Le;t&&!Q.nodeName(t,"html")&&"static"===Q.css(t,"position");)t=t.offsetParent;return t||Le}))}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;Q.fn[t]=function(r){return pt(this,(function(t,r,o){var a=j(t);return void 0===o?a?a[e]:t[r]:void(a?a.scrollTo(i?n.pageXOffset:o,i?o:n.pageYOffset):t[r]=o)}),t,r,arguments.length,null)}})),Q.each(["top","left"],(function(t,e){Q.cssHooks[e]=M(Y.pixelPosition,(function(t,n){return n?(n=S(t,e),Vt.test(n)?Q(t).position()[e]+"px":n):void 0}))})),Q.each({Height:"height",Width:"width"},(function(t,e){Q.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){Q.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===r?"margin":"border");return pt(this,(function(e,n,i){var r;return Q.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===i?Q.css(e,n,a):Q.style(e,n,i,a)}),e,o?i:void 0,o,null)}}))})),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,void 0===(i=function(){return Q}.apply(e,[]))||(t.exports=i);var Oe=n.jQuery,Re=n.$;return Q.noConflict=function(t){return n.$===Q&&(n.$=Re),t&&n.jQuery===Q&&(n.jQuery=Oe),Q},typeof r===St&&(n.jQuery=n.$=Q),Q}))},function(t,e,n){var i,r;!function(o,a){i=[n(75),n(76),n(79),n(80)],r=function(t,e){return o.Marionette=o.Mn=function(t,e,n){"use strict";var i=t.Marionette,r=t.Mn,o=e.Marionette={};o.VERSION="2.4.7",o.noConflict=function(){return t.Marionette=i,t.Mn=r,this},o.Deferred=e.$.Deferred,o.FEATURES={},o.isEnabled=function(t){return!!o.FEATURES[t]},o.extend=e.Model.extend,o.isNodeAttached=function(t){return e.$.contains(document.documentElement,t)},o.mergeOptions=function(t,e){t&&n.extend(this,n.pick(t,e))},o.getOption=function(t,e){return t&&e?t.options&&void 0!==t.options[e]?t.options[e]:t[e]:void 0},o.proxyGetOption=function(t){return o.getOption(this,t)},o._getValue=function(t,e,i){return n.isFunction(t)&&(t=i?t.apply(e,i):t.call(e)),t},o.normalizeMethods=function(t){return n.reduce(t,(function(t,e,i){return n.isFunction(e)||(e=this[e]),e&&(t[i]=e),t}),{},this)},o.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z-_$0-9]*/g,(function(t){return e[t.slice(4)]}))},o.normalizeUIKeys=function(t,e){return n.reduce(t,(function(t,n,i){return t[o.normalizeUIString(i,e)]=n,t}),{})},o.normalizeUIValues=function(t,e,i){return n.each(t,(function(r,a){n.isString(r)?t[a]=o.normalizeUIString(r,e):n.isObject(r)&&n.isArray(i)&&(n.extend(r,o.normalizeUIValues(n.pick(r,i),e)),n.each(i,(function(t){var i=r[t];n.isString(i)&&(r[t]=o.normalizeUIString(i,e))})))})),t},o.actAsCollection=function(t,e){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,(function(i){t[i]=function(){var t=[n.values(n.result(this,e))].concat(n.toArray(arguments));return n[i].apply(n,t)}}))};var a=o.deprecate=function(t,e){n.isObject(t)&&(t=t.prev+" is going to be removed in the future. Please use "+t.next+" instead."+(t.url?" See: "+t.url:"")),void 0!==e&&e||a._cache[t]||(a._warn("Deprecation warning: "+t),a._cache[t]=!0)};a._console="undefined"!=typeof console?console:{},a._warn=function(){return(a._console.warn||a._console.log||function(){}).apply(a._console,arguments)},a._cache={},o._triggerMethod=function(){function t(t,e,n){return n.toUpperCase()}var e=/(^|:)(\w)/gi;return function(i,r,o){var a=arguments.length<3;a&&(r=(o=r)[0]);var s,l=i["on"+r.replace(e,t)];return n.isFunction(l)&&(s=l.apply(i,a?n.rest(o):o)),n.isFunction(i.trigger)&&(a+o.length>1?i.trigger.apply(i,a?o:[r].concat(n.drop(o,0))):i.trigger(r)),s}}(),o.triggerMethod=function(t){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(t){return(n.isFunction(t.triggerMethod)?t.triggerMethod:o.triggerMethod).apply(t,n.rest(arguments))},o.MonitorDOMRefresh=function(t){function e(){t._isShown=!0,i()}function n(){t._isRendered=!0,i()}function i(){t._isShown&&t._isRendered&&o.isNodeAttached(t.el)&&o.triggerMethodOn(t,"dom:refresh",t)}t._isDomRefreshMonitored||(t._isDomRefreshMonitored=!0,t.on({show:e,render:n}))},function(t){function e(e,i,r,o){var a=o.split(/\s+/);n.each(a,(function(n){var o=e[n];if(!o)throw new t.Error('Method "'+n+'" was configured as an event handler, but does not exist.');e.listenTo(i,r,o)}))}function i(t,e,n,i){t.listenTo(e,n,i)}function r(t,e,i,r){var o=r.split(/\s+/);n.each(o,(function(n){var r=t[n];t.stopListening(e,i,r)}))}function o(t,e,n,i){t.stopListening(e,n,i)}function a(e,i,r,o,a){if(i&&r){if(!n.isObject(r))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=t._getValue(r,e),n.each(r,(function(t,r){n.isFunction(t)?o(e,i,r,t):a(e,i,r,t)}))}}t.bindEntityEvents=function(t,n,r){a(t,n,r,i,e)},t.unbindEntityEvents=function(t,e,n){a(t,e,n,o,r)},t.proxyBindEntityEvents=function(e,n){return t.bindEntityEvents(this,e,n)},t.proxyUnbindEntityEvents=function(e,n){return t.unbindEntityEvents(this,e,n)}}(o);var s=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(t,e){n.isObject(t)?t=(e=t).message:e||(e={});var i=Error.call(this,t);n.extend(this,n.pick(i,s),n.pick(e,s)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(t,e){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),i.then((function(n){e&&(n.context=e),t.call(n.context,n.options)}))},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],n.each(t,(function(t){this.add(t.cb,t.ctx)}),this)}}),o.Controller=function(t){this.options=t||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,e.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(t){this.options=n.extend({},n.result(this,"options"),t),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,n.extend(o.Object.prototype,e.Events,{initialize:function(){},destroy:function(t){return t=t||{},this.triggerMethod("before:destroy",t),this.triggerMethod("destroy",t),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,t)},show:function(t,e){if(this._ensureElement()){this._ensureViewIsIntact(t),o.MonitorDOMRefresh(t);var i=e||{},r=t!==this.currentView,a=!!i.preventDestroy,s=!!i.forceShow,l=!!this.currentView,c=r&&!a,u=r||s;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,e),this.currentView&&r&&delete this.currentView._parent,c?this.empty():l&&u&&this.currentView.off("destroy",this.empty,this),u){t.once("destroy",this.empty,this),t._parent=this,this._renderView(t),l&&this.triggerMethod("before:swap",t,this,e),this.triggerMethod("before:show",t,this,e),o.triggerMethodOn(t,"before:show",t,this,e),l&&this.triggerMethod("swapOut",this.currentView,this,e);var h=o.isNodeAttached(this.el),d=[],f=n.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},i);return h&&f.triggerBeforeAttach&&(d=this._displayedViews(t),this._triggerAttach(d,"before:")),this.attachHtml(t),this.currentView=t,h&&f.triggerAttach&&(d=this._displayedViews(t),this._triggerAttach(d)),l&&this.triggerMethod("swap",t,this,e),this.triggerMethod("show",t,this,e),o.triggerMethodOn(t,"show",t,this,e),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(t,e){var i=(e||"")+"attach";n.each(t,(function(t){o.triggerMethodOn(t,i,t,this)}),this)},_displayedViews:function(t){return n.union([t],n.result(t,"_getNestedViews")||[])},_renderView:function(t){t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t)},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(t){if(!t)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t,o._getValue(this.options.parentEl,this))},attachHtml:function(t){this.$el.contents().detach(),this.el.appendChild(t.el)},empty:function(t){var e=this.currentView,n=!!(t||{}).preventDestroy;return e?(e.off("destroy",this.empty,this),this.triggerMethod("before:empty",e),n||this._destroyView(),this.triggerMethod("empty",e),delete this.currentView,n&&this.$el.contents().detach(),this):this},_destroyView:function(){var t=this.currentView;t.isDestroyed||(t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():(t.remove(),t.isDestroyed=!0),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t))},attachView:function(t){return this.currentView&&delete this.currentView._parent,t._parent=this,this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(t,e){if(n.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(n.isFunction(t))return this._buildRegionFromRegionClass(t);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,e){var i=t.regionClass||e,r=n.omit(t,"selector","regionClass");return t.selector&&!r.el&&(r.el=t.selector),new i(r)},_buildRegionFromRegionClass:function(t){return new t}}),o.RegionManager=o.Controller.extend({constructor:function(t){this._regions={},this.length=0,o.Controller.call(this,t),this.addRegions(this.getOption("regions"))},addRegions:function(t,e){return t=o._getValue(t,this,arguments),n.reduce(t,(function(t,i,r){return n.isString(i)&&(i={selector:i}),i.selector&&(i=n.defaults({},i,e)),t[r]=this.addRegion(r,i),t}),{},this)},addRegion:function(t,e){var n;return n=e instanceof o.Region?e:o.Region.buildRegion(e,o.Region),this.triggerMethod("before:add:region",t,n),n._parent=this,this._store(t,n),this.triggerMethod("add:region",t,n),n},get:function(t){return this._regions[t]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return n.each(this._regions,(function(t,e){this._remove(e,t)}),this),t},emptyRegions:function(){var t=this.getRegions();return n.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]||this.length++,this._regions[t]=e},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete e._parent,delete this._regions[t],this.length--,this.triggerMethod("remove:region",t,e)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(t){this.templateId=t},n.extend(o.TemplateCache,{templateCaches:{},get:function(t,e){var n=this.templateCaches[t];return n||(n=new o.TemplateCache(t),this.templateCaches[t]=n),n.load(e)},clear:function(){var t,e=n.toArray(arguments),i=e.length;if(i>0)for(t=0;i>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(t){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId,t);return this.compiledTemplate=this.compileTemplate(e,t),this.compiledTemplate},loadTemplate:function(t,n){var i=e.$(t);if(!i.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return i.html()},compileTemplate:function(t,e){return n.template(t,e)}}),o.Renderer={render:function(t,e){if(!t)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});return(n.isFunction(t)?t:o.TemplateCache.get(t))(e)}},o.View=e.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(t){this.render=n.bind(this.render,this),t=o._getValue(t,this),this.options=n.extend({},n.result(this,"options"),t),this._behaviors=o.Behaviors(this),e.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,n.rest(arguments))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return e=o._getValue(e,this),n.extend(t,e)},normalizeUIKeys:function(t){var e=n.result(this,"_uiBindings");return o.normalizeUIKeys(t,e||n.result(this,"ui"))},normalizeUIValues:function(t,e){var i=n.result(this,"ui"),r=n.result(this,"_uiBindings");return o.normalizeUIValues(t,r||i,e)},configureTriggers:function(){if(this.triggers){var t=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(t,(function(t,e,n){return t[n]=this._buildViewTrigger(e),t}),{},this)}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,(function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))}),this),this},_delegateDOMEvents:function(t){var i=o._getValue(t||this.events,this);i=this.normalizeUIKeys(i),n.isUndefined(t)&&(this.events=i);var r={},a=n.result(this,"behaviorEvents")||{},s=this.configureTriggers(),l=n.result(this,"behaviorTriggers")||{};n.extend(r,a,i,s,l),e.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return e.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,(function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))}),this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var t=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",t),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=n.result(this,"_uiBindings");this.ui={},n.each(t,(function(t,e){this.ui[e]=this.$(t)}),this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,(function(t,e){delete this.ui[e]}),this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=n.defaults({},t,{preventDefault:!0,stopPropagation:!0}),i=n.isObject(t)?e.event:t;return function(t){t&&(t.preventDefault&&e.preventDefault&&t.preventDefault(),t.stopPropagation&&e.stopPropagation&&t.stopPropagation());var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(i,n)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),t},_triggerEventOnBehaviors:function(t){for(var e=o._triggerMethod,n=this._behaviors,i=0,r=n&&n.length;r>i;i++)e(n[i],t)},_triggerEventOnParentLayout:function(t,e){var i=this._parentLayoutView();if(i){var r=o.getOption(i,"childViewEventPrefix")+":"+t,a=[this].concat(e);o._triggerMethod(i,r,a);var s=o.getOption(i,"childEvents");s=o._getValue(s,i);var l=i.normalizeMethods(s);l&&n.isFunction(l[t])&&l[t].apply(i,a)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var t=this._getImmediateChildren();return t.length?n.reduce(t,(function(t,e){return e._getNestedViews?t.concat(e._getNestedViews()):t}),t):t},_parentLayoutView:function(){for(var t=this._parent;t;){if(t instanceof o.LayoutView)return t;t=t._parent}},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var t=[this.model||this.collection];return arguments.length&&t.push.apply(t,arguments),this.model?this.serializeModel.apply(this,t):{items:this.serializeCollection.apply(this,t)}},serializeCollection:function(t){return t.toJSON.apply(t,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(!1!==t){if(!t)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.mixinTemplateHelpers(this.serializeData()),n=o.Renderer.render(t,e,this);return this.attachElContent(n),this}},attachElContent:function(t){return this.$el.html(t),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(t){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var t,e=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),e&&this._triggerBeforeAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),e&&this._triggerAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(t,e,i){var r=n.drop(arguments,3);n.each(t,(function(t){o.triggerMethodOn.apply(t,[t,i,t,e].concat(r))}))},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t,e,i){var r=void 0!==i.at&&(i.index||e.indexOf(t));if((this.getOption("filter")||!1===r)&&(r=n.indexOf(this._filteredSortedModels(r),t)),this._shouldAddChild(t,r)){this.destroyEmptyView();var o=this.getChildView(t);this.addChild(t,o,r)}},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each((function(t){o.triggerMethodOn(t,"before:show",t)}))},_onShowCalled:function(){this.children.each((function(t){o.triggerMethodOn(t,"show",t)}))},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var t=this.children,e=this._filteredSortedModels();if(!e.length&&this._showingEmptyView)return this;var i=n.some(e,(function(e){return!t.findByModel(e)}));if(i)this.render();else{var r=n.map(e,(function(e,n){var i=t.findByModel(e);return i._index=n,i.el})),o=t.filter((function(t){return!n.contains(r,t.el)}));this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),n.each(o,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var t=this._filteredSortedModels(),e=n.find(t,(function(t,e){var n=this.children.findByModel(t);return!n||n._index!==e}),this);e&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(t){this.$el.append(t)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var t,e=this._filteredSortedModels();n.each(e,(function(e,n){t=this.getChildView(e),this.addChild(e,t,n)}),this)},_filteredSortedModels:function(t){var e,i=this.getViewComparator(),r=this.collection.models;(t=Math.min(Math.max(t,0),r.length-1),i)&&(t&&(e=r[t],r=r.slice(0,t).concat(r.slice(t+1))),r=this._sortModelsBy(r,i),e&&r.splice(t,0,e));return this.getOption("filter")&&(r=n.filter(r,(function(t,e){return this._shouldAddChild(t,e)}),this)),r},_sortModelsBy:function(t,e){return"string"==typeof e?n.sortBy(t,(function(t){return t.get(e)}),this):1===e.length?n.sortBy(t,e,this):t.sort(n.bind(e,this))},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new e.Model;this.addEmptyView(n,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var i,r=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),a=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(a)&&(a=a.call(this,t,this._emptyViewIndex));var s=this.buildChildView(t,e,a);s._parent=this,this.proxyChildEvents(s),s.once("render",(function(){this._isShown&&o.triggerMethodOn(s,"before:show",s),r&&this._triggerBeforeAttach&&(i=this._getViewAndNested(s),this._triggerMethodMany(i,this,"before:attach"))}),this),this.children.add(s),this.renderChildView(s,this._emptyViewIndex),r&&this._triggerAttach&&(i=this._getViewAndNested(s),this._triggerMethodMany(i,this,"attach")),this._isShown&&o.triggerMethodOn(s,"show",s)},getChildView:function(t){var e=this.getOption("childView");if(!e)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(t,e,n){var i=this.getOption("childViewOptions");i=o._getValue(i,this,[t,n]);var r=this.buildChildView(t,e,i);return this._updateIndices(r,!0,n),this.triggerMethod("before:add:child",r),this._addChildView(r,n),this.triggerMethod("add:child",r),r._parent=this,r},_updateIndices:function(t,e,n){this.getOption("sort")&&(e&&(t._index=n),this.children.each((function(n){n._index>=t._index&&(n._index+=e?1:-1)})))},_addChildView:function(t,e){var n,i=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(t),t.once("render",(function(){this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"before:show",t),i&&this._triggerBeforeAttach&&(n=this._getViewAndNested(t),this._triggerMethodMany(n,this,"before:attach"))}),this),this.children.add(t),this.renderChildView(t,e),i&&this._triggerAttach&&(n=this._getViewAndNested(t),this._triggerMethodMany(n,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"show",t)},renderChildView:function(t,e){return t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t),this.attachHtml(this,t,e),t},buildChildView:function(t,e,i){var r=new e(n.extend({model:t},i));return o.MonitorDOMRefresh(r),r},removeChildView:function(t){return t?(this.triggerMethod("before:remove:child",t),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():t.remove(),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t),delete t._parent,this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1),t):t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t,e){t.$el.append(e)},_createBuffer:function(){var t=document.createDocumentFragment();return n.each(this._bufferedChildren,(function(e){t.appendChild(e.el)})),t},attachHtml:function(t,e,n){t.isBuffering?t._bufferedChildren.splice(n,0,e):t._insertBefore(e,n)||t._insertAfter(e)},_insertBefore:function(t,e){var n;return this.getOption("sort")&&e<this.children.length-1&&(n=this.children.find((function(t){return t._index===e+1}))),!!n&&(n.$el.before(t.el),!0)},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(t){var e=t||{},i=!0,r=this.children.map(n.identity);return n.isUndefined(e.checkEmpty)||(i=e.checkEmpty),this.children.each(this.removeChildView,this),i&&this.checkEmpty(),r},_shouldAddChild:function(t,e){var i=this.getOption("filter");return!n.isFunction(i)||i.call(this,t,e,this.collection)},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",(function(){var i=n.toArray(arguments),r=i[0],o=this.normalizeMethods(n.result(this,"childEvents"));i[0]=e+":"+r,i.splice(1,0,t),void 0!==o&&n.isFunction(o[r])&&o[r].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)}))},_getImmediateChildren:function(){return n.values(this.children._views)},_getViewAndNested:function(t){return[t].concat(n.result(t,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(t){return this.getOption("childView")||this.constructor},serializeData:function(){var t={};return this.model&&(t=n.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),n=o.Renderer.render(e,t,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t,e){this.getChildViewContainer(t).append(e)},_insertAfter:function(t){this.getChildViewContainer(this,t).append(t.el)},_appendReorderedChildren:function(t){this.getChildViewContainer(this).append(t)},getChildViewContainer:function(t,e){if(t.$childViewContainer)return t.$childViewContainer;var n,i=o.getOption(t,"childViewContainer");if(i){var r=o._getValue(i,t);if((n="@"===r.charAt(0)&&t.ui?t.ui[r.substr(4)]:t.$(r)).length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else n=t.$el;return t.$childViewContainer=n,n},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(!0===this.getOption("destroyImmediate")&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(t,e,i){var r=this.getRegion(t);return r.show.apply(r,n.rest(arguments))},getChildView:function(t){return this.getRegion(t).currentView},addRegion:function(t,e){var n={};return n[t]=e,this._buildRegions(n)[t]},addRegions:function(t){return this.regions=n.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(t,e)},_initializeRegions:function(t){var e;this._initRegionManager(),e=o._getValue(this.regions,this,[t])||{};var i=this.getOption.call(t,"regions");i=o._getValue(i,this,[t]),n.extend(e,i),e=this.normalizeUIValues(e,["selector","el"]),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",(function(t){this.triggerMethod("before:add:region",t)})),this.listenTo(this.regionManager,"add:region",(function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)})),this.listenTo(this.regionManager,"before:remove:region",(function(t){this.triggerMethod("before:remove:region",t)})),this.listenTo(this.regionManager,"remove:region",(function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)}))},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(t,e){this.view=e,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,t),this.ui=n.extend({},n.result(e,"ui"),n.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el}}),o.Behaviors=function(t,e){function n(t,i){return e.isObject(t.behaviors)?(i=n.parseBehaviors(t,i||e.result(t,"behaviors")),n.wrap(t,i,e.keys(a)),i):{}}function i(t,e){this._view=t,this._behaviors=e,this._triggers={}}function r(t){return t._uiBindings||t.ui}var o=/^(\S+)\s*(.*)$/,a={behaviorTriggers:function(t,e){return new i(this,e).buildBehaviorTriggers()},behaviorEvents:function(n,i){var a={};return e.each(i,(function(n,i){var s={},l=e.clone(e.result(n,"events"))||{};l=t.normalizeUIKeys(l,r(n));var c=0;e.each(l,(function(t,r){var a=r.match(o),l=a[1]+"."+[this.cid,i,c++," "].join("")+a[2],u=e.isFunction(t)?t:n[t];u&&(s[l]=e.bind(u,n))}),this),a=e.extend(a,s)}),this),a}};return e.extend(n,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(e,i){return e.behaviorClass?e.behaviorClass:t._getValue(n.behaviorsLookup,this,[e,i])[i]},parseBehaviors:function(t,i){return e.chain(i).map((function(i,r){var o=new(n.getBehaviorClass(i,r))(i,t),a=n.parseBehaviors(t,e.result(o,"behaviors"));return[o].concat(a)})).flatten().value()},wrap:function(t,n,i){e.each(i,(function(i){t[i]=e.partial(a[i],t[i],n)}))}}),e.extend(i.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var o=e.clone(e.result(n,"triggers"))||{};o=t.normalizeUIKeys(o,r(n)),e.each(o,e.bind(this._setHandlerForBehavior,this,n,i))},_setHandlerForBehavior:function(t,e,n,i){var r=i.replace(/^\S+/,(function(t){return t+".behaviortriggers"+e}));this._triggers[r]=this._view._buildViewTrigger(n)}}),n}(o,n),o.AppRouter=e.Router.extend({constructor:function(t){this.options=t||{},e.Router.apply(this,arguments);var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var n=this._getController();this._addAppRoute(n,t,e)},_processOnRoute:function(t,e){if(n.isFunction(this.onRoute)){var i=n.invert(this.getOption("appRoutes"))[t];this.onRoute(t,i,e)}},processAppRoutes:function(t,e){if(e){var i=n.keys(e).reverse();n.each(i,(function(n){this._addAppRoute(t,n,e[n])}),this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,i){var r=t[i];if(!r)throw new o.Error('Method "'+i+'" was not found on the controller');this.route(e,i,n.bind(r,t))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(t){this._initializeRegions(t),this._initCallbacks=new o.Callbacks,this.submodules={},n.extend(this,t),this._initChannel(),o.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var i=o.Module.getClass(e),r=n.toArray(arguments);return r.unshift(this),i.create.apply(i,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(t){var e=n.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var i=o.getOption(t,"regions");return n.isFunction(i)&&(i=i.call(this,t)),n.extend(e,i),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",(function(){o._triggerMethod(this,"before:add:region",arguments)})),this.listenTo(this._regionManager,"add:region",(function(t,e){this[t]=e,o._triggerMethod(this,"add:region",arguments)})),this.listenTo(this._regionManager,"before:remove:region",(function(){o._triggerMethod(this,"before:remove:region",arguments)})),this.listenTo(this._regionManager,"remove:region",(function(t){delete this[t],o._triggerMethod(this,"remove:region",arguments)}))},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),o.Module=function(t,e,i){this.moduleName=t,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,n.isFunction(this.initialize)&&this.initialize(t,e,this.options)},o.Module.extend=o.extend,n.extend(o.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(n.each(this.submodules,(function(e){e.startWithParent&&e.start(t)})),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,i){if(t){var r=n.flatten([this,this.app,e,o,e.$,n,i]);t.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),n.extend(o.Module,{create:function(t,e,i){var r=t,o=n.drop(arguments,3),a=(e=e.split(".")).length,s=[];return s[a-1]=i,n.each(e,(function(e,n){var a=r;r=this._getModule(a,e,t,i),this._addModuleDefinition(a,r,s[n],o)}),this),r},_getModule:function(t,e,i,r,o){var a=n.extend({},r),s=this.getClass(r),l=t[e];return l||(l=new s(e,i,a),t[e]=l,t.submodules[e]=l),l},getClass:function(t){var e=o.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,n,i){var r=this._getDefine(n),o=this._getStartWithParent(n,e);r&&e.addDefinition(r,i),this._addStartWithParent(t,e,o)},_getStartWithParent:function(t,e){var i;return n.isFunction(t)&&t.prototype instanceof o.Module?(i=e.constructor.prototype.startWithParent,!!n.isUndefined(i)||i):!n.isObject(t)||(i=t.startWithParent,!!n.isUndefined(i)||i)},_getDefine:function(t){return!n.isFunction(t)||t.prototype instanceof o.Module?n.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,n){e.startWithParent=e.startWithParent&&n,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer((function(t){e.startWithParent&&e.start(t)})))}}),o}(o,t,e)}.apply(e,i),void 0===r||(t.exports=r)}(this)},function(t,e,n){var i,r;i=[n(75),n(76)],r=function(t,e){return function(t,e){"use strict";var n=t.Wreqr,i=t.Wreqr={};return t.Wreqr.VERSION="1.3.6",t.Wreqr.noConflict=function(){return t.Wreqr=n,this},i.Handlers=function(t,e){var n=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events,{setHandlers:function(t){e.each(t,(function(t,n){var i=null;e.isObject(t)&&!e.isFunction(t)&&(i=t.context,t=t.callback),this.setHandler(n,t,i)}),this)},setHandler:function(t,e,n){var i={callback:e,context:n};this._wreqrHandlers[t]=i,this.trigger("handler:add",t,e,n)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){return e.callback.apply(e.context,arguments)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(t,e),i.CommandStorage=function(){var n=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(n.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){this.getCommands(t).instances.push(e)},clearCommands:function(t){this.getCommands(t).instances=[]}}),n}(),i.Commands=function(t,e){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),t.Handlers.prototype.constructor.apply(this,arguments)},execute:function(t){t=arguments[0];var n=e.rest(arguments);this.hasHandler(t)?this.getHandler(t).apply(this,n):this.storage.addCommand(t,n)},_executeCommands:function(t,n,i){var r=this.storage.getCommands(t);e.each(r.instances,(function(t){n.apply(i,t)})),this.storage.clearCommands(t)},_initializeStorage:function(t){var n,i=t.storageType||this.storageType;n=e.isFunction(i)?new i:i,this.storage=n}})}(i,e),i.RequestResponse=function(t,e){return t.Handlers.extend({request:function(t){return this.hasHandler(t)?this.getHandler(t).apply(this,e.rest(arguments)):void 0}})}(i,e),i.EventAggregator=function(t,e){var n=function(){};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events),n}(t,e),i.Channel=function(n){var i=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,n,i){if(n){i=i||this;var r="vent"===t?"on":"setHandler";e.each(n,(function(n,o){this[t][r](o,e.bind(n,i))}),this)}}}),i}(),i.radio=function(t,e){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(n.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var n=this._channels[e];return n||(n=new t.Channel(e),this._channels[e]=n),n},_proxyMethods:function(){e.each(["vent","commands","reqres"],(function(t){e.each(i[t],(function(e){this[t][e]=r(this,t,e)}),this)}),this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(t,n,i){return function(r){var o=t._getChannel(r)[n];return o[i].apply(o,e.rest(arguments))}};return new n}(i,e),t.Wreqr}(t,e)}.apply(e,i),void 0===r||(t.exports=r)},function(t,e,n){var i,r;i=[n(75),n(76)],r=function(t,e){return function(t,e){"use strict";var n=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var n=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(n.prototype,{add:function(t,e){var n=t.cid;return this._views[n]=t,t.model&&(this._indexByModel[t.model.cid]=n),e&&(this._indexByCustom[e]=n),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var n=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,(function(t,e){return t===n?(delete this._indexByCustom[e],!0):void 0}),this),delete this._views[n],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,n){e.each(this._views,(function(i){e.isFunction(i[t])&&i[t].apply(i,n||[])}))},_updateLength:function(){this.length=e.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return e.each(i,(function(t){n.prototype[t]=function(){var n=[e.values(this._views)].concat(e.toArray(arguments));return e[t].apply(e,n)}})),n}(0,e),t.ChildViewContainer.VERSION="0.1.11",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=n,this},t.ChildViewContainer}(t,e)}.apply(e,i),void 0===r||(t.exports=r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(78)),u=l(n(104)),h=l(n(111)),d=l(n(112)),f=s("Root Element"),p=s("Layout"),m=s("Router"),v=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this[f]=t.el,this[p]=new u.default,this[p].$el.appendTo(this[f]),this[m]=new h.default({controller:new d.default({application:this,resourcePath:t.resourcePath,apiBaseURL:t.apiBaseURL})}),this[p].render()}return r(e,t),o(e,[{key:"layout",get:function(){return this[p]}},{key:"router",get:function(){return this[m]}}]),e}(c.default.Application);e.default=v,t.exports=e.default},function(t,e,n){"use strict";var i=n(83).default;e.default=function(t,e,n){for(var r=!0;r;){var o=t,a=e,s=n;r=!1,null===o&&(o=Function.prototype);var l=i(o,a);if(void 0!==l){if("value"in l)return l.value;var c=l.get;return void 0===c?void 0:c.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;t=u,e=a,n=s,r=!0,l=u=void 0}},e.__esModule=!0},function(t,e,n){t.exports={default:n(84),__esModule:!0}},function(t,e,n){var i=n(35);n(85),t.exports=function(t,e){return i.getDesc(t,e)}},[465,50,86],[466,28,30,38],function(t,e,n){"use strict";var i=n(88).default,r=n(90).default;e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=i(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r?r(t,e):t.__proto__=e)},e.__esModule=!0},function(t,e,n){t.exports={default:n(89),__esModule:!0}},function(t,e,n){var i=n(35);t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){t.exports={default:n(91),__esModule:!0}},function(t,e,n){n(92),t.exports=n(30).Object.setPrototypeOf},[467,28,63],function(t,e,n){"use strict";var i=n(94).default;e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i(t,r.key,r)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),e.__esModule=!0},function(t,e,n){t.exports={default:n(95),__esModule:!0}},function(t,e,n){var i=n(35);t.exports=function(t,e,n){return i.setDesc(t,e,n)}},function(t,e){"use strict";e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e.__esModule=!0},function(t,e,n){t.exports={default:n(98),__esModule:!0}},function(t,e,n){n(99),n(21),t.exports=n(30).Symbol},[468,35,29,39,37,28,33,38,44,42,45,43,100,101,102,103,56,50,36,27],[469,35,50],[470,50,35],[471,35],[472,52],function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(105)),h=n(107),d=s("regions"),f=s("interactiveUI"),p=s("events"),m=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this[f]=!0}return r(e,t),o(e,[{key:"onLinkClick",value:function(t){u.default.navigateToAbsoluteUrl({url:t.currentTarget.href})&&t.preventDefault()}},{key:"tagName",get:function(){return"section"}},{key:"className",get:function(){return"sm-starmap-application"}},{key:"template",get:function(){return h}},{key:"regions",get:function(){return this[d]=this[d]||{header:"#sm-header-region",map:"#sm-map-region",controls:"#sm-controls-region",disc:"#sm-disc-region",modal:"#sm-modal-region"},this[d]},set:function(t){this[d]=t}},{key:"interactiveUI",get:function(){return this[f]},set:function(t){t?this.$el.removeClass("sm-non-interactive"):this.$el.addClass("sm-non-interactive"),this[f]=t}},{key:"events",get:function(){return this[p]=this[p]||{"click a[href]":"onLinkClick"}},set:function(t){this[p]=t}}]),e}(c.LayoutView);e.default=m,t.exports=e.default},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var a=n(106),s=n(75),l=o(n(76)),c=function(){function t(){r(this,t)}return i(t,null,[{key:"navigateToAbsoluteUrl",value:function(e){var n=e.url,i=e.options;(i=i||{}).trigger=!!l.default.isUndefined(i.trigger)||i.trigger;var r=t.getFragment({url:n});return null!==r&&(s.history.navigate(r,i),!0)}},{key:"getFragment",value:function(t){var e=t.url,n=t.options;(n=n||{}).removeHash=!!l.default.isUndefined(n.removeHash)||n.removeHash;var i=(e=e||a.location.href).indexOf("?")>-1;n.removeQueryString&&i&&(e=e.substring(0,e.indexOf("?")));var r=e.indexOf("#")>-1;n.removeHash&&r&&(e=e.substring(0,e.indexOf("#")));var o=e.substring(e.indexOf(a.location.host)+a.location.host.length),c=s.history.root.substring(0,s.history.root.length-1),u=o===c?c:s.history.root;return 0!==o.indexOf(u)?null:o.substring(u.length)}}]),t}();e.default=c,t.exports=e.default},function(t,e){(function(e){"undefined"!=typeof window?t.exports=window:void 0!==e?t.exports=e:"undefined"!=typeof self?t.exports=self:t.exports={}}).call(e,function(){return this}())},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{r(null,o+='<div id="sm-header-region"></div>\n<div id="sm-map-region"></div>\n<div id="sm-controls-region"></div>\n<div id="sm-modal-region"></div>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i;!function(){var r={};!function(){"use strict";r.object=function t(e,n,i){var r=function(){};r.prototype=e.prototype;var o=new r,a=/xyz/.test((function(){xyz}))?/\bparent\b/:/.*/;for(var s in i=i||{}){var l=i[s],c=o[s];"function"==typeof c&&"function"==typeof l&&a.test(l)?o[s]=function(t,e){return function(){var n=this.parent;this.parent=e;var i=t.apply(this,arguments);return this.parent=n,i}}(l,c):o[s]=l}o.typename=n;var u=function(){o.init&&o.init.apply(this,arguments)};return(u.prototype=o).constructor=u,u.extend=function(e,n){return"object"==typeof e&&(n=e,e="anonymous"),t(u,e,n)},u}(Object,"Object",{})}(),function(){"use strict";var t=Array.prototype,e=Object.prototype,n={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},i=/[&"'<>]/g,o=function(t){return n[t]},a=r.lib={};a.withPrettyErrors=function(t,e,n){try{return n()}catch(n){if(n.Update||(n=new a.TemplateError(n)),n.Update(t),!e){var i=n;(n=new Error(i.message)).name=i.name}throw n}},a.TemplateError=function(t,e,n){var i=this;return t instanceof Error?(i=t,t=t.name+": "+t.message):Error.captureStackTrace&&Error.captureStackTrace(i),i.name="Template render error",i.message=t,i.lineno=e,i.colno=n,i.firstUpdate=!0,i.Update=function(t){var e="("+(t||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?e+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(e+=" [Line "+this.lineno+"]")),e+="\n ",this.firstUpdate&&(e+=" "),this.message=e+(this.message||""),this.firstUpdate=!1,this},i},a.TemplateError.prototype=Error.prototype,a.escape=function(t){return t.replace(i,o)},a.isFunction=function(t){return"[object Function]"===e.toString.call(t)},a.isArray=Array.isArray||function(t){return"[object Array]"===e.toString.call(t)},a.isString=function(t){return"[object String]"===e.toString.call(t)},a.isObject=function(t){return"[object Object]"===e.toString.call(t)},a.groupBy=function(t,e){for(var n={},i=a.isFunction(e)?e:function(t){return t[e]},r=0;r<t.length;r++){var o=t[r],s=i(o,r);(n[s]||(n[s]=[])).push(o)}return n},a.toArray=function(t){return Array.prototype.slice.call(t)},a.without=function(t){var e=[];if(!t)return e;for(var n=-1,i=t.length,r=a.toArray(arguments).slice(1);++n<i;)-1===a.indexOf(r,t[n])&&e.push(t[n]);return e},a.extend=function(t,e){for(var n in e)t[n]=e[n];return t},a.repeat=function(t,e){for(var n="",i=0;e>i;i++)n+=t;return n},a.each=function(e,n,i){if(null!=e)if(t.each&&e.each===t.each)e.forEach(n,i);else if(e.length===+e.length)for(var r=0,o=e.length;o>r;r++)n.call(i,e[r],r,e)},a.map=function(e,n){var i=[];if(null==e)return i;if(t.map&&e.map===t.map)return e.map(n);for(var r=0;r<e.length;r++)i[i.length]=n(e[r],r);return e.length===+e.length&&(i.length=e.length),i},a.asyncIter=function(t,e,n){var i=-1;!function r(){++i<t.length?e(t[i],i,r,n):n()}()},a.asyncFor=function(t,e,n){var i=a.keys(t),r=i.length,o=-1;!function a(){o++;var s=i[o];r>o?e(s,t[s],o,r,a):n()}()},a.indexOf=Array.prototype.indexOf?function(t,e,n){return Array.prototype.indexOf.call(t,e,n)}:function(t,e,n){var i=this.length>>>0;for(n=+n||0,Math.abs(n)===1/0&&(n=0),0>n&&(0>(n+=i)&&(n=0));i>n;n++)if(t[n]===e)return n;return-1},Array.prototype.map||(Array.prototype.map=function(){throw new Error("map is unimplemented for this js engine")}),a.keys=function(t){if(Object.prototype.keys)return t.keys();var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}}(),function(){"use strict";function t(t){var e=t.length;if(0===e)return 0;var n=t[e-1];return n&&n.hasOwnProperty("__keywords")?e-1:e}function e(t){return"string"!=typeof t?t:void(this.val=t)}var n=r.lib,i=r.object.extend({init:function(t){this.variables={},this.parent=t},set:function(t,e,n){var i=t.split("."),r=this.variables,o=this;if(n){if(o=this.resolve(i[0]))return void o.set(t,e);o=this}for(var a=0;a<i.length-1;a++){var s=i[a];r[s]||(r[s]={}),r=r[s]}r[i[i.length-1]]=e},get:function(t){var e=this.variables[t];return null!=e?e:null},lookup:function(t){var e=this.parent,n=this.variables[t];return null!=n?n:e&&e.lookup(t)},resolve:function(t){var e=this.parent,n=this.variables[t];return null!=n?this:e&&e.resolve(t)},push:function(){return new i(this)},pop:function(){return this.parent}});e.prototype=Object.create(String.prototype),e.prototype.valueOf=function(){return this.val},e.prototype.toString=function(){return this.val},r.runtime={Frame:i,makeMacro:function(e,n,i){return function(){var r,o=t(arguments),a=function(t){var e=t.length;if(e){var n=t[e-1];if(n&&n.hasOwnProperty("__keywords"))return n}return{}}(arguments);if(o>e.length){r=Array.prototype.slice.call(arguments,0,e.length);for(var s=Array.prototype.slice.call(arguments,r.length,o),l=0;l<s.length;l++)l<n.length&&(a[n[l]]=s[l]);r.push(a)}else if(o<e.length){r=Array.prototype.slice.call(arguments,0,o);for(l=o;l<e.length;l++){var c=e[l];r.push(a[c]),delete a[c]}r.push(a)}else r=arguments;return i.apply(this,r)}},makeKeywordArgs:function(t){return t.__keywords=!0,t},numArgs:t,suppressValue:function(t,e){return t=null!=t?t:"",e&&"string"==typeof t&&(t=n.escape(t)),t},memberLookup:function(t,e){return"function"==typeof(t=t||{})[e]?function(){return t[e].apply(t,arguments)}:t[e]},contextOrFrameLookup:function(t,e,n){var i=e.lookup(n);return null!=i?i:t.lookup(n)},callWrap:function(t,e,n){if(!t)throw new Error("Unable to call `"+e+"`, which is undefined or falsey");if("function"!=typeof t)throw new Error("Unable to call `"+e+"`, which is not a function");return t.apply(this,n)},handleError:function(t,e,i){return t.lineno?t:new n.TemplateError(t,e,i)},isArray:n.isArray,keys:n.keys,SafeString:e,copySafeness:function(t,n){return t instanceof e?new e(n):n.toString()},markSafe:function(t){var n=typeof t;return"string"===n?new e(t):"function"!==n?t:function(){var n=t.apply(this,arguments);return"string"==typeof n?new e(n):n}},asyncEach:function(t,e,i,r){if(n.isArray(t)){var o=t.length;n.asyncIter(t,(function(t,n,r){switch(e){case 1:i(t,n,o,r);break;case 2:i(t[0],t[1],n,o,r);break;case 3:i(t[0],t[1],t[2],n,o,r);break;default:t.push(n,r),i.apply(this,t)}}),r)}else n.asyncFor(t,(function(t,e,n,r,o){i(t,e,n,r,o)}),r)},asyncAll:function(t,e,i,r){function o(t,e){l++,s[t]=e,l===a&&r(null,s.join(""))}var a,s,l=0;if(n.isArray(t))if(a=t.length,s=new Array(a),0===a)r(null,"");else for(var c=0;c<t.length;c++){var u=t[c];switch(e){case 1:i(u,c,a,o);break;case 2:i(u[0],u[1],c,a,o);break;case 3:i(u[0],u[1],u[2],c,a,o);break;default:u.push(c,o),i.apply(this,u)}}else{var h=n.keys(t);if(a=h.length,s=new Array(a),0===a)r(null,"");else for(c=0;c<h.length;c++){var d=h[c];i(d,t[d],c,a,o)}}}}}(),function(){"use strict";var t=r.path,e=r.object,n=r.lib,i=e.extend({on:function(t,e){this.listeners=this.listeners||{},this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e)},emit:function(t){var e=Array.prototype.slice.call(arguments,1);this.listeners&&this.listeners[t]&&n.each(this.listeners[t],(function(t){t.apply(null,e)}))},resolve:function(e,n){return t.resolve(t.dirname(e),n)},isRelative:function(t){return 0===t.indexOf("./")||0===t.indexOf("../")}});r.loader=i}(),function(){"use strict";var t=r.loader.extend({init:function(t,e){this.precompiled=window.nunjucksPrecompiled||{},this.baseURL=t||"",this.neverUpdate=e},getSource:function(t){if(this.precompiled[t])return{src:{type:"code",obj:this.precompiled[t]},path:t};var e=this.fetch(this.baseURL+"/"+t);return e?{src:e,path:t,noCache:!this.neverUpdate}:null},fetch:function(t,e){var n,i,r=!0;return window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n.onreadystatechange=function(){4!==n.readyState||0!==n.status&&200!==n.status||!r||(r=!1,i=n.responseText)},t+=(-1===t.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),n.open("GET",t,!1),n.send(),i}});r["web-loaders"]={WebLoader:t}}(),function(){"undefined"==typeof window||window!==this?r.loaders=r["node-loaders"]:r.loaders=r["web-loaders"]}(),function(){"use strict";var t=r.lib,e=r.runtime,n={abs:function(t){return Math.abs(t)},batch:function(t,e,n){for(var i=[],r=[],o=0;o<t.length;o++)o%e==0&&r.length&&(i.push(r),r=[]),r.push(t[o]);if(r.length){if(n)for(o=r.length;e>o;o++)r.push(n);i.push(r)}return i},capitalize:function(t){var n=t.toLowerCase();return e.copySafeness(t,n.charAt(0).toUpperCase()+n.slice(1))},center:function(n,i){if(i=i||80,n.length>=i)return n;var r=i-n.length,o=t.repeat(" ",r/2-r%2),a=t.repeat(" ",r/2);return e.copySafeness(n,o+n+a)},default:function(t,e){return t||e},dictsort:function(e,n,i){if(!t.isObject(e))throw new t.TemplateError("dictsort filter: val must be an object");var r,o=[];for(var a in e)o.push([a,e[a]]);if(void 0===i||"key"===i)r=0;else{if("value"!==i)throw new t.TemplateError("dictsort filter: You can only sort by either key or value");r=1}return o.sort((function(e,i){var o=e[r],a=i[r];return n||(t.isString(o)&&(o=o.toUpperCase()),t.isString(a)&&(a=a.toUpperCase())),o>a?1:o===a?0:-1})),o},escape:function(n){return"string"==typeof n||n instanceof e.SafeString?t.escape(n):n},safe:function(t){return e.markSafe(t)},first:function(t){return t[0]},groupby:function(e,n){return t.groupBy(e,n)},indent:function(n,i,r){i=i||4;for(var o="",a=n.split("\n"),s=t.repeat(" ",i),l=0;l<a.length;l++)o+=0!==l||r?s+a[l]+"\n":a[l]+"\n";return e.copySafeness(n,o)},join:function(e,n,i){return n=n||"",i&&(e=t.map(e,(function(t){return t[i]}))),e.join(n)},last:function(t){return t[t.length-1]},length:function(t){return void 0!==t?t.length:0},list:function(e){if(t.isString(e))return e.split("");if(t.isObject(e)){var n=[];if(Object.keys)n=Object.keys(e);else for(var i in e)n.push(i);return t.map(n,(function(t){return{key:t,value:e[t]}}))}if(t.isArray(e))return e;throw new t.TemplateError("list filter: type not iterable")},lower:function(t){return t.toLowerCase()},random:function(t){return t[Math.floor(Math.random()*t.length)]},rejectattr:function(t,e){return t.filter((function(t){return!t[e]}))},selectattr:function(t,e){return t.filter((function(t){return!!t[e]}))},replace:function(t,n,i,r){if(n instanceof RegExp)return t.replace(n,i);var o=t,a=o,s=1;for(o=o.replace(n,i);a!==o&&!(s>=r);)a=o,o=o.replace(n,i),s++;return e.copySafeness(t,o)},reverse:function(i){var r;return(r=t.isString(i)?n.list(i):t.map(i,(function(t){return t}))).reverse(),t.isString(i)?e.copySafeness(i,r.join("")):r},round:function(t,e,n){e=e||0;var i=Math.pow(10,e);return("ceil"===n?Math.ceil:"floor"===n?Math.floor:Math.round)(t*i)/i},slice:function(t,e,n){for(var i=Math.floor(t.length/e),r=t.length%e,o=0,a=[],s=0;e>s;s++){var l=o+s*i;r>s&&o++;var c=o+(s+1)*i,u=t.slice(l,c);n&&s>=r&&u.push(n),a.push(u)}return a},sort:function(e,n,i,r){return(e=t.map(e,(function(t){return t}))).sort((function(e,o){var a,s;return r?(a=e[r],s=o[r]):(a=e,s=o),!i&&t.isString(a)&&t.isString(s)&&(a=a.toLowerCase(),s=s.toLowerCase()),s>a?n?1:-1:a>s?n?-1:1:0})),e},string:function(t){return e.copySafeness(t,t)},title:function(t){for(var i=t.split(" "),r=0;r<i.length;r++)i[r]=n.capitalize(i[r]);return e.copySafeness(t,i.join(" "))},trim:function(t){return e.copySafeness(t,t.replace(/^\s*|\s*$/g,""))},truncate:function(t,n,i,r){var o=t;if(n=n||255,t.length<=n)return t;if(i)t=t.substring(0,n);else{var a=t.lastIndexOf(" ",n);-1===a&&(a=n),t=t.substring(0,a)}return t+=null!=r?r:"...",e.copySafeness(o,t)},upper:function(t){return t.toUpperCase()},urlencode:function(e){var n,i=encodeURIComponent;if(t.isString(e))return i(e);if(t.isArray(e))n=e.map((function(t){return i(t[0])+"="+i(t[1])}));else for(var r in n=[],e)e.hasOwnProperty(r)&&n.push(i(r)+"="+i(e[r]));return n.join("&")},urlize:function(t,e,n){isNaN(e)&&(e=1/0);var i=!0===n?' rel="nofollow"':"",r=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,o=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,a=/^https?:\/\/.*$/,s=/^www\./,l=/\.(?:org|net|com)(?:\:|\/|$)/,c=t.split(/\s+/).filter((function(t){return t&&t.length})).map((function(t){var n=t.match(r),c=n&&n[1]||t;return a.test(c)?'<a href="'+c+'"'+i+">"+c.substr(0,e)+"</a>":s.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,e)+"</a>":o.test(c)?'<a href="mailto:'+c+'">'+c+"</a>":l.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,e)+"</a>":t}));return c.join(" ")},wordcount:function(t){var e=t?t.match(/\w+/g):null;return e?e.length:null},float:function(t,e){var n=parseFloat(t);return isNaN(n)?e:n},int:function(t,e){var n=parseInt(t,10);return isNaN(n)?e:n}};n.d=n.default,n.e=n.escape,r.filters=n}(),function(){"use strict";var t={range:function(t,e,n){e?n||(n=1):(e=t,t=0,n=1);for(var i=[],r=t;e>r;r+=n)i.push(r);return i},cycler:function(){return function(t){var e=-1;return{current:null,reset:function(){e=-1,this.current=null},next:function(){return++e>=t.length&&(e=0),this.current=t[e],this.current}}}(Array.prototype.slice.call(arguments))},joiner:function(t){return function(t){t=t||",";var e=!0;return function(){var n=e?"":t;return e=!1,n}}(t)}};r.globals=t}(),function(){"use strict";var t=r.path,e=r.lib,n=r.object,i=(r.lexer,r.compiler),o=r.filters,a=r.loaders,s=r.runtime,l=r.globals,c=s.Frame,u=n.extend({init:function(t,n){n=this.opts=n||{};for(var i in this.opts.dev=!!n.dev,this.opts.autoescape=!!n.autoescape,this.opts.trimBlocks=!!n.trimBlocks,this.opts.lstripBlocks=!!n.lstripBlocks,t?this.loaders=e.isArray(t)?t:[t]:a.FileSystemLoader?this.loaders=[new a.FileSystemLoader("views")]:this.loaders=[new a.WebLoader("/views")],this.initCache(),this.filters={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],o)this.addFilter(i,o[i])},initCache:function(){e.each(this.loaders,(function(t){t.cache={},"function"==typeof t.on&&t.on("update",(function(e){t.cache[e]=null}))}))},addExtension:function(t,e){e._name=t,this.extensions[t]=e,this.extensionsList.push(e)},getExtension:function(t){return this.extensions[t]},addGlobal:function(t,e){l[t]=e},addFilter:function(t,e,n){var i=e;n&&this.asyncFilters.push(t),this.filters[t]=i},getFilter:function(t){if(!this.filters[t])throw new Error("filter not found: "+t);return this.filters[t]},resolveTemplate:function(t,e,n){return!(!t.isRelative||!e)&&t.isRelative(n)&&t.resolve?t.resolve(e,n):n},getTemplate:function(t,n,i,r){var o,a=this,s=null;if(t&&t.raw&&(t=t.raw),e.isFunction(i)&&(r=i,i=null,n=n||!1),e.isFunction(n)&&(r=n,n=!1),"string"!=typeof t)throw new Error("template names must be a string: "+t);for(var l=0;l<this.loaders.length;l++){var c=this.resolveTemplate(this.loaders[l],i,t);if(s=this.loaders[l].cache[c])break}return s?(n&&s.compile(),r?void r(null,s):s):(e.asyncIter(this.loaders,(function(e,n,r,o){function s(t){t?(t.loader=e,o(t)):r()}t=a.resolveTemplate(e,i,t),e.async?e.getSource(t,(function(t,e){if(t)throw t;s(e)})):s(e.getSource(t))}),function(e){if(e){var i=new d(e.src,this,e.path,n);e.noCache||(e.loader.cache[t]=i),r?r(null,i):o=i}else{var a=new Error("template not found: "+t);if(!r)throw a;r(a)}}.bind(this)),o)},express:function(e){function n(e,n){if(this.name=e,this.path=e,this.defaultEngine=n.defaultEngine,this.ext=t.extname(e),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}var i=this;n.prototype.render=function(t,e){i.render(this.name,t,e)},e.set("view",n)},render:function(t,n,i){e.isFunction(n)&&(i=n,n=null);var r=null;return this.getTemplate(t,(function(t,e){if(t&&i)i(t);else{if(t)throw t;e.render(n,i||function(t,e){if(t)throw t;r=e})}})),r},renderString:function(t,n,i,r){return e.isFunction(i)&&(r=i,i={}),new d(t,this,(i=i||{}).path).render(n,r)}}),h=n.extend({init:function(t,e){for(var n in this.ctx=t,this.blocks={},this.exported=[],e)this.addBlock(n,e[n])},lookup:function(t){return t in l&&!(t in this.ctx)?l[t]:this.ctx[t]},setVariable:function(t,e){this.ctx[t]=e},getVariables:function(){return this.ctx},addBlock:function(t,e){this.blocks[t]=this.blocks[t]||[],this.blocks[t].push(e)},getBlock:function(t){if(!this.blocks[t])throw new Error('unknown block "'+t+'"');return this.blocks[t][0]},getSuper:function(t,n,i,r,o,a){var s=e.indexOf(this.blocks[n]||[],i),l=this.blocks[n][s+1];if(-1===s||!l)throw new Error('no super block available for "'+n+'"');l(t,this,r,o,a)},addExport:function(t){this.exported.push(t)},getExported:function(){for(var t={},e=0;e<this.exported.length;e++){var n=this.exported[e];t[n]=this.ctx[n]}return t}}),d=n.extend({init:function(t,n,i,r){if(this.env=n||new u,e.isObject(t))switch(t.type){case"code":this.tmplProps=t.obj;break;case"string":this.tmplStr=t.obj}else{if(!e.isString(t))throw new Error("src must be a string or an object describing the source");this.tmplStr=t}this.path=i,r?e.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this)):this.compiled=!1},render:function(t,n,i){return"function"==typeof t?(i=t,t={}):"function"==typeof n&&(i=n,n=null),e.withPrettyErrors(this.path,this.env.dev,function(){try{this.compile()}catch(t){if(i)return i(t);throw t}var e=new h(t||{},this.blocks),r=null;return this.rootRenderFunc(this.env,e,n||new c,s,i||function(t,e){if(t)throw t;r=e}),r}.bind(this))},getExported:function(t,e,n){"function"==typeof t&&(n=t,t={}),"function"==typeof e&&(n=e,e=null);try{this.compile()}catch(t){if(n)return n(t);throw t}var i=new h(t||{},this.blocks);this.rootRenderFunc(this.env,i,e||new c,s,(function(){n(null,i.getExported())}))},compile:function(){this.compiled||this._compile()},_compile:function(){var t;if(this.tmplProps)t=this.tmplProps;else{var e=i.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);t=new Function(e)()}this.blocks=this._getBlocks(t),this.rootRenderFunc=t.root,this.compiled=!0},_getBlocks:function(t){var e={};for(var n in t)"b_"===n.slice(0,2)&&(e[n.slice(2)]=t[n]);return e}});r.environment={Environment:u,Template:d}}();var o,a,s=r.lib,l=r.environment,c=r.compiler,u=r.parser,h=r.lexer,d=r.runtime,f=r.loader,p=r.loaders,m=r.precompile;(o={}).Environment=l.Environment,o.Template=l.Template,o.Loader=f,o.FileSystemLoader=p.FileSystemLoader,o.WebLoader=p.WebLoader,o.compiler=c,o.parser=u,o.lexer=h,o.runtime=d,o.configure=function(t,e){e=e||{},s.isObject(t)&&(e=t,t=null);var n="watch"in e&&!e.watch,i=p.FileSystemLoader||p.WebLoader;return a=new l.Environment(new i(t,n),e),e&&e.express&&a.express(e.express),a},o.compile=function(t,e,n,i){return a||o.configure(),new o.Template(t,e,n,i)},o.render=function(t,e,n){return a||o.configure(),a.render(t,e,n)},o.renderString=function(t,e,n){return a||o.configure(),a.renderString(t,e,n)},m&&(o.precompile=m.precompile,o.precompileString=m.precompileString),o.require=function(t){return r[t]},void 0===(i=function(){return o}.call(e,n,e,t))||(t.exports=i)}()},function(t,e){"use strict";var n;n=function(t){t.addFilter("stringify",(function(t){return JSON.stringify(t,null,2)}))},t.exports=n},function(t,e){t.exports=function(t,e,n,i){var r=n.root;n.root=function(t,e,n,o,a){var s=t.getTemplate;t.getTemplate=function(t,e,r,o){"function"==typeof e&&(o=e,e=!1);var a=function(t){try{return i[t]}catch(e){if(n.get("_require"))return n.get("_require")(t)}},s=a(t);n.set("_require",a),e&&s.compile(),o(null,s)},r(t,e,n,o,(function(e,n){t.getTemplate=s,a(e,n)}))};var o={obj:n,type:"code"};return new t.Template(o,e)}},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(78),c=s(n(76)),u=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"_parseQueryString",value:function(t){return t=t||"",c.default.object(t.split("&").map((function(t){return t.split("=")})))}},{key:"execute",value:function(){for(var t=this._getController(),n=!1,r=arguments.length,o=Array(r),a=0;r>a;a++)o[a]=arguments[a];return o[1].push(this._parseQueryString(o[1].pop())),t&&c.default.isFunction(t.onBeforeRoute)&&(n=t.onBeforeRoute.apply(t,o)),!n&&(i(Object.getPrototypeOf(e.prototype),"execute",this).apply(this,o),void(t&&c.default.isFunction(t.onAfterRoute)&&t.onAfterRoute.apply(t,o)))}},{key:"appRoutes",get:function(){return c.default.invert(e.ROUTES)}}],[{key:"ROUTES",get:function(){return{display:"",routes:"routes",bookmarks:"bookmarks",search:"search"}}}]),e}(l.AppRouter);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(19).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=(c(n(113)),n(122)),d=c(h),f=c(n(138)),p=c(n(148)),m=c(n(167)),v=c(n(188)),g=c(n(399)),y=c(n(432)),b=c(n(76)),x=s("Application"),w=s("Resource path"),_=s("API base URL"),S=s("Controller._initialized"),M=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this[x]=t.application,this[w]=t.resourcePath,this[_]=t.apiBaseURL,this[S]=!1}return r(e,t),o(e,[{key:"onBeforeRoute",value:function(t,e,n){this[S]||this._initialize(e)}},{key:"_initialize",value:function(t){var e=this;if(y.default.webgl){var n=b.default.last(t);this.starmap=new p.default({resourcePath:this[w],apiBaseURL:this[_],state:n}),this.layout.map.show(new v.default({model:this.starmap,layout:this.layout}));var i=new d.default({model:this.starmap});this.listenTo(i,"end",this.onLoadingEnd);var r=this.starmap.get("soundFX").get("resourcePath")+"/sounds",o=this.starmap.get("soundFX").getSoundService();l.all([o.load("loading:logos:1",r+"/SE_LoadingLogo1.wav","loading:sfx"),o.load("loading:logos:2",r+"/SE_LoadingLogo2.wav","loading:sfx"),o.load("loading:enter-button:appear",r+"/SE_LoadingEnterButtonAppear.wav","loading:sfx"),o.load("loading:enter-button:hover",r+"/SE_LoadingEnterButtonHover.wav","loading:sfx"),o.load("loading:background-music:main",r+"/SE_LoadingBackground_LOOP.wav","loading:bgm",{loop:!0}),o.load("loading:background-music:extra",r+"/SE_LoadingBackgroundExtra_LOOP.wav","loading:bgm",{loop:!0})]).then((function(){return e.layout.modal.show(i)})),this[S]=!0}else this._handleNoWebgl()}},{key:"_handleNoWebgl",value:function(){var t=new d.default({noWebgl:!0});this.layout.modal.show(t)}},{key:"onLoadingEnd",value:function(){this.layout.modal.empty(),this.layout.header.show(new f.default({model:this.starmap})),this.layout.controls.show(new g.default({model:this.starmap}))}},{key:"onAfterRoute",value:function(){}},{key:"display",value:function(t){this.starmap.allLoaded.then((function(t){return setTimeout((function(){t.get("interface").set("tab",m.default.TABS.display)})),t}))}},{key:"routes",value:function(){this.starmap.allLoaded.then((function(t){return setTimeout((function(){t.get("interface").set("tab",m.default.TABS.routes)})),t}))}},{key:"bookmarks",value:function(){this.starmap.allLoaded.then((function(t){return setTimeout((function(){t.get("interface").set("tab",m.default.TABS.bookmarks)})),t}))}},{key:"search",value:function(){this.starmap.allLoaded.then((function(t){return setTimeout((function(){t.get("interface").set("tab",m.default.TABS.search)})),t}))}},{key:"application",get:function(){return this[x]}},{key:"router",get:function(){return this.application.router}},{key:"layout",get:function(){return this.application.layout}}]),e}(u.Object);e.default=M,t.exports=e.default},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(19).default,a=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var s=(a(n(106)),n(114)),l=a(s),c=a(n(116)),u=a(n(120)),h=(n(121),["selectSystem","selectBody","selectJumpPoint","selectNothing","hoverSystemIn","hoverSystemOut","hoverBodyIn","hoverBodyOut","hoverJumpPointIn","hoverJumpPointOut"]),d={LEFT_BUTTON:0,RIGHT_BUTTON:2},f=function(){function t(e,n){r(this,t),this._core=e,this._canvas=l.default.createDocumentFragment(),this._eventTarget=l.default.createDocumentFragment(),this._selectedLocation=null,this._longRangeScanner=new u.default(this),this._location=c.default.Galaxy,this._locationIsZoomed=!1,this._resourcePath}return i(t,[{key:"start",value:function(){var t=this;return h.forEach((function(e){var n="_on"+(e[0].toUpperCase()+e.slice(1));t[n]&&t._core.addEventListener(e,t[n].bind(t))})),this._core.load()}},{key:"destroy",value:function(){var t=this;h.forEach((function(e){var n="_on"+(e[0].toUpperCase()+e.slice(1));t[n]&&t._core.removeEventListener(e,t[n].bind(t))}))}},{key:"addEventListener",value:function(t,e){return this._eventTarget.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){return this._eventTarget.removeEventListener(t,e)}},{key:"goToLocation",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=o.resolve();if(this._location.equals(t)&&this._locationIsZoomed)return i;var r=this._location.type,a=t.type;return r===c.default.Types.GALAXY?(i=i.then((function(n){return e._goToStarSystem(t)})),(a===c.default.Types.CELESTIAL_OBJECT||a===c.default.Types.JUMP_POINT)&&(i=i.then((function(i){return e._goToObject(t,n)})))):r===c.default.Types.STAR_SYSTEM?a===c.default.Types.GALAXY?i=i.then((function(t){return e._goToGalaxy()})):a===c.default.Types.STAR_SYSTEM?i=i.then((function(t){return e._goToGalaxy()})).then((function(n){return e._goToStarSystem(t)})):(a===c.default.Types.CELESTIAL_OBJECT||a===c.default.Types.JUMP_POINT)&&(this._location.starSystemCode!==t.starSystemCode&&(i=i.then((function(t){return e._goToGalaxy()})).then((function(n){return e._goToStarSystem(t)}))),i=i.then((function(i){return e._goToObject(t,n)}))):(r===c.default.Types.CELESTIAL_OBJECT||r===c.default.Types.JUMP_POINT)&&(a===c.default.Types.GALAXY?i=i.then((function(t){return e._goToGalaxy()})):a===c.default.Types.STAR_SYSTEM?(this._location.starSystemCode!==t.starSystemCode&&(i=i.then((function(t){return e._goToGalaxy()}))),i=i.then((function(n){return e._goToStarSystem(t)}))):(a===c.default.Types.CELESTIAL_OBJECT||a===c.default.Types.JUMP_POINT)&&(this._location.starSystemCode!==t.starSystemCode&&(i=i.then((function(t){return e._goToGalaxy()})).then((function(n){return e._goToStarSystem(t)}))),i=i.then((function(i){return e._goToObject(t,n)})))),this._setLocation(t,i),i}},{key:"_setLocation",value:function(t,e){this._location=t,this._eventTarget.dispatchEvent(new CustomEvent("location:change",{detail:{location:this._location,animation:e}}))}},{key:"goToParentLocation",value:function(t){return t.equals(c.default.Galaxy)?o.resolve():t.type===c.default.Types.STAR_SYSTEM?this.goToLocation(c.default.Galaxy):this.goToLocation(new c.default(c.default.Types.STAR_SYSTEM,t.starSystemCode))}},{key:"selectLocation",value:function(t){this._selectedLocation=t,t.type==c.default.Types.STAR_SYSTEM?this._core.setSystemPivot(t.starSystemCode):(t.type==c.default.Types.CELESTIAL_OBJECT||t.type==c.default.Types.JUMP_POINT)&&this._core.setPlanetaryPivot(t.starSystemCode,t.objectCode)}},{key:"unselectLocation",value:function(){this._selectedLocation=null,this._location.type===c.default.Types.GALAXY&&this._core.releaseSystemPivot()}},{key:"addStickyHoverLocation",value:function(t){t.type==c.default.Types.STAR_SYSTEM?this._core.forceSystemHighlight(t.starSystemCode):(t.type==c.default.Types.CELESTIAL_OBJECT||t.type==c.default.Types.JUMP_POINT)&&this._core.forcePlanetaryHovered(t.starSystemCode,t.objectCode)}},{key:"removeStickyHoverLocation",value:function(t){t.type==c.default.Types.STAR_SYSTEM?this._core.releaseSystemHighlight(t.starSystemCode):(t.type==c.default.Types.CELESTIAL_OBJECT||t.type==c.default.Types.JUMP_POINT)&&this._core.releasePlanetaryHovered(t.starSystemCode,t.objectCode)}},{key:"moveSelectedElementAt",value:function(t,e){this._core.setPivotScreenCoord(t,e)}},{key:"goThroughJumpPoint",value:function(t){var e=this,n=o.resolve();this._location===c.default.Types.STAR_SYSTEM&&(n=n.then((function(n){return e._goToObject(t)}))),n=n.then((function(t){return e._goToStarSystem(i)}));var i=new c.default(c.default.Types.STAR_SYSTEM,this._core.getJumpPointDestination(t.objectCode));return this._location=i,this._eventTarget.dispatchEvent(new CustomEvent("location:change",{detail:{location:this._location,animation:n}})),n}},{key:"getJumpTunnelInfo",value:function(t){var e=this._core.getInfo().systems,n=this._core.getJumpPointInfo(t.objectCode),i=e.find((function(t){return t.id===n.entry.star_system_id})),r=e.find((function(t){return t.id===n.exit.star_system_id}));return n.extra={destination:t.starSystemCode===i.code?r:i},n}},{key:"getLocationInfo",value:function(t){if(t.type===c.default.Types.GALAXY)return null;if(t.type===c.default.Types.STAR_SYSTEM)return this._core.getSystemInfo(t.starSystemCode);var e=this._core.getBodyInfo(t.starSystemCode,t.objectCode);return t.type===c.default.Types.JUMP_POINT&&(((e||{}).raw||{}).jumpInfo=this.getJumpTunnelInfo(t)),e}},{key:"getLocationCoordinates",value:function(t){if(t.type===c.default.Types.GALAXY)return null;var e;return{x:(e=t.type===c.default.Types.STAR_SYSTEM?this._core.getSystemScreenCoord(t.starSystemCode):this._core.getPlanetaryScreenCoord(t.starSystemCode,t.objectCode)).x,y:e.y}}},{key:"routingShow",value:function(t){this._core.showRouting(t)}},{key:"routingHide",value:function(){this._core.showRouting(null)}},{key:"routingGoToSegment",value:function(t){this._core.setCurrentRoutingSystem(t.system_code);var e=new c.default(c.default.Types.STAR_SYSTEM,t.system_code);this._setLocation(e,o.resolve())}},{key:"landingZoneHighlight",value:function(t,e){this._core.setLandingZoneHighlight(t.starSystemCode,t.objectCode,e.code,!0)}},{key:"landingZoneClear",value:function(t,e){this._core.setLandingZoneHighlight(t.starSystemCode,t.objectCode,e.code,!1)}},{key:"_goToGalaxy",value:function(){var t=this;return new o((function(e){return t._core.gotoGalacticView().onDone(e)}))}},{key:"_goToStarSystem",value:function(t){var e=this;return new o((function(n){return e._core.gotoSystemView().setSystemCode(t.starSystemCode).onDone(n)}))}},{key:"_goToObject",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new o((function(i){var r=e._core.gotoPlanetaryView().setPlanetaryCode(t.objectCode);n.size?(r=r.setBodyPixelSize(n.size),e._locationIsZoomed=!0):e._locationIsZoomed=!1,r=r.onDone(i)}))}},{key:"_onSelectSystem",value:function(t){var e=t.systemCode,n=t.button,i=new c.default(c.default.Types.STAR_SYSTEM,e),r=new CustomEvent("select:starsystem",{detail:{mouseButton:n,location:i},cancelable:!0});this._eventTarget.dispatchEvent(r)}},{key:"_onSelectBody",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.CELESTIAL_OBJECT,e,n),o=new CustomEvent("select:celestialobject",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"_onSelectJumpPoint",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.JUMP_POINT,e,n),o=new CustomEvent("select:jumppoint",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"_onSelectNothing",value:function(t){var e=new CustomEvent("select:none",{detail:{mouseButton:t.button},cancelable:!0});this._eventTarget.dispatchEvent(e)}},{key:"_onHoverSystemIn",value:function(t){var e=t.systemCode,n=t.button,i=new c.default(c.default.Types.STAR_SYSTEM,e),r=new CustomEvent("mouseenter:starsystem",{detail:{mouseButton:n,location:i},cancelable:!0});this._eventTarget.dispatchEvent(r)}},{key:"_onHoverSystemOut",value:function(t){var e=t.systemCode,n=t.button,i=new c.default(c.default.Types.STAR_SYSTEM,e),r=new CustomEvent("mouseleave:starsystem",{detail:{mouseButton:n,location:i},cancelable:!0});this._eventTarget.dispatchEvent(r)}},{key:"_onHoverBodyIn",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.CELESTIAL_OBJECT,e,n),o=new CustomEvent("mouseenter:celestialobject",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"_onHoverBodyOut",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.CELESTIAL_OBJECT,e,n),o=new CustomEvent("mouseleave:celestialobject",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"_onHoverJumpPointIn",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.JUMP_POINT,e,n),o=new CustomEvent("mouseenter:jumppoint",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"_onHoverJumpPointOut",value:function(t){var e=t.systemCode,n=t.planetaryCode,i=t.button,r=new c.default(c.default.Types.JUMP_POINT,e,n),o=new CustomEvent("mouseleave:jumppoint",{detail:{mouseButton:i,location:r},cancelable:!0});this._eventTarget.dispatchEvent(o)}},{key:"showLongRangeScanner",value:function(){this._core.showLongRangeScanner(!0,.25)}},{key:"hideLongRangeScanner",value:function(){this._core.showLongRangeScanner(!1,.25)}},{key:"setLongRangeScannerValues",value:function(t){var e=t.lifeform,n=t.economy,i=t.danger;this._core.setLongRangeScannerData(e/10,n/10,i/10)}},{key:"setLongRangeScannerPosition",value:function(t){var e=t.x,n=t.y;this._core.setLongRangeScannerPosition(e,n)}},{key:"setLongRangeScannerSize",value:function(t){var e=t.width,n=t.height;this._core.setLongRangeScannerSize(e,n)}},{key:"canvas",get:function(){return this._canvas}},{key:"resourcePath",get:function(){return this._resourcePath}},{key:"selectedLocation",get:function(){return this._selectedLocation}},{key:"longRangeScanner",get:function(){return this._longRangeScanner}},{key:"loadingOverlayOpacity",get:function(){return this._loadingOverlayOpacity},set:function(t){this._loadingOverlayOpacity=t,this._core.showLoadingScreen(t)}},{key:"location",get:function(){return this._location}},{key:"locationZoomed",get:function(){return this._locationIsZoomed}}],[{key:"Mouse",get:function(){return d}}]),t}();e.default=f,t.exports=e.default},function(t,e,n){(function(e){var i=void 0!==e?e:"undefined"!=typeof window?window:{},r=n(115);if("undefined"!=typeof document)t.exports=document;else{var o=i["__GLOBAL_DOCUMENT_CACHE@4"];o||(o=i["__GLOBAL_DOCUMENT_CACHE@4"]=r),t.exports=o}}).call(e,function(){return this}())},function(t,e){},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(117).default;Object.defineProperty(e,"__esModule",{value:!0});var a=o({GALAXY:"GALAXY",STAR_SYSTEM:"STAR_SYSTEM",CELESTIAL_OBJECT:"CELESTIAL_OBJECT",JUMP_POINT:"JUMP_POINT"}),s=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?a.GALAXY:arguments[0],n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2];r(this,t),this._type=e,this._starSystemCode=n,this._objectCode=i}return i(t,[{key:"equals",value:function(t){return!!t&&(this._type===t._type&&this._starSystemCode===t._starSystemCode&&this._objectCode===t._objectCode)}},{key:"toURLParams",value:function(){var t=this.objectCode||this.starSystemCode;if(!t)return null;var e="";return this.objectCode&&(e="&system="+this.starSystemCode),""+t+e}},{key:"type",get:function(){return this._type}},{key:"starSystemCode",get:function(){return this._starSystemCode}},{key:"objectCode",get:function(){return this._objectCode}}],[{key:"Galaxy",get:function(){return new t(a.GALAXY)}},{key:"Types",get:function(){return a}}]),t}();e.default=s,t.exports=e.default},function(t,e,n){t.exports={default:n(118),__esModule:!0}},function(t,e,n){n(119),t.exports=n(30).Object.freeze},[473,55,86],function(t,e,n){"use strict";var i=n(93).default,r=n(96).default;Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(e){r(this,t),this._starmapApi=e,this._hidden=!0,this._position={x:0,y:0},this._size={width:0,height:0}}return i(t,[{key:"setValues",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{lifeform:0,economy:0,danger:0}:arguments[0];this._starmapApi.setLongRangeScannerValues(t)}},{key:"hidden",get:function(){return this._hidden},set:function(t){this._hidden!==t&&(t?this._starmapApi.hideLongRangeScanner():this._starmapApi.showLongRangeScanner(),this._hidden=t)}},{key:"position",get:function(){return this._position},set:function(){var t=arguments.length<=0||void 0===arguments[0]?{x:0,y:0}:arguments[0];this._position=t,this._starmapApi.setLongRangeScannerPosition(t)}},{key:"size",get:function(){return this._size},set:function(){var t=arguments.length<=0||void 0===arguments[0]?{width:0,height:0}:arguments[0];this._size=t,this._starmapApi.setLongRangeScannerSize(t)}}]),t}();e.default=o,t.exports=e.default},function(e,n){e.exports=function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var n=e.slice(1),i=t[e[0]];return function(t,e,r){i.apply(this,[t,e,r].concat(n))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,n){function i(t){var n=new a.default,i=new b.default(t.rootElement||document.body),C=new g.default(i.renderer),T=new v.default(i.renderer.domElement),E=new y.default(C.camera,i.renderer.domElement,n),k=new l.default(n,i.renderer,C.scene,C.camera,S.window.innerWidth,S.window.innerHeight,t.resourcePath),A=new s.default(C.scene,C.camera,S.window,T.positionInVP,k,n,t.apiBaseURL+"/api/starmap",t.resourcePath,(function(){var e=t.getSessionData(),n={"Content-Type":"application/json"};return n["X-"+e.sessionName]=e.sessionId,n})),P=new c.default(S.window.innerWidth,S.window.innerHeight,C.camera,i.renderer),L=new _.default(C.camera,t.resourcePath),O=new M.default(i.initPostProcessing,T,S.window.innerWidth,S.window.innerHeight,C.camera),R=new x.default,F=new r.default(R,i,C,T,E,A,n,P,L,O);n.env=F,e.theEnvironment=F,R.addState("StateGalaxy",new o.default(R,F)),R.addState("StateEnterStarSystem",new u.default(R,F)),R.addState("StateStarSystem",new h.default(R,F)),R.addState("StateLeaveStarSystem",new d.default(R,F)),R.addState("StateCelestialBody",new f.default(R,F)),R.addState("StateEnterJumpPoint",new p.default(R,F)),R.addState("StateSlideJumpPoint",new m.default(R,F));var B=[new w.default,n,L,E,A,k,P,C,O,R,T];return i.init(B,C.camera),n}n(1),n(3),n(4),n(5),n(6),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18);var r=n(19),o=n(20),a=n(28),s=n(47),l=n(77),c=n(91),u=n(92),h=n(93),d=n(94),f=n(95),p=n(96),m=n(97),v=n(98),g=n(99),y=n(23),b=n(64),x=n(100),w=n(101),_=n(102),S=n(65),M=(n(103),n(104));e.starmapMain=i,S.window.starmapMain=i},function(e,n,i){(function(e){e.ColladaLoader=function(){function n(t,n,o){if(Et=t,n=n||At,void 0!==o){var a=o.split("/");a.pop(),Mt=(a.length<1?".":a.join("/"))+"/"}(function(){var t=Et.querySelectorAll("asset"),e=t[0];if(e&&e.childNodes)for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];switch(i.nodeName){case"unit":var r=i.getAttribute("meter");r&&(zt=parseFloat(r));break;case"up_axis":Ut=i.textContent.charAt(0)}}})(),function(){if(!0!==Vt.convertUpAxis||Ut===Vt.upAxis)Ht=null;else switch(Ut){case"X":Ht="Y"===Vt.upAxis?"XtoY":"XtoZ";break;case"Y":Ht="X"===Vt.upAxis?"YtoX":"YtoZ";break;case"Z":Ht="X"===Vt.upAxis?"ZtoX":"ZtoY"}}(),Lt=i("library_images image",y,"image"),Bt=i("library_materials material",V,"material"),Dt=i("library_effects effect",W,"effect"),Ft=i("library_geometries geometry",A,"geometry"),It=i("library_cameras camera",Q,"camera"),Nt=i("library_lights light",$,"light"),Rt=i("library_controllers controller",b,"controller"),Ot=i("library_animations animation",X,"animation"),_t=i("library_visual_scenes visual_scene",S,"visual_scene"),St=i("library_kinematics_models kinematics_model",et,"kinematics_model"),Ct=[],Tt=[],yt=function(){var t=Et.querySelectorAll("scene instance_visual_scene")[0];if(t){var e=t.getAttribute("url").replace(/^#/,"");return _t[e.length>0?e:"visual_scene0"]}return null}(),kt=new e.Group;for(var s=0;s<yt.nodes.length;s++)kt.add(d(yt.nodes[s]));kt.scale.multiplyScalar(zt),xt=[],r(kt),bt=function(){var t=Et.querySelectorAll("instance_kinematics_model")[0];if(t){var e=t.getAttribute("url").replace(/^#/,"");return St[e.length>0?e:"kinematics_model0"]}return null}(),function(){if(bt&&0===bt.joints.length)return void(wt=void 0);var t={},n=function(e,n){var i=n.getAttribute("id"),r=yt.getChildById(i,!0),o=bt.joints[e];kt.traverse((function(n){n.colladaId==i&&(t[e]={node:n,transforms:r.transforms,joint:o,position:o.zeroPosition})}))};wt={joints:bt&&bt.joints,getJointValue:function(e){var n=t[e];return n?n.position:void console.log("getJointValue: joint "+e+" doesn't exist")},setJointValue:function(n,i){var o=t[n];if(o){var a=o.joint;if(i>a.limits.max||i<a.limits.min)console.log("setJointValue: joint "+n+" value "+i+" outside of limits (min: "+a.limits.min+", max: "+a.limits.max+")");else if(a.static)console.log("setJointValue: joint "+n+" is static");else{var s=o.node,l=a.axis,c=o.transforms,u=new e.Matrix4;for(r=0;r<c.length;r++){var h=c[r];if(h.sid&&-1!==h.sid.indexOf("joint"+n))switch(a.type){case"revolute":u.multiply(d.makeRotationAxis(l,e.Math.degToRad(i)));break;case"prismatic":u.multiply(d.makeTranslation(l.x*i,l.y*i,l.z*i));break;default:console.warn("setJointValue: unknown joint type: "+a.type)}else{var d=new e.Matrix4;switch(h.type){case"matrix":u.multiply(h.obj);break;case"translate":u.multiply(d.makeTranslation(h.obj.x,h.obj.y,h.obj.z));break;case"rotate":u.multiply(d.makeRotationAxis(h.obj,h.angle))}}}var f=u.elements,p=Array.prototype.slice.call(f),m=[p[0],p[4],p[8],p[12],p[1],p[5],p[9],p[13],p[2],p[6],p[10],p[14],p[3],p[7],p[11],p[15]];s.matrix.set.apply(s.matrix,m),s.matrix.decompose(s.position,s.quaternion,s.scale)}}else console.log("setJointValue: joint "+n+" doesn't exist")}};var i=Et.querySelector("scene instance_kinematics_scene");if(i)for(var r=0;r<i.childNodes.length;r++){var o=i.childNodes[r];if(1==o.nodeType&&"bind_joint_axis"===o.nodeName){var a=o.getAttribute("target").split("/").pop(),s=o.querySelector("axis param").textContent,l=parseInt(s.split("joint").pop().split(".")[0]),c=Et.querySelector('[sid="'+a+'"]');c&&n(l,c.parentElement)}}}();var l={scene:kt,morphs:Ct,skins:Tt,animations:xt,kinematics:wt,dae:{images:Lt,materials:Bt,cameras:It,lights:Nt,effects:Dt,geometries:Ft,controllers:Rt,animations:Ot,visualScenes:_t,visualScene:yt,scene:yt,kinematicsModels:St,kinematicsModel:bt}};return n&&n(l),l}function i(t,e,n){for(var i=Et.querySelectorAll(t),r={},o=0,a=i.length,s=0;a>s;s++){var l=i[s],c=(new e).parse(l);c.id&&0!==c.id.length||(c.id=n+o++),r[c.id]=c}return r}function r(t){var e=yt.getChildById(t.colladaId,!0),n=null;if(e&&e.keys){n={fps:60,hierarchy:[{node:e,keys:e.keys,sids:e.sids}],node:t,name:"animation_"+t.name,length:0},xt.push(n);for(var i=0,o=e.keys.length;o>i;i++)n.length=Math.max(n.length,e.keys[i].time)}else n={hierarchy:[{keys:[],sids:[]}]};for(i=0,o=t.children.length;o>i;i++)for(var a=0,s=r(t.children[i]).hierarchy.length;s>a;a++)n.hierarchy.push({keys:[],sids:[]});return n}function a(t,e){var n=e instanceof T?Rt[e.url]:e;if(n&&n.morph){for(var i=n.morph,r=0;r<i.targets.length;r++){var o=i.targets[r],a=Ft[o];if(a.mesh&&a.mesh.primitives&&a.mesh.primitives.length){var s=a.mesh.primitives[0].geometry;s.vertices.length===t.vertices.length&&t.morphTargets.push({name:"target_1",vertices:s.vertices})}}t.morphTargets.push({name:"target_Z",vertices:t.vertices})}else console.log("could not find morph controller!")}function l(t,n,i,r){if(t.world=t.world||new e.Matrix4,t.localworld=t.localworld||new e.Matrix4,t.world.copy(t.matrix),t.localworld.copy(t.matrix),t.channels&&t.channels.length){var o=t.channels[0].sampler.output[i];o instanceof e.Matrix4&&(t.world.copy(o),t.localworld.copy(o),0===i&&t.matrix.copy(o))}r&&t.world.multiplyMatrices(r,t.world),n.push(t);for(var a=0;a<t.nodes.length;a++)l(t.nodes[a],n,i,t.world)}function c(t,n){for(var i=0;i<t.length;i++){var r=t[i],o=-1;if("JOINT"==r.type){for(var a=0;a<n.joints.length;a++)if(r.sid===n.joints[a]){o=a;break}if(o>=0){var s=n.invBindMatrices[o];r.invBindMatrix=s,r.skinningMatrix=new e.Matrix4,r.skinningMatrix.multiplyMatrices(r.world,s),r.animatrix=new e.Matrix4,r.animatrix.copy(r.localworld),r.weights=[];for(a=0;a<n.weights.length;a++)for(var l=0;l<n.weights[a].length;l++){var c=n.weights[a][l];c.joint===o&&r.weights.push(c)}}else console.warn("ColladaLoader: Could not find joint '"+r.sid+"'."),r.skinningMatrix=new e.Matrix4,r.weights=[]}}}function u(t,n,i){var r=[];l(n,r,-1),c(r,i.skin),v=new e.Vector3;for(var a=[],u=0;u<t.vertices.length;u++)a.push(new e.Vector3);for(u=0;u<r.length;u++)if("JOINT"==r[u].type)for(j=0;j<r[u].weights.length;j++)w=r[u].weights[j],vidx=w.index,weight=w.weight,o=t.vertices[vidx],s=a[vidx],v.x=o.x,v.y=o.y,v.z=o.z,v.applyMatrix4(r[u].skinningMatrix),s.x+=v.x*weight,s.y+=v.y*weight,s.z+=v.z*weight;for(u=0;u<t.vertices.length;u++)t.vertices[u]=a[u]}function h(t,n,i){var r=Rt[n.url];if(i=void 0!==i?i:40,r&&r.skin)if(n.skeleton&&n.skeleton.length){for(var o=function(){var t,e=1e6,n=-e,i=0;for(var r in Ot){var o=Ot[r];t=t||o.id;for(var a=0;a<o.sampler.length;a++){var s=o.sampler[a];s.create(),e=Math.min(e,s.startTime),n=Math.max(n,s.endTime),i=Math.max(i,s.input.length)}}return{start:e,end:n,frames:i,ID:t}}(),a=yt.getChildById(n.skeleton[0],!0)||yt.getChildBySid(n.skeleton[0],!0),s=function(t){var n=[],i=function(t,n,r){var o={};o.name=n.sid,o.parent=t,o.matrix=n.matrix;var a=[new e.Vector3,new e.Quaternion,new e.Vector3];for(var s in o.matrix.decompose(a[0],a[1],a[2]),o.pos=[a[0].x,a[0].y,a[0].z],o.scl=[a[2].x,a[2].y,a[2].z],o.rotq=[a[1].x,a[1].y,a[1].z,a[1].w],r.push(o),n.nodes)i(n.sid,n.nodes[s],r)};return i(-1,t,n),n}(a),h=r.skin.joints,d=[],f=0;f<h.length;f++)for(var p=0;p<s.length;p++)s[p].name===h[f]&&(d[f]=s[p]);for(f=0;f<d.length;f++)for(p=0;p<d.length;p++)d[f].parent===d[p].name&&(d[f].parent=p);for(new e.Vector3,f=0;f<t.vertices.length;f++)t.vertices[f].applyMatrix4(r.skin.bindShapeMatrix);var m=[],v=[],g=r.skin.weights;for(f=0;f<g.length;f++){var y=new e.Vector4(g[f][0]?g[f][0].joint:0,g[f][1]?g[f][1].joint:0,g[f][2]?g[f][2].joint:0,g[f][3]?g[f][3].joint:0),b=new e.Vector4(g[f][0]?g[f][0].weight:0,g[f][1]?g[f][1].weight:0,g[f][2]?g[f][2].weight:0,g[f][3]?g[f][3].weight:0);m.push(y),v.push(b)}t.skinIndices=m,t.skinWeights=v,t.bones=d;var x={name:o.ID,fps:30,length:o.frames/30,hierarchy:[]};for(p=0;p<d.length;p++)x.hierarchy.push({parent:d[p].parent,name:d[p].name,keys:[]});for(console.log("ColladaLoader:",o.ID+" has "+d.length+" bones."),u(t,a,r),i=0;i<o.frames;i++){var w=[];l(a,w,i),c(w,r.skin);for(f=0;f<w.length;f++)for(p=0;p<x.hierarchy.length;p++)if(x.hierarchy[p].name===w[f].sid){var _={};_.time=i/30,_.matrix=w[f].animatrix,0===i&&(w[f].matrix=_.matrix);var S=[new e.Vector3,new e.Quaternion,new e.Vector3];_.matrix.decompose(S[0],S[1],S[2]),_.pos=[S[0].x,S[0].y,S[0].z],_.scl=[S[2].x,S[2].y,S[2].z],_.rot=S[1],x.hierarchy[p].keys.push(_)}t.animation=x}}else console.log("ColladaLoader: Could not find the skeleton for the skin. ");else console.log("ColladaLoader: Could not find skin controller.")}function d(t,n){var i,r,o,s,l=new e.Object3D;for(o=0;o<t.controllers.length;o++){var c=Rt[t.controllers[o].url];switch(c.type){case"skin":if(Ft[c.skin.source])(f=new k).url=c.skin.source,f.instance_material=t.controllers[o].instance_material,t.geometries.push(f),!0,i=t.controllers[o];else if(Rt[c.skin.source]){var u=Rt[c.skin.source];if(r=u,u.morph&&Ft[u.morph.source])(f=new k).url=u.morph.source,f.instance_material=t.controllers[o].instance_material,t.geometries.push(f)}break;case"morph":var f;if(Ft[c.morph.source])(f=new k).url=c.morph.source,f.instance_material=t.controllers[o].instance_material,t.geometries.push(f),r=t.controllers[o];console.log("ColladaLoader: Morph-controller partially supported.")}}var p={};for(o=0;o<t.geometries.length;o++){var m,v=t.geometries[o],g=v.instance_material,y=Ft[v.url],b={},x=[],w=0;if(y){if(!y.mesh||!y.mesh.primitives)continue;if(0===l.name.length&&(l.name=y.id),g)for(s=0;s<g.length;s++){var _=g[s],S=Bt[_.target],M=S.instance_effect.url,C=Dt[M].shader.material;if(y.doubleSided){if(!(_.symbol in p)){var T=C.clone();T.side=e.DoubleSide,p[_.symbol]=T}C=p[_.symbol]}C.opacity=C.opacity?C.opacity:1,b[_.symbol]=w,x.push(C),(m=C).name=null===S.name||""===S.name?S.id:S.name,w++}var E,A=m||new e.MeshLambertMaterial({color:14540253,side:y.doubleSided?e.DoubleSide:e.FrontSide}),P=y.mesh.geometry3js;if(w>1)for(A=new e.MeshFaceMaterial(x),s=0;s<P.faces.length;s++){var L=P.faces[s];L.materialIndex=b[L.daeMaterial]}void 0!==i?(h(P,i),P.morphTargets.length>0?(A.morphTargets=!0,A.skinning=!1):(A.morphTargets=!1,A.skinning=!0),(E=new e.SkinnedMesh(P,A,!1)).name="skin_"+Tt.length,Tt.push(E)):void 0!==r?(a(P,r),A.morphTargets=!0,(E=new e.Mesh(P,A)).name="morph_"+Ct.length,Ct.push(E)):E=!0===P.isLineStrip?new e.Line(P):new e.Mesh(P,A),l.add(E)}}for(o=0;o<t.cameras.length;o++){var O=t.cameras[o],R=It[O.url],F=new e.PerspectiveCamera(R.yfov,parseFloat(R.aspect_ratio),parseFloat(R.znear),parseFloat(R.zfar));l.add(F)}for(o=0;o<t.lights.length;o++){var B=null,D=t.lights[o],I=Nt[D.url];if(I&&I.technique){var N=I.color.getHex(),j=I.intensity,V=I.distance,z=I.falloff_angle;switch(I.technique){case"directional":(B=new e.DirectionalLight(N,j,V)).position.set(0,0,1);break;case"point":B=new e.PointLight(N,j,V);break;case"spot":(B=new e.SpotLight(N,j,V,z,undefined)).position.set(0,0,1);break;case"ambient":B=new e.AmbientLight(N)}}B&&l.add(B)}if(l.name=t.name||t.id||"",l.colladaId=t.id||"",l.layer=t.layer||"",l.matrix=t.matrix,l.matrix.decompose(l.position,l.quaternion,l.scale),Vt.centerGeometry&&l.geometry){var U=l.geometry.center();U.multiply(l.scale),U.applyQuaternion(l.quaternion),l.position.sub(U)}for(o=0;o<t.nodes.length;o++)l.add(d(t.nodes[o],t));return l}function f(t){for(var e=Et.querySelectorAll("library_nodes node"),n=0;n<e.length;n++){var i=e[n].attributes.getNamedItem("id");if(i&&i.value===t)return e[n]}}function p(t,e){for(var n=null,i=0,r=t.length;r>i&&null===n;i++){var o=t[i];if(o.time===e)n=o;else if(o.time>e)break}return n}function m(t,e){for(var n=-1,i=0,r=t.length;r>i&&-1===n;i++){t[i].time>=e&&(n=i)}return n}function g(t,e,n,i){var r=function(t,e,n){for(n=n>=0?n:n+t.length;n>=0;n--){var i=t[n];if(i.hasTarget(e))return i}return null}(t,i,n?n-1:0),o=function(t,e,n){for(;n<t.length;n++){var i=t[n];if(i.hasTarget(e))return i}return null}(t,i,n+1);if(r&&o){var a,s=(e.time-r.time)/(o.time-r.time),l=r.getTarget(i),c=o.getTarget(i).data,u=l.data;if("matrix"===l.type)a=u;else if(u.length){a=[];for(var h=0;h<u.length;++h)a[h]=u[h]+(c[h]-u[h])*s}else a=u+(c-u)*s;e.addTarget(i,l.transform,l.member,a)}}function y(){this.id="",this.init_from=""}function b(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function x(){this.method=null,this.source=null,this.targets=null,this.weights=null}function _(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function S(){this.id="",this.name="",this.nodes=[],this.scene=new e.Group}function M(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new e.Matrix4}function C(){this.sid="",this.type="",this.data=[],this.obj=null}function T(){this.url="",this.skeleton=[],this.instance_material=[]}function E(){this.symbol="",this.target=""}function k(){this.url="",this.instance_material=[]}function A(){this.id="",this.mesh=null}function P(t){this.geometry=t.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function L(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new e.Geometry}function O(){L.call(this),this.vcount=[]}function R(){L.call(this),this.vcount=1}function F(){L.call(this),this.vcount=3}function B(){this.source="",this.count=0,this.stride=0,this.params=[]}function D(){this.input={}}function I(){this.semantic="",this.offset=0,this.source="",this.set=0}function N(t){this.id=t,this.type=null}function V(){this.id="",this.name="",this.instance_effect=null}function z(){this.color=new e.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function U(t,e){this.type=t,this.effect=e,this.material=null}function H(t){this.effect=t,this.init_from=null,this.format=null}function G(t){this.effect=t,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function W(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function q(){this.url=""}function X(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function Y(t){this.animation=t,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function J(t){this.id="",this.animation=t,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function Z(t){this.targets=[],this.time=t}function Q(){this.id="",this.name="",this.technique=""}function K(){this.url=""}function $(){this.id="",this.name="",this.technique=""}function tt(){this.url=""}function et(){this.id="",this.name="",this.joints=[],this.links=[]}function nt(){this.sid="",this.name="",this.axis=new e.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}function it(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}function rt(){this.joint="",this.transforms=[],this.links=[]}function ot(t){var e=t.getAttribute("id");return null!=Pt[e]||(Pt[e]=new N(e).parse(t)),Pt[e]}function at(t){for(var e=ct(t),n=[],i=0,r=e.length;r>i;i++)n.push("true"===e[i]||"1"===e[i]);return n}function st(t){for(var e=ct(t),n=[],i=0,r=e.length;r>i;i++)n.push(parseFloat(e[i]));return n}function lt(t){for(var e=ct(t),n=[],i=0,r=e.length;r>i;i++)n.push(parseInt(e[i],10));return n}function ct(t){return t.length>0?function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")}(t).split(/\s+/):[]}function ut(t,e,n){return t.hasAttribute(e)?parseInt(t.getAttribute(e),10):n}function ht(t,n){loader=new e.ImageLoader,loader.load(n,(function(e){t.image=e,t.needsUpdate=!0}))}function dt(t,e){t.doubleSided=!1;var n=e.querySelectorAll("extra double_sided")[0];n&&n&&1===parseInt(n.textContent,10)&&(t.doubleSided=!0)}function ft(t,e){if(!0===Vt.convertUpAxis&&Ut!==Vt.upAxis)switch(Ht){case"XtoY":var n=t[0];t[0]=e*t[1],t[1]=n;break;case"XtoZ":n=t[2];t[2]=t[1],t[1]=t[0],t[0]=n;break;case"YtoX":n=t[0];t[0]=t[1],t[1]=e*n;break;case"YtoZ":n=t[1];t[1]=e*t[2],t[2]=n;break;case"ZtoX":n=t[0];t[0]=t[1],t[1]=t[2],t[2]=n;break;case"ZtoY":n=t[1];t[1]=t[2],t[2]=e*n}}function pt(t,n){var i=[t[n],t[n+1],t[n+2]];return ft(i,-1),new e.Vector3(i[0],i[1],i[2])}function mt(t){if(Vt.convertUpAxis){var n=[t[0],t[4],t[8]];ft(n,-1),t[0]=n[0],t[4]=n[1],t[8]=n[2],ft(n=[t[1],t[5],t[9]],-1),t[1]=n[0],t[5]=n[1],t[9]=n[2],ft(n=[t[2],t[6],t[10]],-1),t[2]=n[0],t[6]=n[1],t[10]=n[2],ft(n=[t[0],t[1],t[2]],-1),t[0]=n[0],t[1]=n[1],t[2]=n[2],ft(n=[t[4],t[5],t[6]],-1),t[4]=n[0],t[5]=n[1],t[6]=n[2],ft(n=[t[8],t[9],t[10]],-1),t[8]=n[0],t[9]=n[1],t[10]=n[2],ft(n=[t[3],t[7],t[11]],-1),t[3]=n[0],t[7]=n[1],t[11]=n[2]}return(new e.Matrix4).set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function vt(t){if(t>-1&&3>t){t={X:0,Y:1,Z:2}[t=gt(["X","Y","Z"][t])]}return t}function gt(t){if(Vt.convertUpAxis)switch(t){case"X":switch(Ht){case"XtoY":case"XtoZ":case"YtoX":t="Y";break;case"ZtoX":t="Z"}break;case"Y":switch(Ht){case"XtoY":case"YtoX":case"ZtoX":t="X";break;case"XtoZ":case"YtoZ":case"ZtoY":t="Z"}break;case"Z":switch(Ht){case"XtoZ":t="X";break;case"YtoZ":case"ZtoX":case"ZtoY":t="Y"}}return t}var yt,bt,xt,wt,_t,St,Mt,Ct,Tt,Et=null,kt=null,At=null,Pt={},Lt={},Ot={},Rt={},Ft={},Bt={},Dt={},It={},Nt={},jt=e.SmoothShading,Vt={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},zt=1,Ut="Y",Ht=null;return y.prototype.parse=function(t){this.id=t.getAttribute("id");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];"init_from"===n.nodeName&&(this.init_from=n.textContent)}return this},b.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name"),this.type="none";for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"skin":this.skin=(new _).parse(n),this.type=n.nodeName;break;case"morph":this.morph=(new x).parse(n),this.type=n.nodeName}}return this},x.prototype.parse=function(t){var e,n={},i=[];for(this.method=t.getAttribute("method"),this.source=t.getAttribute("source").replace(/^#/,""),e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if(1==r.nodeType)switch(r.nodeName){case"source":n[(a=(new N).parse(r)).id]=a;break;case"targets":i=this.parseInputs(r);break;default:console.log(r.nodeName)}}for(e=0;e<i.length;e++){var o=i[e],a=n[o.source];switch(o.semantic){case"MORPH_TARGET":this.targets=a.read();break;case"MORPH_WEIGHT":this.weights=a.read()}}return this},x.prototype.parseInputs=function(t){for(var e=[],n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType&&"input"===i.nodeName)e.push((new I).parse(i))}return e},_.prototype.parse=function(t){var e,n,i={};this.source=t.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes[r];if(1==o.nodeType)switch(o.nodeName){case"bind_shape_matrix":var a=st(o.textContent);this.bindShapeMatrix=mt(a);break;case"source":var s=(new N).parse(o);i[s.id]=s;break;case"joints":e=o;break;case"vertex_weights":n=o;break;default:console.log(o.nodeName)}}return this.parseJoints(e,i),this.parseWeights(n,i),this},_.prototype.parseJoints=function(t,e){for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType&&"input"===i.nodeName){var r=(new I).parse(i),o=e[r.source];"JOINT"===r.semantic?this.joints=o.read():"INV_BIND_MATRIX"===r.semantic&&(this.invBindMatrices=o.read())}}},_.prototype.parseWeights=function(t,e){for(var n,i,r=[],o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];if(1==a.nodeType)switch(a.nodeName){case"input":r.push((new I).parse(a));break;case"v":n=lt(a.textContent);break;case"vcount":i=lt(a.textContent)}}var s=0;for(o=0;o<i.length;o++){for(var l=i[o],c=[],u=0;l>u;u++){for(var h={},d=0;d<r.length;d++){var f=r[d],p=n[s+f.offset];switch(f.semantic){case"JOINT":h.joint=p;break;case"WEIGHT":h.weight=e[f.source].data[p]}}c.push(h),s+=r.length}for(u=0;u<c.length;u++)c[u].index=o;this.weights.push(c)}},S.prototype.getChildById=function(t,e){for(var n=0;n<this.nodes.length;n++){var i=this.nodes[n].getChildById(t,e);if(i)return i}return null},S.prototype.getChildBySid=function(t,e){for(var n=0;n<this.nodes.length;n++){var i=this.nodes[n].getChildBySid(t,e);if(i)return i}return null},S.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name"),this.nodes=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"node"===n.nodeName)this.nodes.push((new M).parse(n))}return this},M.prototype.getChannelForTransform=function(t){for(var e=0;e<this.channels.length;e++){var n,i=this.channels[e],r=i.target.split("/"),o=(r.shift(),r.shift()),a=o.indexOf(".")>=0,s=o.indexOf("(")>=0;if(a)r=o.split("."),o=r.shift(),r.shift();else if(s){n=o.split("("),o=n.shift();for(var l=0;l<n.length;l++)n[l]=parseInt(n[l].replace(/\)/,""))}if(o===t)return i.info={sid:o,dotSyntax:a,arrSyntax:s,arrIndices:n},i}return null},M.prototype.getChildById=function(t,e){if(this.id===t)return this;if(e)for(var n=0;n<this.nodes.length;n++){var i=this.nodes[n].getChildById(t,e);if(i)return i}return null},M.prototype.getChildBySid=function(t,e){if(this.sid===t)return this;if(e)for(var n=0;n<this.nodes.length;n++){var i=this.nodes[n].getChildBySid(t,e);if(i)return i}return null},M.prototype.getTransformBySid=function(t){for(var e=0;e<this.transforms.length;e++)if(this.transforms[e].sid===t)return this.transforms[e];return null},M.prototype.parse=function(t){this.id=t.getAttribute("id"),this.sid=t.getAttribute("sid"),this.name=t.getAttribute("name"),this.type=t.getAttribute("type"),this.layer=t.getAttribute("layer"),this.type="JOINT"===this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new e.Matrix4;for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType)switch(i.nodeName){case"node":this.nodes.push((new M).parse(i));break;case"instance_camera":this.cameras.push((new K).parse(i));break;case"instance_controller":this.controllers.push((new T).parse(i));break;case"instance_geometry":this.geometries.push((new k).parse(i));break;case"instance_light":this.lights.push((new tt).parse(i));break;case"instance_node":var r=f(i.getAttribute("url").replace(/^#/,""));r&&this.nodes.push((new M).parse(r));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new C).parse(i));break;case"extra":break;default:console.log(i.nodeName)}}return this.channels=function(t){var e=[],n=1e6,i=-1e6;for(var r in Ot)for(var o=Ot[r],a=0;a<o.channel.length;a++){var s=o.channel[a],l=o.sampler[a];(r=s.target.split("/")[0])==t.id&&(l.create(),s.sampler=l,n=Math.min(n,l.startTime),i=Math.max(i,l.endTime),e.push(s))}return e.length&&(t.startTime=n,t.endTime=i),e}(this),function(t){if(t.channels&&t.channels.length){for(var e=[],n=[],i=0,r=t.channels.length;r>i;i++){var o,a=t.channels[i],s=a.fullSid,l=a.sampler,c=l.input,u=t.getTransformBySid(a.sid);if(a.arrIndices){o=[];for(var h=0,d=a.arrIndices.length;d>h;h++)o[h]=vt(a.arrIndices[h])}else o=gt(a.member);if(u)for(-1===n.indexOf(s)&&n.push(s),h=0,d=c.length;d>h;h++){var f=c[h],v=l.getData(u.type,h,o);if(!(x=p(e,f))){x=new Z(f);var y=m(e,f);e.splice(-1===y?e.length:y,0,x)}x.addTarget(s,u,o,v)}else console.log('Could not find transform "'+a.sid+'" in node '+t.id)}for(i=0;i<n.length;i++){var b=n[i];for(h=0;h<e.length;h++){var x;(x=e[h]).hasTarget(b)||g(e,x,h,b)}}t.keys=e,t.sids=n}}(this),this.updateMatrix(),this},M.prototype.updateMatrix=function(){this.matrix.identity();for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(this.matrix)},C.prototype.clone=function(){return t=new C,t.sid=this.sid,t.type=this.type,t.data=this.data,t.angle=this.angle,this.obj&&(t.obj=this.obj.clone()),t},C.prototype.parse=function(t){return this.sid=t.getAttribute("sid"),this.type=t.nodeName,this.data=st(t.textContent),this.convert(),this},C.prototype.convert=function(){switch(this.type){case"matrix":this.obj=mt(this.data);break;case"rotate":this.angle=e.Math.degToRad(this.data[3]);case"translate":ft(this.data,-1),this.obj=new e.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":ft(this.data,1),this.obj=new e.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},C.prototype.apply=function(){var t=new e.Matrix4;return function(e){switch(this.type){case"matrix":e.multiply(this.obj);break;case"translate":e.multiply(t.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":e.multiply(t.makeRotationAxis(this.obj,this.angle));break;case"scale":e.scale(this.obj)}}}(),C.prototype.update=function(t,n){var i=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(n)if(1===n.length)switch(n[0]){case 0:this.obj.n11=t[0],this.obj.n21=t[1],this.obj.n31=t[2],this.obj.n41=t[3];break;case 1:this.obj.n12=t[0],this.obj.n22=t[1],this.obj.n32=t[2],this.obj.n42=t[3];break;case 2:this.obj.n13=t[0],this.obj.n23=t[1],this.obj.n33=t[2],this.obj.n43=t[3];break;case 3:this.obj.n14=t[0],this.obj.n24=t[1],this.obj.n34=t[2],this.obj.n44=t[3]}else if(2===n.length){var r="n"+(n[0]+1)+(n[1]+1);this.obj[r]=t}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(t);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(n)&&(n=i[n[0]]),n){case"X":this.obj.x=t;break;case"Y":this.obj.y=t;break;case"Z":this.obj.z=t;break;default:this.obj.x=t[0],this.obj.y=t[1],this.obj.z=t[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(n)&&(n=i[n[0]]),n){case"X":this.obj.x=t;break;case"Y":this.obj.y=t;break;case"Z":this.obj.z=t;break;case"ANGLE":this.angle=e.Math.degToRad(t);break;default:this.obj.x=t[0],this.obj.y=t[1],this.obj.z=t[2],this.angle=e.Math.degToRad(t[3])}}},T.prototype.parse=function(t){this.url=t.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1===n.nodeType)switch(n.nodeName){case"skeleton":this.skeleton.push(n.textContent.replace(/^#/,""));break;case"bind_material":for(var i=n.querySelectorAll("instance_material"),r=0;r<i.length;r++){var o=i[r];this.instance_material.push((new E).parse(o))}}}return this},E.prototype.parse=function(t){return this.symbol=t.getAttribute("symbol"),this.target=t.getAttribute("target").replace(/^#/,""),this},k.prototype.parse=function(t){this.url=t.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"bind_material"===n.nodeName){for(var i=n.querySelectorAll("instance_material"),r=0;r<i.length;r++){var o=i[r];this.instance_material.push((new E).parse(o))}break}}return this},A.prototype.parse=function(t){this.id=t.getAttribute("id"),dt(this,t);for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if("mesh"===n.nodeName)this.mesh=new P(this).parse(n)}return this},P.prototype.parse=function(t){this.primitives=[];for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];switch(i.nodeName){case"source":ot(i);break;case"vertices":this.vertices=(new D).parse(i);break;case"linestrips":this.primitives.push((new R).parse(i));break;case"triangles":this.primitives.push((new F).parse(i));break;case"polygons":this.primitives.push((new L).parse(i));break;case"polylist":this.primitives.push((new O).parse(i))}}if(this.geometry3js=new e.Geometry,null===this.vertices)return this;var r=Pt[this.vertices.input.POSITION.source].data;for(n=0;n<r.length;n+=3)this.geometry3js.vertices.push(pt(r,n).clone());for(n=0;n<this.primitives.length;n++){var o=this.primitives[n];o.setVertices(this.vertices),this.handlePrimitive(o,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},P.prototype.handlePrimitive=function(t,n){if(t instanceof R)n.isLineStrip=!0;else{var i,r,o,a,s,l,c,u=t.p,h=t.inputs,d=0,f=3,p=0,m=[];for(i=0;i<h.length;i++){var v=(o=h[i]).offset+1;if("TEXCOORD"===(p=v>p?v:p,o.semantic))m.push(o.set)}for(var g=0;g<u.length;++g)for(var y=u[g],b=0;b<y.length;){var x=[],w=[],_=null,S=[];for(f=t.vcount?t.vcount.length?t.vcount[d++]:t.vcount:y.length/p,i=0;f>i;i++)for(r=0;r<h.length;r++)switch(o=h[r],l=Pt[o.source],a=y[b+i*p+o.offset],c=l.accessor.params.length,s=a*c,o.semantic){case"VERTEX":x.push(a);break;case"NORMAL":w.push(pt(l.data,s));break;case"TEXCOORD":void 0===(_=_||{})[o.set]&&(_[o.set]=[]),_[o.set].push(new e.Vector2(l.data[s],l.data[s+1]));break;case"COLOR":S.push((new e.Color).setRGB(l.data[s],l.data[s+1],l.data[s+2]))}if(0===w.length)if(o=this.vertices.input.NORMAL){c=(l=Pt[o.source]).accessor.params.length;for(var M=0,C=x.length;C>M;M++)w.push(pt(l.data,x[M]*c))}else n.calcNormals=!0;if(!_&&(_={},o=this.vertices.input.TEXCOORD)){m.push(o.set),c=(l=Pt[o.source]).accessor.params.length;for(M=0,C=x.length;C>M;M++)s=x[M]*c,void 0===_[o.set]&&(_[o.set]=[]),_[o.set].push(new e.Vector2(l.data[s],1-l.data[s+1]))}if(0===S.length&&(o=this.vertices.input.COLOR)){c=(l=Pt[o.source]).accessor.params.length;for(M=0,C=x.length;C>M;M++)s=x[M]*c,S.push((new e.Color).setRGB(l.data[s],l.data[s+1],l.data[s+2]))}var T,E,k=null,A=[];if(3===f)A.push(new e.Face3(x[0],x[1],x[2],w,S.length?S:new e.Color));else if(4===f)A.push(new e.Face3(x[0],x[1],x[3],[w[0].clone(),w[1].clone(),w[3].clone()],S.length?[S[0],S[1],S[3]]:new e.Color)),A.push(new e.Face3(x[1],x[2],x[3],[w[1].clone(),w[2].clone(),w[3].clone()],S.length?[S[1],S[2],S[3]]:new e.Color));else if(f>4&&Vt.subdivideFaces){var P=S.length?S:new e.Color;for(r=1;f-1>r;)A.push(new e.Face3(x[0],x[r],x[r+1],[w[0].clone(),w[r++].clone(),w[r].clone()],P))}if(A.length)for(M=0,C=A.length;C>M;M++)for((k=A[M]).daeMaterial=t.material,n.faces.push(k),r=0;r<m.length;r++)T=_[m[r]],E=f>4?[T[0],T[M+1],T[M+2]]:4===f?0===M?[T[0],T[1],T[3]]:[T[1].clone(),T[2],T[3].clone()]:[T[0],T[1],T[2]],void 0===n.faceVertexUvs[r]&&(n.faceVertexUvs[r]=[]),n.faceVertexUvs[r].push(E);else console.log("dropped face with vcount "+f+" for geometry with id: "+n.id);b+=p*f}}},L.prototype.setVertices=function(t){for(var e=0;e<this.inputs.length;e++)this.inputs[e].source===t.id&&(this.inputs[e].source=t.input.POSITION.source)},L.prototype.parse=function(t){this.material=t.getAttribute("material"),this.count=ut(t,"count",0);for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"input":this.inputs.push((new I).parse(t.childNodes[e]));break;case"vcount":this.vcount=lt(n.textContent);break;case"p":this.p.push(lt(n.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},O.prototype=Object.create(L.prototype),O.prototype.constructor=O,R.prototype=Object.create(L.prototype),R.prototype.constructor=R,F.prototype=Object.create(L.prototype),F.prototype.constructor=F,B.prototype.parse=function(t){this.params=[],this.source=t.getAttribute("source"),this.count=ut(t,"count",0),this.stride=ut(t,"stride",0);for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if("param"===n.nodeName){var i={};i.name=n.getAttribute("name"),i.type=n.getAttribute("type"),this.params.push(i)}}return this},D.prototype.parse=function(t){this.id=t.getAttribute("id");for(var e=0;e<t.childNodes.length;e++)if("input"===t.childNodes[e].nodeName){var n=(new I).parse(t.childNodes[e]);this.input[n.semantic]=n}return this},I.prototype.parse=function(t){return this.semantic=t.getAttribute("semantic"),this.source=t.getAttribute("source").replace(/^#/,""),this.set=ut(t,"set",-1),this.offset=ut(t,"offset",0),"TEXCOORD"===this.semantic&&this.set<0&&(this.set=0),this},N.prototype.parse=function(t){this.id=t.getAttribute("id");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"bool_array":this.data=at(n.textContent),this.type=n.nodeName;break;case"float_array":this.data=st(n.textContent),this.type=n.nodeName;break;case"int_array":this.data=lt(n.textContent),this.type=n.nodeName;break;case"IDREF_array":case"Name_array":this.data=ct(n.textContent),this.type=n.nodeName;break;case"technique_common":for(var i=0;i<n.childNodes.length;i++)if("accessor"===n.childNodes[i].nodeName){this.accessor=(new B).parse(n.childNodes[i]);break}}}return this},N.prototype.read=function(){var t=[],e=this.accessor.params[0];switch(e.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var n=0;n<this.data.length;n+=16){var i=mt(this.data.slice(n,n+16));t.push(i)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+e.type+".")}return t},V.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name");for(var e=0;e<t.childNodes.length;e++)if("instance_effect"===t.childNodes[e].nodeName){this.instance_effect=(new q).parse(t.childNodes[e]);break}return this},z.prototype.isColor=function(){return null===this.texture},z.prototype.isTexture=function(){return null!=this.texture},z.prototype.parse=function(t){"transparent"===t.nodeName&&(this.opaque=t.getAttribute("opaque"));for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType)switch(i.nodeName){case"color":var r=st(i.textContent);this.color=new e.Color,this.color.setRGB(r[0],r[1],r[2]),this.color.a=r[3];break;case"texture":this.texture=i.getAttribute("texture"),this.texcoord=i.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(i)}}return this},z.prototype.parseTexture=function(t){if(!t.childNodes)return this;t.childNodes[1]&&"extra"===t.childNodes[1].nodeName&&((t=t.childNodes[1]).childNodes[1]&&"technique"===t.childNodes[1].nodeName&&(t=t.childNodes[1]));for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":"TRUE"===n.textContent.toUpperCase()?this.texOpts[n.nodeName]=1:this.texOpts[n.nodeName]=parseInt(n.textContent);break;default:this.texOpts[n.nodeName]=n.textContent}}return this},U.prototype.parse=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[n.nodeName]=(new z).parse(n);break;case"bump":var i=n.getAttribute("bumptype");i?"heightfield"===i.toLowerCase()?this.bump=(new z).parse(n):"normalmap"===i.toLowerCase()?this.normal=(new z).parse(n):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+i+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new z).parse(n)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=(new z).parse(n));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var r=n.querySelectorAll("float");r.length>0&&(this[n.nodeName]=parseFloat(r[0].textContent))}}return this.create(),this},U.prototype.create=function(){var t={},n=!1;if(void 0!==this.transparency&&void 0!==this.transparent){var i=(this.transparent,(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency);i>0&&(n=!0,t.transparent=!0,t.opacity=1-i)}var r={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var o in this)switch(o){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var a=this[o];if(a instanceof z)if(a.isTexture()){var s=a.texture,l=this.effect.sampler[s];if(void 0!==l&&void 0!==l.source){var c=this.effect.surface[l.source];if(void 0!==c){var u=Lt[c.init_from];if(u){var h,d=Mt+u.init_from,f=e.Loader.Handlers.get(d);null!==f?h=f.load(d):ht(h=new e.Texture,d),h.wrapS=a.texOpts.wrapU?e.RepeatWrapping:e.ClampToEdgeWrapping,h.wrapT=a.texOpts.wrapV?e.RepeatWrapping:e.ClampToEdgeWrapping,h.offset.x=a.texOpts.offsetU,h.offset.y=a.texOpts.offsetV,h.repeat.x=a.texOpts.repeatU,h.repeat.y=a.texOpts.repeatV,t[r[o]]=h,"emission"===o&&(t.emissive=16777215)}}}}else"diffuse"!==o&&n||("emission"===o?t.emissive=a.color.getHex():t[o]=a.color.getHex());break;case"shininess":t[o]=this[o];break;case"reflectivity":t[o]=this[o],t[o]>0&&(t.envMap=Vt.defaultEnvMap),t.combine=e.MixOperation;break;case"index_of_refraction":t.refractionRatio=this[o],1!==this[o]&&(t.envMap=Vt.defaultEnvMap)}switch(t.shading=jt,t.side=this.effect.doubleSided?e.DoubleSide:e.FrontSide,this.type){case"constant":null!=t.emissive&&(t.color=t.emissive),this.material=new e.MeshBasicMaterial(t);break;case"phong":case"blinn":null!=t.diffuse&&(t.color=t.diffuse),this.material=new e.MeshPhongMaterial(t);break;default:null!=t.diffuse&&(t.color=t.diffuse),this.material=new e.MeshLambertMaterial(t)}return this.material},H.prototype.parse=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"init_from":this.init_from=n.textContent;break;case"format":this.format=n.textContent;break;default:console.log("unhandled Surface prop: "+n.nodeName)}}return this},G.prototype.parse=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"source":this.source=n.textContent;break;case"minfilter":this.minfilter=n.textContent;break;case"magfilter":this.magfilter=n.textContent;break;case"mipfilter":this.mipfilter=n.textContent;break;case"wrap_s":this.wrap_s=n.textContent;break;case"wrap_t":this.wrap_t=n.textContent;break;default:console.log("unhandled Sampler2D prop: "+n.nodeName)}}return this},W.prototype.create=function(){return null===this.shader?null:void 0},W.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name"),dt(this,t),this.shader=null;for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"profile_COMMON"===n.nodeName)this.parseTechnique(this.parseProfileCOMMON(n))}return this},W.prototype.parseNewparam=function(t){for(var e=t.getAttribute("sid"),n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType)switch(i.nodeName){case"surface":this.surface[e]=new H(this).parse(i);break;case"sampler2D":this.sampler[e]=new G(this).parse(i);break;case"extra":break;default:console.log(i.nodeName)}}},W.prototype.parseProfileCOMMON=function(t){for(var e,n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1==i.nodeType)switch(i.nodeName){case"profile_COMMON":this.parseProfileCOMMON(i);break;case"technique":e=i;break;case"newparam":this.parseNewparam(i);break;case"image":var r=(new y).parse(i);Lt[r.id]=r;break;case"extra":break;default:console.log(i.nodeName)}}return e},W.prototype.parseTechnique=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new U(n.nodeName,this).parse(n);break;case"extra":this.parseExtra(n)}}},W.prototype.parseExtra=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"technique"===n.nodeName)this.parseExtraTechnique(n)}},W.prototype.parseExtraTechnique=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"bump"===n.nodeName)this.shader.parse(t)}},q.prototype.parse=function(t){return this.url=t.getAttribute("url").replace(/^#/,""),this},X.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name"),this.source={};for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"animation":var i=(new X).parse(n);for(var r in i.source)this.source[r]=i.source[r];for(var o=0;o<i.channel.length;o++)this.channel.push(i.channel[o]),this.sampler.push(i.sampler[o]);break;case"source":r=(new N).parse(n);this.source[r.id]=r;break;case"sampler":this.sampler.push(new J(this).parse(n));break;case"channel":this.channel.push(new Y(this).parse(n))}}return this},Y.prototype.parse=function(t){this.source=t.getAttribute("source").replace(/^#/,""),this.target=t.getAttribute("target");var e=this.target.split("/"),n=(e.shift(),e.shift()),i=n.indexOf(".")>=0,r=n.indexOf("(")>=0;if(i)e=n.split("."),this.sid=e.shift(),this.member=e.shift();else if(r){var o=n.split("(");this.sid=o.shift();for(var a=0;a<o.length;a++)o[a]=parseInt(o[a].replace(/\)/,""));this.arrIndices=o}else this.sid=n;return this.fullSid=n,this.dotSyntax=i,this.arrSyntax=r,this},J.prototype.parse=function(t){this.id=t.getAttribute("id"),this.inputs=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"input"===n.nodeName)this.inputs.push((new I).parse(n))}return this},J.prototype.create=function(){for(var t=0;t<this.inputs.length;t++){var e=this.inputs[t],n=this.animation.source[e.source];switch(e.semantic){case"INPUT":this.input=n.read();break;case"OUTPUT":this.output=n.read(),this.strideOut=n.accessor.stride;break;case"INTERPOLATION":this.interpolation=n.read();break;case"IN_TANGENT":case"OUT_TANGENT":break;default:console.log(e.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(t=0;t<this.input.length;t++)this.startTime=Math.min(this.startTime,this.input[t]),this.endTime=Math.max(this.endTime,this.input[t]);this.duration=this.endTime-this.startTime}},J.prototype.getData=function(t,e,n){var i;if("matrix"===t&&16===this.strideOut)i=this.output[e];else if(this.strideOut>1){i=[],e*=this.strideOut;for(var r=0;r<this.strideOut;++r)i[r]=this.output[e+r];if(3===this.strideOut)switch(t){case"rotate":case"translate":ft(i,-1);break;case"scale":ft(i,1)}else 4===this.strideOut&&"matrix"===t&&ft(i,-1)}else i=this.output[e],n&&"translate"===t&&(i=function(t,e){if(!0!==Vt.convertUpAxis||Ut===Vt.upAxis)return e;switch(t){case"X":e="XtoY"===Ht?-1*e:e;break;case"Y":e="YtoZ"===Ht||"YtoX"===Ht?-1*e:e;break;case"Z":e="ZtoY"===Ht?-1*e:e}return e}(n,i));return i},Z.prototype.addTarget=function(t,e,n,i){this.targets.push({sid:t,member:n,transform:e,data:i})},Z.prototype.apply=function(t){for(var e=0;e<this.targets.length;++e){var n=this.targets[e];t&&n.sid!==t||n.transform.update(n.data,n.member)}},Z.prototype.getTarget=function(t){for(var e=0;e<this.targets.length;++e)if(this.targets[e].sid===t)return this.targets[e];return null},Z.prototype.hasTarget=function(t){for(var e=0;e<this.targets.length;++e)if(this.targets[e].sid===t)return!0;return!1},Z.prototype.interpolate=function(t,e){for(var n=0,i=this.targets.length;i>n;n++){var r,o=this.targets[n],a=t.getTarget(o.sid);if("matrix"!==o.transform.type&&a){var s=(e-this.time)/(t.time-this.time),l=a.data,c=o.data;if(0>s&&(s=0),s>1&&(s=1),c.length){r=[];for(var u=0;u<c.length;++u)r[u]=c[u]+(l[u]-c[u])*s}else r=c+(l-c)*s}else r=o.data;o.transform.update(r,o.member)}},Q.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"optics"===n.nodeName)this.parseOptics(n)}return this},Q.prototype.parseOptics=function(t){for(var e=0;e<t.childNodes.length;e++)if("technique_common"===t.childNodes[e].nodeName)for(var n=t.childNodes[e],i=0;i<n.childNodes.length;i++)if(this.technique=n.childNodes[i].nodeName,"perspective"===this.technique)for(var r=n.childNodes[i],o=0;o<r.childNodes.length;o++){switch((s=r.childNodes[o]).nodeName){case"yfov":this.yfov=s.textContent;break;case"xfov":this.xfov=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}else if("orthographic"===this.technique){var a=n.childNodes[i];for(o=0;o<a.childNodes.length;o++){var s;switch((s=a.childNodes[o]).nodeName){case"xmag":this.xmag=s.textContent;break;case"ymag":this.ymag=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}}return this},K.prototype.parse=function(t){return this.url=t.getAttribute("url").replace(/^#/,""),this},$.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"technique_common":this.parseCommon(n);break;case"technique":this.parseTechnique(n)}}return this},$.prototype.parseCommon=function(t){for(var n=0;n<t.childNodes.length;n++)switch(t.childNodes[n].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=t.childNodes[n].nodeName;for(var i=t.childNodes[n],r=0;r<i.childNodes.length;r++){var o=i.childNodes[r];switch(o.nodeName){case"color":var a=st(o.textContent);this.color=new e.Color(0),this.color.setRGB(a[0],a[1],a[2]),this.color.a=a[3];break;case"falloff_angle":this.falloff_angle=parseFloat(o.textContent);break;case"quadratic_attenuation":var s=parseFloat(o.textContent);this.distance=s?Math.sqrt(1/s):0}}}return this},$.prototype.parseTechnique=function(t){this.profile=t.getAttribute("profile");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if("intensity"===n.nodeName)this.intensity=parseFloat(n.textContent)}return this},tt.prototype.parse=function(t){return this.url=t.getAttribute("url").replace(/^#/,""),this},et.prototype.parse=function(t){this.id=t.getAttribute("id"),this.name=t.getAttribute("name"),this.joints=[],this.links=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType&&"technique_common"===n.nodeName)this.parseCommon(n)}return this},et.prototype.parseCommon=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(t.childNodes[e].nodeName){case"joint":this.joints.push((new nt).parse(n));break;case"link":this.links.push((new it).parse(n))}}return this},nt.prototype.parse=function(t){this.sid=t.getAttribute("sid"),this.name=t.getAttribute("name"),this.axis=new e.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var n=st(t.querySelector("axis").textContent);this.axis=pt(n,0);var i=t.querySelector("limits min")?parseFloat(t.querySelector("limits min").textContent):-360,r=t.querySelector("limits max")?parseFloat(t.querySelector("limits max").textContent):360;this.limits={min:i,max:r};for(var o=["prismatic","revolute"],a=0;a<o.length;a++){var s=o[a];t.querySelector(s)&&(this.type=s)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this},it.prototype.parse=function(t){this.sid=t.getAttribute("sid"),this.name=t.getAttribute("name"),this.transforms=[],this.attachments=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"attachment_full":this.attachments.push((new rt).parse(n));break;case"rotate":case"translate":case"matrix":this.transforms.push((new C).parse(n))}}return this},rt.prototype.parse=function(t){this.joint=t.getAttribute("joint").split("/").pop(),this.links=[];for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];if(1==n.nodeType)switch(n.nodeName){case"link":this.links.push((new it).parse(n));break;case"rotate":case"translate":case"matrix":this.transforms.push((new C).parse(n))}}return this},{load:function(t,e,i,r){var o=0;if(document.implementation&&document.implementation.createDocument){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState){if(0===a.status||200===a.status)if(a.responseXML)At=e,n(a.responseXML,void 0,t);else if(a.responseText){At=e,n((new DOMParser).parseFromString(a.responseText,"application/xml"),void 0,t)}else faillCallback?r():console.error("ColladaLoader: Empty or non-existing file ("+t+")")}else 3===a.readyState&&i&&(0===o&&(o=a.getResponseHeader("Content-Length")),i({total:o,loaded:a.responseText.length}))},a.open("GET",t,!0),a.send(null)}else alert("Don't know how to parse XML!")},parse:n,setPreferredShading:function(t){jt=t},applySkin:h,geometries:Ft,options:Vt}}}).call(n,i(2))},function(t,e,n){var i=i||{},r={REVISION:"71"};t.exports=r,void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),r.log=function(){console.log.apply(console,arguments)},r.warn=function(){console.warn.apply(console,arguments)},r.error=function(){console.error.apply(console,arguments)},r.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},r.CullFaceNone=0,r.CullFaceBack=1,r.CullFaceFront=2,r.CullFaceFrontBack=3,r.FrontFaceDirectionCW=0,r.FrontFaceDirectionCCW=1,r.BasicShadowMap=0,r.PCFShadowMap=1,r.PCFSoftShadowMap=2,r.FrontSide=0,r.BackSide=1,r.DoubleSide=2,r.NoShading=0,r.FlatShading=1,r.SmoothShading=2,r.NoColors=0,r.FaceColors=1,r.VertexColors=2,r.NoBlending=0,r.NormalBlending=1,r.AdditiveBlending=2,r.SubtractiveBlending=3,r.MultiplyBlending=4,r.CustomBlending=5,r.AddEquation=100,r.SubtractEquation=101,r.ReverseSubtractEquation=102,r.MinEquation=103,r.MaxEquation=104,r.ZeroFactor=200,r.OneFactor=201,r.SrcColorFactor=202,r.OneMinusSrcColorFactor=203,r.SrcAlphaFactor=204,r.OneMinusSrcAlphaFactor=205,r.DstAlphaFactor=206,r.OneMinusDstAlphaFactor=207,r.DstColorFactor=208,r.OneMinusDstColorFactor=209,r.SrcAlphaSaturateFactor=210,r.MultiplyOperation=0,r.MixOperation=1,r.AddOperation=2,r.UVMapping=300,r.CubeReflectionMapping=301,r.CubeRefractionMapping=302,r.EquirectangularReflectionMapping=303,r.EquirectangularRefractionMapping=304,r.SphericalReflectionMapping=305,r.RepeatWrapping=1e3,r.ClampToEdgeWrapping=1001,r.MirroredRepeatWrapping=1002,r.NearestFilter=1003,r.NearestMipMapNearestFilter=1004,r.NearestMipMapLinearFilter=1005,r.LinearFilter=1006,r.LinearMipMapNearestFilter=1007,r.LinearMipMapLinearFilter=1008,r.UnsignedByteType=1009,r.ByteType=1010,r.ShortType=1011,r.UnsignedShortType=1012,r.IntType=1013,r.UnsignedIntType=1014,r.FloatType=1015,r.HalfFloatType=1025,r.UnsignedShort4444Type=1016,r.UnsignedShort5551Type=1017,r.UnsignedShort565Type=1018,r.AlphaFormat=1019,r.RGBFormat=1020,r.RGBAFormat=1021,r.LuminanceFormat=1022,r.LuminanceAlphaFormat=1023,r.RGBEFormat=r.RGBAFormat,r.RGB_S3TC_DXT1_Format=2001,r.RGBA_S3TC_DXT1_Format=2002,r.RGBA_S3TC_DXT3_Format=2003,r.RGBA_S3TC_DXT5_Format=2004,r.RGB_PVRTC_4BPPV1_Format=2100,r.RGB_PVRTC_2BPPV1_Format=2101,r.RGBA_PVRTC_4BPPV1_Format=2102,r.RGBA_PVRTC_2BPPV1_Format=2103,r.Projector=function(){r.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){r.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){r.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){r.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},r.CanvasRenderer=function(){r.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},r.Color=function(t){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(t)},r.Color.prototype={constructor:r.Color,r:1,g:1,b:1,set:function(t){return t instanceof r.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(0===e)this.r=this.g=this.b=n;else{var i=function(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+6*(e-t)*(2/3-n):t},r=.5>=n?n*(1+e):n+e-n*e,o=2*n-r;this.r=i(o,r,t+1/3),this.g=i(o,r,t),this.b=i(o,r,t-1/3)}return this},setStyle:function(t){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(t)){var e=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(t);return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(t)){e=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(t);return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(t)){e=/^\#([0-9a-f]{6})$/i.exec(t);return this.setHex(parseInt(e[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)){e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);return this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this}return/^(\w+)$/i.test(t)?(this.setHex(r.ColorKeywords[t]),this):void 0},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,i=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),c=(l+s)/2;if(l===s)e=0,n=0;else{var u=s-l;switch(n=.5>=c?u/(s+l):u/(2-s-l),s){case r:e=(o-a)/u+(a>o?6:0);break;case o:e=(a-r)/u+2;break;case a:e=(r-o)/u+4}e/=6}return i.h=e,i.s=n,i.l=c,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},clone:function(){return(new r.Color).setRGB(this.r,this.g,this.b)}},r.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},r.Quaternion=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1},r.Quaternion.prototype={constructor:r.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(t instanceof r.Euler==0)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),o=Math.cos(t._z/2),a=Math.sin(t._x/2),s=Math.sin(t._y/2),l=Math.sin(t._z/2);return"XYZ"===t.order?(this._x=a*i*o+n*s*l,this._y=n*s*o-a*i*l,this._z=n*i*l+a*s*o,this._w=n*i*o-a*s*l):"YXZ"===t.order?(this._x=a*i*o+n*s*l,this._y=n*s*o-a*i*l,this._z=n*i*l-a*s*o,this._w=n*i*o+a*s*l):"ZXY"===t.order?(this._x=a*i*o-n*s*l,this._y=n*s*o+a*i*l,this._z=n*i*l+a*s*o,this._w=n*i*o-a*s*l):"ZYX"===t.order?(this._x=a*i*o-n*s*l,this._y=n*s*o+a*i*l,this._z=n*i*l-a*s*o,this._w=n*i*o+a*s*l):"YZX"===t.order?(this._x=a*i*o+n*s*l,this._y=n*s*o+a*i*l,this._z=n*i*l-a*s*o,this._w=n*i*o-a*s*l):"XZY"===t.order&&(this._x=a*i*o-n*s*l,this._y=n*s*o-a*i*l,this._z=n*i*l+a*s*o,this._w=n*i*o+a*s*l),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],l=n[9],c=n[2],u=n[6],h=n[10],d=i+s+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(u-l)*e,this._y=(o-c)*e,this._z=(a-r)*e):i>s&&i>h?(e=2*Math.sqrt(1+i-s-h),this._w=(u-l)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+c)/e):s>h?(e=2*Math.sqrt(1+s-i-h),this._w=(o-c)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(l+u)/e):(e=2*Math.sqrt(1+h-i-s),this._w=(a-r)/e,this._x=(o+c)/e,this._y=(l+u)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(n,i){return void 0===t&&(t=new r.Vector3),1e-6>(e=n.dot(i)+1)?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(r.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+o*a+i*l-r*s,this._y=i*c+o*s+r*a-n*l,this._z=r*c+o*l+n*s-i*a,this._w=o*c-n*a-i*s-r*l,this.onChangeCallback(),this},multiplyVector3:function(t){return r.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var c=Math.sin((1-e)*s)/l,u=Math.sin(e*s)/l;return this._w=o*c+this._w*u,this._x=n*c+this._x*u,this._y=i*c+this._y*u,this._z=r*c+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new r.Quaternion(this._x,this._y,this._z,this._w)}},r.Quaternion.slerp=function(t,e,n,i){return n.copy(t).slerp(e,i)},r.Vector2=function(t,e){this.x=t||0,this.y=e||0},r.Vector2.prototype={constructor:r.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(r.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},sub:function(t,e){return void 0!==e?(r.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e}else this.x=0,this.y=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new r.Vector2,e=new r.Vector2),t.set(n,n),e.set(i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this},clone:function(){return new r.Vector2(this.x,this.y)}},r.Vector3=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0},r.Vector3.prototype={constructor:r.Vector3,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(r.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},sub:function(t,e){return void 0!==e?(r.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(r.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return e instanceof r.Euler==0&&r.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new r.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new r.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,n)),this}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},applyProjection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*i-a*n,c=s*n+a*e-r*i,u=s*i+r*n-o*e,h=-r*e-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new r.Matrix4),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new r.Matrix4),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new r.Vector3,e=new r.Vector3),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},cross:function(t,e){if(void 0!==e)return r.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,o=this.z;return this.x=i*t.z-o*t.y,this.y=o*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(){var t,e;return function(n){return void 0===t&&(t=new r.Vector3),t.copy(n).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new r.Vector3),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new r.Vector3),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/(this.length()*t.length());return Math.acos(r.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},setEulerFromRotationMatrix:function(t,e){r.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(t,e){r.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return r.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return r.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return r.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),n=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),i=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){var n=4*t,i=e.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this},clone:function(){return new r.Vector3(this.x,this.y,this.z)}},r.Vector4=function(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1},r.Vector4.prototype={constructor:r.Vector4,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(r.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},sub:function(t,e){return void 0!==e?(r.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e,this.w*=e}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o=.01,a=.1,s=t.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],f=s[9],p=s[2],m=s[6],v=s[10];if(Math.abs(c-h)<o&&Math.abs(u-p)<o&&Math.abs(f-m)<o){if(Math.abs(c+h)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var g=(l+1)/2,y=(d+1)/2,b=(v+1)/2,x=(c+h)/4,w=(u+p)/4,_=(f+m)/4;return g>y&&g>b?o>g?(n=0,i=.707106781,r=.707106781):(i=x/(n=Math.sqrt(g)),r=w/n):y>b?o>y?(n=.707106781,i=0,r=.707106781):(n=x/(i=Math.sqrt(y)),r=_/i):o>b?(n=.707106781,i=.707106781,r=0):(n=w/(r=Math.sqrt(b)),i=_/r),this.set(n,i,r,e),this}var S=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(S)<.001&&(S=1),this.x=(m-f)/S,this.y=(u-p)/S,this.z=(h-c)/S,this.w=Math.acos((l+d+v-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new r.Vector4,e=new r.Vector4),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this},clone:function(){return new r.Vector4(this.x,this.y,this.z,this.w)}},r.Euler=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||r.Euler.DefaultOrder},r.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],r.Euler.DefaultOrder="XYZ",r.Euler.prototype={constructor:r.Euler,_x:0,_y:0,_z:0,_order:r.Euler.DefaultOrder,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=r.Math.clamp,o=t.elements,a=o[0],s=o[4],l=o[8],c=o[1],u=o[5],h=o[9],d=o[2],f=o[6],p=o[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===e?(this._y=Math.asin(-i(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-s,u))):"YZX"===e?(this._z=Math.asin(i(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(l,p))):"XZY"===e?(this._z=Math.asin(-i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-h,p),this._y=0)):r.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new r.Matrix4),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new r.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new r.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new r.Euler(this._x,this._y,this._z,this._order)}},r.Line3=function(t,e){this.start=void 0!==t?t:new r.Vector3,this.end=void 0!==e?e:new r.Vector3},r.Line3.prototype={constructor:r.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){return(t||new r.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new r.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new r.Vector3;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new r.Vector3,e=new r.Vector3;return function(n,i){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var o=e.dot(e),a=e.dot(t)/o;return i&&(a=r.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e),o=n||new r.Vector3;return this.delta(o).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},clone:function(){return(new r.Line3).copy(this)}},r.Box2=function(t,e){this.min=void 0!==t?t:new r.Vector2(1/0,1/0),this.max=void 0!==e?e:new r.Vector2(-1/0,-1/0)},r.Box2.prototype={constructor:r.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;n>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new r.Vector2;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new r.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new r.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new r.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new r.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new r.Vector2;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new r.Box2).copy(this)}},r.Box3=function(t,e){this.min=void 0!==t?t:new r.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new r.Vector3(-1/0,-1/0,-1/0)},r.Box3.prototype={constructor:r.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;n>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new r.Vector3;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new r.Vector3;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse((function(e){var i=e.geometry;if(void 0!==i)if(i instanceof r.Geometry)for(var o=i.vertices,a=0,s=o.length;s>a;a++)t.copy(o[a]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t);else if(i instanceof r.BufferGeometry&&void 0!==i.attributes.position){var l=i.attributes.position.array;for(a=0,s=l.length;s>a;a+=3)t.set(l[a],l[a+1],l[a+2]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}})),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new r.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new r.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new r.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},clampPoint:function(t,e){return(e||new r.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new r.Vector3;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new r.Vector3;return function(e){var n=e||new r.Sphere;return n.center=this.center(),n.radius=.5*this.size(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new r.Box3).copy(this)}},r.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&r.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},r.Matrix3.prototype={constructor:r.Matrix3,set:function(t,e,n,i,r,o,a,s,l){var c=this.elements;return c[0]=t,c[3]=e,c[6]=n,c[1]=i,c[4]=r,c[7]=o,c[2]=a,c[5]=s,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(t){return r.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return r.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t=new r.Vector3;return function(e,n,i){void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;i>r;r+=3,o+=3)t.x=e[o],t.y=e[o+1],t.z=e[o+2],t.applyMatrix3(this),e[o]=t.x,e[o+1]=t.y,e[o+2]=t.z;return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-n*r*c+n*a*s+i*r*l-i*o*s},getInverse:function(t,e){var n=t.elements,i=this.elements;i[0]=n[10]*n[5]-n[6]*n[9],i[1]=-n[10]*n[1]+n[2]*n[9],i[2]=n[6]*n[1]-n[2]*n[5],i[3]=-n[10]*n[4]+n[6]*n[8],i[4]=n[10]*n[0]-n[2]*n[8],i[5]=-n[6]*n[0]+n[2]*n[4],i[6]=n[9]*n[4]-n[5]*n[8],i[7]=-n[9]*n[0]+n[1]*n[8],i[8]=n[5]*n[0]-n[1]*n[4];var o=n[0]*i[0]+n[1]*i[3]+n[2]*i[6];if(0===o){var a="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(a);return r.warn(a),this.identity(),this}return this.multiplyScalar(1/o),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},clone:function(){return(new r.Matrix3).fromArray(this.elements)}},r.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&r.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},r.Matrix4.prototype={constructor:r.Matrix4,set:function(t,e,n,i,r,o,a,s,l,c,u,h,d,f,p,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return r.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){var i=this.elements;return t.set(i[0],i[1],i[2]),e.set(i[4],i[5],i[6]),n.set(i[8],i[9],i[10]),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new r.Vector3;return function(e){var n=this.elements,i=e.elements,r=1/t.set(i[0],i[1],i[2]).length(),o=1/t.set(i[4],i[5],i[6]).length(),a=1/t.set(i[8],i[9],i[10]).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(t){t instanceof r.Euler==0&&r.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,o=t.z,a=Math.cos(n),s=Math.sin(n),l=Math.cos(i),c=Math.sin(i),u=Math.cos(o),h=Math.sin(o);if("XYZ"===t.order){var d=a*u,f=a*h,p=s*u,m=s*h;e[0]=l*u,e[4]=-l*h,e[8]=c,e[1]=f+p*c,e[5]=d-m*c,e[9]=-s*l,e[2]=m-d*c,e[6]=p+f*c,e[10]=a*l}else if("YXZ"===t.order){var v=l*u,g=l*h,y=c*u,b=c*h;e[0]=v+b*s,e[4]=y*s-g,e[8]=a*c,e[1]=a*h,e[5]=a*u,e[9]=-s,e[2]=g*s-y,e[6]=b+v*s,e[10]=a*l}else if("ZXY"===t.order){v=l*u,g=l*h,y=c*u,b=c*h;e[0]=v-b*s,e[4]=-a*h,e[8]=y+g*s,e[1]=g+y*s,e[5]=a*u,e[9]=b-v*s,e[2]=-a*c,e[6]=s,e[10]=a*l}else if("ZYX"===t.order){d=a*u,f=a*h,p=s*u,m=s*h;e[0]=l*u,e[4]=p*c-f,e[8]=d*c+m,e[1]=l*h,e[5]=m*c+d,e[9]=f*c-p,e[2]=-c,e[6]=s*l,e[10]=a*l}else if("YZX"===t.order){var x=a*l,w=a*c,_=s*l,S=s*c;e[0]=l*u,e[4]=S-x*h,e[8]=_*h+w,e[1]=h,e[5]=a*u,e[9]=-s*u,e[2]=-c*u,e[6]=w*h+_,e[10]=x-S*h}else if("XZY"===t.order){x=a*l,w=a*c,_=s*l,S=s*c;e[0]=l*u,e[4]=-h,e[8]=c*u,e[1]=x*h+S,e[5]=a*u,e[9]=w*h-_,e[2]=_*h-w,e[6]=s*u,e[10]=S*h+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return r.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,o=t.w,a=n+n,s=i+i,l=r+r,c=n*a,u=n*s,h=n*l,d=i*s,f=i*l,p=r*l,m=o*a,v=o*s,g=o*l;return e[0]=1-(d+p),e[4]=u-g,e[8]=h+v,e[1]=u+g,e[5]=1-(c+p),e[9]=f-m,e[2]=h-v,e[6]=f+m,e[10]=1-(c+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Vector3;return function(i,r,o){var a=this.elements;return n.subVectors(i,r).normalize(),0===n.length()&&(n.z=1),t.crossVectors(o,n).normalize(),0===t.length()&&(n.x+=1e-4,t.crossVectors(o,n).normalize()),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(r.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],x=n[15],w=i[0],_=i[4],S=i[8],M=i[12],C=i[1],T=i[5],E=i[9],k=i[13],A=i[2],P=i[6],L=i[10],O=i[14],R=i[3],F=i[7],B=i[11],D=i[15];return r[0]=o*w+a*C+s*A+l*R,r[4]=o*_+a*T+s*P+l*F,r[8]=o*S+a*E+s*L+l*B,r[12]=o*M+a*k+s*O+l*D,r[1]=c*w+u*C+h*A+d*R,r[5]=c*_+u*T+h*P+d*F,r[9]=c*S+u*E+h*L+d*B,r[13]=c*M+u*k+h*O+d*D,r[2]=f*w+p*C+m*A+v*R,r[6]=f*_+p*T+m*P+v*F,r[10]=f*S+p*E+m*L+v*B,r[14]=f*M+p*k+m*O+v*D,r[3]=g*w+y*C+b*A+x*R,r[7]=g*_+y*T+b*P+x*F,r[11]=g*S+y*E+b*L+x*B,r[15]=g*M+y*k+b*O+x*D,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return r.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return r.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return r.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t=new r.Vector3;return function(e,n,i){void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;i>r;r+=3,o+=3)t.x=e[o],t.y=e[o+1],t.z=e[o+2],t.applyMatrix4(this),e[o]=t.x,e[o+1]=t.y,e[o+2]=t.z;return e}}(),rotateAxis:function(t){r.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return r.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+t[7]*(+e*s*d-e*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+t[11]*(+e*l*u-e*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+t[15]*(-i*a*c-e*s*u+e*a*h+i*o*u-n*o*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t},getPosition:function(){var t=new r.Vector3;return function(){r.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],u=i[5],h=i[9],d=i[13],f=i[2],p=i[6],m=i[10],v=i[14],g=i[3],y=i[7],b=i[11],x=i[15];n[0]=h*v*y-d*m*y+d*p*b-u*v*b-h*p*x+u*m*x,n[4]=l*m*y-s*v*y-l*p*b+a*v*b+s*p*x-a*m*x,n[8]=s*d*y-l*h*y+l*u*b-a*d*b-s*u*x+a*h*x,n[12]=l*h*p-s*d*p-l*u*m+a*d*m+s*u*v-a*h*v,n[1]=d*m*g-h*v*g-d*f*b+c*v*b+h*f*x-c*m*x,n[5]=s*v*g-l*m*g+l*f*b-o*v*b-s*f*x+o*m*x,n[9]=l*h*g-s*d*g-l*c*b+o*d*b+s*c*x-o*h*x,n[13]=s*d*f-l*h*f+l*c*m-o*d*m-s*c*v+o*h*v,n[2]=u*v*g-d*p*g+d*f*y-c*v*y-u*f*x+c*p*x,n[6]=l*p*g-a*v*g-l*f*y+o*v*y+a*f*x-o*p*x,n[10]=a*d*g-l*u*g+l*c*y-o*d*y-a*c*x+o*u*x,n[14]=l*u*f-a*d*f-l*c*p+o*d*p+a*c*v-o*u*v,n[3]=h*p*g-u*m*g-h*f*y+c*m*y+u*f*b-c*p*b,n[7]=a*m*g-s*p*g+s*f*y-o*m*y-a*f*b+o*p*b,n[11]=s*u*g-a*h*g-s*c*y+o*h*y+a*c*b-o*u*b,n[15]=a*h*f-s*u*f+s*c*p-o*h*p-a*c*m+o*u*m;var w=o*n[0]+c*n[4]+f*n[8]+g*n[12];if(0==w){var _="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(_);return r.warn(_),this.identity(),this}return this.multiplyScalar(1/w),this},translate:function(t){r.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){r.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){r.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){r.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){r.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(n,i)))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new r.Vector3,e=new r.Matrix4;return function(n,i,r){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements);var c=1/a,u=1/s,h=1/l;return e.elements[0]*=c,e.elements[1]*=c,e.elements[2]*=c,e.elements[4]*=u,e.elements[5]*=u,e.elements[6]*=u,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makeFrustum:function(t,e,n,i,r,o){var a=this.elements,s=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),u=(i+n)/(i-n),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,n,i){var o=n*Math.tan(r.Math.degToRad(.5*t)),a=-o,s=a*e,l=o*e;return this.makeFrustum(s,l,a,o,n,i)},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=e-t,l=n-i,c=o-r,u=(e+t)/s,h=(n+i)/l,d=(o+r)/c;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){return(new r.Matrix4).fromArray(this.elements)}},r.Ray=function(t,e){this.origin=void 0!==t?t:new r.Vector3,this.direction=void 0!==e?e:new r.Vector3},r.Ray.prototype={constructor:r.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new r.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new r.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new r.Vector3;n.subVectors(t,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var t=new r.Vector3;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceTo(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceTo(e))}}(),distanceSqToSegment:function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Vector3;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,l,c,u,h=.5*i.distanceTo(r),d=-this.direction.dot(e),f=n.dot(this.direction),p=-n.dot(e),m=n.lengthSq(),v=Math.abs(1-d*d);if(v>0)if(l=d*f-p,u=h*v,(s=d*p-f)>=0)if(l>=-u)if(u>=l){var g=1/v;c=(s*=g)*(s+d*(l*=g)+2*f)+l*(d*s+l+2*p)+m}else l=h,c=-(s=Math.max(0,-(d*l+f)))*s+l*(l+2*p)+m;else l=-h,c=-(s=Math.max(0,-(d*l+f)))*s+l*(l+2*p)+m;else-u>=l?c=-(s=Math.max(0,-(-d*h+f)))*s+(l=s>0?-h:Math.min(Math.max(-h,-p),h))*(l+2*p)+m:u>=l?(s=0,c=(l=Math.min(Math.max(-h,-p),h))*(l+2*p)+m):c=-(s=Math.max(0,-(d*h+f)))*s+(l=s>0?h:Math.min(Math.max(-h,-p),h))*(l+2*p)+m;else l=d>0?-h:h,c=-(s=Math.max(0,-(d*l+f)))*s+l*(l+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(l).add(t),c}}(),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},intersectSphere:function(){var t=new r.Vector3;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,l=i+a;return 0>s&&0>l?null:0>s?this.at(l,n):this.at(s,n)}}(),isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0==e)return 0==t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},isIntersectionBox:function(){var t=new r.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var n,i,r,o,a,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||r>i?null:((r>n||n!=n)&&(n=r),(i>o||i!=i)&&(i=o),u>=0?(a=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||a>i?null:((a>n||n!=n)&&(n=a),(i>s||i!=i)&&(i=s),0>i?null:this.at(n>=0?n:i,e)))},intersectTriangle:function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Vector3,i=new r.Vector3;return function(r,o,a,s,l){e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n);var c,u=this.direction.dot(i);if(u>0){if(s)return null;c=1}else{if(!(0>u))return null;c=-1,u=-u}t.subVectors(this.origin,r);var h=c*this.direction.dot(n.crossVectors(t,n));if(0>h)return null;var d=c*this.direction.dot(e.cross(t));if(0>d)return null;if(h+d>u)return null;var f=-c*t.dot(i);return 0>f?null:this.at(f/u,l)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},clone:function(){return(new r.Ray).copy(this)}},r.Sphere=function(t,e){this.center=void 0!==t?t:new r.Vector3,this.radius=void 0!==e?e:0},r.Sphere.prototype={constructor:r.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new r.Box3;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).center(i);for(var r=0,o=0,a=e.length;a>o;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new r.Vector3;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var e=t||new r.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius},clone:function(){return(new r.Sphere).copy(this)}},r.Frustum=function(t,e,n,i,o,a){this.planes=[void 0!==t?t:new r.Plane,void 0!==e?e:new r.Plane,void 0!==n?n:new r.Plane,void 0!==i?i:new r.Plane,void 0!==o?o:new r.Plane,void 0!==a?a:new r.Plane]},r.Frustum.prototype={constructor:r.Frustum,set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-i,u-s,p-h,y-m).normalize(),e[1].setComponents(a+i,u+s,p+h,y+m).normalize(),e[2].setComponents(a+r,u+l,p+d,y+v).normalize(),e[3].setComponents(a-r,u-l,p-d,y-v).normalize(),e[4].setComponents(a-o,u-c,p-f,y-g).normalize(),e[5].setComponents(a+o,u+c,p+f,y+g).normalize(),this},intersectsObject:function(){var t=new r.Sphere;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;6>r;r++){if(i>e[r].distanceToPoint(n))return!1}return!0},intersectsBox:function(){var t=new r.Vector3,e=new r.Vector3;return function(n){for(var i=this.planes,r=0;6>r;r++){var o=i[r];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0},clone:function(){return(new r.Frustum).copy(this)}},r.Plane=function(t,e){this.normal=void 0!==t?t:new r.Vector3(1,0,0),this.constant=void 0!==e?e:0},r.Plane.prototype={constructor:r.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new r.Vector3,e=new r.Vector3;return function(n,i,r){var o=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new r.Vector3).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return 0>e&&n>0||0>n&&e>0},intersectLine:function(){var t=new r.Vector3;return function(e,n){var i=n||new r.Vector3,o=e.delta(t),a=this.normal.dot(o);if(0==a)return 0==this.distanceToPoint(e.start)?i.copy(e.start):void 0;var s=-(e.start.dot(this.normal)+this.constant)/a;return 0>s||s>1?void 0:i.copy(o).multiplyScalar(s).add(e.start)}}(),coplanarPoint:function(t){return(t||new r.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Matrix3;return function(i,r){var o=r||n.getNormalMatrix(i),a=t.copy(this.normal).applyMatrix3(o),s=this.coplanarPoint(e);return s.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(a,s),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},clone:function(){return(new r.Plane).copy(this)}},r.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0;return function(){for(var r=0;36>r;r++)8==r||13==r||18==r||23==r?n[r]="-":14==r?n[r]="4":(2>=i&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19==r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return e>t?e:t>n?n:t},clampBottom:function(t,e){return e>t?e:t},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},smoothstep:function(t,e,n){return e>=t?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return e>=t?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return Math.floor(this.randFloat(t,e))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}(),isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},r.Spline=function(t){function e(t,e,n,i,r,o,a){var s=.5*(n-t),l=.5*(i-e);return(2*(e-n)+s+l)*a+(-3*(e-n)-2*s-l)*o+s*r+e}this.points=t;var n,i,o,a,s,l,c,u,h,d=[],f={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return n=(this.points.length-1)*t,i=Math.floor(n),o=n-i,d[0]=0===i?i:i-1,d[1]=i,d[2]=i>this.points.length-2?this.points.length-1:i+1,d[3]=i>this.points.length-3?this.points.length-1:i+2,l=this.points[d[0]],c=this.points[d[1]],u=this.points[d[2]],h=this.points[d[3]],s=o*(a=o*o),f.x=e(l.x,c.x,u.x,h.x,o,a,s),f.y=e(l.y,c.y,u.y,h.y,o,a,s),f.z=e(l.z,c.z,u.z,h.z,o,a,s),f},this.getControlPointsArray=function(){var t,e,n=this.points.length,i=[];for(t=0;n>t;t++)e=this.points[t],i[t]=[e.x,e.y,e.z];return i},this.getLength=function(t){var e,n,i,o,a=0,s=0,l=0,c=new r.Vector3,u=new r.Vector3,h=[],d=0;for(h[0]=0,t||(t=100),i=this.points.length*t,c.copy(this.points[0]),e=1;i>e;e++)n=e/i,o=this.getPoint(n),u.copy(o),d+=u.distanceTo(c),c.copy(o),a=(this.points.length-1)*n,(s=Math.floor(a))!=l&&(h[s]=d,l=s);return h[h.length]=d,{chunks:h,total:d}},this.reparametrizeByArcLength=function(t){var e,n,i,o,a,s,l,c,u=[],h=new r.Vector3,d=this.getLength();for(u.push(h.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(s=d.chunks[e]-d.chunks[e-1],l=Math.ceil(t*s/d.total),o=(e-1)/(this.points.length-1),a=e/(this.points.length-1),n=1;l-1>n;n++)i=o+n*(1/l)*(a-o),c=this.getPoint(i),u.push(h.copy(c).clone());u.push(h.copy(this.points[e]).clone())}this.points=u}},r.Triangle=function(t,e,n){this.a=void 0!==t?t:new r.Vector3,this.b=void 0!==e?e:new r.Vector3,this.c=void 0!==n?n:new r.Vector3},r.Triangle.normal=function(){var t=new r.Vector3;return function(e,n,i,o){var a=o||new r.Vector3;a.subVectors(i,n),t.subVectors(e,n),a.cross(t);var s=a.lengthSq();return s>0?a.multiplyScalar(1/Math.sqrt(s)):a.set(0,0,0)}}(),r.Triangle.barycoordFromPoint=function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Vector3;return function(i,o,a,s,l){t.subVectors(s,o),e.subVectors(a,o),n.subVectors(i,o);var c=t.dot(t),u=t.dot(e),h=t.dot(n),d=e.dot(e),f=e.dot(n),p=c*d-u*u,m=l||new r.Vector3;if(0==p)return m.set(-2,-1,-1);var v=1/p,g=(d*h-u*f)*v,y=(c*f-u*h)*v;return m.set(1-g-y,y,g)}}(),r.Triangle.containsPoint=function(){var t=new r.Vector3;return function(e,n,i,o){var a=r.Triangle.barycoordFromPoint(e,n,i,o,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}(),r.Triangle.prototype={constructor:r.Triangle,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new r.Vector3,e=new r.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new r.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return r.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new r.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return r.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return r.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},clone:function(){return(new r.Triangle).copy(this)}},r.Clock=function(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},r.Clock.prototype={constructor:r.Clock,start:function(){this.startTime=void 0!==i.performance&&void 0!==i.performance.now?i.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==i.performance&&void 0!==i.performance.now?i.performance.now():Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},r.EventDispatcher=function(){},r.EventDispatcher.prototype={constructor:r.EventDispatcher,apply:function(t){t.addEventListener=r.EventDispatcher.prototype.addEventListener,t.hasEventListener=r.EventDispatcher.prototype.hasEventListener,t.removeEventListener=r.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=r.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=[],i=e.length,r=0;i>r;r++)n[r]=e[r];for(r=0;i>r;r++)n[r].call(this,t)}}}},function(t){t.Raycaster=function(e,n,i,r){this.ray=new t.Ray(e,n),this.near=i||0,this.far=r||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var e=function(t,e){return t.distance-e.distance},n=function(t,e,i,r){if(t.raycast(e,i),!0===r)for(var o=t.children,a=0,s=o.length;s>a;a++)n(o[a],e,i,!0)};t.Raycaster.prototype={constructor:t.Raycaster,precision:1e-4,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,n){n instanceof t.PerspectiveCamera?(this.ray.origin.copy(n.position),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(n.position).normalize()):n instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):t.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,i){var r=[];return n(t,this,r,i),r.sort(e),r},intersectObjects:function(i,r){var o=[];if(i instanceof Array==0)return t.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var a=0,s=i.length;s>a;a++)n(i[a],this,o,r);return o.sort(e),o}}}(r),r.Object3D=function(){Object.defineProperty(this,"id",{value:r.Object3DIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=r.Object3D.DefaultUp.clone();var t=new r.Vector3,e=new r.Euler,n=new r.Quaternion,i=new r.Vector3(1,1,1);e.onChange((function(){n.setFromEuler(e,!1)})),n.onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i}}),this.rotationAutoUpdate=!0,this.matrix=new r.Matrix4,this.matrixWorld=new r.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},r.Object3D.DefaultUp=new r.Vector3(0,1,0),r.Object3D.prototype={constructor:r.Object3D,get eulerOrder(){return r.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(t){r.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=t},get useQuaternion(){r.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){r.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new r.Quaternion;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new r.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new r.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new r.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new r.Vector3;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translate:function(t,e){return r.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},translateX:function(){var t=new r.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new r.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new r.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new r.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new r.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(r.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t instanceof r.Object3D?(void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):r.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var n=this.children.indexOf(t);-1!==n&&(t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getChildByName:function(t){return r.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;i>n;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){var e=t||new r.Vector3;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new r.Vector3,e=new r.Vector3;return function(n){var i=n||new r.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new r.Quaternion;return function(e){var n=e||new r.Euler;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new r.Vector3,e=new r.Quaternion;return function(n){var i=n||new r.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new r.Quaternion;return function(e){var n=e||new r.Vector3;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=0,n=this.children.length;n>e;e++)this.children[e].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=0,n=this.children.length;n>e;e++)this.children[e].traverseVisible(t)}},traverseAncestors:function(t){this.parent&&(t(this.parent),this.parent.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===t)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,n=this.children.length;n>e;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(){var t={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},e={},n=function(n){if(void 0===t.geometries&&(t.geometries=[]),void 0===e[n.uuid]){var i=n.toJSON();delete i.metadata,e[n.uuid]=i,t.geometries.push(i)}return n.uuid},i={},o=function(e){if(void 0===t.materials&&(t.materials=[]),void 0===i[e.uuid]){var n=e.toJSON();delete n.metadata,i[e.uuid]=n,t.materials.push(n)}return e.uuid},a=function(t){var e={};if(e.uuid=t.uuid,e.type=t.type,""!==t.name&&(e.name=t.name),"{}"!==JSON.stringify(t.userData)&&(e.userData=t.userData),!0!==t.visible&&(e.visible=t.visible),t instanceof r.PerspectiveCamera?(e.fov=t.fov,e.aspect=t.aspect,e.near=t.near,e.far=t.far):t instanceof r.OrthographicCamera?(e.left=t.left,e.right=t.right,e.top=t.top,e.bottom=t.bottom,e.near=t.near,e.far=t.far):t instanceof r.AmbientLight?e.color=t.color.getHex():t instanceof r.DirectionalLight?(e.color=t.color.getHex(),e.intensity=t.intensity):t instanceof r.PointLight?(e.color=t.color.getHex(),e.intensity=t.intensity,e.distance=t.distance,e.decay=t.decay):t instanceof r.SpotLight?(e.color=t.color.getHex(),e.intensity=t.intensity,e.distance=t.distance,e.angle=t.angle,e.exponent=t.exponent,e.decay=t.decay):t instanceof r.HemisphereLight?(e.color=t.color.getHex(),e.groundColor=t.groundColor.getHex()):t instanceof r.Mesh||t instanceof r.Line||t instanceof r.PointCloud?(e.geometry=n(t.geometry),e.material=o(t.material),t instanceof r.Line&&(e.mode=t.mode)):t instanceof r.Sprite&&(e.material=o(t.material)),e.matrix=t.matrix.toArray(),t.children.length>0){e.children=[];for(var i=0;i<t.children.length;i++)e.children.push(a(t.children[i]))}return e};return t.object=a(this),t},clone:function(t,e){if(void 0===t&&(t=new r.Object3D),void 0===e&&(e=!0),t.name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.quaternion.copy(this.quaternion),t.scale.copy(this.scale),t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData)),!0===e)for(var n=0;n<this.children.length;n++){var i=this.children[n];t.add(i.clone())}return t}},r.EventDispatcher.prototype.apply(r.Object3D.prototype),r.Object3DIdCount=0,r.Face3=function(t,e,n,i,o,a){this.a=t,this.b=e,this.c=n,this.normal=i instanceof r.Vector3?i:new r.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=o instanceof r.Color?o:new r.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==a?a:0},r.Face3.prototype={constructor:r.Face3,clone:function(){var t=new r.Face3(this.a,this.b,this.c);t.normal.copy(this.normal),t.color.copy(this.color),t.materialIndex=this.materialIndex;for(var e=0,n=this.vertexNormals.length;n>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,n=this.vertexColors.length;n>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,n=this.vertexTangents.length;n>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},r.Face4=function(t,e,n,i,o,a,s){return r.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new r.Face3(t,e,n,o,a,s)},r.BufferAttribute=function(t,e){this.array=t,this.itemSize=e,this.needsUpdate=!1},r.BufferAttribute.prototype={constructor:r.BufferAttribute,get length(){return this.array.length},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;r>i;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},setX:function(t,e){return this.array[t*this.itemSize]=e,this},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},clone:function(){return new r.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},r.Int8Attribute=function(t,e){return r.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Uint8Attribute=function(t,e){return r.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Uint8ClampedAttribute=function(t,e){return r.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Int16Attribute=function(t,e){return r.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Uint16Attribute=function(t,e){return r.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Int32Attribute=function(t,e){return r.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Uint32Attribute=function(t,e){return r.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Float32Attribute=function(t,e){return r.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.Float64Attribute=function(t,e){return r.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(t,e)},r.DynamicBufferAttribute=function(t,e){r.BufferAttribute.call(this,t,e),this.updateRange={offset:0,count:-1}},r.DynamicBufferAttribute.prototype=Object.create(r.BufferAttribute.prototype),r.DynamicBufferAttribute.prototype.constructor=r.DynamicBufferAttribute,r.DynamicBufferAttribute.prototype.clone=function(){return new r.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)},r.BufferGeometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},r.BufferGeometry.prototype={constructor:r.BufferGeometry,addAttribute:function(t,e){return e instanceof r.BufferAttribute==0?(r.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[t]={array:arguments[1],itemSize:arguments[2]})):(this.attributes[t]=e,void(this.attributesKeys=Object.keys(this.attributes)))},getAttribute:function(t){return this.attributes[t]},addDrawCall:function(t,e,n){this.drawcalls.push({start:t,count:e,index:void 0!==n?n:0})},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new r.Matrix3).getNormalMatrix(t).applyToVector3Array(n.array),n.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.applyMatrix((new r.Matrix4).setPosition(t)),t},fromGeometry:function(t,e){e=e||{vertexColors:r.NoColors};var n=t.vertices,i=t.faces,o=t.faceVertexUvs,a=e.vertexColors,s=o[0].length>0,l=3==i[0].vertexNormals.length,c=new Float32Array(3*i.length*3);this.addAttribute("position",new r.BufferAttribute(c,3));var u=new Float32Array(3*i.length*3);if(this.addAttribute("normal",new r.BufferAttribute(u,3)),a!==r.NoColors){var h=new Float32Array(3*i.length*3);this.addAttribute("color",new r.BufferAttribute(h,3))}if(!0===s){var d=new Float32Array(3*i.length*2);this.addAttribute("uv",new r.BufferAttribute(d,2))}for(var f=0,p=0,m=0;f<i.length;f++,p+=6,m+=9){var v=i[f],g=n[v.a],y=n[v.b],b=n[v.c];if(c[m]=g.x,c[m+1]=g.y,c[m+2]=g.z,c[m+3]=y.x,c[m+4]=y.y,c[m+5]=y.z,c[m+6]=b.x,c[m+7]=b.y,c[m+8]=b.z,!0===l){var x=v.vertexNormals[0],w=v.vertexNormals[1],_=v.vertexNormals[2];u[m]=x.x,u[m+1]=x.y,u[m+2]=x.z,u[m+3]=w.x,u[m+4]=w.y,u[m+5]=w.z,u[m+6]=_.x,u[m+7]=_.y,u[m+8]=_.z}else{var S=v.normal;u[m]=S.x,u[m+1]=S.y,u[m+2]=S.z,u[m+3]=S.x,u[m+4]=S.y,u[m+5]=S.z,u[m+6]=S.x,u[m+7]=S.y,u[m+8]=S.z}if(a===r.FaceColors){var M=v.color;h[m]=M.r,h[m+1]=M.g,h[m+2]=M.b,h[m+3]=M.r,h[m+4]=M.g,h[m+5]=M.b,h[m+6]=M.r,h[m+7]=M.g,h[m+8]=M.b}else if(a===r.VertexColors){var C=v.vertexColors[0],T=v.vertexColors[1],E=v.vertexColors[2];h[m]=C.r,h[m+1]=C.g,h[m+2]=C.b,h[m+3]=T.r,h[m+4]=T.g,h[m+5]=T.b,h[m+6]=E.r,h[m+7]=E.g,h[m+8]=E.b}if(!0===s){var k=o[0][f][0],A=o[0][f][1],P=o[0][f][2];d[p]=k.x,d[p+1]=k.y,d[p+2]=A.x,d[p+3]=A.y,d[p+4]=P.x,d[p+5]=P.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var t=new r.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new r.Box3);var e=this.attributes.position.array;if(e){var n=this.boundingBox;n.makeEmpty();for(var i=0,o=e.length;o>i;i+=3)t.set(e[i],e[i+1],e[i+2]),n.expandByPoint(t)}(void 0===e||0===e.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&r.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var t=new r.Box3,e=new r.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere);var n=this.attributes.position.array;if(n){t.makeEmpty();for(var i=this.boundingSphere.center,o=0,a=n.length;a>o;o+=3)e.set(n[o],n[o+1],n[o+2]),t.expandByPoint(e);t.center(i);var s=0;for(o=0,a=n.length;a>o;o+=3)e.set(n[o],n[o+1],n[o+2]),s=Math.max(s,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&r.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.attributes;if(t.position){var e=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new r.BufferAttribute(new Float32Array(e.length),3));else for(var n=0,i=(l=t.normal.array).length;i>n;n++)l[n]=0;var o,a,s,l=t.normal.array,c=new r.Vector3,u=new r.Vector3,h=new r.Vector3,d=new r.Vector3,f=new r.Vector3;if(t.index)for(var p=t.index.array,m=this.offsets.length>0?this.offsets:[{start:0,count:p.length,index:0}],v=0,g=m.length;g>v;++v){var y=m[v].start,b=m[v].count,x=m[v].index;for(n=y,i=y+b;i>n;n+=3)o=3*(x+p[n]),a=3*(x+p[n+1]),s=3*(x+p[n+2]),c.fromArray(e,o),u.fromArray(e,a),h.fromArray(e,s),d.subVectors(h,u),f.subVectors(c,u),d.cross(f),l[o]+=d.x,l[o+1]+=d.y,l[o+2]+=d.z,l[a]+=d.x,l[a+1]+=d.y,l[a+2]+=d.z,l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z}else for(n=0,i=e.length;i>n;n+=9)c.fromArray(e,n),u.fromArray(e,n+3),h.fromArray(e,n+6),d.subVectors(h,u),f.subVectors(c,u),d.cross(f),l[n]=d.x,l[n+1]=d.y,l[n+2]=d.z,l[n+3]=d.x,l[n+4]=d.y,l[n+5]=d.z,l[n+6]=d.x,l[n+7]=d.y,l[n+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},computeTangents:function(){function t(t,e,n){P.fromArray(i,3*t),L.fromArray(i,3*e),O.fromArray(i,3*n),R.fromArray(a,2*t),F.fromArray(a,2*e),B.fromArray(a,2*n),d=L.x-P.x,f=O.x-P.x,p=L.y-P.y,m=O.y-P.y,v=L.z-P.z,g=O.z-P.z,y=F.x-R.x,b=B.x-R.x,x=F.y-R.y,w=B.y-R.y,_=1/(y*w-b*x),D.set((w*d-x*f)*_,(w*p-x*m)*_,(w*v-x*g)*_),I.set((y*f-b*d)*_,(y*m-b*p)*_,(y*g-b*v)*_),c[t].add(D),c[e].add(D),c[n].add(D),u[t].add(I),u[e].add(I),u[n].add(I)}function e(t){X.fromArray(o,3*t),Y.copy(X),H=c[t],W.copy(H),W.sub(X.multiplyScalar(X.dot(H))).normalize(),q.crossVectors(Y,H),G=q.dot(u[t]),U=0>G?-1:1,l[4*t]=W.x,l[4*t+1]=W.y,l[4*t+2]=W.z,l[4*t+3]=U}if(void 0!==this.attributes.index&&void 0!==this.attributes.position&&void 0!==this.attributes.normal&&void 0!==this.attributes.uv){var n=this.attributes.index.array,i=this.attributes.position.array,o=this.attributes.normal.array,a=this.attributes.uv.array,s=i.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new r.BufferAttribute(new Float32Array(4*s),4));for(var l=this.attributes.tangent.array,c=[],u=[],h=0;s>h;h++)c[h]=new r.Vector3,u[h]=new r.Vector3;var d,f,p,m,v,g,y,b,x,w,_,S,M,C,T,E,k,A,P=new r.Vector3,L=new r.Vector3,O=new r.Vector3,R=new r.Vector2,F=new r.Vector2,B=new r.Vector2,D=new r.Vector3,I=new r.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,n.length,0);var N=this.drawcalls;for(C=0,T=N.length;T>C;++C){var j=N[C].start,V=N[C].count,z=N[C].index;for(S=j,M=j+V;M>S;S+=3)t(E=z+n[S],k=z+n[S+1],A=z+n[S+2])}var U,H,G,W=new r.Vector3,q=new r.Vector3,X=new r.Vector3,Y=new r.Vector3;for(C=0,T=N.length;T>C;++C){j=N[C].start,V=N[C].count,z=N[C].index;for(S=j,M=j+V;M>S;S+=3)E=z+n[S],k=z+n[S+1],A=z+n[S+2],e(E),e(k),e(A)}}else r.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()")},computeOffsets:function(t){void 0===t&&(t=65535);for(var e=this.attributes.index.array,n=this.attributes.position.array,i=e.length/3,r=new Uint16Array(e.length),o=0,a=0,s=[{start:0,count:0,index:0}],l=s[0],c=0,u=new Int32Array(6),h=new Int32Array(n.length),d=new Int32Array(n.length),f=0;f<n.length;f++)h[f]=-1,d[f]=-1;for(var p=0;i>p;p++){c=0;for(var m=0;3>m;m++){-1==h[b=e[3*p+m]]?(u[2*m]=b,u[2*m+1]=-1,c++):h[b]<l.index?(u[2*m]=b,u[2*m+1]=-1):(u[2*m]=b,u[2*m+1]=h[b])}if(a+c>l.index+t){var v={start:o,count:0,index:a};s.push(v),l=v;for(var g=0;6>g;g+=2){(y=u[g+1])>-1&&y<l.index&&(u[g+1]=-1)}}for(g=0;6>g;g+=2){var y,b=u[g];-1===(y=u[g+1])&&(y=a++),h[b]=y,d[y]=b,r[o++]=y-l.index,l.count++}}return this.reorderBuffers(r,d,a),this.offsets=s,this.drawcalls=s,s},merge:function(t,e){if(t instanceof r.BufferGeometry!=0){void 0===e&&(e=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var o=n[i].array,a=t.attributes[i],s=a.array,l=0,c=a.itemSize*e;l<s.length;l++,c++)o[c]=s[l];return this}r.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,n,i,r=this.attributes.normal.array,o=0,a=r.length;a>o;o+=3)t=r[o],e=r[o+1],n=r[o+2],i=1/Math.sqrt(t*t+e*e+n*n),r[o]*=i,r[o+1]*=i,r[o+2]*=i},reorderBuffers:function(t,e,n){var i={};for(var r in this.attributes)if("index"!=r){var o=this.attributes[r].array;i[r]=new o.constructor(this.attributes[r].itemSize*n)}for(var a=0;n>a;a++){var s=e[a];for(var r in this.attributes)if("index"!=r)for(var l=this.attributes[r].array,c=this.attributes[r].itemSize,u=i[r],h=0;c>h;h++)u[a*c+h]=l[s*c+h]}for(var r in this.attributes.index.array=t,this.attributes)"index"!=r&&(this.attributes[r].array=i[r],this.attributes[r].numItems=this.attributes[r].itemSize*n)},toJSON:function(){var t={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},e=this.attributes,n=this.offsets,i=this.boundingSphere;for(var r in e){var o=e[r],a=Array.prototype.slice.call(o.array);t.data.attributes[r]={itemSize:o.itemSize,type:o.array.constructor.name,array:a}}return n.length>0&&(t.data.offsets=JSON.parse(JSON.stringify(n))),null!==i&&(t.data.boundingSphere={center:i.center.toArray(),radius:i.radius}),t},clone:function(){var t=new r.BufferGeometry;for(var e in this.attributes){var n=this.attributes[e];t.addAttribute(e,n.clone())}for(var i=0,o=this.offsets.length;o>i;i++){var a=this.offsets[i];t.offsets.push({start:a.start,index:a.index,count:a.count})}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.BufferGeometry.prototype),r.Geometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},r.Geometry.prototype={constructor:r.Geometry,applyMatrix:function(t){for(var e=(new r.Matrix3).getNormalMatrix(t),n=0,i=this.vertices.length;i>n;n++){this.vertices[n].applyMatrix4(t)}for(n=0,i=this.faces.length;i>n;n++){var o=this.faces[n];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(e).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},fromBufferGeometry:function(t){for(var e=this,n=t.attributes,i=n.position.array,o=void 0!==n.index?n.index.array:void 0,a=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,c=[],u=[],h=0,d=0;h<i.length;h+=3,d+=2)e.vertices.push(new r.Vector3(i[h],i[h+1],i[h+2])),void 0!==a&&c.push(new r.Vector3(a[h],a[h+1],a[h+2])),void 0!==s&&e.colors.push(new r.Color(s[h],s[h+1],s[h+2])),void 0!==l&&u.push(new r.Vector2(l[d],l[d+1]));var f=function(t,n,i){var o=void 0!==a?[c[t].clone(),c[n].clone(),c[i].clone()]:[],h=void 0!==s?[e.colors[t].clone(),e.colors[n].clone(),e.colors[i].clone()]:[];e.faces.push(new r.Face3(t,n,i,o,h)),void 0!==l&&e.faceVertexUvs[0].push([u[t].clone(),u[n].clone(),u[i].clone()])};if(void 0!==o){var p=t.drawcalls;if(p.length>0)for(h=0;h<p.length;h++)for(var m=p[h],v=m.start,g=m.count,y=m.index,b=(d=v,v+g);b>d;d+=3)f(y+o[d],y+o[d+1],y+o[d+2]);else for(h=0;h<o.length;h+=3)f(o[h],o[h+1],o[h+2])}else for(h=0;h<i.length/3;h+=3)f(h,h+1,h+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.applyMatrix((new r.Matrix4).setPosition(t)),t},computeFaceNormals:function(){for(var t=new r.Vector3,e=new r.Vector3,n=0,i=this.faces.length;i>n;n++){var o=this.faces[n],a=this.vertices[o.a],s=this.vertices[o.b],l=this.vertices[o.c];t.subVectors(l,s),e.subVectors(a,s),t.cross(e),t.normalize(),o.normal.copy(t)}},computeVertexNormals:function(t){var e,n,i,o,a,s;for(s=new Array(this.vertices.length),e=0,n=this.vertices.length;n>e;e++)s[e]=new r.Vector3;if(t){var l,c,u,h=new r.Vector3,d=new r.Vector3;for(i=0,o=this.faces.length;o>i;i++)a=this.faces[i],l=this.vertices[a.a],c=this.vertices[a.b],u=this.vertices[a.c],h.subVectors(u,c),d.subVectors(l,c),h.cross(d),s[a.a].add(h),s[a.b].add(h),s[a.c].add(h)}else for(i=0,o=this.faces.length;o>i;i++)s[(a=this.faces[i]).a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(e=0,n=this.vertices.length;n>e;e++)s[e].normalize();for(i=0,o=this.faces.length;o>i;i++)(a=this.faces[i]).vertexNormals[0]=s[a.a].clone(),a.vertexNormals[1]=s[a.b].clone(),a.vertexNormals[2]=s[a.c].clone()},computeMorphNormals:function(){var t,e,n,i,o;for(n=0,i=this.faces.length;i>n;n++)for((o=this.faces[n]).__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,e=o.vertexNormals.length;e>t;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var a=new r.Geometry;for(a.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;i>n;n++)c=new r.Vector3,u={a:new r.Vector3,b:new r.Vector3,c:new r.Vector3},s.push(c),l.push(u)}var c,u,h=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,i=this.faces.length;i>n;n++)o=this.faces[n],c=h.faceNormals[n],u=h.vertexNormals[n],c.copy(o.normal),u.a.copy(o.vertexNormals[0]),u.b.copy(o.vertexNormals[1]),u.c.copy(o.vertexNormals[2])}for(n=0,i=this.faces.length;i>n;n++)(o=this.faces[n]).normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeTangents:function(){function t(t,e,n,i,r,o,a){u=t.vertices[e],h=t.vertices[n],d=t.vertices[i],f=c[r],p=c[o],m=c[a],v=h.x-u.x,g=d.x-u.x,y=h.y-u.y,b=d.y-u.y,x=h.z-u.z,w=d.z-u.z,_=p.x-f.x,S=m.x-f.x,M=p.y-f.y,C=m.y-f.y,T=1/(_*C-S*M),L.set((C*v-M*g)*T,(C*y-M*b)*T,(C*x-M*w)*T),O.set((_*g-S*v)*T,(_*b-S*y)*T,(_*w-S*x)*T),A[e].add(L),A[n].add(L),A[i].add(L),P[e].add(O),P[n].add(O),P[i].add(O)}var e,n,i,o,a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M,C,T,E,k,A=[],P=[],L=new r.Vector3,O=new r.Vector3,R=new r.Vector3,F=new r.Vector3,B=new r.Vector3;for(i=0,o=this.vertices.length;o>i;i++)A[i]=new r.Vector3,P[i]=new r.Vector3;for(e=0,n=this.faces.length;n>e;e++)l=this.faces[e],c=this.faceVertexUvs[0][e],t(this,l.a,l.b,l.c,0,1,2);var D=["a","b","c","d"];for(e=0,n=this.faces.length;n>e;e++)for(l=this.faces[e],a=0;a<Math.min(l.vertexNormals.length,3);a++)B.copy(l.vertexNormals[a]),s=l[D[a]],E=A[s],R.copy(E),R.sub(B.multiplyScalar(B.dot(E))).normalize(),F.crossVectors(l.vertexNormals[a],E),k=0>F.dot(P[s])?-1:1,l.vertexTangents[a]=new r.Vector4(R.x,R.y,R.z,k);this.hasTangents=!0},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;i>n;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new r.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t instanceof r.Geometry!=0){var i,o=this.vertices.length,a=this.vertices,s=t.vertices,l=this.faces,c=t.faces,u=this.faceVertexUvs[0],h=t.faceVertexUvs[0];void 0===n&&(n=0),void 0!==e&&(i=(new r.Matrix3).getNormalMatrix(e));for(var d=0,f=s.length;f>d;d++){var p=s[d].clone();void 0!==e&&p.applyMatrix4(e),a.push(p)}for(d=0,f=c.length;f>d;d++){var m,v,g,y=c[d],b=y.vertexNormals,x=y.vertexColors;(m=new r.Face3(y.a+o,y.b+o,y.c+o)).normal.copy(y.normal),void 0!==i&&m.normal.applyMatrix3(i).normalize();for(var w=0,_=b.length;_>w;w++)v=b[w].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),m.vertexNormals.push(v);m.color.copy(y.color);for(w=0,_=x.length;_>w;w++)g=x[w],m.vertexColors.push(g.clone());m.materialIndex=y.materialIndex+n,l.push(m)}for(d=0,f=h.length;f>d;d++){var S=h[d],M=[];if(void 0!==S){for(w=0,_=S.length;_>w;w++)M.push(S[w].clone());u.push(M)}}}else r.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){return t instanceof r.Mesh==0?void r.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,i,r,o,a,s,l={},c=[],u=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;i>n;n++)t=this.vertices[n],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=n,c.push(this.vertices[n]),u[n]=c.length-1):u[n]=u[l[e]];var d=[];for(n=0,i=this.faces.length;i>n;n++){(r=this.faces[n]).a=u[r.a],r.b=u[r.b],r.c=u[r.c],o=[r.a,r.b,r.c];for(var f=0;3>f;f++)if(o[f]==o[(f+1)%3]){f,d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;s>a;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==d[e]||(d[e]=h.length/3,h.push(t.x,t.y,t.z)),d[e]}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==p[e]||(p[e]=f.length,f.push(t.getHex())),p[e]}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==v[e]||(v[e]=m.length/2,m.push(t.x,t.y)),v[e]}var r={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(var s=[],l=0;l<this.vertices.length;l++){var c=this.vertices[l];s.push(c.x,c.y,c.z)}var u=[],h=[],d={},f=[],p={},m=[],v={};for(l=0;l<this.faces.length;l++){var g=this.faces[l],y=void 0!==this.faceVertexUvs[0][l],b=g.normal.length()>0,x=g.vertexNormals.length>0,w=1!==g.color.r||1!==g.color.g||1!==g.color.b,_=g.vertexColors.length>0,S=0;if(S=t(S,0,0),S=t(S,1,!1),S=t(S,2,!1),S=t(S,3,y),S=t(S,4,b),S=t(S,5,x),S=t(S,6,w),S=t(S,7,_),u.push(S),u.push(g.a,g.b,g.c),y){var M=this.faceVertexUvs[0][l];u.push(i(M[0]),i(M[1]),i(M[2]))}if(b&&u.push(e(g.normal)),x){var C=g.vertexNormals;u.push(e(C[0]),e(C[1]),e(C[2]))}if(w&&u.push(n(g.color)),_){var T=g.vertexColors;u.push(n(T[0]),n(T[1]),n(T[2]))}}return r.data={},r.data.vertices=s,r.data.normals=h,f.length>0&&(r.data.colors=f),m.length>0&&(r.data.uvs=[m]),r.data.faces=u,r},clone:function(){for(var t=new r.Geometry,e=this.vertices,n=0,i=e.length;i>n;n++)t.vertices.push(e[n].clone());var o=this.faces;for(n=0,i=o.length;i>n;n++)t.faces.push(o[n].clone());for(n=0,i=this.faceVertexUvs.length;i>n;n++){var a=this.faceVertexUvs[n];void 0===t.faceVertexUvs[n]&&(t.faceVertexUvs[n]=[]);for(var s=0,l=a.length;l>s;s++){for(var c=a[s],u=[],h=0,d=c.length;d>h;h++){var f=c[h];u.push(f.clone())}t.faceVertexUvs[n].push(u)}}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Geometry.prototype),r.GeometryIdCount=0,r.Camera=function(){r.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new r.Matrix4,this.projectionMatrix=new r.Matrix4},r.Camera.prototype=Object.create(r.Object3D.prototype),r.Camera.prototype.constructor=r.Camera,r.Camera.prototype.getWorldDirection=function(){var t=new r.Quaternion;return function(e){var n=e||new r.Vector3;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),r.Camera.prototype.lookAt=function(){var t=new r.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),r.Camera.prototype.clone=function(t){return void 0===t&&(t=new r.Camera),r.Object3D.prototype.clone.call(this,t),t.matrixWorldInverse.copy(this.matrixWorldInverse),t.projectionMatrix.copy(this.projectionMatrix),t},r.CubeCamera=function(t,e,n){r.Object3D.call(this),this.type="CubeCamera";var i=90,o=new r.PerspectiveCamera(i,1,t,e);o.up.set(0,-1,0),o.lookAt(new r.Vector3(1,0,0)),this.add(o);var a=new r.PerspectiveCamera(i,1,t,e);a.up.set(0,-1,0),a.lookAt(new r.Vector3(-1,0,0)),this.add(a);var s=new r.PerspectiveCamera(i,1,t,e);s.up.set(0,0,1),s.lookAt(new r.Vector3(0,1,0)),this.add(s);var l=new r.PerspectiveCamera(i,1,t,e);l.up.set(0,0,-1),l.lookAt(new r.Vector3(0,-1,0)),this.add(l);var c=new r.PerspectiveCamera(i,1,t,e);c.up.set(0,-1,0),c.lookAt(new r.Vector3(0,0,1)),this.add(c);var u=new r.PerspectiveCamera(i,1,t,e);u.up.set(0,-1,0),u.lookAt(new r.Vector3(0,0,-1)),this.add(u),this.renderTarget=new r.WebGLRenderTargetCube(n,n,{format:r.RGBFormat,magFilter:r.LinearFilter,minFilter:r.LinearFilter}),this.updateCubeMap=function(t,e){var n=this.renderTarget,i=n.generateMipmaps;n.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,o,n),n.activeCubeFace=1,t.render(e,a,n),n.activeCubeFace=2,t.render(e,s,n),n.activeCubeFace=3,t.render(e,l,n),n.activeCubeFace=4,t.render(e,c,n),n.generateMipmaps=i,n.activeCubeFace=5,t.render(e,u,n)}},r.CubeCamera.prototype=Object.create(r.Object3D.prototype),r.CubeCamera.prototype.constructor=r.CubeCamera,r.OrthographicCamera=function(t,e,n,i,o,a){r.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==o?o:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()},r.OrthographicCamera.prototype=Object.create(r.Camera.prototype),r.OrthographicCamera.prototype.constructor=r.OrthographicCamera,r.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(n-t,n+t,i+e,i-e,this.near,this.far)},r.OrthographicCamera.prototype.clone=function(){var t=new r.OrthographicCamera;return r.Camera.prototype.clone.call(this,t),t.zoom=this.zoom,t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t.projectionMatrix.copy(this.projectionMatrix),t},r.PerspectiveCamera=function(t,e,n,i){r.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype=Object.create(r.Camera.prototype),r.PerspectiveCamera.prototype.constructor=r.PerspectiveCamera,r.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*r.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.setViewOffset=function(t,e,n,i,r,o){this.fullWidth=t,this.fullHeight=e,this.x=n,this.y=i,this.width=r,this.height=o,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=r.Math.radToDeg(2*Math.atan(Math.tan(.5*r.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,n=Math.tan(r.Math.degToRad(.5*t))*this.near,i=-n,o=e*i,a=e*n,s=Math.abs(a-o),l=Math.abs(n-i);this.projectionMatrix.makeFrustum(o+this.x*s/this.fullWidth,o+(this.x+this.width)*s/this.fullWidth,n-(this.y+this.height)*l/this.fullHeight,n-this.y*l/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},r.PerspectiveCamera.prototype.clone=function(){var t=new r.PerspectiveCamera;return r.Camera.prototype.clone.call(this,t),t.zoom=this.zoom,t.fov=this.fov,t.aspect=this.aspect,t.near=this.near,t.far=this.far,t.projectionMatrix.copy(this.projectionMatrix),t},r.Light=function(t){r.Object3D.call(this),this.type="Light",this.color=new r.Color(t)},r.Light.prototype=Object.create(r.Object3D.prototype),r.Light.prototype.constructor=r.Light,r.Light.prototype.clone=function(t){return void 0===t&&(t=new r.Light),r.Object3D.prototype.clone.call(this,t),t.color.copy(this.color),t},r.AmbientLight=function(t){r.Light.call(this,t),this.type="AmbientLight"},r.AmbientLight.prototype=Object.create(r.Light.prototype),r.AmbientLight.prototype.constructor=r.AmbientLight,r.AmbientLight.prototype.clone=function(){var t=new r.AmbientLight;return r.Light.prototype.clone.call(this,t),t},r.AreaLight=function(t,e){r.Light.call(this,t),this.type="AreaLight",this.normal=new r.Vector3(0,-1,0),this.right=new r.Vector3(1,0,0),this.intensity=void 0!==e?e:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},r.AreaLight.prototype=Object.create(r.Light.prototype),r.AreaLight.prototype.constructor=r.AreaLight,r.DirectionalLight=function(t,e){r.Light.call(this,t),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new r.Object3D,this.intensity=void 0!==e?e:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new r.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.DirectionalLight.prototype=Object.create(r.Light.prototype),r.DirectionalLight.prototype.constructor=r.DirectionalLight,r.DirectionalLight.prototype.clone=function(){var t=new r.DirectionalLight;return r.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t.shadowCameraNear=this.shadowCameraNear,t.shadowCameraFar=this.shadowCameraFar,t.shadowCameraLeft=this.shadowCameraLeft,t.shadowCameraRight=this.shadowCameraRight,t.shadowCameraTop=this.shadowCameraTop,t.shadowCameraBottom=this.shadowCameraBottom,t.shadowCameraVisible=this.shadowCameraVisible,t.shadowBias=this.shadowBias,t.shadowDarkness=this.shadowDarkness,t.shadowMapWidth=this.shadowMapWidth,t.shadowMapHeight=this.shadowMapHeight,t.shadowCascade=this.shadowCascade,t.shadowCascadeOffset.copy(this.shadowCascadeOffset),t.shadowCascadeCount=this.shadowCascadeCount,t.shadowCascadeBias=this.shadowCascadeBias.slice(0),t.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),t.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),t.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),t.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),t},r.HemisphereLight=function(t,e,n){r.Light.call(this,t),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new r.Color(e),this.intensity=void 0!==n?n:1},r.HemisphereLight.prototype=Object.create(r.Light.prototype),r.HemisphereLight.prototype.constructor=r.HemisphereLight,r.HemisphereLight.prototype.clone=function(){var t=new r.HemisphereLight;return r.Light.prototype.clone.call(this,t),t.groundColor.copy(this.groundColor),t.intensity=this.intensity,t},r.PointLight=function(t,e,n,i){r.Light.call(this,t),this.type="PointLight",this.intensity=void 0!==e?e:1,this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1},r.PointLight.prototype=Object.create(r.Light.prototype),r.PointLight.prototype.constructor=r.PointLight,r.PointLight.prototype.clone=function(){var t=new r.PointLight;return r.Light.prototype.clone.call(this,t),t.intensity=this.intensity,t.distance=this.distance,t.decay=this.decay,t},r.SpotLight=function(t,e,n,i,o,a){r.Light.call(this,t),this.type="SpotLight",this.position.set(0,1,0),this.target=new r.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==o?o:10,this.decay=void 0!==a?a:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.SpotLight.prototype=Object.create(r.Light.prototype),r.SpotLight.prototype.constructor=r.SpotLight,r.SpotLight.prototype.clone=function(){var t=new r.SpotLight;return r.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.distance=this.distance,t.angle=this.angle,t.exponent=this.exponent,t.decay=this.decay,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t.shadowCameraNear=this.shadowCameraNear,t.shadowCameraFar=this.shadowCameraFar,t.shadowCameraFov=this.shadowCameraFov,t.shadowCameraVisible=this.shadowCameraVisible,t.shadowBias=this.shadowBias,t.shadowDarkness=this.shadowDarkness,t.shadowMapWidth=this.shadowMapWidth,t.shadowMapHeight=this.shadowMapHeight,t},r.Cache={files:{},add:function(t,e){this.files[t]=e},get:function(t){return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},r.Loader=function(t){this.showStatus=t,this.statusDomElement=t?r.Loader.prototype.addStatusElement():null,this.imageLoader=new r.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},r.Loader.prototype={constructor:r.Loader,crossOrigin:"",addStatusElement:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.fontSize="0.8em",t.style.textAlign="left",t.style.background="rgba(0,0,0,0.25)",t.style.color="#fff",t.style.width="120px",t.style.padding="0.5em 0.5em 0.5em 0.5em",t.style.zIndex=1e3,t.innerHTML="Loading ...",t},updateProgress:function(t){var e="Loaded ";e+=t.total?(100*t.loaded/t.total).toFixed(0)+"%":(t.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=e},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e){for(var n=[],i=0;i<t.length;++i)n[i]=this.createMaterial(t[i],e);return n},needsTangents:function(t){for(var e=0,n=t.length;n>e;e++){if(t[e]instanceof r.ShaderMaterial)return!0}return!1},createMaterial:function(t,e){function n(t){var e=Math.log(t)/Math.LN2;return Math.pow(2,Math.round(e))}function i(t,i,o,s,l,c,u){var h,d=e+o,f=r.Loader.Handlers.get(d);if(null!==f?h=f.load(d):(h=new r.Texture,(f=a.imageLoader).crossOrigin=a.crossOrigin,f.load(d,(function(t){if(!1===r.Math.isPowerOfTwo(t.width)||!1===r.Math.isPowerOfTwo(t.height)){var e=n(t.width),i=n(t.height),o=document.createElement("canvas");o.width=e,o.height=i,o.getContext("2d").drawImage(t,0,0,e,i),h.image=o}else h.image=t;h.needsUpdate=!0}))),h.sourceFile=o,s&&(h.repeat.set(s[0],s[1]),1!==s[0]&&(h.wrapS=r.RepeatWrapping),1!==s[1]&&(h.wrapT=r.RepeatWrapping)),l&&h.offset.set(l[0],l[1]),c){var p={repeat:r.RepeatWrapping,mirror:r.MirroredRepeatWrapping};void 0!==p[c[0]]&&(h.wrapS=p[c[0]]),void 0!==p[c[1]]&&(h.wrapT=p[c[1]])}u&&(h.anisotropy=u),t[i]=h}function o(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var a=this,s="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var c=t.shading.toLowerCase();"phong"===c?s="MeshPhongMaterial":"basic"===c&&(s="MeshBasicMaterial")}void 0!==t.blending&&void 0!==r[t.blending]&&(l.blending=r[t.blending]),void 0!==t.transparent&&(l.transparent=t.transparent),void 0!==t.opacity&&t.opacity<1&&(l.transparent=!0),void 0!==t.depthTest&&(l.depthTest=t.depthTest),void 0!==t.depthWrite&&(l.depthWrite=t.depthWrite),void 0!==t.visible&&(l.visible=t.visible),void 0!==t.flipSided&&(l.side=r.BackSide),void 0!==t.doubleSided&&(l.side=r.DoubleSide),void 0!==t.wireframe&&(l.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?l.vertexColors=r.FaceColors:t.vertexColors&&(l.vertexColors=r.VertexColors)),t.colorDiffuse?l.color=o(t.colorDiffuse):t.DbgColor&&(l.color=t.DbgColor),t.colorSpecular&&(l.specular=o(t.colorSpecular)),t.colorEmissive&&(l.emissive=o(t.colorEmissive)),void 0!==t.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),t.opacity=t.transparency),void 0!==t.opacity&&(l.opacity=t.opacity),t.specularCoef&&(l.shininess=t.specularCoef),t.mapDiffuse&&e&&i(l,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e&&i(l,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapBump&&e&&i(l,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e&&i(l,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e&&i(l,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapAlpha&&e&&i(l,"alphaMap",t.mapAlpha,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy),t.mapBumpScale&&(l.bumpScale=t.mapBumpScale),t.mapNormalFactor&&(l.normalScale=new r.Vector2(t.mapNormalFactor,t.mapNormalFactor));var u=new r[s](l);return void 0!==t.DbgName&&(u.name=t.DbgName),u}},r.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=0,n=this.handlers.length;n>e;e+=2){var i=this.handlers[e],r=this.handlers[e+1];if(i.test(t))return r}return null}},r.XHRLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager},r.XHRLoader.prototype={constructor:r.XHRLoader,load:function(t,e,n,i){var o=this,a=r.Cache.get(t);if(void 0===a){var s=new XMLHttpRequest;s.open("GET",t,!0),s.addEventListener("load",(function(n){r.Cache.add(t,this.response),e&&e(this.response),o.manager.itemEnd(t)}),!1),void 0!==n&&s.addEventListener("progress",(function(t){n(t)}),!1),void 0!==i&&s.addEventListener("error",(function(t){i(t)}),!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(s.responseType=this.responseType),s.send(null),o.manager.itemStart(t)}else e&&e(a)},setResponseType:function(t){this.responseType=t},setCrossOrigin:function(t){this.crossOrigin=""}},r.ImageLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager},r.ImageLoader.prototype={constructor:r.ImageLoader,load:function(t,e,n,i){var o=this,a=r.Cache.get(t);if(void 0===a){var s=document.createElement("img");return s.addEventListener("load",(function(n){r.Cache.add(t,this),e&&e(this),o.manager.itemEnd(t)}),!1),void 0!==n&&s.addEventListener("progress",(function(t){n(t)}),!1),void 0!==i&&s.addEventListener("error",(function(t){i(t)}),!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),s.src=t,o.manager.itemStart(t),s}e(a)},setCrossOrigin:function(t){this.crossOrigin=""}},r.JSONLoader=function(t){r.Loader.call(this,t),this.withCredentials=!1},r.JSONLoader.prototype=Object.create(r.Loader.prototype),r.JSONLoader.prototype.constructor=r.JSONLoader,r.JSONLoader.prototype.load=function(t,e,n){n=n&&"string"==typeof n?n:this.extractUrlBase(t),this.onLoadStart(),this.loadAjaxJSON(this,t,e,n)},r.JSONLoader.prototype.loadAjaxJSON=function(t,e,n,i,o){var a=new XMLHttpRequest,s=0;a.onreadystatechange=function(){if(a.readyState===a.DONE)if(200===a.status||0===a.status){if(a.responseText){var l=JSON.parse(a.responseText),c=l.metadata;if(void 0!==c){if("object"===c.type)return void r.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===c.type)return void r.error("THREE.JSONLoader: "+e+" seems to be a Scene. Use THREE.SceneLoader instead.")}var u=t.parse(l,i);n(u.geometry,u.materials)}else r.error("THREE.JSONLoader: "+e+" seems to be unreachable or the file is empty.");t.onLoadComplete()}else r.error("THREE.JSONLoader: Couldn't load "+e+" ("+a.status+")");else a.readyState===a.LOADING?o&&(0===s&&(s=a.getResponseHeader("Content-Length")),o({total:s,loaded:a.responseText.length})):a.readyState===a.HEADERS_RECEIVED&&void 0!==o&&(s=a.getResponseHeader("Content-Length"))},a.open("GET",e,!0),a.withCredentials=this.withCredentials,a.send(null)},r.JSONLoader.prototype.parse=function(t,e){var n=new r.Geometry,i=void 0!==t.scale?1/t.scale:1;if(function(e){function i(t,e){return t&1<<e}var o,a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M,C,T,E,k,A,P,L,O=t.faces,R=t.vertices,F=t.normals,B=t.colors,D=0;if(void 0!==t.uvs){for(o=0;o<t.uvs.length;o++)t.uvs[o].length&&D++;for(o=0;D>o;o++)n.faceVertexUvs[o]=[]}for(l=0,c=R.length;c>l;)(_=new r.Vector3).x=R[l++]*e,_.y=R[l++]*e,_.z=R[l++]*e,n.vertices.push(_);for(l=0,c=O.length;c>l;)if(m=i(p=O[l++],0),v=i(p,1),g=i(p,3),y=i(p,4),b=i(p,5),x=i(p,6),w=i(p,7),m){if((M=new r.Face3).a=O[l],M.b=O[l+1],M.c=O[l+3],(C=new r.Face3).a=O[l+1],C.b=O[l+2],C.c=O[l+3],l+=4,v&&(f=O[l++],M.materialIndex=f,C.materialIndex=f),s=n.faces.length,g)for(o=0;D>o;o++)for(k=t.uvs[o],n.faceVertexUvs[o][s]=[],n.faceVertexUvs[o][s+1]=[],a=0;4>a;a++)P=k[2*(d=O[l++])],L=k[2*d+1],A=new r.Vector2(P,L),2!==a&&n.faceVertexUvs[o][s].push(A),0!==a&&n.faceVertexUvs[o][s+1].push(A);if(y&&(h=3*O[l++],M.normal.set(F[h++],F[h++],F[h]),C.normal.copy(M.normal)),b)for(o=0;4>o;o++)h=3*O[l++],E=new r.Vector3(F[h++],F[h++],F[h]),2!==o&&M.vertexNormals.push(E),0!==o&&C.vertexNormals.push(E);if(x&&(T=B[u=O[l++]],M.color.setHex(T),C.color.setHex(T)),w)for(o=0;4>o;o++)T=B[u=O[l++]],2!==o&&M.vertexColors.push(new r.Color(T)),0!==o&&C.vertexColors.push(new r.Color(T));n.faces.push(M),n.faces.push(C)}else{if((S=new r.Face3).a=O[l++],S.b=O[l++],S.c=O[l++],v&&(f=O[l++],S.materialIndex=f),s=n.faces.length,g)for(o=0;D>o;o++)for(k=t.uvs[o],n.faceVertexUvs[o][s]=[],a=0;3>a;a++)P=k[2*(d=O[l++])],L=k[2*d+1],A=new r.Vector2(P,L),n.faceVertexUvs[o][s].push(A);if(y&&(h=3*O[l++],S.normal.set(F[h++],F[h++],F[h])),b)for(o=0;3>o;o++)h=3*O[l++],E=new r.Vector3(F[h++],F[h++],F[h]),S.vertexNormals.push(E);if(x&&(u=O[l++],S.color.setHex(B[u])),w)for(o=0;3>o;o++)u=O[l++],S.vertexColors.push(new r.Color(B[u]));n.faces.push(S)}}(i),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,o=t.skinWeights.length;o>i;i+=e){var a=t.skinWeights[i],s=e>1?t.skinWeights[i+1]:0,l=e>2?t.skinWeights[i+2]:0,c=e>3?t.skinWeights[i+3]:0;n.skinWeights.push(new r.Vector4(a,s,l,c))}if(t.skinIndices)for(i=0,o=t.skinIndices.length;o>i;i+=e){var u=t.skinIndices[i],h=e>1?t.skinIndices[i+1]:0,d=e>2?t.skinIndices[i+2]:0,f=e>3?t.skinIndices[i+3]:0;n.skinIndices.push(new r.Vector4(u,h,d,f))}n.bones=t.bones,n.bones&&n.bones.length>0&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)&&r.warn("THREE.JSONLoader: When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match."),n.animation=t.animation,n.animations=t.animations}(),function(e){var i,o,a,s,l,c,u,h,d,f,p;if(void 0!==t.morphTargets)for(l=0,c=t.morphTargets.length;c>l;l++)for(n.morphTargets[l]={},n.morphTargets[l].name=t.morphTargets[l].name,n.morphTargets[l].vertices=[],a=n.morphTargets[l].vertices,i=0,o=(s=t.morphTargets[l].vertices).length;o>i;i+=3){var m=new r.Vector3;m.x=s[i]*e,m.y=s[i+1]*e,m.z=s[i+2]*e,a.push(m)}if(void 0!==t.morphColors)for(l=0,c=t.morphColors.length;c>l;l++)for(n.morphColors[l]={},n.morphColors[l].name=t.morphColors[l].name,n.morphColors[l].colors=[],d=n.morphColors[l].colors,u=0,h=(f=t.morphColors[l].colors).length;h>u;u+=3)(p=new r.Color(16755200)).setRGB(f[u],f[u+1],f[u+2]),d.push(p)}(i),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:n};var o=this.initMaterials(t.materials,e);return this.needsTangents(o)&&n.computeTangents(),{geometry:n,materials:o}},r.LoadingManager=function(t,e,n){var i=this,r=0,o=0;this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++},this.itemEnd=function(t){r++,void 0!==i.onProgress&&i.onProgress(t,r,o),r===o&&void 0!==i.onLoad&&i.onLoad()}},r.DefaultLoadingManager=new r.LoadingManager,r.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager},r.BufferGeometryLoader.prototype={constructor:r.BufferGeometryLoader,load:function(t,e,n,i){var o=this,a=new r.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,(function(t){e(o.parse(JSON.parse(t)))}),n,i)},setCrossOrigin:function(t){this.crossOrigin=""},parse:function(t){var e=new r.BufferGeometry,n=t.data.attributes;for(var o in n){var a=n[o],s=new i[a.type](a.array);e.addAttribute(o,new r.BufferAttribute(s,a.itemSize))}var l=t.data.offsets;void 0!==l&&(e.offsets=JSON.parse(JSON.stringify(l)));var c=t.data.boundingSphere;if(void 0!==c){var u=new r.Vector3;void 0!==c.center&&u.fromArray(c.center),e.boundingSphere=new r.Sphere(u,c.radius)}return e}},r.MaterialLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager},r.MaterialLoader.prototype={constructor:r.MaterialLoader,load:function(t,e,n,i){var o=this,a=new r.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,(function(t){e(o.parse(JSON.parse(t)))}),n,i)},setCrossOrigin:function(t){this.crossOrigin=""},parse:function(t){var e=new r[t.type];if(void 0!==t.color&&e.color.setHex(t.color),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.materials)for(var n=0,i=t.materials.length;i>n;n++)e.materials.push(this.parse(t.materials[n]));return e}},r.ObjectLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager,this.texturePath=""},r.ObjectLoader.prototype={constructor:r.ObjectLoader,load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var o=this,a=new r.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,(function(t){o.parse(JSON.parse(t),e)}),n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=""},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,(function(){void 0!==e&&e(a)})),r=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,r),a=this.parseObject(t.object,n,o);return(void 0===t.images||0===t.images.length)&&void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new r.JSONLoader,i=new r.BufferGeometryLoader,o=0,a=t.length;a>o;o++){var s,l=t[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new r[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"CubeGeometry":s=new r.BoxGeometry(l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":s=new r.CircleGeometry(l.radius,l.segments);break;case"CylinderGeometry":s=new r.CylinderGeometry(l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded);break;case"SphereGeometry":s=new r.SphereGeometry(l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"IcosahedronGeometry":s=new r.IcosahedronGeometry(l.radius,l.detail);break;case"TorusGeometry":s=new r.TorusGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":s=new r.TorusKnotGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.p,l.q,l.heightScale);break;case"BufferGeometry":s=i.parse(l);break;case"Geometry":s=n.parse(l.data).geometry}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),e[l.uuid]=s}return e},parseMaterials:function(t,e){var n={};if(void 0!==t)for(var i=function(t){return void 0===e[t]&&r.warn("THREE.ObjectLoader: Undefined texture",t),e[t]},o=new r.MaterialLoader,a=0,s=t.length;s>a;a++){var l=t[a],c=o.parse(l);c.uuid=l.uuid,void 0!==l.name&&(c.name=l.name),void 0!==l.map&&(c.map=i(l.map)),void 0!==l.bumpMap&&(c.bumpMap=i(l.bumpMap),l.bumpScale&&(c.bumpScale=new r.Vector2(l.bumpScale,l.bumpScale))),void 0!==l.alphaMap&&(c.alphaMap=i(l.alphaMap)),void 0!==l.envMap&&(c.envMap=i(l.envMap)),void 0!==l.normalMap&&(c.normalMap=i(l.normalMap),l.normalScale&&(c.normalScale=new r.Vector2(l.normalScale,l.normalScale))),void 0!==l.lightMap&&(c.lightMap=i(l.lightMap)),void 0!==l.specularMap&&(c.specularMap=i(l.specularMap)),n[l.uuid]=c}return n},parseImages:function(t,e){var n=this,i={};if(void 0!==t&&t.length>0){var o=new r.LoadingManager(e),a=new r.ImageLoader(o);a.setCrossOrigin(this.crossOrigin);for(var s=function(t){return n.manager.itemStart(t),a.load(t,(function(){n.manager.itemEnd(t)}))},l=0,c=t.length;c>l;l++){var u=t[l],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;i[u.uuid]=s(h)}}return i},parseTextures:function(t,e){var n={};if(void 0!==t)for(var i=0,o=t.length;o>i;i++){var a=t[i];void 0===a.image&&r.warn('THREE.ObjectLoader: No "image" speficied for',a.uuid),void 0===e[a.image]&&r.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new r.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.repeat&&(s.repeat=new r.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=r[a.minFilter]),void 0!==a.magFilter&&(s.magFilter=r[a.magFilter]),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),a.wrap instanceof Array&&(s.wrapS=r[a.wrap[0]],s.wrapT=r[a.wrap[1]]),n[a.uuid]=s}return n},parseObject:function(){var t=new r.Matrix4;return function(e,n,i){var o,a=function(t){return void 0===n[t]&&r.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]},s=function(t){return void 0===i[t]&&r.warn("THREE.ObjectLoader: Undefined material",t),i[t]};switch(e.type){case"Scene":o=new r.Scene;break;case"PerspectiveCamera":o=new r.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":o=new r.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":o=new r.AmbientLight(e.color);break;case"DirectionalLight":o=new r.DirectionalLight(e.color,e.intensity);break;case"PointLight":o=new r.PointLight(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":o=new r.SpotLight(e.color,e.intensity,e.distance,e.angle,e.exponent,e.decay);break;case"HemisphereLight":o=new r.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":o=new r.Mesh(a(e.geometry),s(e.material));break;case"Line":o=new r.Line(a(e.geometry),s(e.material),e.mode);break;case"PointCloud":o=new r.PointCloud(a(e.geometry),s(e.material));break;case"Sprite":o=new r.Sprite(s(e.material));break;case"Group":o=new r.Group;break;default:o=new r.Object3D}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.children)for(var l in e.children)o.add(this.parseObject(e.children[l],n,i));return o}}()},r.TextureLoader=function(t){this.manager=void 0!==t?t:r.DefaultLoadingManager},r.TextureLoader.prototype={constructor:r.TextureLoader,load:function(t,e,n,i){var o=new r.ImageLoader(this.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,(function(t){var n=new r.Texture(t);n.needsUpdate=!0,void 0!==e&&e(n)}),n,i)},setCrossOrigin:function(t){this.crossOrigin=""}},r.DataTextureLoader=r.BinaryTextureLoader=function(){this._parser=null},r.BinaryTextureLoader.prototype={constructor:r.BinaryTextureLoader,load:function(t,e,n,i){var o=this,a=new r.DataTexture,s=new r.XHRLoader;return s.setResponseType("arraybuffer"),s.load(t,(function(t){var n=o._parser(t);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:r.ClampToEdgeWrapping,a.wrapT=void 0!==n.wrapT?n.wrapT:r.ClampToEdgeWrapping,a.magFilter=void 0!==n.magFilter?n.magFilter:r.LinearFilter,a.minFilter=void 0!==n.minFilter?n.minFilter:r.LinearMipMapLinearFilter,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps),1===n.mipmapCount&&(a.minFilter=r.LinearFilter),a.needsUpdate=!0,e&&e(a,n))}),n,i),a}},r.CompressedTextureLoader=function(){this._parser=null},r.CompressedTextureLoader.prototype={constructor:r.CompressedTextureLoader,load:function(t,e,n){var i=this,o=[],a=new r.CompressedTexture;a.image=o;var s=new r.XHRLoader;if(s.setResponseType("arraybuffer"),t instanceof Array)for(var l=0,c=function(n){s.load(t[n],(function(t){var s=i._parser(t,!0);o[n]={width:s.width,height:s.height,format:s.format,mipmaps:s.mipmaps},6===(l+=1)&&(1==s.mipmapCount&&(a.minFilter=r.LinearFilter),a.format=s.format,a.needsUpdate=!0,e&&e(a))}))},u=0,h=t.length;h>u;++u)c(u);else s.load(t,(function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var s=n.mipmaps.length/n.mipmapCount,l=0;s>l;l++){o[l]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[l].mipmaps.push(n.mipmaps[l*n.mipmapCount+c]),o[l].format=n.format,o[l].width=n.width,o[l].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=r.LinearFilter),a.format=n.format,a.needsUpdate=!0,e&&e(a)}));return a}},r.Material=function(){Object.defineProperty(this,"id",{value:r.MaterialIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Material",this.side=r.FrontSide,this.opacity=1,this.transparent=!1,this.blending=r.NormalBlending,this.blendSrc=r.SrcAlphaFactor,this.blendDst=r.OneMinusSrcAlphaFactor,this.blendEquation=r.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},r.Material.prototype={constructor:r.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){if(e in this){var i=this[e];i instanceof r.Color?i.set(n):i instanceof r.Vector3&&n instanceof r.Vector3?i.copy(n):this[e]="overdraw"==e?Number(n):n}}else r.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(){var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(t.name=this.name),this instanceof r.MeshBasicMaterial?(t.color=this.color.getHex(),this.vertexColors!==r.NoColors&&(t.vertexColors=this.vertexColors),this.blending!==r.NormalBlending&&(t.blending=this.blending),this.side!==r.FrontSide&&(t.side=this.side)):this instanceof r.MeshLambertMaterial?(t.color=this.color.getHex(),t.emissive=this.emissive.getHex(),this.vertexColors!==r.NoColors&&(t.vertexColors=this.vertexColors),this.shading!==r.SmoothShading&&(t.shading=this.shading),this.blending!==r.NormalBlending&&(t.blending=this.blending),this.side!==r.FrontSide&&(t.side=this.side)):this instanceof r.MeshPhongMaterial?(t.color=this.color.getHex(),t.emissive=this.emissive.getHex(),t.specular=this.specular.getHex(),t.shininess=this.shininess,this.vertexColors!==r.NoColors&&(t.vertexColors=this.vertexColors),this.shading!==r.SmoothShading&&(t.shading=this.shading),this.blending!==r.NormalBlending&&(t.blending=this.blending),this.side!==r.FrontSide&&(t.side=this.side)):this instanceof r.MeshNormalMaterial||this instanceof r.MeshDepthMaterial?(this.blending!==r.NormalBlending&&(t.blending=this.blending),this.side!==r.FrontSide&&(t.side=this.side)):this instanceof r.PointCloudMaterial?(t.size=this.size,t.sizeAttenuation=this.sizeAttenuation,t.color=this.color.getHex(),this.vertexColors!==r.NoColors&&(t.vertexColors=this.vertexColors),this.blending!==r.NormalBlending&&(t.blending=this.blending)):this instanceof r.ShaderMaterial?(t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader):this instanceof r.SpriteMaterial&&(t.color=this.color.getHex()),this.opacity<1&&(t.opacity=this.opacity),!1!==this.transparent&&(t.transparent=this.transparent),!1!==this.wireframe&&(t.wireframe=this.wireframe),t},clone:function(t){return void 0===t&&(t=new r.Material),t.name=this.name,t.side=this.side,t.opacity=this.opacity,t.transparent=this.transparent,t.blending=this.blending,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.blendSrcAlpha=this.blendSrcAlpha,t.blendDstAlpha=this.blendDstAlpha,t.blendEquationAlpha=this.blendEquationAlpha,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.polygonOffset=this.polygonOffset,t.polygonOffsetFactor=this.polygonOffsetFactor,t.polygonOffsetUnits=this.polygonOffsetUnits,t.alphaTest=this.alphaTest,t.overdraw=this.overdraw,t.visible=this.visible,t},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Material.prototype),r.MaterialIdCount=0,r.LineBasicMaterial=function(t){r.Material.call(this),this.type="LineBasicMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=r.NoColors,this.fog=!0,this.setValues(t)},r.LineBasicMaterial.prototype=Object.create(r.Material.prototype),r.LineBasicMaterial.prototype.constructor=r.LineBasicMaterial,r.LineBasicMaterial.prototype.clone=function(){var t=new r.LineBasicMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.linecap=this.linecap,t.linejoin=this.linejoin,t.vertexColors=this.vertexColors,t.fog=this.fog,t},r.LineDashedMaterial=function(t){r.Material.call(this),this.type="LineDashedMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},r.LineDashedMaterial.prototype=Object.create(r.Material.prototype),r.LineDashedMaterial.prototype.constructor=r.LineDashedMaterial,r.LineDashedMaterial.prototype.clone=function(){var t=new r.LineDashedMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.scale=this.scale,t.dashSize=this.dashSize,t.gapSize=this.gapSize,t.vertexColors=this.vertexColors,t.fog=this.fog,t},r.MeshBasicMaterial=function(t){r.Material.call(this),this.type="MeshBasicMaterial",this.color=new r.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},r.MeshBasicMaterial.prototype=Object.create(r.Material.prototype),r.MeshBasicMaterial.prototype.constructor=r.MeshBasicMaterial,r.MeshBasicMaterial.prototype.clone=function(){var t=new r.MeshBasicMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t},r.MeshLambertMaterial=function(t){r.Material.call(this),this.type="MeshLambertMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.wrapAround=!1,this.wrapRGB=new r.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},r.MeshLambertMaterial.prototype=Object.create(r.Material.prototype),r.MeshLambertMaterial.prototype.constructor=r.MeshLambertMaterial,r.MeshLambertMaterial.prototype.clone=function(){var t=new r.MeshLambertMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.emissive.copy(this.emissive),t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},r.MeshPhongMaterial=function(t){r.Material.call(this),this.type="MeshPhongMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.specular=new r.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new r.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new r.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},r.MeshPhongMaterial.prototype=Object.create(r.Material.prototype),r.MeshPhongMaterial.prototype.constructor=r.MeshPhongMaterial,r.MeshPhongMaterial.prototype.clone=function(){var t=new r.MeshPhongMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.emissive.copy(this.emissive),t.specular.copy(this.specular),t.shininess=this.shininess,t.metal=this.metal,t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.bumpMap=this.bumpMap,t.bumpScale=this.bumpScale,t.normalMap=this.normalMap,t.normalScale.copy(this.normalScale),t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},r.MeshDepthMaterial=function(t){r.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},r.MeshDepthMaterial.prototype=Object.create(r.Material.prototype),r.MeshDepthMaterial.prototype.constructor=r.MeshDepthMaterial,r.MeshDepthMaterial.prototype.clone=function(){var t=new r.MeshDepthMaterial;return r.Material.prototype.clone.call(this,t),t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},r.MeshNormalMaterial=function(t){r.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},r.MeshNormalMaterial.prototype=Object.create(r.Material.prototype),r.MeshNormalMaterial.prototype.constructor=r.MeshNormalMaterial,r.MeshNormalMaterial.prototype.clone=function(){var t=new r.MeshNormalMaterial;return r.Material.prototype.clone.call(this,t),t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},r.MeshFaceMaterial=function(t){this.uuid=r.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=t instanceof Array?t:[]},r.MeshFaceMaterial.prototype={constructor:r.MeshFaceMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,n=this.materials.length;n>e;e++)t.materials.push(this.materials[e].toJSON());return t},clone:function(){for(var t=new r.MeshFaceMaterial,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t}},r.PointCloudMaterial=function(t){r.Material.call(this),this.type="PointCloudMaterial",this.color=new r.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=r.NoColors,this.fog=!0,this.setValues(t)},r.PointCloudMaterial.prototype=Object.create(r.Material.prototype),r.PointCloudMaterial.prototype.constructor=r.PointCloudMaterial,r.PointCloudMaterial.prototype.clone=function(){var t=new r.PointCloudMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.size=this.size,t.sizeAttenuation=this.sizeAttenuation,t.vertexColors=this.vertexColors,t.fog=this.fog,t},r.ParticleBasicMaterial=function(t){return r.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new r.PointCloudMaterial(t)},r.ParticleSystemMaterial=function(t){return r.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new r.PointCloudMaterial(t)},r.ShaderMaterial=function(t){r.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=r.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(t)},r.ShaderMaterial.prototype=Object.create(r.Material.prototype),r.ShaderMaterial.prototype.constructor=r.ShaderMaterial,r.ShaderMaterial.prototype.clone=function(){var t=new r.ShaderMaterial;return r.Material.prototype.clone.call(this,t),t.fragmentShader=this.fragmentShader,t.vertexShader=this.vertexShader,t.uniforms=r.UniformsUtils.clone(this.uniforms),t.attributes=this.attributes,t.defines=this.defines,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.fog=this.fog,t.lights=this.lights,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},r.RawShaderMaterial=function(t){r.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},r.RawShaderMaterial.prototype=Object.create(r.ShaderMaterial.prototype),r.RawShaderMaterial.prototype.constructor=r.RawShaderMaterial,r.RawShaderMaterial.prototype.clone=function(){var t=new r.RawShaderMaterial;return r.ShaderMaterial.prototype.clone.call(this,t),t},r.SpriteMaterial=function(t){r.Material.call(this),this.type="SpriteMaterial",this.color=new r.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},r.SpriteMaterial.prototype=Object.create(r.Material.prototype),r.SpriteMaterial.prototype.constructor=r.SpriteMaterial,r.SpriteMaterial.prototype.clone=function(){var t=new r.SpriteMaterial;return r.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.rotation=this.rotation,t.fog=this.fog,t},r.Texture=function(t,e,n,i,o,a,s,l,c){Object.defineProperty(this,"id",{value:r.TextureIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:r.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:r.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:r.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:r.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:r.LinearFilter,this.minFilter=void 0!==a?a:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==c?c:1,this.format=void 0!==s?s:r.RGBAFormat,this.type=void 0!==l?l:r.UnsignedByteType,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},r.Texture.DEFAULT_IMAGE=void 0,r.Texture.DEFAULT_MAPPING=r.UVMapping,r.Texture.prototype={constructor:r.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},clone:function(t){return void 0===t&&(t=new r.Texture),t.image=this.image,t.mipmaps=this.mipmaps.slice(0),t.mapping=this.mapping,t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.format=this.format,t.type=this.type,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.generateMipmaps=this.generateMipmaps,t.premultiplyAlpha=this.premultiplyAlpha,t.flipY=this.flipY,t.unpackAlignment=this.unpackAlignment,t},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Texture.prototype),r.TextureIdCount=0,r.CubeTexture=function(t,e,n,i,o,a,s,l,c){e=void 0!==e?e:r.CubeReflectionMapping,r.Texture.call(this,t,e,n,i,o,a,s,l,c),this.images=t},r.CubeTexture.prototype=Object.create(r.Texture.prototype),r.CubeTexture.prototype.constructor=r.CubeTexture,r.CubeTexture.clone=function(t){return void 0===t&&(t=new r.CubeTexture),r.Texture.prototype.clone.call(this,t),t.images=this.images,t},r.CompressedTexture=function(t,e,n,i,o,a,s,l,c,u,h){r.Texture.call(this,null,a,s,l,c,u,i,o,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},r.CompressedTexture.prototype=Object.create(r.Texture.prototype),r.CompressedTexture.prototype.constructor=r.CompressedTexture,r.CompressedTexture.prototype.clone=function(){var t=new r.CompressedTexture;return r.Texture.prototype.clone.call(this,t),t},r.DataTexture=function(t,e,n,i,o,a,s,l,c,u,h){r.Texture.call(this,null,a,s,l,c,u,i,o,h),this.image={data:t,width:e,height:n}},r.DataTexture.prototype=Object.create(r.Texture.prototype),r.DataTexture.prototype.constructor=r.DataTexture,r.DataTexture.prototype.clone=function(){var t=new r.DataTexture;return r.Texture.prototype.clone.call(this,t),t},r.VideoTexture=function(t,e,n,i,o,a,s,l,c){r.Texture.call(this,t,e,n,i,o,a,s,l,c),this.generateMipmaps=!1;var u=this,h=function(){requestAnimationFrame(h),t.readyState===t.HAVE_ENOUGH_DATA&&(u.needsUpdate=!0)};h()},r.VideoTexture.prototype=Object.create(r.Texture.prototype),r.VideoTexture.prototype.constructor=r.VideoTexture,r.Group=function(){r.Object3D.call(this),this.type="Group"},r.Group.prototype=Object.create(r.Object3D.prototype),r.Group.prototype.constructor=r.Group,r.PointCloud=function(t,e){r.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==t?t:new r.Geometry,this.material=void 0!==e?e:new r.PointCloudMaterial({color:16777215*Math.random()})},r.PointCloud.prototype=Object.create(r.Object3D.prototype),r.PointCloud.prototype.constructor=r.PointCloud,r.PointCloud.prototype.raycast=function(){var t=new r.Matrix4,e=new r.Ray;return function(n,i){var o=this,a=o.geometry,s=n.params.PointCloud.threshold;if(t.getInverse(this.matrixWorld),e.copy(n.ray).applyMatrix4(t),null===a.boundingBox||!1!==e.isIntersectionBox(a.boundingBox)){var l=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=new r.Vector3,u=function(t,r){var a=e.distanceToPoint(t);if(l>a){var s=e.closestPointToPoint(t);s.applyMatrix4(o.matrixWorld);var c=n.ray.origin.distanceTo(s);i.push({distance:c,distanceToRay:a,point:s.clone(),index:r,face:null,object:o})}};if(a instanceof r.BufferGeometry){var h=a.attributes,d=h.position.array;if(void 0!==h.index){var f=h.index.array,p=a.offsets;if(0===p.length)p=[{start:0,count:f.length,index:0}];for(var m=0,v=p.length;v>m;++m)for(var g=p[m].start,y=p[m].count,b=p[m].index,x=g,w=g+y;w>x;x++){var _=b+f[x];c.fromArray(d,3*_),u(c,_)}}else{var S=d.length/3;for(x=0;S>x;x++)c.set(d[3*x],d[3*x+1],d[3*x+2]),u(c,x)}}else{var M=this.geometry.vertices;for(x=0;x<M.length;x++)u(M[x],x)}}}}(),r.PointCloud.prototype.clone=function(t){return void 0===t&&(t=new r.PointCloud(this.geometry,this.material)),r.Object3D.prototype.clone.call(this,t),t},r.ParticleSystem=function(t,e){return r.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new r.PointCloud(t,e)},r.Line=function(t,e,n){r.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new r.Geometry,this.material=void 0!==e?e:new r.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==n?n:r.LineStrip},r.LineStrip=0,r.LinePieces=1,r.Line.prototype=Object.create(r.Object3D.prototype),r.Line.prototype.constructor=r.Line,r.Line.prototype.raycast=function(){var t=new r.Matrix4,e=new r.Ray,n=new r.Sphere;return function(i,o){var a=i.linePrecision,s=a*a,l=this.geometry;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(this.matrixWorld),!1!==i.ray.isIntersectionSphere(n)){t.getInverse(this.matrixWorld),e.copy(i.ray).applyMatrix4(t);var c=new r.Vector3,u=new r.Vector3,h=new r.Vector3,d=new r.Vector3,f=this.mode===r.LineStrip?1:2;if(l instanceof r.BufferGeometry){var p=l.attributes;if(void 0!==p.index){var m=p.index.array,v=p.position.array,g=l.offsets;0===g.length&&(g=[{start:0,count:m.length,index:0}]);for(var y=0;y<g.length;y++)for(var b=g[y].start,x=g[y].count,w=g[y].index,_=b;b+x-1>_;_+=f){var S=w+m[_],M=w+m[_+1];if(c.fromArray(v,3*S),u.fromArray(v,3*M),!(e.distanceSqToSegment(c,u,d,h)>s))(E=e.origin.distanceTo(d))<i.near||E>i.far||o.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:_,offsetIndex:y,face:null,faceIndex:null,object:this})}}else for(v=p.position.array,_=0;_<v.length/3-1;_+=f){if(c.fromArray(v,3*_),u.fromArray(v,3*_+3),!(e.distanceSqToSegment(c,u,d,h)>s))(E=e.origin.distanceTo(d))<i.near||E>i.far||o.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else if(l instanceof r.Geometry){var C=l.vertices,T=C.length;for(_=0;T-1>_;_+=f){var E;if(!(e.distanceSqToSegment(C[_],C[_+1],d,h)>s))(E=e.origin.distanceTo(d))<i.near||E>i.far||o.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),r.Line.prototype.clone=function(t){return void 0===t&&(t=new r.Line(this.geometry,this.material,this.mode)),r.Object3D.prototype.clone.call(this,t),t},r.Mesh=function(t,e){r.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new r.Geometry,this.material=void 0!==e?e:new r.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},r.Mesh.prototype=Object.create(r.Object3D.prototype),r.Mesh.prototype.constructor=r.Mesh,r.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},r.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(r.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},r.Mesh.prototype.raycast=function(){var t=new r.Matrix4,e=new r.Ray,n=new r.Sphere,i=new r.Vector3,o=new r.Vector3,a=new r.Vector3;return function(s,l){var c=this.geometry;if(null===c.boundingSphere&&c.computeBoundingSphere(),n.copy(c.boundingSphere),n.applyMatrix4(this.matrixWorld),!1!==s.ray.isIntersectionSphere(n)&&(t.getInverse(this.matrixWorld),e.copy(s.ray).applyMatrix4(t),null===c.boundingBox||!1!==e.isIntersectionBox(c.boundingBox)))if(c instanceof r.BufferGeometry){if(void 0===(O=this.material))return;var u=c.attributes,h=s.precision;if(void 0!==u.index){var d=u.index.array,f=u.position.array,p=c.offsets;0===p.length&&(p=[{start:0,count:d.length,index:0}]);for(var m=0,v=p.length;v>m;++m)for(var g=p[m].start,y=p[m].count,b=p[m].index,x=g,w=g+y;w>x;x+=3){if(M=b+d[x],C=b+d[x+1],T=b+d[x+2],i.fromArray(f,3*M),o.fromArray(f,3*C),a.fromArray(f,3*T),O.side===r.BackSide)var _=e.intersectTriangle(a,o,i,!0);else _=e.intersectTriangle(i,o,a,O.side!==r.DoubleSide);if(null!==_)_.applyMatrix4(this.matrixWorld),h>(V=s.ray.origin.distanceTo(_))||V<s.near||V>s.far||l.push({distance:V,point:_,face:new r.Face3(M,C,T,r.Triangle.normal(i,o,a)),faceIndex:null,object:this})}}else{x=0;var S=0;for(w=(f=u.position.array).length;w>x;x+=3,S+=9){if(M=x,C=x+1,T=x+2,i.fromArray(f,S),o.fromArray(f,S+3),a.fromArray(f,S+6),O.side===r.BackSide)_=e.intersectTriangle(a,o,i,!0);else _=e.intersectTriangle(i,o,a,O.side!==r.DoubleSide);if(null!==_)_.applyMatrix4(this.matrixWorld),h>(V=s.ray.origin.distanceTo(_))||V<s.near||V>s.far||l.push({distance:V,point:_,face:new r.Face3(M,C,T,r.Triangle.normal(i,o,a)),faceIndex:null,object:this})}}}else if(c instanceof r.Geometry)for(var M,C,T,E=this.material instanceof r.MeshFaceMaterial,k=!0===E?this.material.materials:null,A=(h=s.precision,c.vertices),P=0,L=c.faces.length;L>P;P++){var O,R=c.faces[P];if(void 0!==(O=!0===E?k[R.materialIndex]:this.material)){if(M=A[R.a],C=A[R.b],T=A[R.c],!0===O.morphTargets){var F=c.morphTargets,B=this.morphTargetInfluences;i.set(0,0,0),o.set(0,0,0),a.set(0,0,0);for(var D=0,I=F.length;I>D;D++){var N=B[D];if(0!==N){var j=F[D].vertices;i.x+=(j[R.a].x-M.x)*N,i.y+=(j[R.a].y-M.y)*N,i.z+=(j[R.a].z-M.z)*N,o.x+=(j[R.b].x-C.x)*N,o.y+=(j[R.b].y-C.y)*N,o.z+=(j[R.b].z-C.z)*N,a.x+=(j[R.c].x-T.x)*N,a.y+=(j[R.c].y-T.y)*N,a.z+=(j[R.c].z-T.z)*N}}i.add(M),o.add(C),a.add(T),M=i,C=o,T=a}if(O.side===r.BackSide)_=e.intersectTriangle(T,C,M,!0);else _=e.intersectTriangle(M,C,T,O.side!==r.DoubleSide);var V;if(null!==_)_.applyMatrix4(this.matrixWorld),h>(V=s.ray.origin.distanceTo(_))||V<s.near||V>s.far||l.push({distance:V,point:_,face:R,faceIndex:P,object:this})}}}}(),r.Mesh.prototype.clone=function(t,e){return void 0===t&&(t=new r.Mesh(this.geometry,this.material)),r.Object3D.prototype.clone.call(this,t,e),t},r.Bone=function(t){r.Object3D.call(this),this.type="Bone",this.skin=t},r.Bone.prototype=Object.create(r.Object3D.prototype),r.Bone.prototype.constructor=r.Bone,r.Skeleton=function(t,e,n){var i;(this.useVertexTexture=void 0===n||n,this.identityMatrix=new r.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture)?(i=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new r.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,r.RGBAFormat,r.FloatType),this.boneTexture.minFilter=r.NearestFilter,this.boneTexture.magFilter=r.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{r.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,a=this.bones.length;a>o;o++)this.boneInverses.push(new r.Matrix4)}},r.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;e>t;t++){var n=new r.Matrix4;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},r.Skeleton.prototype.pose=function(){for(var t,e=0,n=this.bones.length;n>e;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;n>e;e++)(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},r.Skeleton.prototype.update=function(){var t=new r.Matrix4;return function(){for(var e=0,n=this.bones.length;n>e;e++){var i=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(i,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),r.SkinnedMesh=function(t,e,n){r.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new r.Matrix4,this.bindMatrixInverse=new r.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var o,a,s,l,c,u=0,h=this.geometry.bones.length;h>u;++u)s=(a=this.geometry.bones[u]).pos,l=a.rotq,c=a.scl,o=new r.Bone(this),i.push(o),o.name=a.name,o.position.set(s[0],s[1],s[2]),o.quaternion.set(l[0],l[1],l[2],l[3]),void 0!==c?o.scale.set(c[0],c[1],c[2]):o.scale.set(1,1,1);for(u=0,h=this.geometry.bones.length;h>u;++u)-1!==(a=this.geometry.bones[u]).parent?i[a.parent].add(i[u]):this.add(i[u])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new r.Skeleton(i,void 0,n))},r.SkinnedMesh.prototype=Object.create(r.Mesh.prototype),r.SkinnedMesh.prototype.constructor=r.SkinnedMesh,r.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},r.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},r.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof r.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();n!==1/0?e.multiplyScalar(n):e.set(1)}},r.SkinnedMesh.prototype.updateMatrixWorld=function(t){r.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):r.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},r.SkinnedMesh.prototype.clone=function(t){return void 0===t&&(t=new r.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),r.Mesh.prototype.clone.call(this,t),t},r.MorphAnimMesh=function(t,e){r.Mesh.call(this,t,e),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},r.MorphAnimMesh.prototype=Object.create(r.Mesh.prototype),r.MorphAnimMesh.prototype.constructor=r.MorphAnimMesh,r.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},r.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},r.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},r.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,n=t.animations,i=/([a-z]+)_?(\d+)/,r=0,o=t.morphTargets.length;o>r;r++){var a=t.morphTargets[r].name.match(i);if(a&&a.length>1){var s=a[1];n[s]||(n[s]={start:1/0,end:-1/0});var l=n[s];r<l.start&&(l.start=r),r>l.end&&(l.end=r),e||(e=s)}}t.firstAnimation=e},r.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,n){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:n}},r.MorphAnimMesh.prototype.playAnimation=function(t,e){var n=this.geometry.animations[t];n?(this.setFrameRange(n.start,n.end),this.duration=(n.end-n.start)/e*1e3,this.time=0):r.warn("THREE.MorphAnimMesh: animation["+t+"] undefined in .playAnimation()")},r.MorphAnimMesh.prototype.updateAnimation=function(t){var e=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var n=this.startKeyframe+r.Math.clamp(Math.floor(this.time/e),0,this.length-1);n!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n);var i=this.time%e/e;this.directionBackwards&&(i=1-i),this.morphTargetInfluences[this.currentKeyframe]=i,this.morphTargetInfluences[this.lastKeyframe]=1-i},r.MorphAnimMesh.prototype.interpolateTargets=function(t,e,n){for(var i=this.morphTargetInfluences,r=0,o=i.length;o>r;r++)i[r]=0;t>-1&&(i[t]=1-n),e>-1&&(i[e]=n)},r.MorphAnimMesh.prototype.clone=function(t){return void 0===t&&(t=new r.MorphAnimMesh(this.geometry,this.material)),t.duration=this.duration,t.mirroredLoop=this.mirroredLoop,t.time=this.time,t.lastKeyframe=this.lastKeyframe,t.currentKeyframe=this.currentKeyframe,t.direction=this.direction,t.directionBackwards=this.directionBackwards,r.Mesh.prototype.clone.call(this,t),t},r.LOD=function(){r.Object3D.call(this),this.objects=[]},r.LOD.prototype=Object.create(r.Object3D.prototype),r.LOD.prototype.constructor=r.LOD,r.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=0;n<this.objects.length&&!(e<this.objects[n].distance);n++);this.objects.splice(n,0,{distance:e,object:t}),this.add(t)},r.LOD.prototype.getObjectForDistance=function(t){for(var e=1,n=this.objects.length;n>e&&!(t<this.objects[e].distance);e++);return this.objects[e-1].object},r.LOD.prototype.raycast=function(){var t=new r.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),r.LOD.prototype.update=function(){var t=new r.Vector3,e=new r.Vector3;return function(n){if(this.objects.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);this.objects[0].object.visible=!0;for(var r=1,o=this.objects.length;o>r&&i>=this.objects[r].distance;r++)this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0;for(;o>r;r++)this.objects[r].object.visible=!1}}}(),r.LOD.prototype.clone=function(t){void 0===t&&(t=new r.LOD),r.Object3D.prototype.clone.call(this,t);for(var e=0,n=this.objects.length;n>e;e++){var i=this.objects[e].object.clone();i.visible=0===e,t.addLevel(i,this.objects[e].distance)}return t},r.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new r.BufferGeometry;return i.addAttribute("index",new r.BufferAttribute(t,1)),i.addAttribute("position",new r.BufferAttribute(e,3)),i.addAttribute("uv",new r.BufferAttribute(n,2)),function(t){r.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==t?t:new r.SpriteMaterial}}(),r.Sprite.prototype=Object.create(r.Object3D.prototype),r.Sprite.prototype.constructor=r.Sprite,r.Sprite.prototype.raycast=function(){var t=new r.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceToPoint(t);i>this.scale.x||n.push({distance:i,point:this.position,face:null,object:this})}}(),r.Sprite.prototype.clone=function(t){return void 0===t&&(t=new r.Sprite(this.material)),r.Object3D.prototype.clone.call(this,t),t},r.Particle=r.Sprite,r.LensFlare=function(t,e,n,i,o){r.Object3D.call(this),this.lensFlares=[],this.positionScreen=new r.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,o)},r.LensFlare.prototype=Object.create(r.Object3D.prototype),r.LensFlare.prototype.constructor=r.LensFlare,r.LensFlare.prototype.add=function(t,e,n,i,o,a){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===a&&(a=1),void 0===o&&(o=new r.Color(16777215)),void 0===i&&(i=r.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:a,color:o,blending:i})},r.LensFlare.prototype.updateLensFlares=function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;n>t;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},r.Scene=function(){r.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},r.Scene.prototype=Object.create(r.Object3D.prototype),r.Scene.prototype.constructor=r.Scene,r.Scene.prototype.clone=function(t){return void 0===t&&(t=new r.Scene),r.Object3D.prototype.clone.call(this,t),null!==this.fog&&(t.fog=this.fog.clone()),null!==this.overrideMaterial&&(t.overrideMaterial=this.overrideMaterial.clone()),t.autoUpdate=this.autoUpdate,t.matrixAutoUpdate=this.matrixAutoUpdate,t},r.Fog=function(t,e,n){this.name="",this.color=new r.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3},r.Fog.prototype.clone=function(){return new r.Fog(this.color.getHex(),this.near,this.far)},r.FogExp2=function(t,e){this.name="",this.color=new r.Color(t),this.density=void 0!==e?e:25e-5},r.FogExp2.prototype.clone=function(){return new r.FogExp2(this.color.getHex(),this.density)},r.ShaderChunk={},r.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\n\treturn point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n\t}\n\treturn 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\n",r.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",r.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack += ambientLightColor;\n\n#endif\n",r.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n",r.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",r.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif",r.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif",r.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif",r.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalDiffuseLight += hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\n#ifdef METAL\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",r.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif",r.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif",r.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",r.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",r.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n",r.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif",r.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif",r.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif",r.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif",r.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif",r.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",r.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",r.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = inputToLinear( color.xyz );\n\n#endif",r.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n",r.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n",r.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n",r.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif",r.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n",r.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n",r.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",r.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif",r.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif",r.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif",r.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif",r.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n\t\tfogFactor = whiteCompliment( fogFactor );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",r.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",r.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n\tvec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n\tvec3 objectNormal = morphedNormal;\n\n#else\n\n\tvec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",r.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n",r.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",r.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",r.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",r.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",r.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif",r.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif",r.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n",r.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n\tshadowColor = inputToLinear( shadowColor );\n\n\toutgoingLight = outgoingLight * shadowColor;\n\n#endif\n",r.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#elif defined( USE_MORPHTARGETS )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif\n",r.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif",r.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif",r.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",r.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",r.UniformsUtils={merge:function(t){for(var e={},n=0;n<t.length;n++){var i=this.clone(t[n]);for(var r in i)e[r]=i[r]}return e},clone:function(t){var e={};for(var n in t)for(var i in e[n]={},t[n]){var o=t[n][i];o instanceof r.Color||o instanceof r.Vector2||o instanceof r.Vector3||o instanceof r.Vector4||o instanceof r.Matrix4||o instanceof r.Texture?e[n][i]=o.clone():e[n][i]=o instanceof Array?o.slice():o}return e}},r.UniformsLib={common:{diffuse:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new r.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},r.ShaderLib={basic:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,r.UniformsLib.shadowmap]),vertexShader:[r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"\t#endif",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)},wrapRGB:{type:"v3",value:new r.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_lambert_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_lambert_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,"\t#ifdef DOUBLE_SIDED","\t\tif ( gl_FrontFacing )","\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t\telse","\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;","\t#else","\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t#endif",r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.bump,r.UniformsLib.normalmap,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)},specular:{type:"c",value:new r.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new r.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif",r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_phong_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_phong_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.lights_phong_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.bumpmap_pars_fragment,r.ShaderChunk.normalmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,r.ShaderChunk.lights_phong_fragment,r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},particle_basic:{uniforms:r.UniformsUtils.merge([r.UniformsLib.particle,r.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\t#ifdef USE_SIZEATTENUATION","\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );","\t#else","\t\tgl_PointSize = size;","\t#endif","\tgl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_particle_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( psColor, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_particle_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tif ( mod( vLineDistance, totalSize ) > dashSize ) {","\t\tdiscard;","\t}","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",r.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",r.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );","\tgl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvNormal = normalize( normalMatrix * normal );",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.skinbase_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","\tres -= res.xxyz * bit_mask;","\treturn res;","}","void main() {",r.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","\t#else","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","\t#endif","}"].join("\n")}},r.WebGLRenderer=function(t){function e(t){t.__webglVertexBuffer=at.createBuffer(),t.__webglNormalBuffer=at.createBuffer(),t.__webglTangentBuffer=at.createBuffer(),t.__webglColorBuffer=at.createBuffer(),t.__webglUVBuffer=at.createBuffer(),t.__webglUV2Buffer=at.createBuffer(),t.__webglSkinIndicesBuffer=at.createBuffer(),t.__webglSkinWeightsBuffer=at.createBuffer(),t.__webglFaceBuffer=at.createBuffer(),t.__webglLineBuffer=at.createBuffer();var e=t.numMorphTargets;if(e){t.__webglMorphTargetsBuffers=[];for(var n=0,i=e;i>n;n++)t.__webglMorphTargetsBuffers.push(at.createBuffer())}var r=t.numMorphNormals;if(r){t.__webglMorphNormalsBuffers=[];for(n=0,i=r;i>n;n++)t.__webglMorphNormalsBuffers.push(at.createBuffer())}st.info.memory.geometries++}function n(t){var e=t.geometry,n=t.material,i=e.vertices.length;if(n.attributes)for(var r in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),n.attributes){var o=n.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=at.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}function i(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__webglParticleCount=i,n(e)}function o(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__lineDistanceArray=new Float32Array(1*i),t.__webglLineCount=i,n(e)}function a(t,e){var n=e.geometry,i=t.faces3,r=3*i.length,o=1*i.length,a=3*i.length,l=s(e,t);t.__vertexArray=new Float32Array(3*r),t.__normalArray=new Float32Array(3*r),t.__colorArray=new Float32Array(3*r),t.__uvArray=new Float32Array(2*r),n.faceVertexUvs.length>1&&(t.__uv2Array=new Float32Array(2*r)),n.hasTangents&&(t.__tangentArray=new Float32Array(4*r)),e.geometry.skinWeights.length&&e.geometry.skinIndices.length&&(t.__skinIndexArray=new Float32Array(4*r),t.__skinWeightArray=new Float32Array(4*r));var c=null!==At.get("OES_element_index_uint")&&o>21845?Uint32Array:Uint16Array;t.__typeArray=c,t.__faceArray=new c(3*o),t.__lineArray=new c(2*a);var u=t.numMorphTargets;if(u){t.__morphTargetsArrays=[];for(var h=0,d=u;d>h;h++)t.__morphTargetsArrays.push(new Float32Array(3*r))}var f=t.numMorphNormals;if(f){t.__morphNormalsArrays=[];for(h=0,d=f;d>h;h++)t.__morphNormalsArrays.push(new Float32Array(3*r))}if(t.__webglFaceCount=3*o,t.__webglLineCount=2*a,l.attributes)for(var p in void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]),l.attributes){var m=l.attributes[p],v={};for(var g in m)v[g]=m[g];if(!v.__webglInitialized||v.createUniqueBuffers){v.__webglInitialized=!0;var y=1;"v2"===v.type?y=2:"v3"===v.type?y=3:"v4"===v.type?y=4:"c"===v.type&&(y=3),v.size=y,v.array=new Float32Array(r*y),v.buffer=at.createBuffer(),v.buffer.belongsToAttribute=p,m.needsUpdate=!0,v.__original=m}t.__webglCustomAttributesList.push(v)}t.__inittedArrays=!0}function s(t,e){return t.material instanceof r.MeshFaceMaterial?t.material.materials[e.materialIndex]:t.material}function l(t,e,n,i,o){if(t.__inittedArrays){var a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M,C,T,E,k,A,P,L,O,R,F,B,D,I,N,j,V,z,U,H,G,W,q,X=function(t){return t instanceof r.MeshPhongMaterial==0&&t.shading===r.FlatShading}(o),Y=0,J=0,Z=0,Q=0,K=0,$=0,tt=0,et=0,nt=0,it=0,rt=0,ot=0,st=t.__vertexArray,lt=t.__uvArray,ct=t.__uv2Array,ut=t.__normalArray,ht=t.__tangentArray,dt=t.__colorArray,ft=t.__skinIndexArray,pt=t.__skinWeightArray,mt=t.__morphTargetsArrays,vt=t.__morphNormalsArrays,gt=t.__webglCustomAttributesList,yt=t.__faceArray,bt=t.__lineArray,xt=e.geometry,wt=xt.verticesNeedUpdate,_t=xt.elementsNeedUpdate,St=xt.uvsNeedUpdate,Mt=xt.normalsNeedUpdate,Ct=xt.tangentsNeedUpdate,Tt=xt.colorsNeedUpdate,Et=xt.morphTargetsNeedUpdate,kt=xt.vertices,At=t.faces3,Pt=xt.faces,Lt=xt.faceVertexUvs[0],Ot=xt.faceVertexUvs[1],Rt=xt.skinIndices,Ft=xt.skinWeights,Bt=xt.morphTargets,Dt=xt.morphNormals;if(wt){for(a=0,s=At.length;s>a;a++)v=kt[(l=Pt[At[a]]).a],g=kt[l.b],y=kt[l.c],st[J]=v.x,st[J+1]=v.y,st[J+2]=v.z,st[J+3]=g.x,st[J+4]=g.y,st[J+5]=g.z,st[J+6]=y.x,st[J+7]=y.y,st[J+8]=y.z,J+=9;at.bindBuffer(at.ARRAY_BUFFER,t.__webglVertexBuffer),at.bufferData(at.ARRAY_BUFFER,st,n)}if(Et)for(j=0,V=Bt.length;V>j;j++){for(rt=0,a=0,s=At.length;s>a;a++)l=Pt[H=At[a]],v=Bt[j].vertices[l.a],g=Bt[j].vertices[l.b],y=Bt[j].vertices[l.c],(z=mt[j])[rt]=v.x,z[rt+1]=v.y,z[rt+2]=v.z,z[rt+3]=g.x,z[rt+4]=g.y,z[rt+5]=g.z,z[rt+6]=y.x,z[rt+7]=y.y,z[rt+8]=y.z,o.morphNormals&&(X?(S=_=Dt[j].faceNormals[H],M=_):(_=(G=Dt[j].vertexNormals[H]).a,S=G.b,M=G.c),(U=vt[j])[rt]=_.x,U[rt+1]=_.y,U[rt+2]=_.z,U[rt+3]=S.x,U[rt+4]=S.y,U[rt+5]=S.z,U[rt+6]=M.x,U[rt+7]=M.y,U[rt+8]=M.z),rt+=9;at.bindBuffer(at.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[j]),at.bufferData(at.ARRAY_BUFFER,mt[j],n),o.morphNormals&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[j]),at.bufferData(at.ARRAY_BUFFER,vt[j],n))}if(Ft.length){for(a=0,s=At.length;s>a;a++)k=Ft[(l=Pt[At[a]]).a],A=Ft[l.b],P=Ft[l.c],pt[it]=k.x,pt[it+1]=k.y,pt[it+2]=k.z,pt[it+3]=k.w,pt[it+4]=A.x,pt[it+5]=A.y,pt[it+6]=A.z,pt[it+7]=A.w,pt[it+8]=P.x,pt[it+9]=P.y,pt[it+10]=P.z,pt[it+11]=P.w,L=Rt[l.a],O=Rt[l.b],R=Rt[l.c],ft[it]=L.x,ft[it+1]=L.y,ft[it+2]=L.z,ft[it+3]=L.w,ft[it+4]=O.x,ft[it+5]=O.y,ft[it+6]=O.z,ft[it+7]=O.w,ft[it+8]=R.x,ft[it+9]=R.y,ft[it+10]=R.z,ft[it+11]=R.w,it+=12;it>0&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglSkinIndicesBuffer),at.bufferData(at.ARRAY_BUFFER,ft,n),at.bindBuffer(at.ARRAY_BUFFER,t.__webglSkinWeightsBuffer),at.bufferData(at.ARRAY_BUFFER,pt,n))}if(Tt){for(a=0,s=At.length;s>a;a++)h=(l=Pt[At[a]]).vertexColors,d=l.color,3===h.length&&o.vertexColors===r.VertexColors?(C=h[0],T=h[1],E=h[2]):(C=d,T=d,E=d),dt[nt]=C.r,dt[nt+1]=C.g,dt[nt+2]=C.b,dt[nt+3]=T.r,dt[nt+4]=T.g,dt[nt+5]=T.b,dt[nt+6]=E.r,dt[nt+7]=E.g,dt[nt+8]=E.b,nt+=9;nt>0&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglColorBuffer),at.bufferData(at.ARRAY_BUFFER,dt,n))}if(Ct&&xt.hasTangents){for(a=0,s=At.length;s>a;a++)b=(f=(l=Pt[At[a]]).vertexTangents)[0],x=f[1],w=f[2],ht[tt]=b.x,ht[tt+1]=b.y,ht[tt+2]=b.z,ht[tt+3]=b.w,ht[tt+4]=x.x,ht[tt+5]=x.y,ht[tt+6]=x.z,ht[tt+7]=x.w,ht[tt+8]=w.x,ht[tt+9]=w.y,ht[tt+10]=w.z,ht[tt+11]=w.w,tt+=12;at.bindBuffer(at.ARRAY_BUFFER,t.__webglTangentBuffer),at.bufferData(at.ARRAY_BUFFER,ht,n)}if(Mt){for(a=0,s=At.length;s>a;a++)if(c=(l=Pt[At[a]]).vertexNormals,u=l.normal,3===c.length&&!1===X)for(F=0;3>F;F++)D=c[F],ut[$]=D.x,ut[$+1]=D.y,ut[$+2]=D.z,$+=3;else for(F=0;3>F;F++)ut[$]=u.x,ut[$+1]=u.y,ut[$+2]=u.z,$+=3;at.bindBuffer(at.ARRAY_BUFFER,t.__webglNormalBuffer),at.bufferData(at.ARRAY_BUFFER,ut,n)}if(St&&Lt){for(a=0,s=At.length;s>a;a++)if(void 0!==(p=Lt[At[a]]))for(F=0;3>F;F++)I=p[F],lt[Z]=I.x,lt[Z+1]=I.y,Z+=2;Z>0&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglUVBuffer),at.bufferData(at.ARRAY_BUFFER,lt,n))}if(St&&Ot){for(a=0,s=At.length;s>a;a++)if(void 0!==(m=Ot[At[a]]))for(F=0;3>F;F++)N=m[F],ct[Q]=N.x,ct[Q+1]=N.y,Q+=2;Q>0&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglUV2Buffer),at.bufferData(at.ARRAY_BUFFER,ct,n))}if(_t){for(a=0,s=At.length;s>a;a++)yt[K]=Y,yt[K+1]=Y+1,yt[K+2]=Y+2,K+=3,bt[et]=Y,bt[et+1]=Y+1,bt[et+2]=Y,bt[et+3]=Y+2,bt[et+4]=Y+1,bt[et+5]=Y+2,et+=6,Y+=3;at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,t.__webglFaceBuffer),at.bufferData(at.ELEMENT_ARRAY_BUFFER,yt,n),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,t.__webglLineBuffer),at.bufferData(at.ELEMENT_ARRAY_BUFFER,bt,n)}if(gt)for(F=0,B=gt.length;B>F;F++)if((q=gt[F]).__original.needsUpdate){if(ot=0,1===q.size){if(void 0===q.boundTo||"vertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)l=Pt[At[a]],q.array[ot]=q.value[l.a],q.array[ot+1]=q.value[l.b],q.array[ot+2]=q.value[l.c],ot+=3;else if("faces"===q.boundTo)for(a=0,s=At.length;s>a;a++)W=q.value[At[a]],q.array[ot]=W,q.array[ot+1]=W,q.array[ot+2]=W,ot+=3}else if(2===q.size){if(void 0===q.boundTo||"vertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)l=Pt[At[a]],v=q.value[l.a],g=q.value[l.b],y=q.value[l.c],q.array[ot]=v.x,q.array[ot+1]=v.y,q.array[ot+2]=g.x,q.array[ot+3]=g.y,q.array[ot+4]=y.x,q.array[ot+5]=y.y,ot+=6;else if("faces"===q.boundTo)for(a=0,s=At.length;s>a;a++)v=W=q.value[At[a]],g=W,y=W,q.array[ot]=v.x,q.array[ot+1]=v.y,q.array[ot+2]=g.x,q.array[ot+3]=g.y,q.array[ot+4]=y.x,q.array[ot+5]=y.y,ot+=6}else if(3===q.size){var It;if(It="c"===q.type?["r","g","b"]:["x","y","z"],void 0===q.boundTo||"vertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)l=Pt[At[a]],v=q.value[l.a],g=q.value[l.b],y=q.value[l.c],q.array[ot]=v[It[0]],q.array[ot+1]=v[It[1]],q.array[ot+2]=v[It[2]],q.array[ot+3]=g[It[0]],q.array[ot+4]=g[It[1]],q.array[ot+5]=g[It[2]],q.array[ot+6]=y[It[0]],q.array[ot+7]=y[It[1]],q.array[ot+8]=y[It[2]],ot+=9;else if("faces"===q.boundTo)for(a=0,s=At.length;s>a;a++)v=W=q.value[At[a]],g=W,y=W,q.array[ot]=v[It[0]],q.array[ot+1]=v[It[1]],q.array[ot+2]=v[It[2]],q.array[ot+3]=g[It[0]],q.array[ot+4]=g[It[1]],q.array[ot+5]=g[It[2]],q.array[ot+6]=y[It[0]],q.array[ot+7]=y[It[1]],q.array[ot+8]=y[It[2]],ot+=9;else if("faceVertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)v=(W=q.value[At[a]])[0],g=W[1],y=W[2],q.array[ot]=v[It[0]],q.array[ot+1]=v[It[1]],q.array[ot+2]=v[It[2]],q.array[ot+3]=g[It[0]],q.array[ot+4]=g[It[1]],q.array[ot+5]=g[It[2]],q.array[ot+6]=y[It[0]],q.array[ot+7]=y[It[1]],q.array[ot+8]=y[It[2]],ot+=9}else if(4===q.size)if(void 0===q.boundTo||"vertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)l=Pt[At[a]],v=q.value[l.a],g=q.value[l.b],y=q.value[l.c],q.array[ot]=v.x,q.array[ot+1]=v.y,q.array[ot+2]=v.z,q.array[ot+3]=v.w,q.array[ot+4]=g.x,q.array[ot+5]=g.y,q.array[ot+6]=g.z,q.array[ot+7]=g.w,q.array[ot+8]=y.x,q.array[ot+9]=y.y,q.array[ot+10]=y.z,q.array[ot+11]=y.w,ot+=12;else if("faces"===q.boundTo)for(a=0,s=At.length;s>a;a++)v=W=q.value[At[a]],g=W,y=W,q.array[ot]=v.x,q.array[ot+1]=v.y,q.array[ot+2]=v.z,q.array[ot+3]=v.w,q.array[ot+4]=g.x,q.array[ot+5]=g.y,q.array[ot+6]=g.z,q.array[ot+7]=g.w,q.array[ot+8]=y.x,q.array[ot+9]=y.y,q.array[ot+10]=y.z,q.array[ot+11]=y.w,ot+=12;else if("faceVertices"===q.boundTo)for(a=0,s=At.length;s>a;a++)v=(W=q.value[At[a]])[0],g=W[1],y=W[2],q.array[ot]=v.x,q.array[ot+1]=v.y,q.array[ot+2]=v.z,q.array[ot+3]=v.w,q.array[ot+4]=g.x,q.array[ot+5]=g.y,q.array[ot+6]=g.z,q.array[ot+7]=g.w,q.array[ot+8]=y.x,q.array[ot+9]=y.y,q.array[ot+10]=y.z,q.array[ot+11]=y.w,ot+=12;at.bindBuffer(at.ARRAY_BUFFER,q.buffer),at.bufferData(at.ARRAY_BUFFER,q.array,n)}i&&(delete t.__inittedArrays,delete t.__colorArray,delete t.__normalArray,delete t.__tangentArray,delete t.__uvArray,delete t.__uv2Array,delete t.__faceArray,delete t.__vertexArray,delete t.__lineArray,delete t.__skinIndexArray,delete t.__skinWeightArray)}}function c(t,e,n,i){for(var r=n.attributes,o=e.attributes,a=e.attributesKeys,s=0,l=a.length;l>s;s++){var c=a[s],u=o[c];if(u>=0){var h=r[c];if(void 0!==h){var d=h.itemSize;at.bindBuffer(at.ARRAY_BUFFER,h.buffer),kt.enableAttribute(u),at.vertexAttribPointer(u,d,at.FLOAT,!1,0,i*d*4)}else void 0!==t.defaultAttributeValues&&(2===t.defaultAttributeValues[c].length?at.vertexAttrib2fv(u,t.defaultAttributeValues[c]):3===t.defaultAttributeValues[c].length&&at.vertexAttrib3fv(u,t.defaultAttributeValues[c]))}}kt.disableUnusedAttributes()}function u(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function h(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function d(t,e){return e[0]-t[0]}function f(t){if(!1!==t.visible){if(t instanceof r.Scene||t instanceof r.Group);else if(y(t),t instanceof r.Light)$.push(t);else if(t instanceof r.Sprite)rt.push(t);else if(t instanceof r.LensFlare)ot.push(t);else{var e=tt[t.id];if(e&&(!1===t.frustumCulled||!0===wt.intersectsObject(t)))for(var n=0,i=e.length;i>n;n++){var o=e[n];g(o),o.render=!0,!0===st.sortObjects&&(St.setFromMatrixPosition(t.matrixWorld),St.applyProjection(_t),o.z=St.z)}}for(n=0,i=t.children.length;i>n;n++)f(t.children[n])}}function p(t,e,n,i,o){for(var a,s=0,l=t.length;l>s;s++){var c=t[s],u=c.object,h=c.buffer;if(P(u,e),o)a=o;else{if(!(a=c.material))continue;C(a)}st.setMaterialFaces(a),h instanceof r.BufferGeometry?st.renderBufferDirect(e,n,i,a,h,u):st.renderBuffer(e,n,i,a,h,u)}}function m(t,e,n,i,r,o){for(var a,s=0,l=t.length;l>s;s++){var c=t[s],u=c.object;if(u.visible){if(o)a=o;else{if(!(a=c[e]))continue;C(a)}st.renderImmediateObject(n,i,r,a,u)}}}function v(t){var e=t.object.material;e.transparent?(t.transparent=e,t.opaque=null):(t.opaque=e,t.transparent=null)}function g(t){var e=t.object,n=t.buffer,i=e.geometry,o=e.material;if(o instanceof r.MeshFaceMaterial){var a=i instanceof r.BufferGeometry?0:n.materialIndex;o=o.materials[a],t.material=o,o.transparent?it.push(t):nt.push(t)}else o&&(t.material=o,o.transparent?it.push(t):nt.push(t))}function y(t){void 0===t.__webglInit&&(t.__webglInit=!0,t._modelViewMatrix=new r.Matrix4,t._normalMatrix=new r.Matrix3,t.addEventListener("removed",Jt));var e=t.geometry;if(void 0===e||void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",Zt),e instanceof r.BufferGeometry?st.info.memory.geometries++:t instanceof r.Mesh?b(t,e):t instanceof r.Line?void 0===e.__webglVertexBuffer&&(function(t){t.__webglVertexBuffer=at.createBuffer(),t.__webglColorBuffer=at.createBuffer(),t.__webglLineDistanceBuffer=at.createBuffer(),st.info.memory.geometries++}(e),o(e,t),e.verticesNeedUpdate=!0,e.colorsNeedUpdate=!0,e.lineDistancesNeedUpdate=!0):t instanceof r.PointCloud&&void 0===e.__webglVertexBuffer&&(function(t){t.__webglVertexBuffer=at.createBuffer(),t.__webglColorBuffer=at.createBuffer(),st.info.memory.geometries++}(e),i(e,t),e.verticesNeedUpdate=!0,e.colorsNeedUpdate=!0)),void 0===t.__webglActive)if(t.__webglActive=!0,t instanceof r.Mesh){if(e instanceof r.BufferGeometry)x(tt,e,t);else if(e instanceof r.Geometry)for(var n=oe[e.id],a=0,s=n.length;s>a;a++)x(tt,n[a],t)}else t instanceof r.Line||t instanceof r.PointCloud?x(tt,e,t):(t instanceof r.ImmediateRenderObject||t.immediateRenderCallback)&&function(t,e){t.push({id:null,object:e,opaque:null,transparent:null,z:0})}(et,t)}function b(t,n){var i=t.material,o=!1;(void 0===oe[n.id]||!0===n.groupsNeedUpdate)&&(delete tt[t.id],oe[n.id]=function(t,e){for(var n,i,r=At.get("OES_element_index_uint")?4294967296:65535,o={},a=t.morphTargets.length,s=t.morphNormals.length,l={},c=[],u=0,h=t.faces.length;h>u;u++){var d=t.faces[u],f=e?d.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),(n=o[f].hash+"_"+o[f].counter)in l||(i={id:ae++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i)),l[n].vertices+3>r&&(o[f].counter+=1,(n=o[f].hash+"_"+o[f].counter)in l||(i={id:ae++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i))),l[n].faces3.push(u),l[n].vertices+=3}return c}(n,i instanceof r.MeshFaceMaterial),n.groupsNeedUpdate=!1);for(var s=oe[n.id],l=0,c=s.length;c>l;l++){var u=s[l];void 0===u.__webglVertexBuffer?(e(u),a(u,t),n.verticesNeedUpdate=!0,n.morphTargetsNeedUpdate=!0,n.elementsNeedUpdate=!0,n.uvsNeedUpdate=!0,n.normalsNeedUpdate=!0,n.tangentsNeedUpdate=!0,n.colorsNeedUpdate=!0,o=!0):o=!1,(o||void 0===t.__webglActive)&&x(tt,u,t)}t.__webglActive=!0}function x(t,e,n){var i=n.id;t[i]=t[i]||[],t[i].push({id:i,buffer:e,object:n,material:null,z:0})}function w(t){var e=t.geometry;if(e instanceof r.BufferGeometry)for(var n=e.attributes,i=e.attributesKeys,o=0,a=i.length;a>o;o++){var c=i[o],u=n[c],h="index"===c?at.ELEMENT_ARRAY_BUFFER:at.ARRAY_BUFFER;void 0===u.buffer?(u.buffer=at.createBuffer(),at.bindBuffer(h,u.buffer),at.bufferData(h,u.array,u instanceof r.DynamicBufferAttribute?at.DYNAMIC_DRAW:at.STATIC_DRAW),u.needsUpdate=!1):!0===u.needsUpdate&&(at.bindBuffer(h,u.buffer),void 0===u.updateRange||-1===u.updateRange.count?at.bufferSubData(h,0,u.array):0===u.updateRange.count?console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually."):(at.bufferSubData(h,u.updateRange.offset*u.array.BYTES_PER_ELEMENT,u.array.subarray(u.updateRange.offset,u.updateRange.offset+u.updateRange.count)),u.updateRange.count=0),u.needsUpdate=!1)}else if(t instanceof r.Mesh){!0===e.groupsNeedUpdate&&b(t,e);for(var d=oe[e.id],f=(o=0,d.length);f>o;o++){var p=d[o],m=(v=s(t,p)).attributes&&_(v);(e.verticesNeedUpdate||e.morphTargetsNeedUpdate||e.elementsNeedUpdate||e.uvsNeedUpdate||e.normalsNeedUpdate||e.colorsNeedUpdate||e.tangentsNeedUpdate||m)&&l(p,t,at.DYNAMIC_DRAW,!e.dynamic,v)}e.verticesNeedUpdate=!1,e.morphTargetsNeedUpdate=!1,e.elementsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.tangentsNeedUpdate=!1,v.attributes&&S(v)}else if(t instanceof r.Line){m=(v=s(t,e)).attributes&&_(v);(e.verticesNeedUpdate||e.colorsNeedUpdate||e.lineDistancesNeedUpdate||m)&&function(t,e){var n,i,r,o,a,s,l,c,u,h,d,f,p=t.vertices,m=t.colors,v=t.lineDistances,g=p.length,y=m.length,b=v.length,x=t.__vertexArray,w=t.__colorArray,_=t.__lineDistanceArray,S=t.verticesNeedUpdate,M=t.colorsNeedUpdate,C=t.lineDistancesNeedUpdate,T=t.__webglCustomAttributesList;if(S){for(n=0;g>n;n++)o=p[n],x[a=3*n]=o.x,x[a+1]=o.y,x[a+2]=o.z;at.bindBuffer(at.ARRAY_BUFFER,t.__webglVertexBuffer),at.bufferData(at.ARRAY_BUFFER,x,e)}if(M){for(i=0;y>i;i++)s=m[i],w[a=3*i]=s.r,w[a+1]=s.g,w[a+2]=s.b;at.bindBuffer(at.ARRAY_BUFFER,t.__webglColorBuffer),at.bufferData(at.ARRAY_BUFFER,w,e)}if(C){for(r=0;b>r;r++)_[r]=v[r];at.bindBuffer(at.ARRAY_BUFFER,t.__webglLineDistanceBuffer),at.bufferData(at.ARRAY_BUFFER,_,e)}if(T)for(l=0,c=T.length;c>l;l++)if((f=T[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,h=f.value.length,1===f.size)for(u=0;h>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;at.bindBuffer(at.ARRAY_BUFFER,f.buffer),at.bufferData(at.ARRAY_BUFFER,f.array,e),f.needsUpdate=!1}}(e,at.DYNAMIC_DRAW),e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,e.lineDistancesNeedUpdate=!1,v.attributes&&S(v)}else if(t instanceof r.PointCloud){var v;m=(v=s(t,e)).attributes&&_(v);(e.verticesNeedUpdate||e.colorsNeedUpdate||m)&&function(t,e,n){var i,r,o,a,s,l,c,u,h,d,f,p=t.vertices,m=p.length,v=t.colors,g=v.length,y=t.__vertexArray,b=t.__colorArray,x=t.verticesNeedUpdate,w=t.colorsNeedUpdate,_=t.__webglCustomAttributesList;if(x){for(i=0;m>i;i++)o=p[i],y[a=3*i]=o.x,y[a+1]=o.y,y[a+2]=o.z;at.bindBuffer(at.ARRAY_BUFFER,t.__webglVertexBuffer),at.bufferData(at.ARRAY_BUFFER,y,e)}if(w){for(r=0;g>r;r++)s=v[r],b[a=3*r]=s.r,b[a+1]=s.g,b[a+2]=s.b;at.bindBuffer(at.ARRAY_BUFFER,t.__webglColorBuffer),at.bufferData(at.ARRAY_BUFFER,b,e)}if(_)for(l=0,c=_.length;c>l;l++){if((f=_[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo))if(h=f.value.length,a=0,1===f.size)for(u=0;h>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(u=0;h>u;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;at.bindBuffer(at.ARRAY_BUFFER,f.buffer),at.bufferData(at.ARRAY_BUFFER,f.array,e),f.needsUpdate=!1}}(e,at.DYNAMIC_DRAW),e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,v.attributes&&S(v)}}function _(t){for(var e in t.attributes)if(t.attributes[e].needsUpdate)return!0;return!1}function S(t){for(var e in t.attributes)t.attributes[e].needsUpdate=!1}function M(t,e,n,i){t.addEventListener("dispose",$t);var o=se[t.type];if(o){var a=r.ShaderLib[o];t.__webglShader={uniforms:r.UniformsUtils.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}}else t.__webglShader={uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};var s=function(t){for(var e=0,n=0,i=0,o=0,a=0,s=t.length;s>a;a++){var l=t[a];l.onlyShadow||!1===l.visible||(l instanceof r.DirectionalLight&&e++,l instanceof r.PointLight&&n++,l instanceof r.SpotLight&&i++,l instanceof r.HemisphereLight&&o++)}return{directional:e,point:n,spot:i,hemi:o}}(e),l=function(t){for(var e=0,n=0,i=t.length;i>n;n++){var o=t[n];o.castShadow&&(o instanceof r.SpotLight&&e++,o instanceof r.DirectionalLight&&!o.shadowCascade&&e++)}return e}(e),c=function(t){if(Nt&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var e=at.getParameter(at.MAX_VERTEX_UNIFORM_VECTORS),n=Math.floor((e-20)/4),i=n;return void 0!==t&&t instanceof r.SkinnedMesh&&(i=Math.min(t.skeleton.bones.length,i),i<t.skeleton.bones.length&&r.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)")),i}(i),u={precision:H,supportsVertexTextures:It,map:!!t.map,envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,lightMap:!!t.lightMap,bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,combine:t.combine,vertexColors:t.vertexColors,fog:n,useFog:t.fog,fogExp:n instanceof r.FogExp2,flatShading:t.shading===r.FlatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:Z,skinning:t.skinning,maxBones:c,useVertexTexture:Nt&&i&&i.skeleton&&i.skeleton.useVertexTexture,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:st.maxMorphTargets,maxMorphNormals:st.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:l,shadowMapEnabled:st.shadowMapEnabled&&i.receiveShadow&&l>0,shadowMapType:st.shadowMapType,shadowMapDebug:st.shadowMapDebug,shadowMapCascade:st.shadowMapCascade,alphaTest:t.alphaTest,metal:t.metal,wrapAround:t.wrapAround,doubleSided:t.side===r.DoubleSide,flipSided:t.side===r.BackSide},h=[];if(o?h.push(o):(h.push(t.fragmentShader),h.push(t.vertexShader)),void 0!==t.defines)for(var d in t.defines)h.push(d),h.push(t.defines[d]);for(var d in u)h.push(d),h.push(u[d]);for(var f,p=h.join(),m=0,v=lt.length;v>m;m++){var g=lt[m];if(g.code===p){(f=g).usedTimes++;break}}void 0===f&&(f=new r.WebGLProgram(st,p,t,u),lt.push(f),st.info.memory.programs=lt.length),t.program=f;var y=f.attributes;if(t.morphTargets){t.numSupportedMorphTargets=0;for(var b="morphTarget",x=0;x<st.maxMorphTargets;x++)y[b+x]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;b="morphNormal";for(x=0;x<st.maxMorphNormals;x++)y[b+x]>=0&&t.numSupportedMorphNormals++}for(var w in t.uniformsList=[],t.__webglShader.uniforms){var _=t.program.uniforms[w];_&&t.uniformsList.push([t.__webglShader.uniforms[w],_])}}function C(t){!0===t.transparent?kt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha):kt.setBlending(r.NoBlending),kt.setDepthTest(t.depthTest),kt.setDepthWrite(t.depthWrite),kt.setColorWrite(t.colorWrite),kt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function T(t,e,n,i,o){pt=0,i.needsUpdate&&(i.program&&re(i),M(i,e,n,o),i.needsUpdate=!1),i.morphTargets&&(o.__webglMorphTargetInfluences||(o.__webglMorphTargetInfluences=new Float32Array(st.maxMorphTargets)));var a=!1,s=!1,l=!1,c=i.program,u=c.uniforms,h=i.__webglShader.uniforms;if(c.id!==ct&&(at.useProgram(c.program),ct=c.id,a=!0,s=!0,l=!0),i.id!==ht&&(-1===ht&&(l=!0),ht=i.id,s=!0),(a||t!==ft)&&(at.uniformMatrix4fv(u.projectionMatrix,!1,t.projectionMatrix.elements),Z&&at.uniform1f(u.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==ft&&(ft=t),(i instanceof r.ShaderMaterial||i instanceof r.MeshPhongMaterial||i.envMap)&&null!==u.cameraPosition&&(St.setFromMatrixPosition(t.matrixWorld),at.uniform3f(u.cameraPosition,St.x,St.y,St.z)),(i instanceof r.MeshPhongMaterial||i instanceof r.MeshLambertMaterial||i instanceof r.MeshBasicMaterial||i instanceof r.ShaderMaterial||i.skinning)&&null!==u.viewMatrix&&at.uniformMatrix4fv(u.viewMatrix,!1,t.matrixWorldInverse.elements)),i.skinning)if(o.bindMatrix&&null!==u.bindMatrix&&at.uniformMatrix4fv(u.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&null!==u.bindMatrixInverse&&at.uniformMatrix4fv(u.bindMatrixInverse,!1,o.bindMatrixInverse.elements),Nt&&o.skeleton&&o.skeleton.useVertexTexture){if(null!==u.boneTexture){var d=A();at.uniform1i(u.boneTexture,d),st.setTexture(o.skeleton.boneTexture,d)}null!==u.boneTextureWidth&&at.uniform1i(u.boneTextureWidth,o.skeleton.boneTextureWidth),null!==u.boneTextureHeight&&at.uniform1i(u.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&null!==u.boneGlobalMatrices&&at.uniformMatrix4fv(u.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return s&&(n&&i.fog&&function(t,e){t.fogColor.value=e.color,e instanceof r.Fog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof r.FogExp2&&(t.fogDensity.value=e.density)}(h,n),(i instanceof r.MeshPhongMaterial||i instanceof r.MeshLambertMaterial||i.lights)&&(Ct&&(l=!0,function(t){var e,n,i,o,a,s,l,c,u=0,h=0,d=0,f=Tt,p=f.directional.colors,m=f.directional.positions,v=f.point.colors,g=f.point.positions,y=f.point.distances,b=f.point.decays,x=f.spot.colors,w=f.spot.positions,_=f.spot.distances,S=f.spot.directions,M=f.spot.anglesCos,C=f.spot.exponents,T=f.spot.decays,E=f.hemi.skyColors,k=f.hemi.groundColors,A=f.hemi.positions,P=0,O=0,R=0,F=0,B=0,D=0,I=0,N=0,j=0,V=0,z=0,U=0;for(e=0,n=t.length;n>e;e++)if(!(i=t[e]).onlyShadow)if(o=i.color,l=i.intensity,c=i.distance,i instanceof r.AmbientLight){if(!i.visible)continue;u+=o.r,h+=o.g,d+=o.b}else if(i instanceof r.DirectionalLight){if(B+=1,!i.visible)continue;Mt.setFromMatrixPosition(i.matrixWorld),St.setFromMatrixPosition(i.target.matrixWorld),Mt.sub(St),Mt.normalize(),m[j=3*P]=Mt.x,m[j+1]=Mt.y,m[j+2]=Mt.z,L(p,j,o,l),P+=1}else if(i instanceof r.PointLight){if(D+=1,!i.visible)continue;L(v,V=3*O,o,l),St.setFromMatrixPosition(i.matrixWorld),g[V]=St.x,g[V+1]=St.y,g[V+2]=St.z,y[O]=c,b[O]=0===i.distance?0:i.decay,O+=1}else if(i instanceof r.SpotLight){if(I+=1,!i.visible)continue;L(x,z=3*R,o,l),Mt.setFromMatrixPosition(i.matrixWorld),w[z]=Mt.x,w[z+1]=Mt.y,w[z+2]=Mt.z,_[R]=c,St.setFromMatrixPosition(i.target.matrixWorld),Mt.sub(St),Mt.normalize(),S[z]=Mt.x,S[z+1]=Mt.y,S[z+2]=Mt.z,M[R]=Math.cos(i.angle),C[R]=i.exponent,T[R]=0===i.distance?0:i.decay,R+=1}else if(i instanceof r.HemisphereLight){if(N+=1,!i.visible)continue;Mt.setFromMatrixPosition(i.matrixWorld),Mt.normalize(),A[U=3*F]=Mt.x,A[U+1]=Mt.y,A[U+2]=Mt.z,a=i.color,s=i.groundColor,L(E,U,a,l),L(k,U,s,l),F+=1}for(e=3*P,n=Math.max(p.length,3*B);n>e;e++)p[e]=0;for(e=3*O,n=Math.max(v.length,3*D);n>e;e++)v[e]=0;for(e=3*R,n=Math.max(x.length,3*I);n>e;e++)x[e]=0;for(e=3*F,n=Math.max(E.length,3*N);n>e;e++)E[e]=0;for(e=3*F,n=Math.max(k.length,3*N);n>e;e++)k[e]=0;f.directional.length=P,f.point.length=O,f.spot.length=R,f.hemi.length=F,f.ambient[0]=u,f.ambient[1]=h,f.ambient[2]=d}(e),Ct=!1),l?(function(t,e){t.ambientLightColor.value=e.ambient,t.directionalLightColor.value=e.directional.colors,t.directionalLightDirection.value=e.directional.positions,t.pointLightColor.value=e.point.colors,t.pointLightPosition.value=e.point.positions,t.pointLightDistance.value=e.point.distances,t.pointLightDecay.value=e.point.decays,t.spotLightColor.value=e.spot.colors,t.spotLightPosition.value=e.spot.positions,t.spotLightDistance.value=e.spot.distances,t.spotLightDirection.value=e.spot.directions,t.spotLightAngleCos.value=e.spot.anglesCos,t.spotLightExponent.value=e.spot.exponents,t.spotLightDecay.value=e.spot.decays,t.hemisphereLightSkyColor.value=e.hemi.skyColors,t.hemisphereLightGroundColor.value=e.hemi.groundColors,t.hemisphereLightDirection.value=e.hemi.positions}(h,Tt),k(h,!0)):k(h,!1)),(i instanceof r.MeshBasicMaterial||i instanceof r.MeshLambertMaterial||i instanceof r.MeshPhongMaterial)&&function(t,e){var n;if(t.opacity.value=e.opacity,t.diffuse.value=e.color,t.map.value=e.map,t.lightMap.value=e.lightMap,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.map?n=e.map:e.specularMap?n=e.specularMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.alphaMap&&(n=e.alphaMap),void 0!==n){var i=n.offset,o=n.repeat;t.offsetRepeat.value.set(i.x,i.y,o.x,o.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof r.WebGLRenderTargetCube?1:-1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}(h,i),i instanceof r.LineBasicMaterial?E(h,i):i instanceof r.LineDashedMaterial?(E(h,i),function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(h,i)):i instanceof r.PointCloudMaterial?function(t,e){if(t.psColor.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size,t.scale.value=V.height/2,t.map.value=e.map,null!==e.map){var n=e.map.offset,i=e.map.repeat;t.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}}(h,i):i instanceof r.MeshPhongMaterial?function(t,e){t.shininess.value=e.shininess,t.emissive.value=e.emissive,t.specular.value=e.specular,e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}(h,i):i instanceof r.MeshLambertMaterial?function(t,e){t.emissive.value=e.emissive,e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}(h,i):i instanceof r.MeshDepthMaterial?(h.mNear.value=t.near,h.mFar.value=t.far,h.opacity.value=i.opacity):i instanceof r.MeshNormalMaterial&&(h.opacity.value=i.opacity),o.receiveShadow&&!i._shadowPass&&function(t,e){if(t.shadowMatrix)for(var n=0,i=0,o=e.length;o>i;i++){var a=e[i];a.castShadow&&(a instanceof r.SpotLight||a instanceof r.DirectionalLight&&!a.shadowCascade)&&(t.shadowMap.value[n]=a.shadowMap,t.shadowMapSize.value[n]=a.shadowMapSize,t.shadowMatrix.value[n]=a.shadowMatrix,t.shadowDarkness.value[n]=a.shadowDarkness,t.shadowBias.value[n]=a.shadowBias,n++)}}(h,e),function(t){for(var e,n,i,o=0,a=t.length;a>o;o++){var s=t[o][0];if(!1!==s.needsUpdate){var l=s.type,c=s.value,u=t[o][1];switch(l){case"1i":case"i":at.uniform1i(u,c);break;case"1f":case"f":at.uniform1f(u,c);break;case"2f":at.uniform2f(u,c[0],c[1]);break;case"3f":at.uniform3f(u,c[0],c[1],c[2]);break;case"4f":at.uniform4f(u,c[0],c[1],c[2],c[3]);break;case"1iv":case"iv1":at.uniform1iv(u,c);break;case"3iv":case"iv":at.uniform3iv(u,c);break;case"1fv":case"fv1":at.uniform1fv(u,c);break;case"2fv":at.uniform2fv(u,c);break;case"3fv":case"fv":at.uniform3fv(u,c);break;case"4fv":at.uniform4fv(u,c);break;case"Matrix3fv":at.uniformMatrix3fv(u,!1,c);break;case"Matrix4fv":at.uniformMatrix4fv(u,!1,c);break;case"v2":at.uniform2f(u,c.x,c.y);break;case"v3":at.uniform3f(u,c.x,c.y,c.z);break;case"v4":at.uniform4f(u,c.x,c.y,c.z,c.w);break;case"c":at.uniform3f(u,c.r,c.g,c.b);break;case"v2v":void 0===s._array&&(s._array=new Float32Array(2*c.length));for(var h=0,d=c.length;d>h;h++)i=2*h,s._array[i]=c[h].x,s._array[i+1]=c[h].y;at.uniform2fv(u,s._array);break;case"v3v":void 0===s._array&&(s._array=new Float32Array(3*c.length));for(h=0,d=c.length;d>h;h++)i=3*h,s._array[i]=c[h].x,s._array[i+1]=c[h].y,s._array[i+2]=c[h].z;at.uniform3fv(u,s._array);break;case"v4v":void 0===s._array&&(s._array=new Float32Array(4*c.length));for(h=0,d=c.length;d>h;h++)i=4*h,s._array[i]=c[h].x,s._array[i+1]=c[h].y,s._array[i+2]=c[h].z,s._array[i+3]=c[h].w;at.uniform4fv(u,s._array);break;case"m3":at.uniformMatrix3fv(u,!1,c.elements);break;case"m3v":void 0===s._array&&(s._array=new Float32Array(9*c.length));for(h=0,d=c.length;d>h;h++)c[h].flattenToArrayOffset(s._array,9*h);at.uniformMatrix3fv(u,!1,s._array);break;case"m4":at.uniformMatrix4fv(u,!1,c.elements);break;case"m4v":void 0===s._array&&(s._array=new Float32Array(16*c.length));for(h=0,d=c.length;d>h;h++)c[h].flattenToArrayOffset(s._array,16*h);at.uniformMatrix4fv(u,!1,s._array);break;case"t":if(e=c,n=A(),at.uniform1i(u,n),!e)continue;e instanceof r.CubeTexture||e.image instanceof Array&&6===e.image.length?F(e,n):e instanceof r.WebGLRenderTargetCube?B(e,n):st.setTexture(e,n);break;case"tv":void 0===s._array&&(s._array=[]);for(h=0,d=s.value.length;d>h;h++)s._array[h]=A();at.uniform1iv(u,s._array);for(h=0,d=s.value.length;d>h;h++)e=s.value[h],n=s._array[h],e&&st.setTexture(e,n);break;default:r.warn("THREE.WebGLRenderer: Unknown uniform type: "+l)}}}}(i.uniformsList)),function(t,e){at.uniformMatrix4fv(t.modelViewMatrix,!1,e._modelViewMatrix.elements),t.normalMatrix&&at.uniformMatrix3fv(t.normalMatrix,!1,e._normalMatrix.elements)}(u,o),null!==u.modelMatrix&&at.uniformMatrix4fv(u.modelMatrix,!1,o.matrixWorld.elements),c}function E(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function k(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLightColor.needsUpdate=e,t.directionalLightDirection.needsUpdate=e,t.pointLightColor.needsUpdate=e,t.pointLightPosition.needsUpdate=e,t.pointLightDistance.needsUpdate=e,t.pointLightDecay.needsUpdate=e,t.spotLightColor.needsUpdate=e,t.spotLightPosition.needsUpdate=e,t.spotLightDistance.needsUpdate=e,t.spotLightDirection.needsUpdate=e,t.spotLightAngleCos.needsUpdate=e,t.spotLightExponent.needsUpdate=e,t.spotLightDecay.needsUpdate=e,t.hemisphereLightSkyColor.needsUpdate=e,t.hemisphereLightGroundColor.needsUpdate=e,t.hemisphereLightDirection.needsUpdate=e}function A(){var t=pt;return t>=Rt&&r.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Rt),pt+=1,t}function P(t,e){t._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),t._normalMatrix.getNormalMatrix(t._modelViewMatrix)}function L(t,e,n,i){t[e]=n.r*i,t[e+1]=n.g*i,t[e+2]=n.b*i}function O(t,e,n){var i;n?(at.texParameteri(t,at.TEXTURE_WRAP_S,j(e.wrapS)),at.texParameteri(t,at.TEXTURE_WRAP_T,j(e.wrapT)),at.texParameteri(t,at.TEXTURE_MAG_FILTER,j(e.magFilter)),at.texParameteri(t,at.TEXTURE_MIN_FILTER,j(e.minFilter))):(at.texParameteri(t,at.TEXTURE_WRAP_S,at.CLAMP_TO_EDGE),at.texParameteri(t,at.TEXTURE_WRAP_T,at.CLAMP_TO_EDGE),(e.wrapS!==r.ClampToEdgeWrapping||e.wrapT!==r.ClampToEdgeWrapping)&&r.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+e.sourceFile+" )"),at.texParameteri(t,at.TEXTURE_MAG_FILTER,N(e.magFilter)),at.texParameteri(t,at.TEXTURE_MIN_FILTER,N(e.minFilter)),e.minFilter!==r.NearestFilter&&e.minFilter!==r.LinearFilter&&r.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+e.sourceFile+" )")),(i=At.get("EXT_texture_filter_anisotropic"))&&e.type!==r.FloatType&&e.type!==r.HalfFloatType&&(e.anisotropy>1||e.__currentAnisotropy)&&(at.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,st.getMaxAnisotropy())),e.__currentAnisotropy=e.anisotropy)}function R(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElement("canvas");return i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),r.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function F(t,e){if(6===t.image.length)if(t.needsUpdate){t.image.__webglTextureCube||(t.addEventListener("dispose",Qt),t.image.__webglTextureCube=at.createTexture(),st.info.memory.textures++),at.activeTexture(at.TEXTURE0+e),at.bindTexture(at.TEXTURE_CUBE_MAP,t.image.__webglTextureCube),at.pixelStorei(at.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var n=t instanceof r.CompressedTexture,i=t.image[0]instanceof r.DataTexture,o=[],a=0;6>a;a++)!st.autoScaleCubemaps||n||i?o[a]=i?t.image[a].image:t.image[a]:o[a]=R(t.image[a],Dt);var s=o[0],l=r.Math.isPowerOfTwo(s.width)&&r.Math.isPowerOfTwo(s.height),c=j(t.format),u=j(t.type);O(at.TEXTURE_CUBE_MAP,t,l);for(a=0;6>a;a++)if(n)for(var h,d=o[a].mipmaps,f=0,p=d.length;p>f;f++)h=d[f],t.format!==r.RGBAFormat&&t.format!==r.RGBFormat?Ht().indexOf(c)>-1?at.compressedTexImage2D(at.TEXTURE_CUBE_MAP_POSITIVE_X+a,f,c,h.width,h.height,0,h.data):r.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):at.texImage2D(at.TEXTURE_CUBE_MAP_POSITIVE_X+a,f,c,h.width,h.height,0,c,u,h.data);else i?at.texImage2D(at.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,o[a].width,o[a].height,0,c,u,o[a].data):at.texImage2D(at.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,c,u,o[a]);t.generateMipmaps&&l&&at.generateMipmap(at.TEXTURE_CUBE_MAP),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()}else at.activeTexture(at.TEXTURE0+e),at.bindTexture(at.TEXTURE_CUBE_MAP,t.image.__webglTextureCube)}function B(t,e){at.activeTexture(at.TEXTURE0+e),at.bindTexture(at.TEXTURE_CUBE_MAP,t.__webglTexture)}function D(t,e,n){at.bindFramebuffer(at.FRAMEBUFFER,t),at.framebufferTexture2D(at.FRAMEBUFFER,at.COLOR_ATTACHMENT0,n,e.__webglTexture,0)}function I(t,e){at.bindRenderbuffer(at.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(at.renderbufferStorage(at.RENDERBUFFER,at.DEPTH_COMPONENT16,e.width,e.height),at.framebufferRenderbuffer(at.FRAMEBUFFER,at.DEPTH_ATTACHMENT,at.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(at.renderbufferStorage(at.RENDERBUFFER,at.DEPTH_STENCIL,e.width,e.height),at.framebufferRenderbuffer(at.FRAMEBUFFER,at.DEPTH_STENCIL_ATTACHMENT,at.RENDERBUFFER,t)):at.renderbufferStorage(at.RENDERBUFFER,at.RGBA4,e.width,e.height)}function N(t){return t===r.NearestFilter||t===r.NearestMipMapNearestFilter||t===r.NearestMipMapLinearFilter?at.NEAREST:at.LINEAR}function j(t){var e;if(t===r.RepeatWrapping)return at.REPEAT;if(t===r.ClampToEdgeWrapping)return at.CLAMP_TO_EDGE;if(t===r.MirroredRepeatWrapping)return at.MIRRORED_REPEAT;if(t===r.NearestFilter)return at.NEAREST;if(t===r.NearestMipMapNearestFilter)return at.NEAREST_MIPMAP_NEAREST;if(t===r.NearestMipMapLinearFilter)return at.NEAREST_MIPMAP_LINEAR;if(t===r.LinearFilter)return at.LINEAR;if(t===r.LinearMipMapNearestFilter)return at.LINEAR_MIPMAP_NEAREST;if(t===r.LinearMipMapLinearFilter)return at.LINEAR_MIPMAP_LINEAR;if(t===r.UnsignedByteType)return at.UNSIGNED_BYTE;if(t===r.UnsignedShort4444Type)return at.UNSIGNED_SHORT_4_4_4_4;if(t===r.UnsignedShort5551Type)return at.UNSIGNED_SHORT_5_5_5_1;if(t===r.UnsignedShort565Type)return at.UNSIGNED_SHORT_5_6_5;if(t===r.ByteType)return at.BYTE;if(t===r.ShortType)return at.SHORT;if(t===r.UnsignedShortType)return at.UNSIGNED_SHORT;if(t===r.IntType)return at.INT;if(t===r.UnsignedIntType)return at.UNSIGNED_INT;if(t===r.FloatType)return at.FLOAT;if(null!==(e=At.get("OES_texture_half_float"))&&t===r.HalfFloatType)return e.HALF_FLOAT_OES;if(t===r.AlphaFormat)return at.ALPHA;if(t===r.RGBFormat)return at.RGB;if(t===r.RGBAFormat)return at.RGBA;if(t===r.LuminanceFormat)return at.LUMINANCE;if(t===r.LuminanceAlphaFormat)return at.LUMINANCE_ALPHA;if(t===r.AddEquation)return at.FUNC_ADD;if(t===r.SubtractEquation)return at.FUNC_SUBTRACT;if(t===r.ReverseSubtractEquation)return at.FUNC_REVERSE_SUBTRACT;if(t===r.ZeroFactor)return at.ZERO;if(t===r.OneFactor)return at.ONE;if(t===r.SrcColorFactor)return at.SRC_COLOR;if(t===r.OneMinusSrcColorFactor)return at.ONE_MINUS_SRC_COLOR;if(t===r.SrcAlphaFactor)return at.SRC_ALPHA;if(t===r.OneMinusSrcAlphaFactor)return at.ONE_MINUS_SRC_ALPHA;if(t===r.DstAlphaFactor)return at.DST_ALPHA;if(t===r.OneMinusDstAlphaFactor)return at.ONE_MINUS_DST_ALPHA;if(t===r.DstColorFactor)return at.DST_COLOR;if(t===r.OneMinusDstColorFactor)return at.ONE_MINUS_DST_COLOR;if(t===r.SrcAlphaSaturateFactor)return at.SRC_ALPHA_SATURATE;if(null!==(e=At.get("WEBGL_compressed_texture_s3tc"))){if(t===r.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===r.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===r.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===r.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=At.get("WEBGL_compressed_texture_pvrtc"))){if(t===r.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===r.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===r.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===r.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=At.get("EXT_blend_minmax"))){if(t===r.MinEquation)return e.MIN_EXT;if(t===r.MaxEquation)return e.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",r.REVISION);var V=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),z=void 0!==t.context?t.context:null,U=1,H=void 0!==t.precision?t.precision:"highp",G=void 0!==t.alpha&&t.alpha,W=void 0===t.depth||t.depth,q=void 0===t.stencil||t.stencil,X=void 0!==t.antialias&&t.antialias,Y=void 0===t.premultipliedAlpha||t.premultipliedAlpha,J=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,Z=void 0!==t.logarithmicDepthBuffer&&t.logarithmicDepthBuffer,Q=new r.Color(0),K=0,$=[],tt={},et=[],nt=[],it=[],rt=[],ot=[];this.domElement=V,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=r.PCFShadowMap,this.shadowMapCullFace=r.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var at,st=this,lt=[],ct=null,ut=null,ht=-1,dt="",ft=null,pt=0,mt=0,vt=0,gt=V.width,yt=V.height,bt=0,xt=0,wt=new r.Frustum,_t=new r.Matrix4,St=new r.Vector3,Mt=new r.Vector3,Ct=!0,Tt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var Et={alpha:G,depth:W,stencil:q,antialias:X,premultipliedAlpha:Y,preserveDrawingBuffer:J};if(null===(at=z||V.getContext("webgl",Et)||V.getContext("experimental-webgl",Et)))throw null!==V.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";V.addEventListener("webglcontextlost",(function(t){t.preventDefault(),Ot(),Lt(),tt={}}),!1)}catch(t){r.error("THREE.WebGLRenderer: "+t)}var kt=new r.WebGLState(at,j);void 0===at.getShaderPrecisionFormat&&(at.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var At=new r.WebGLExtensions(at);At.get("OES_texture_float"),At.get("OES_texture_float_linear"),At.get("OES_texture_half_float"),At.get("OES_texture_half_float_linear"),At.get("OES_standard_derivatives"),Z&&At.get("EXT_frag_depth");var Pt=function(t,e,n,i){!0===Y&&(t*=i,e*=i,n*=i),at.clearColor(t,e,n,i)},Lt=function(){at.clearColor(0,0,0,1),at.clearDepth(1),at.clearStencil(0),at.enable(at.DEPTH_TEST),at.depthFunc(at.LEQUAL),at.frontFace(at.CCW),at.cullFace(at.BACK),at.enable(at.CULL_FACE),at.enable(at.BLEND),at.blendEquation(at.FUNC_ADD),at.blendFunc(at.SRC_ALPHA,at.ONE_MINUS_SRC_ALPHA),at.viewport(mt,vt,gt,yt),Pt(Q.r,Q.g,Q.b,K)},Ot=function(){ct=null,ft=null,dt="",ht=-1,Ct=!0,kt.reset()};Lt(),this.context=at,this.state=kt;var Rt=at.getParameter(at.MAX_TEXTURE_IMAGE_UNITS),Ft=at.getParameter(at.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Bt=at.getParameter(at.MAX_TEXTURE_SIZE),Dt=at.getParameter(at.MAX_CUBE_MAP_TEXTURE_SIZE),It=Ft>0,Nt=It&&At.get("OES_texture_float"),jt=at.getShaderPrecisionFormat(at.VERTEX_SHADER,at.HIGH_FLOAT),Vt=at.getShaderPrecisionFormat(at.VERTEX_SHADER,at.MEDIUM_FLOAT),zt=at.getShaderPrecisionFormat(at.FRAGMENT_SHADER,at.HIGH_FLOAT),Ut=at.getShaderPrecisionFormat(at.FRAGMENT_SHADER,at.MEDIUM_FLOAT),Ht=function(){var t;return function(){if(void 0!==t)return t;if(t=[],At.get("WEBGL_compressed_texture_pvrtc")||At.get("WEBGL_compressed_texture_s3tc"))for(var e=at.getParameter(at.COMPRESSED_TEXTURE_FORMATS),n=0;n<e.length;n++)t.push(e[n]);return t}}(),Gt=jt.precision>0&&zt.precision>0,Wt=Vt.precision>0&&Ut.precision>0;"highp"!==H||Gt||(Wt?(H="mediump",r.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(H="lowp",r.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==H||Wt||(H="lowp",r.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var qt=new r.ShadowMapPlugin(this,$,tt,et),Xt=new r.SpritePlugin(this,rt),Yt=new r.LensFlarePlugin(this,ot);this.getContext=function(){return at},this.forceContextLoss=function(){At.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return It},this.supportsFloatTextures=function(){return At.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return At.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return At.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return At.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return At.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return At.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=At.get("EXT_texture_filter_anisotropic");return t=null!==e?at.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return H},this.getPixelRatio=function(){return U},this.setPixelRatio=function(t){U=t},this.setSize=function(t,e,n){V.width=t*U,V.height=e*U,!1!==n&&(V.style.width=t+"px",V.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){mt=t*U,vt=e*U,gt=n*U,yt=i*U,at.viewport(mt,vt,gt,yt)},this.setScissor=function(t,e,n,i){at.scissor(t*U,e*U,n*U,i*U)},this.enableScissorTest=function(t){t?at.enable(at.SCISSOR_TEST):at.disable(at.SCISSOR_TEST)},this.getClearColor=function(){return Q},this.setClearColor=function(t,e){Q.set(t),K=void 0!==e?e:1,Pt(Q.r,Q.g,Q.b,K)},this.getClearAlpha=function(){return K},this.setClearAlpha=function(t){K=t,Pt(Q.r,Q.g,Q.b,K)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=at.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=at.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=at.STENCIL_BUFFER_BIT),at.clear(i)},this.clearColor=function(){at.clear(at.COLOR_BUFFER_BIT)},this.clearDepth=function(){at.clear(at.DEPTH_BUFFER_BIT)},this.clearStencil=function(){at.clear(at.STENCIL_BUFFER_BIT)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=Ot;var Jt=function(t){t.target.traverse((function(t){t.removeEventListener("remove",Jt),function(t){t instanceof r.Mesh||t instanceof r.PointCloud||t instanceof r.Line?delete tt[t.id]:(t instanceof r.ImmediateRenderObject||t.immediateRenderCallback)&&function(t,e){for(var n=t.length-1;n>=0;n--)t[n].object===e&&t.splice(n,1)}(et,t),delete t.__webglInit,delete t._modelViewMatrix,delete t._normalMatrix,delete t.__webglActive}(t)}))},Zt=function(t){var e=t.target;e.removeEventListener("dispose",Zt),ee(e)},Qt=function(t){var e=t.target;e.removeEventListener("dispose",Qt),ne(e),st.info.memory.textures--},Kt=function(t){var e=t.target;e.removeEventListener("dispose",Kt),ie(e),st.info.memory.textures--},$t=function(t){var e=t.target;e.removeEventListener("dispose",$t),re(e)},te=function(t){for(var e=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],n=0,i=e.length;i>n;n++){void 0!==t[r=e[n]]&&(at.deleteBuffer(t[r]),delete t[r])}if(void 0!==t.__webglCustomAttributesList){for(var r in t.__webglCustomAttributesList)at.deleteBuffer(t.__webglCustomAttributesList[r].buffer);delete t.__webglCustomAttributesList}st.info.memory.geometries--},ee=function(t){if(delete t.__webglInit,t instanceof r.BufferGeometry){for(var e in t.attributes){var n=t.attributes[e];void 0!==n.buffer&&(at.deleteBuffer(n.buffer),delete n.buffer)}st.info.memory.geometries--}else{var i=oe[t.id];if(void 0!==i){for(var o=0,a=i.length;a>o;o++){var s=i[o];if(void 0!==s.numMorphTargets){for(var l=0,c=s.numMorphTargets;c>l;l++)at.deleteBuffer(s.__webglMorphTargetsBuffers[l]);delete s.__webglMorphTargetsBuffers}if(void 0!==s.numMorphNormals){for(l=0,c=s.numMorphNormals;c>l;l++)at.deleteBuffer(s.__webglMorphNormalsBuffers[l]);delete s.__webglMorphNormalsBuffers}te(s)}delete oe[t.id]}else te(t)}dt=""},ne=function(t){if(t.image&&t.image.__webglTextureCube)at.deleteTexture(t.image.__webglTextureCube),delete t.image.__webglTextureCube;else{if(void 0===t.__webglInit)return;at.deleteTexture(t.__webglTexture),delete t.__webglTexture,delete t.__webglInit}},ie=function(t){if(t&&void 0!==t.__webglTexture){if(at.deleteTexture(t.__webglTexture),delete t.__webglTexture,t instanceof r.WebGLRenderTargetCube)for(var e=0;6>e;e++)at.deleteFramebuffer(t.__webglFramebuffer[e]),at.deleteRenderbuffer(t.__webglRenderbuffer[e]);else at.deleteFramebuffer(t.__webglFramebuffer),at.deleteRenderbuffer(t.__webglRenderbuffer);delete t.__webglFramebuffer,delete t.__webglRenderbuffer}},re=function(t){var e=t.program.program;if(void 0!==e){t.program=void 0;var n,i,r,o=!1;for(n=0,i=lt.length;i>n;n++)if((r=lt[n]).program===e){r.usedTimes--,0===r.usedTimes&&(o=!0);break}if(!0===o){var a=[];for(n=0,i=lt.length;i>n;n++)(r=lt[n]).program!==e&&a.push(r);lt=a,at.deleteProgram(e),st.info.memory.programs--}}};this.renderBufferImmediate=function(t,e,n){if(kt.initAttributes(),t.hasPositions&&!t.__webglVertexBuffer&&(t.__webglVertexBuffer=at.createBuffer()),t.hasNormals&&!t.__webglNormalBuffer&&(t.__webglNormalBuffer=at.createBuffer()),t.hasUvs&&!t.__webglUvBuffer&&(t.__webglUvBuffer=at.createBuffer()),t.hasColors&&!t.__webglColorBuffer&&(t.__webglColorBuffer=at.createBuffer()),t.hasPositions&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglVertexBuffer),at.bufferData(at.ARRAY_BUFFER,t.positionArray,at.DYNAMIC_DRAW),kt.enableAttribute(e.attributes.position),at.vertexAttribPointer(e.attributes.position,3,at.FLOAT,!1,0,0)),t.hasNormals){if(at.bindBuffer(at.ARRAY_BUFFER,t.__webglNormalBuffer),n instanceof r.MeshPhongMaterial==0&&n.shading===r.FlatShading){var i,o,a,s,l,c,u,h,d,f,p,m=3*t.count;for(p=0;m>p;p+=9)s=(f=t.normalArray)[p],c=f[p+1],h=f[p+2],l=f[p+3],u=f[p+4],d=f[p+5],i=(s+l+f[p+6])/3,o=(c+u+f[p+7])/3,a=(h+d+f[p+8])/3,f[p]=i,f[p+1]=o,f[p+2]=a,f[p+3]=i,f[p+4]=o,f[p+5]=a,f[p+6]=i,f[p+7]=o,f[p+8]=a}at.bufferData(at.ARRAY_BUFFER,t.normalArray,at.DYNAMIC_DRAW),kt.enableAttribute(e.attributes.normal),at.vertexAttribPointer(e.attributes.normal,3,at.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglUvBuffer),at.bufferData(at.ARRAY_BUFFER,t.uvArray,at.DYNAMIC_DRAW),kt.enableAttribute(e.attributes.uv),at.vertexAttribPointer(e.attributes.uv,2,at.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==r.NoColors&&(at.bindBuffer(at.ARRAY_BUFFER,t.__webglColorBuffer),at.bufferData(at.ARRAY_BUFFER,t.colorArray,at.DYNAMIC_DRAW),kt.enableAttribute(e.attributes.color),at.vertexAttribPointer(e.attributes.color,3,at.FLOAT,!1,0,0)),kt.disableUnusedAttributes(),at.drawArrays(at.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,o,a){if(!1!==i.visible){w(a);var s=T(t,e,n,i,a),l=!1,u=i.wireframe?1:0,h="direct_"+o.id+"_"+s.id+"_"+u;if(h!==dt&&(dt=h,l=!0),l&&kt.initAttributes(),a instanceof r.Mesh){var d=!0===i.wireframe?at.LINES:at.TRIANGLES;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&At.get("OES_element_index_uint")?(y=at.UNSIGNED_INT,b=4):(y=at.UNSIGNED_SHORT,b=2),0===(x=o.offsets).length)l&&(c(i,s,o,0),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,g.array.length,y,0),st.info.render.calls++,st.info.render.vertices+=g.array.length,st.info.render.faces+=g.array.length/3;else{l=!0;for(var f=0,p=x.length;p>f;f++){var m=x[f].index;l&&(c(i,s,o,m),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,x[f].count,y,x[f].start*b),st.info.render.calls++,st.info.render.vertices+=x[f].count,st.info.render.faces+=x[f].count/3}}}else{l&&c(i,s,o,0);var v=o.attributes.position;at.drawArrays(d,0,v.array.length/v.itemSize),st.info.render.calls++,st.info.render.vertices+=v.array.length/v.itemSize,st.info.render.faces+=v.array.length/(3*v.itemSize)}}else if(a instanceof r.PointCloud){d=at.POINTS;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&At.get("OES_element_index_uint")?(y=at.UNSIGNED_INT,b=4):(y=at.UNSIGNED_SHORT,b=2),0===(x=o.offsets).length)l&&(c(i,s,o,0),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,g.array.length,y,0),st.info.render.calls++,st.info.render.points+=g.array.length;else{x.length>1&&(l=!0);for(f=0,p=x.length;p>f;f++){m=x[f].index;l&&(c(i,s,o,m),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,x[f].count,y,x[f].start*b),st.info.render.calls++,st.info.render.points+=x[f].count}}}else{l&&c(i,s,o,0);v=o.attributes.position;if(0===(x=o.offsets).length)at.drawArrays(d,0,v.array.length/3),st.info.render.calls++,st.info.render.points+=v.array.length/3;else for(f=0,p=x.length;p>f;f++)at.drawArrays(d,x[f].index,x[f].count),st.info.render.calls++,st.info.render.points+=x[f].count}}else if(a instanceof r.Line){var g;d=a.mode===r.LineStrip?at.LINE_STRIP:at.LINES;if(kt.setLineWidth(i.linewidth*U),g=o.attributes.index){var y,b;if(g.array instanceof Uint32Array?(y=at.UNSIGNED_INT,b=4):(y=at.UNSIGNED_SHORT,b=2),0===(x=o.offsets).length)l&&(c(i,s,o,0),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,g.array.length,y,0),st.info.render.calls++,st.info.render.vertices+=g.array.length;else{x.length>1&&(l=!0);for(f=0,p=x.length;p>f;f++){m=x[f].index;l&&(c(i,s,o,m),at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,g.buffer)),at.drawElements(d,x[f].count,y,x[f].start*b),st.info.render.calls++,st.info.render.vertices+=x[f].count}}}else{l&&c(i,s,o,0);var x;v=o.attributes.position;if(0===(x=o.offsets).length)at.drawArrays(d,0,v.array.length/3),st.info.render.calls++,st.info.render.vertices+=v.array.length/3;else for(f=0,p=x.length;p>f;f++)at.drawArrays(d,x[f].index,x[f].count),st.info.render.calls++,st.info.render.vertices+=x[f].count}}}},this.renderBuffer=function(t,e,n,i,o,a){if(!1!==i.visible){w(a);var s=T(t,e,n,i,a),l=s.attributes,c=!1,u=i.wireframe?1:0,h=o.id+"_"+s.id+"_"+u;if(h!==dt&&(dt=h,c=!0),c&&kt.initAttributes(),!i.morphTargets&&l.position>=0?c&&(at.bindBuffer(at.ARRAY_BUFFER,o.__webglVertexBuffer),kt.enableAttribute(l.position),at.vertexAttribPointer(l.position,3,at.FLOAT,!1,0,0)):a.morphTargetBase&&function(t,e,n){var i=t.program.attributes;if(-1!==n.morphTargetBase&&i.position>=0?(at.bindBuffer(at.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[n.morphTargetBase]),kt.enableAttribute(i.position),at.vertexAttribPointer(i.position,3,at.FLOAT,!1,0,0)):i.position>=0&&(at.bindBuffer(at.ARRAY_BUFFER,e.__webglVertexBuffer),kt.enableAttribute(i.position),at.vertexAttribPointer(i.position,3,at.FLOAT,!1,0,0)),n.morphTargetForcedOrder.length)for(var r=0,o=n.morphTargetForcedOrder,a=n.morphTargetInfluences;r<t.numSupportedMorphTargets&&r<o.length;)(f=i["morphTarget"+r])>=0&&(at.bindBuffer(at.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[o[r]]),kt.enableAttribute(f),at.vertexAttribPointer(f,3,at.FLOAT,!1,0,0)),(f=i["morphNormal"+r])>=0&&t.morphNormals&&(at.bindBuffer(at.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[o[r]]),kt.enableAttribute(f),at.vertexAttribPointer(f,3,at.FLOAT,!1,0,0)),n.__webglMorphTargetInfluences[r]=a[o[r]],r++;else{var s=[],l=(a=n.morphTargetInfluences,n.geometry.morphTargets);a.length>l.length&&(console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."),a.length=l.length);for(var c=0,u=a.length;u>c;c++){var h=a[c];s.push([h,c])}s.length>t.numSupportedMorphTargets?(s.sort(d),s.length=t.numSupportedMorphTargets):s.length>t.numSupportedMorphNormals?s.sort(d):0===s.length&&s.push([0,0]),r=0;for(var f,p=t.numSupportedMorphTargets;p>r;r++)if(s[r]){var m=s[r][1];(f=i["morphTarget"+r])>=0&&(at.bindBuffer(at.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[m]),kt.enableAttribute(f),at.vertexAttribPointer(f,3,at.FLOAT,!1,0,0)),(f=i["morphNormal"+r])>=0&&t.morphNormals&&(at.bindBuffer(at.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[m]),kt.enableAttribute(f),at.vertexAttribPointer(f,3,at.FLOAT,!1,0,0)),n.__webglMorphTargetInfluences[r]=a[m]}else n.__webglMorphTargetInfluences[r]=0}null!==t.program.uniforms.morphTargetInfluences&&at.uniform1fv(t.program.uniforms.morphTargetInfluences,n.__webglMorphTargetInfluences)}(i,o,a),c){if(o.__webglCustomAttributesList)for(var f=0,p=o.__webglCustomAttributesList.length;p>f;f++){var m=o.__webglCustomAttributesList[f];l[m.buffer.belongsToAttribute]>=0&&(at.bindBuffer(at.ARRAY_BUFFER,m.buffer),kt.enableAttribute(l[m.buffer.belongsToAttribute]),at.vertexAttribPointer(l[m.buffer.belongsToAttribute],m.size,at.FLOAT,!1,0,0))}l.color>=0&&(a.geometry.colors.length>0||a.geometry.faces.length>0?(at.bindBuffer(at.ARRAY_BUFFER,o.__webglColorBuffer),kt.enableAttribute(l.color),at.vertexAttribPointer(l.color,3,at.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&at.vertexAttrib3fv(l.color,i.defaultAttributeValues.color)),l.normal>=0&&(at.bindBuffer(at.ARRAY_BUFFER,o.__webglNormalBuffer),kt.enableAttribute(l.normal),at.vertexAttribPointer(l.normal,3,at.FLOAT,!1,0,0)),l.tangent>=0&&(at.bindBuffer(at.ARRAY_BUFFER,o.__webglTangentBuffer),kt.enableAttribute(l.tangent),at.vertexAttribPointer(l.tangent,4,at.FLOAT,!1,0,0)),l.uv>=0&&(a.geometry.faceVertexUvs[0]?(at.bindBuffer(at.ARRAY_BUFFER,o.__webglUVBuffer),kt.enableAttribute(l.uv),at.vertexAttribPointer(l.uv,2,at.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&at.vertexAttrib2fv(l.uv,i.defaultAttributeValues.uv)),l.uv2>=0&&(a.geometry.faceVertexUvs[1]?(at.bindBuffer(at.ARRAY_BUFFER,o.__webglUV2Buffer),kt.enableAttribute(l.uv2),at.vertexAttribPointer(l.uv2,2,at.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&at.vertexAttrib2fv(l.uv2,i.defaultAttributeValues.uv2)),i.skinning&&l.skinIndex>=0&&l.skinWeight>=0&&(at.bindBuffer(at.ARRAY_BUFFER,o.__webglSkinIndicesBuffer),kt.enableAttribute(l.skinIndex),at.vertexAttribPointer(l.skinIndex,4,at.FLOAT,!1,0,0),at.bindBuffer(at.ARRAY_BUFFER,o.__webglSkinWeightsBuffer),kt.enableAttribute(l.skinWeight),at.vertexAttribPointer(l.skinWeight,4,at.FLOAT,!1,0,0)),l.lineDistance>=0&&(at.bindBuffer(at.ARRAY_BUFFER,o.__webglLineDistanceBuffer),kt.enableAttribute(l.lineDistance),at.vertexAttribPointer(l.lineDistance,1,at.FLOAT,!1,0,0))}if(kt.disableUnusedAttributes(),a instanceof r.Mesh){var v=o.__typeArray===Uint32Array?at.UNSIGNED_INT:at.UNSIGNED_SHORT;i.wireframe?(kt.setLineWidth(i.wireframeLinewidth*U),c&&at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,o.__webglLineBuffer),at.drawElements(at.LINES,o.__webglLineCount,v,0)):(c&&at.bindBuffer(at.ELEMENT_ARRAY_BUFFER,o.__webglFaceBuffer),at.drawElements(at.TRIANGLES,o.__webglFaceCount,v,0)),st.info.render.calls++,st.info.render.vertices+=o.__webglFaceCount,st.info.render.faces+=o.__webglFaceCount/3}else if(a instanceof r.Line){var g=a.mode===r.LineStrip?at.LINE_STRIP:at.LINES;kt.setLineWidth(i.linewidth*U),at.drawArrays(g,0,o.__webglLineCount),st.info.render.calls++}else a instanceof r.PointCloud&&(at.drawArrays(at.POINTS,0,o.__webglParticleCount),st.info.render.calls++,st.info.render.points+=o.__webglParticleCount)}},this.render=function(t,e,n,i){if(e instanceof r.Camera!=0){var o=t.fog;dt="",ht=-1,ft=null,Ct=!0,!0===t.autoUpdate&&t.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),t.traverse((function(t){t instanceof r.SkinnedMesh&&t.skeleton.update()})),e.matrixWorldInverse.getInverse(e.matrixWorld),_t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),wt.setFromMatrix(_t),$.length=0,nt.length=0,it.length=0,rt.length=0,ot.length=0,f(t),!0===st.sortObjects&&(nt.sort(u),it.sort(h)),qt.render(t,e),st.info.render.calls=0,st.info.render.vertices=0,st.info.render.faces=0,st.info.render.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var a=0,s=et.length;s>a;a++){var l=et[a],c=l.object;c.visible&&(P(c,e),v(l))}if(t.overrideMaterial){var d=t.overrideMaterial;C(d),p(nt,e,$,o,d),p(it,e,$,o,d),m(et,"",e,$,o,d)}else kt.setBlending(r.NoBlending),p(nt,e,$,o,null),m(et,"opaque",e,$,o,null),p(it,e,$,o,null),m(et,"transparent",e,$,o,null);Xt.render(t,e),Yt.render(t,e,bt,xt),n&&n.generateMipmaps&&n.minFilter!==r.NearestFilter&&n.minFilter!==r.LinearFilter&&function(t){t instanceof r.WebGLRenderTargetCube?(at.bindTexture(at.TEXTURE_CUBE_MAP,t.__webglTexture),at.generateMipmap(at.TEXTURE_CUBE_MAP),at.bindTexture(at.TEXTURE_CUBE_MAP,null)):(at.bindTexture(at.TEXTURE_2D,t.__webglTexture),at.generateMipmap(at.TEXTURE_2D),at.bindTexture(at.TEXTURE_2D,null))}(n),kt.setDepthTest(!0),kt.setDepthWrite(!0),kt.setColorWrite(!0)}else r.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.renderImmediateObject=function(t,e,n,i,r){var o=T(t,e,n,i,r);dt="",st.setMaterialFaces(i),r.immediateRenderCallback?r.immediateRenderCallback(o,at,wt):r.render((function(t){st.renderBufferImmediate(t,o,i)}))};var oe={},ae=0,se={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(t,e){t===r.CullFaceNone?at.disable(at.CULL_FACE):(e===r.FrontFaceDirectionCW?at.frontFace(at.CW):at.frontFace(at.CCW),t===r.CullFaceBack?at.cullFace(at.BACK):t===r.CullFaceFront?at.cullFace(at.FRONT):at.cullFace(at.FRONT_AND_BACK),at.enable(at.CULL_FACE))},this.setMaterialFaces=function(t){kt.setDoubleSided(t.side===r.DoubleSide),kt.setFlipSided(t.side===r.BackSide)},this.uploadTexture=function(t){void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",Qt),t.__webglTexture=at.createTexture(),st.info.memory.textures++),at.bindTexture(at.TEXTURE_2D,t.__webglTexture),at.pixelStorei(at.UNPACK_FLIP_Y_WEBGL,t.flipY),at.pixelStorei(at.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),at.pixelStorei(at.UNPACK_ALIGNMENT,t.unpackAlignment),t.image=R(t.image,Bt);var e=t.image,n=r.Math.isPowerOfTwo(e.width)&&r.Math.isPowerOfTwo(e.height),i=j(t.format),o=j(t.type);O(at.TEXTURE_2D,t,n);var a,s=t.mipmaps;if(t instanceof r.DataTexture)if(s.length>0&&n){for(var l=0,c=s.length;c>l;l++)a=s[l],at.texImage2D(at.TEXTURE_2D,l,i,a.width,a.height,0,i,o,a.data);t.generateMipmaps=!1}else at.texImage2D(at.TEXTURE_2D,0,i,e.width,e.height,0,i,o,e.data);else if(t instanceof r.CompressedTexture)for(l=0,c=s.length;c>l;l++)a=s[l],t.format!==r.RGBAFormat&&t.format!==r.RGBFormat?Ht().indexOf(i)>-1?at.compressedTexImage2D(at.TEXTURE_2D,l,i,a.width,a.height,0,a.data):r.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):at.texImage2D(at.TEXTURE_2D,l,i,a.width,a.height,0,i,o,a.data);else if(s.length>0&&n){for(l=0,c=s.length;c>l;l++)a=s[l],at.texImage2D(at.TEXTURE_2D,l,i,i,o,a);t.generateMipmaps=!1}else at.texImage2D(at.TEXTURE_2D,0,i,i,o,t.image);t.generateMipmaps&&n&&at.generateMipmap(at.TEXTURE_2D),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()},this.setTexture=function(t,e){at.activeTexture(at.TEXTURE0+e),t.needsUpdate?st.uploadTexture(t):at.bindTexture(at.TEXTURE_2D,t.__webglTexture)},this.setRenderTarget=function(t){var e,n,i,o,a,s=t instanceof r.WebGLRenderTargetCube;if(t&&void 0===t.__webglFramebuffer){void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",Kt),t.__webglTexture=at.createTexture(),st.info.memory.textures++;var l=r.Math.isPowerOfTwo(t.width)&&r.Math.isPowerOfTwo(t.height),c=j(t.format),u=j(t.type);if(s){t.__webglFramebuffer=[],t.__webglRenderbuffer=[],at.bindTexture(at.TEXTURE_CUBE_MAP,t.__webglTexture),O(at.TEXTURE_CUBE_MAP,t,l);for(var h=0;6>h;h++)t.__webglFramebuffer[h]=at.createFramebuffer(),t.__webglRenderbuffer[h]=at.createRenderbuffer(),at.texImage2D(at.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,c,t.width,t.height,0,c,u,null),D(t.__webglFramebuffer[h],t,at.TEXTURE_CUBE_MAP_POSITIVE_X+h),I(t.__webglRenderbuffer[h],t);l&&at.generateMipmap(at.TEXTURE_CUBE_MAP)}else t.__webglFramebuffer=at.createFramebuffer(),t.shareDepthFrom?t.__webglRenderbuffer=t.shareDepthFrom.__webglRenderbuffer:t.__webglRenderbuffer=at.createRenderbuffer(),at.bindTexture(at.TEXTURE_2D,t.__webglTexture),O(at.TEXTURE_2D,t,l),at.texImage2D(at.TEXTURE_2D,0,c,t.width,t.height,0,c,u,null),D(t.__webglFramebuffer,t,at.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?at.framebufferRenderbuffer(at.FRAMEBUFFER,at.DEPTH_ATTACHMENT,at.RENDERBUFFER,t.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&at.framebufferRenderbuffer(at.FRAMEBUFFER,at.DEPTH_STENCIL_ATTACHMENT,at.RENDERBUFFER,t.__webglRenderbuffer):I(t.__webglRenderbuffer,t),l&&at.generateMipmap(at.TEXTURE_2D);s?at.bindTexture(at.TEXTURE_CUBE_MAP,null):at.bindTexture(at.TEXTURE_2D,null),at.bindRenderbuffer(at.RENDERBUFFER,null),at.bindFramebuffer(at.FRAMEBUFFER,null)}t?(e=s?t.__webglFramebuffer[t.activeCubeFace]:t.__webglFramebuffer,n=t.width,i=t.height,o=0,a=0):(e=null,n=gt,i=yt,o=mt,a=vt),e!==ut&&(at.bindFramebuffer(at.FRAMEBUFFER,e),at.viewport(o,a,n,i),ut=e),bt=n,xt=i},this.readRenderTargetPixels=function(t,e,n,i,o,a){if(t instanceof r.WebGLRenderTarget){if(t.__webglFramebuffer){if(t.format!==r.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var s=!1;t.__webglFramebuffer!==ut&&(at.bindFramebuffer(at.FRAMEBUFFER,t.__webglFramebuffer),s=!0),at.checkFramebufferStatus(at.FRAMEBUFFER)===at.FRAMEBUFFER_COMPLETE?at.readPixels(e,n,i,o,at.RGBA,at.UNSIGNED_BYTE,a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),s&&at.bindFramebuffer(at.FRAMEBUFFER,ut)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.initMaterial=function(){r.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){r.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){r.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){r.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},r.WebGLRenderTarget=function(t,e,n){this.width=t,this.height=e,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:r.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:r.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:r.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.format=void 0!==n.format?n.format:r.RGBAFormat,this.type=void 0!==n.type?n.type:r.UnsignedByteType,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},r.WebGLRenderTarget.prototype={constructor:r.WebGLRenderTarget,setSize:function(t,e){this.width=t,this.height=e},clone:function(){var t=new r.WebGLRenderTarget(this.width,this.height);return t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.format=this.format,t.type=this.type,t.depthBuffer=this.depthBuffer,t.stencilBuffer=this.stencilBuffer,t.generateMipmaps=this.generateMipmaps,t.shareDepthFrom=this.shareDepthFrom,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube=function(t,e,n){r.WebGLRenderTarget.call(this,t,e,n),this.activeCubeFace=0},r.WebGLRenderTargetCube.prototype=Object.create(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube.prototype.constructor=r.WebGLRenderTargetCube,r.WebGLExtensions=function(t){var e={};this.get=function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return null===i&&r.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}},r.WebGLProgram=function(){var t=0;return function(e,n,i,o){var a=e,s=a.context,l=i.defines,c=i.__webglShader.uniforms,u=i.attributes,h=i.__webglShader.vertexShader,d=i.__webglShader.fragmentShader,f=i.index0AttributeName;void 0===f&&!0===o.morphTargets&&(f="position");var p="SHADOWMAP_TYPE_BASIC";o.shadowMapType===r.PCFShadowMap?p="SHADOWMAP_TYPE_PCF":o.shadowMapType===r.PCFSoftShadowMap&&(p="SHADOWMAP_TYPE_PCF_SOFT");var m="ENVMAP_TYPE_CUBE",v="ENVMAP_MODE_REFLECTION",g="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(i.envMap.mapping){case r.CubeReflectionMapping:case r.CubeRefractionMapping:m="ENVMAP_TYPE_CUBE";break;case r.EquirectangularReflectionMapping:case r.EquirectangularRefractionMapping:m="ENVMAP_TYPE_EQUIREC";break;case r.SphericalReflectionMapping:m="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case r.CubeRefractionMapping:case r.EquirectangularRefractionMapping:v="ENVMAP_MODE_REFRACTION"}switch(i.combine){case r.MultiplyOperation:g="ENVMAP_BLENDING_MULTIPLY";break;case r.MixOperation:g="ENVMAP_BLENDING_MIX";break;case r.AddOperation:g="ENVMAP_BLENDING_ADD"}}var y,b,x=e.gammaFactor>0?e.gammaFactor:1,w=function(t){var e,n,i=[];for(var r in t)!1!==(e=t[r])&&(n="#define "+r+" "+e,i.push(n));return i.join("\n")}(l),_=s.createProgram();i instanceof r.RawShaderMaterial?(y="",b=""):(y=["precision "+o.precision+" float;","precision "+o.precision+" int;",w,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"",a.gammaInput?"#define GAMMA_INPUT":"",a.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+x,"#define MAX_DIR_LIGHTS "+o.maxDirLights,"#define MAX_POINT_LIGHTS "+o.maxPointLights,"#define MAX_SPOT_LIGHTS "+o.maxSpotLights,"#define MAX_HEMI_LIGHTS "+o.maxHemiLights,"#define MAX_SHADOWS "+o.maxShadows,"#define MAX_BONES "+o.maxBones,o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+v:"",o.lightMap?"#define USE_LIGHTMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals?"#define USE_MORPHNORMALS":"",o.wrapAround?"#define WRAP_AROUND":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+p:"",o.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",o.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif",""].join("\n"),b=["precision "+o.precision+" float;","precision "+o.precision+" int;",o.bumpMap||o.normalMap||o.flatShading?"#extension GL_OES_standard_derivatives : enable":"",w,"#define MAX_DIR_LIGHTS "+o.maxDirLights,"#define MAX_POINT_LIGHTS "+o.maxPointLights,"#define MAX_SPOT_LIGHTS "+o.maxSpotLights,"#define MAX_HEMI_LIGHTS "+o.maxHemiLights,"#define MAX_SHADOWS "+o.maxShadows,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"",a.gammaInput?"#define GAMMA_INPUT":"",a.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+x,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+m:"",o.envMap?"#define "+v:"",o.envMap?"#define "+g:"",o.lightMap?"#define USE_LIGHTMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.metal?"#define METAL":"",o.wrapAround?"#define WRAP_AROUND":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+p:"",o.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",o.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var S=new r.WebGLShader(s,s.VERTEX_SHADER,y+h),M=new r.WebGLShader(s,s.FRAGMENT_SHADER,b+d);s.attachShader(_,S),s.attachShader(_,M),void 0!==f&&s.bindAttribLocation(_,0,f),s.linkProgram(_);var C=s.getProgramInfoLog(_);!1===s.getProgramParameter(_,s.LINK_STATUS)&&r.error("THREE.WebGLProgram: shader error: "+s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(_,s.VALIDATE_STATUS),"gl.getPRogramInfoLog",C),""!==C&&r.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+C),s.deleteShader(S),s.deleteShader(M);var T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];for(var E in o.useVertexTexture?(T.push("boneTexture"),T.push("boneTextureWidth"),T.push("boneTextureHeight")):T.push("boneGlobalMatrices"),o.logarithmicDepthBuffer&&T.push("logDepthBufFC"),c)T.push(E);this.uniforms=function(t,e,n){for(var i={},r=0,o=n.length;o>r;r++){var a=n[r];i[a]=t.getUniformLocation(e,a)}return i}(s,_,T),T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var k=0;k<o.maxMorphTargets;k++)T.push("morphTarget"+k);for(k=0;k<o.maxMorphNormals;k++)T.push("morphNormal"+k);for(var A in u)T.push(A);return this.attributes=function(t,e,n){for(var i={},r=0,o=n.length;o>r;r++){var a=n[r];i[a]=t.getAttribLocation(e,a)}return i}(s,_,T),this.attributesKeys=Object.keys(this.attributes),this.id=t++,this.code=n,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=M,this}}(),r.WebGLShader=function(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&r.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&r.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t.getShaderInfoLog(i),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),i},r.WebGLState=function(t,e){var n=new Uint8Array(16),i=new Uint8Array(16),o=null,a=null,s=null,l=null,c=null,u=null,h=null,d=null,f=null,p=null,m=null,v=null,g=null,y=null,b=null,x=null;this.initAttributes=function(){for(var t=0,e=n.length;e>t;t++)n[t]=0},this.enableAttribute=function(e){n[e]=1,0===i[e]&&(t.enableVertexAttribArray(e),i[e]=1)},this.disableUnusedAttributes=function(){for(var e=0,r=i.length;r>e;e++)i[e]!==n[e]&&(t.disableVertexAttribArray(e),i[e]=0)},this.setBlending=function(n,i,d,f,p,m,v){n!==o&&(n===r.NoBlending?t.disable(t.BLEND):n===r.AdditiveBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):n===r.SubtractiveBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):n===r.MultiplyBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):n===r.CustomBlending?t.enable(t.BLEND):(t.enable(t.BLEND),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),o=n),n===r.CustomBlending?(p=p||i,m=m||d,v=v||f,(i!==a||p!==c)&&(t.blendEquationSeparate(e(i),e(p)),a=i,c=p),(d!==s||f!==l||m!==u||v!==h)&&(t.blendFuncSeparate(e(d),e(f),e(m),e(v)),s=d,l=f,u=m,h=v)):(a=null,s=null,l=null,c=null,u=null,h=null)},this.setDepthTest=function(e){d!==e&&(e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),d=e)},this.setDepthWrite=function(e){f!==e&&(t.depthMask(e),f=e)},this.setColorWrite=function(e){p!==e&&(t.colorMask(e,e,e,e),p=e)},this.setDoubleSided=function(e){m!==e&&(e?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),m=e)},this.setFlipSided=function(e){v!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),v=e)},this.setLineWidth=function(e){e!==g&&(t.lineWidth(e),g=e)},this.setPolygonOffset=function(e,n,i){y!==e&&(e?t.enable(t.POLYGON_OFFSET_FILL):t.disable(t.POLYGON_OFFSET_FILL),y=e),!e||b===n&&x===i||(t.polygonOffset(n,i),b=n,x=i)},this.reset=function(){for(var t=0;t<i.length;t++)i[t]=0;o=null,d=null,f=null,p=null,m=null,v=null}},r.LensFlarePlugin=function(t,e){function n(e){var n=d.createProgram(),i=d.createShader(d.FRAGMENT_SHADER),r=d.createShader(d.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return d.shaderSource(i,o+e.fragmentShader),d.shaderSource(r,o+e.vertexShader),d.compileShader(i),d.compileShader(r),d.attachShader(n,i),d.attachShader(n,r),d.linkProgram(n),n}var i,o,a,s,l,c,u,h,d=t.context,f=function(){var t,e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),r=new Uint16Array([0,1,2,0,2,3]);i=d.createBuffer(),o=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,i),d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),d.bufferData(d.ELEMENT_ARRAY_BUFFER,r,d.STATIC_DRAW),u=d.createTexture(),h=d.createTexture(),d.bindTexture(d.TEXTURE_2D,u),d.texImage2D(d.TEXTURE_2D,0,d.RGB,16,16,0,d.RGB,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.bindTexture(d.TEXTURE_2D,h),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,16,16,0,d.RGBA,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),t=(c=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0)?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},a=n(t),s={vertex:d.getAttribLocation(a,"position"),uv:d.getAttribLocation(a,"uv")},l={renderType:d.getUniformLocation(a,"renderType"),map:d.getUniformLocation(a,"map"),occlusionMap:d.getUniformLocation(a,"occlusionMap"),opacity:d.getUniformLocation(a,"opacity"),color:d.getUniformLocation(a,"color"),scale:d.getUniformLocation(a,"scale"),rotation:d.getUniformLocation(a,"rotation"),screenPosition:d.getUniformLocation(a,"screenPosition")}};this.render=function(n,p,m,v){if(0!==e.length){var g=new r.Vector3,y=v/m,b=.5*m,x=.5*v,w=16/v,_=new r.Vector2(w*y,w),S=new r.Vector3(1,1,0),M=new r.Vector2(1,1);void 0===a&&f(),d.useProgram(a),d.enableVertexAttribArray(s.vertex),d.enableVertexAttribArray(s.uv),d.uniform1i(l.occlusionMap,0),d.uniform1i(l.map,1),d.bindBuffer(d.ARRAY_BUFFER,i),d.vertexAttribPointer(s.vertex,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(s.uv,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),d.disable(d.CULL_FACE),d.depthMask(!1);for(var C=0,T=e.length;T>C;C++){w=16/v,_.set(w*y,w);var E=e[C];if(g.set(E.matrixWorld.elements[12],E.matrixWorld.elements[13],E.matrixWorld.elements[14]),g.applyMatrix4(p.matrixWorldInverse),g.applyProjection(p.projectionMatrix),S.copy(g),M.x=S.x*b+b,M.y=S.y*x+x,c||M.x>0&&M.x<m&&M.y>0&&M.y<v){d.activeTexture(d.TEXTURE1),d.bindTexture(d.TEXTURE_2D,u),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGB,M.x-8,M.y-8,16,16,0),d.uniform1i(l.renderType,0),d.uniform2f(l.scale,_.x,_.y),d.uniform3f(l.screenPosition,S.x,S.y,S.z),d.disable(d.BLEND),d.enable(d.DEPTH_TEST),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,h),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,M.x-8,M.y-8,16,16,0),d.uniform1i(l.renderType,1),d.disable(d.DEPTH_TEST),d.activeTexture(d.TEXTURE1),d.bindTexture(d.TEXTURE_2D,u),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),E.positionScreen.copy(S),E.customUpdateCallback?E.customUpdateCallback(E):E.updateLensFlares(),d.uniform1i(l.renderType,2),d.enable(d.BLEND);for(var k=0,A=E.lensFlares.length;A>k;k++){var P=E.lensFlares[k];P.opacity>.001&&P.scale>.001&&(S.x=P.x,S.y=P.y,S.z=P.z,w=P.size*P.scale/v,_.x=w*y,_.y=w,d.uniform3f(l.screenPosition,S.x,S.y,S.z),d.uniform2f(l.scale,_.x,_.y),d.uniform1f(l.rotation,P.rotation),d.uniform1f(l.opacity,P.opacity),d.uniform3f(l.color,P.color.r,P.color.g,P.color.b),t.state.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),t.setTexture(P.texture,1),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0))}}}d.enable(d.CULL_FACE),d.enable(d.DEPTH_TEST),d.depthMask(!0),t.resetGLState()}}},r.ShadowMapPlugin=function(t,e,n,i){function o(t,e,i){if(e.visible){var r=n[e.id];if(r&&e.castShadow&&(!1===e.frustumCulled||!0===m.intersectsObject(e)))for(var a=0,s=r.length;s>a;a++){var l=r[a];e._modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),x.push(l)}for(a=0,s=e.children.length;s>a;a++)o(t,e.children[a],i)}}function a(t,e){var n=new r.DirectionalLight;n.isVirtual=!0,n.onlyShadow=!0,n.castShadow=!0,n.shadowCameraNear=t.shadowCameraNear,n.shadowCameraFar=t.shadowCameraFar,n.shadowCameraLeft=t.shadowCameraLeft,n.shadowCameraRight=t.shadowCameraRight,n.shadowCameraBottom=t.shadowCameraBottom,n.shadowCameraTop=t.shadowCameraTop,n.shadowCameraVisible=t.shadowCameraVisible,n.shadowDarkness=t.shadowDarkness,n.shadowBias=t.shadowCascadeBias[e],n.shadowMapWidth=t.shadowCascadeWidth[e],n.shadowMapHeight=t.shadowCascadeHeight[e],n.pointsWorld=[],n.pointsFrustum=[];for(var i=n.pointsWorld,o=n.pointsFrustum,a=0;8>a;a++)i[a]=new r.Vector3,o[a]=new r.Vector3;var s=t.shadowCascadeNearZ[e],l=t.shadowCascadeFarZ[e];return o[0].set(-1,-1,s),o[1].set(1,-1,s),o[2].set(-1,1,s),o[3].set(1,1,s),o[4].set(-1,-1,l),o[5].set(1,-1,l),o[6].set(-1,1,l),o[7].set(1,1,l),n}function s(t,e){var n=t.shadowCascadeArray[e];n.position.copy(t.position),n.target.position.copy(t.target.position),n.lookAt(n.target),n.shadowCameraVisible=t.shadowCameraVisible,n.shadowDarkness=t.shadowDarkness,n.shadowBias=t.shadowCascadeBias[e];var i=t.shadowCascadeNearZ[e],r=t.shadowCascadeFarZ[e],o=n.pointsFrustum;o[0].z=i,o[1].z=i,o[2].z=i,o[3].z=i,o[4].z=r,o[5].z=r,o[6].z=r,o[7].z=r}function l(t,e){var n=e.shadowCamera,i=e.pointsFrustum,r=e.pointsWorld;g.set(1/0,1/0,1/0),y.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=r[o];a.copy(i[o]),a.unproject(t),a.applyMatrix4(n.matrixWorldInverse),a.x<g.x&&(g.x=a.x),a.x>y.x&&(y.x=a.x),a.y<g.y&&(g.y=a.y),a.y>y.y&&(y.y=a.y),a.z<g.z&&(g.z=a.z),a.z>y.z&&(y.z=a.z)}n.left=g.x,n.right=y.x,n.top=y.y,n.bottom=g.y,n.updateProjectionMatrix()}function c(t){return t.material instanceof r.MeshFaceMaterial?t.material.materials[0]:t.material}var u,h,d,f,p=t.context,m=new r.Frustum,v=new r.Matrix4,g=new r.Vector3,y=new r.Vector3,b=new r.Vector3,x=[],w=r.ShaderLib.depthRGBA,_=r.UniformsUtils.clone(w.uniforms);u=new r.ShaderMaterial({uniforms:_,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader}),h=new r.ShaderMaterial({uniforms:_,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0}),d=new r.ShaderMaterial({uniforms:_,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,skinning:!0}),f=new r.ShaderMaterial({uniforms:_,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0,skinning:!0}),u._shadowPass=!0,h._shadowPass=!0,d._shadowPass=!0,f._shadowPass=!0,this.render=function(n,g){if(!1!==t.shadowMapEnabled){var y,w,_,S,M,C,T,E,k,A,P,L,O,R=[],F=0,B=null;for(p.clearColor(1,1,1,1),p.disable(p.BLEND),p.enable(p.CULL_FACE),p.frontFace(p.CCW),t.shadowMapCullFace===r.CullFaceFront?p.cullFace(p.FRONT):p.cullFace(p.BACK),t.state.setDepthTest(!0),y=0,w=e.length;w>y;y++)if((O=e[y]).castShadow)if(O instanceof r.DirectionalLight&&O.shadowCascade)for(M=0;M<O.shadowCascadeCount;M++){var D;if(O.shadowCascadeArray[M])D=O.shadowCascadeArray[M];else{(D=a(O,M)).originalCamera=g;var I=new r.Gyroscope;I.position.copy(O.shadowCascadeOffset),I.add(D),I.add(D.target),g.add(I),O.shadowCascadeArray[M]=D}s(O,M),R[F]=D,F++}else R[F]=O,F++;for(y=0,w=R.length;w>y;y++){if(!(O=R[y]).shadowMap){var N=r.LinearFilter;t.shadowMapType===r.PCFSoftShadowMap&&(N=r.NearestFilter);var j={minFilter:N,magFilter:N,format:r.RGBAFormat};O.shadowMap=new r.WebGLRenderTarget(O.shadowMapWidth,O.shadowMapHeight,j),O.shadowMapSize=new r.Vector2(O.shadowMapWidth,O.shadowMapHeight),O.shadowMatrix=new r.Matrix4}if(!O.shadowCamera){if(O instanceof r.SpotLight)O.shadowCamera=new r.PerspectiveCamera(O.shadowCameraFov,O.shadowMapWidth/O.shadowMapHeight,O.shadowCameraNear,O.shadowCameraFar);else{if(!(O instanceof r.DirectionalLight)){r.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",O);continue}O.shadowCamera=new r.OrthographicCamera(O.shadowCameraLeft,O.shadowCameraRight,O.shadowCameraTop,O.shadowCameraBottom,O.shadowCameraNear,O.shadowCameraFar)}n.add(O.shadowCamera),!0===n.autoUpdate&&n.updateMatrixWorld()}var V,z,U;for(O.shadowCameraVisible&&!O.cameraHelper&&(O.cameraHelper=new r.CameraHelper(O.shadowCamera),n.add(O.cameraHelper)),O.isVirtual&&D.originalCamera==g&&l(g,O),C=O.shadowMap,T=O.shadowMatrix,(E=O.shadowCamera).position.setFromMatrixPosition(O.matrixWorld),b.setFromMatrixPosition(O.target.matrixWorld),E.lookAt(b),E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),O.cameraHelper&&(O.cameraHelper.visible=O.shadowCameraVisible),O.shadowCameraVisible&&O.cameraHelper.update(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(E.projectionMatrix),T.multiply(E.matrixWorldInverse),v.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),m.setFromMatrix(v),t.setRenderTarget(C),t.clear(),x.length=0,o(n,n,E),_=0,S=x.length;S>_;_++)L=(P=x[_]).object,k=P.buffer,V=c(L),z=void 0!==L.geometry.morphTargets&&L.geometry.morphTargets.length>0&&V.morphTargets,U=L instanceof r.SkinnedMesh&&V.skinning,A=L.customDepthMaterial?L.customDepthMaterial:U?z?f:d:z?h:u,t.setMaterialFaces(V),k instanceof r.BufferGeometry?t.renderBufferDirect(E,e,B,A,k,L):t.renderBuffer(E,e,B,A,k,L);for(_=0,S=i.length;S>_;_++)(L=(P=i[_]).object).visible&&L.castShadow&&(L._modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,L.matrixWorld),t.renderImmediateObject(E,e,B,u,L))}var H=t.getClearColor(),G=t.getClearAlpha();p.clearColor(H.r,H.g,H.b,G),p.enable(p.BLEND),t.shadowMapCullFace===r.CullFaceFront&&p.cullFace(p.BACK),t.resetGLState()}}},r.SpritePlugin=function(t,e){function n(){var e=h.createProgram(),n=h.createShader(h.VERTEX_SHADER),i=h.createShader(h.FRAGMENT_SHADER);return h.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),h.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),h.compileShader(n),h.compileShader(i),h.attachShader(e,n),h.attachShader(e,i),h.linkProgram(e),e}function i(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var o,a,s,l,c,u,h=t.context,d=new r.Vector3,f=new r.Quaternion,p=new r.Vector3,m=function(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);o=h.createBuffer(),a=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,o),h.bufferData(h.ARRAY_BUFFER,t,h.STATIC_DRAW),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,a),h.bufferData(h.ELEMENT_ARRAY_BUFFER,e,h.STATIC_DRAW),s=n(),l={position:h.getAttribLocation(s,"position"),uv:h.getAttribLocation(s,"uv")},c={uvOffset:h.getUniformLocation(s,"uvOffset"),uvScale:h.getUniformLocation(s,"uvScale"),rotation:h.getUniformLocation(s,"rotation"),scale:h.getUniformLocation(s,"scale"),color:h.getUniformLocation(s,"color"),map:h.getUniformLocation(s,"map"),opacity:h.getUniformLocation(s,"opacity"),modelViewMatrix:h.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:h.getUniformLocation(s,"projectionMatrix"),fogType:h.getUniformLocation(s,"fogType"),fogDensity:h.getUniformLocation(s,"fogDensity"),fogNear:h.getUniformLocation(s,"fogNear"),fogFar:h.getUniformLocation(s,"fogFar"),fogColor:h.getUniformLocation(s,"fogColor"),alphaTest:h.getUniformLocation(s,"alphaTest")};var i=document.createElement("canvas");i.width=8,i.height=8;var d=i.getContext("2d");d.fillStyle="white",d.fillRect(0,0,8,8),(u=new r.Texture(i)).needsUpdate=!0};this.render=function(n,v){if(0!==e.length){void 0===s&&m(),h.useProgram(s),h.enableVertexAttribArray(l.position),h.enableVertexAttribArray(l.uv),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.bindBuffer(h.ARRAY_BUFFER,o),h.vertexAttribPointer(l.position,2,h.FLOAT,!1,16,0),h.vertexAttribPointer(l.uv,2,h.FLOAT,!1,16,8),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,a),h.uniformMatrix4fv(c.projectionMatrix,!1,v.projectionMatrix.elements),h.activeTexture(h.TEXTURE0),h.uniform1i(c.map,0);var g=0,y=0,b=n.fog;b?(h.uniform3f(c.fogColor,b.color.r,b.color.g,b.color.b),b instanceof r.Fog?(h.uniform1f(c.fogNear,b.near),h.uniform1f(c.fogFar,b.far),h.uniform1i(c.fogType,1),g=1,y=1):b instanceof r.FogExp2&&(h.uniform1f(c.fogDensity,b.density),h.uniform1i(c.fogType,2),g=2,y=2)):(h.uniform1i(c.fogType,0),g=0,y=0);for(var x=0,w=e.length;w>x;x++){(S=e[x])._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,S.matrixWorld),S.z=-S._modelViewMatrix.elements[14]}e.sort(i);var _=[];for(x=0,w=e.length;w>x;x++){var S,M=(S=e[x]).material;h.uniform1f(c.alphaTest,M.alphaTest),h.uniformMatrix4fv(c.modelViewMatrix,!1,S._modelViewMatrix.elements),S.matrixWorld.decompose(d,f,p),_[0]=p.x,_[1]=p.y;var C=0;n.fog&&M.fog&&(C=y),g!==C&&(h.uniform1i(c.fogType,C),g=C),null!==M.map?(h.uniform2f(c.uvOffset,M.map.offset.x,M.map.offset.y),h.uniform2f(c.uvScale,M.map.repeat.x,M.map.repeat.y)):(h.uniform2f(c.uvOffset,0,0),h.uniform2f(c.uvScale,1,1)),h.uniform1f(c.opacity,M.opacity),h.uniform3f(c.color,M.color.r,M.color.g,M.color.b),h.uniform1f(c.rotation,M.rotation),h.uniform2fv(c.scale,_),t.state.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),t.state.setDepthTest(M.depthTest),t.state.setDepthWrite(M.depthWrite),M.map&&M.map.image&&M.map.image.width?t.setTexture(M.map,0):t.setTexture(u,0),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0)}h.enable(h.CULL_FACE),t.resetGLState()}}},r.GeometryUtils={merge:function(t,e,n){var i;r.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e instanceof r.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return r.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},r.ImageUtils={crossOrigin:"",loadTexture:function(t,e,n,i){var o=new r.ImageLoader;o.crossOrigin=this.crossOrigin;var a=new r.Texture(void 0,e);return o.load(t,(function(t){a.image=t,a.needsUpdate=!0,n&&n(a)}),void 0,(function(t){i&&i(t)})),a.sourceFile=t,a},loadTextureCube:function(t,e,n,i){var o=new r.ImageLoader;o.crossOrigin=this.crossOrigin;var a=new r.CubeTexture([],e);a.flipY=!1;for(var s=0,l=function(e){o.load(t[e],(function(t){a.images[e]=t,6===(s+=1)&&(a.needsUpdate=!0,n&&n(a))}),void 0,i)},c=0,u=t.length;u>c;++c)l(c);return a},loadCompressedTexture:function(){r.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){r.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(t,e){var n=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},i=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]},r=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]};e|=1;var o=t.width,a=t.height,s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(t,0,0);for(var c=l.getImageData(0,0,o,a).data,u=l.createImageData(o,a),h=u.data,d=0;o>d;d++)for(var f=0;a>f;f++){var p=0>f-1?0:f-1,m=f+1>a-1?a-1:f+1,v=0>d-1?0:d-1,g=d+1>o-1?o-1:d+1,y=[],b=[0,0,c[4*(f*o+d)]/255*e];y.push([-1,0,c[4*(f*o+v)]/255*e]),y.push([-1,-1,c[4*(p*o+v)]/255*e]),y.push([0,-1,c[4*(p*o+d)]/255*e]),y.push([1,-1,c[4*(p*o+g)]/255*e]),y.push([1,0,c[4*(f*o+g)]/255*e]),y.push([1,1,c[4*(m*o+g)]/255*e]),y.push([0,1,c[4*(m*o+d)]/255*e]),y.push([-1,1,c[4*(m*o+v)]/255*e]);for(var x=[],w=y.length,_=0;w>_;_++){var S=y[_],M=y[(_+1)%w];S=i(S,b),M=i(M,b),x.push(r(n(S,M)))}var C=[0,0,0];for(_=0;_<x.length;_++)C[0]+=x[_][0],C[1]+=x[_][1],C[2]+=x[_][2];C[0]/=x.length,C[1]/=x.length,C[2]/=x.length;var T=4*(f*o+d);h[T]=(C[0]+1)/2*255|0,h[T+1]=(C[1]+1)/2*255|0,h[T+2]=255*C[2]|0,h[T+3]=255}return l.putImageData(u,0,0),s},generateDataTexture:function(t,e,n){for(var i=t*e,o=new Uint8Array(3*i),a=Math.floor(255*n.r),s=Math.floor(255*n.g),l=Math.floor(255*n.b),c=0;i>c;c++)o[3*c]=a,o[3*c+1]=s,o[3*c+2]=l;var u=new r.DataTexture(o,t,e,r.RGBFormat);return u.needsUpdate=!0,u}},r.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new r.Object3D,i=0,o=e.length;o>i;i++)n.add(new r.Mesh(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new r.Matrix4;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},r.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(t){var e=t.familyName.toLowerCase(),n=this;return n.faces[e]=n.faces[e]||{},n.faces[e][t.cssFontWeight]=n.faces[e][t.cssFontWeight]||{},n.faces[e][t.cssFontWeight][t.cssFontStyle]=t,n.faces[e][t.cssFontWeight][t.cssFontStyle]=t,t},drawText:function(t){var e,n=this.getFace(),i=this.size/n.resolution,o=0,a=String(t).split(""),s=a.length,l=[];for(e=0;s>e;e++){var c=new r.Path,u=this.extractGlyphPoints(a[e],n,i,o,c);o+=u.offset,l.push(u.path)}return{paths:l,offset:o/2}},extractGlyphPoints:function(t,e,n,i,o){var a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M=[],C=e.glyphs[t]||e.glyphs["?"];if(C){if(C.o)for(u=(c=C._cachedOutline||(C._cachedOutline=C.o.split(" "))).length,h=n,d=n,a=0;u>a;)switch(c[a++]){case"m":f=c[a++]*h+i,p=c[a++]*d,o.moveTo(f,p);break;case"l":f=c[a++]*h+i,p=c[a++]*d,o.lineTo(f,p);break;case"q":if(m=c[a++]*h+i,v=c[a++]*d,b=c[a++]*h+i,x=c[a++]*d,o.quadraticCurveTo(b,x,m,v),S=M[M.length-1])for(g=S.x,y=S.y,s=1,l=this.divisions;l>=s;s++){var T=s/l;r.Shape.Utils.b2(T,g,b,m),r.Shape.Utils.b2(T,y,x,v)}break;case"b":if(m=c[a++]*h+i,v=c[a++]*d,b=c[a++]*h+i,x=c[a++]*d,w=c[a++]*h+i,_=c[a++]*d,o.bezierCurveTo(b,x,w,_,m,v),S=M[M.length-1])for(g=S.x,y=S.y,s=1,l=this.divisions;l>=s;s++){T=s/l;r.Shape.Utils.b3(T,g,b,w,m),r.Shape.Utils.b3(T,y,x,_,v)}}return{offset:C.ha*n,path:o}}}},r.FontUtils.generateShapes=function(t,e){var n=void 0!==(e=e||{}).size?e.size:100,i=void 0!==e.curveSegments?e.curveSegments:4,o=void 0!==e.font?e.font:"helvetiker",a=void 0!==e.weight?e.weight:"normal",s=void 0!==e.style?e.style:"normal";r.FontUtils.size=n,r.FontUtils.divisions=i,r.FontUtils.face=o,r.FontUtils.weight=a,r.FontUtils.style=s;for(var l=r.FontUtils.drawText(t).paths,c=[],u=0,h=l.length;h>u;u++)Array.prototype.push.apply(c,l[u].toShapes());return c},function(t){var e=1e-10,n=function(t){for(var e=t.length,n=0,i=e-1,r=0;e>r;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},i=function(t,n,i,r,o,a){var s,l,c,u,h,d,f,p,m,v,g,y,b,x,w;if(l=t[a[n]].x,c=t[a[n]].y,u=t[a[i]].x,h=t[a[i]].y,d=t[a[r]].x,f=t[a[r]].y,e>(u-l)*(f-c)-(h-c)*(d-l))return!1;for(v=d-u,g=f-h,y=l-d,b=c-f,x=u-l,w=h-c,s=0;o>s;s++)if(p=t[a[s]].x,m=t[a[s]].y,!(p===l&&m===c||p===u&&m===h||p===d&&m===f)&&(v*(m-h)-g*(p-u)>=-e&&y*(m-f)-b*(p-d)>=-e&&x*(m-c)-w*(p-l)>=-e))return!1;return!0};t.Triangulate=function(t,e){var o=t.length;if(3>o)return null;var a,s,l,c=[],u=[],h=[];if(n(t)>0)for(s=0;o>s;s++)u[s]=s;else for(s=0;o>s;s++)u[s]=o-1-s;var d=o,f=2*d;for(s=d-1;d>2;){if(f--<=0)return r.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),e?h:c;if((a=s)>=d&&(a=0),(s=a+1)>=d&&(s=0),(l=s+1)>=d&&(l=0),i(t,a,s,l,d,u)){var p,m,v,g,y;for(p=u[a],m=u[s],v=u[l],c.push([t[p],t[m],t[v]]),h.push([u[a],u[s],u[l]]),g=s,y=s+1;d>y;g++,y++)u[g]=u[y];f=2*--d}}return e?h:c},t.Triangulate.area=n}(r.FontUtils),i._typeface_js={faces:r.FontUtils.faces,loadFace:r.FontUtils.loadFace},r.typeface_js=i._typeface_js,r.Audio=function(t){r.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.isPlaying=!1},r.Audio.prototype=Object.create(r.Object3D.prototype),r.Audio.prototype.constructor=r.Audio,r.Audio.prototype.load=function(t){var e=this,n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(t){e.context.decodeAudioData(this.response,(function(t){e.source.buffer=t,e.autoplay&&e.play()}))},n.send(),this},r.Audio.prototype.play=function(){if(!0!==this.isPlaying){var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.connect(this.panner),t.start(0,this.startTime),this.isPlaying=!0,this.source=t}else r.warn("THREE.Audio: Audio is already playing.")},r.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},r.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},r.Audio.prototype.onEnded=function(){this.isPlaying=!1},r.Audio.prototype.setLoop=function(t){this.source.loop=t},r.Audio.prototype.setRefDistance=function(t){this.panner.refDistance=t},r.Audio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},r.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},r.Audio.prototype.updateMatrixWorld=function(){var t=new r.Vector3;return function(e){r.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),r.AudioListener=function(){r.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},r.AudioListener.prototype=Object.create(r.Object3D.prototype),r.AudioListener.prototype.constructor=r.AudioListener,r.AudioListener.prototype.updateMatrixWorld=function(){var t=new r.Vector3,e=new r.Quaternion,n=new r.Vector3,i=new r.Vector3,o=new r.Vector3,a=new r.Vector3;return function(s){r.Object3D.prototype.updateMatrixWorld.call(this,s);var l=this.context.listener,c=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),o.subVectors(t,a),l.setPosition(t.x,t.y,t.z),l.setOrientation(i.x,i.y,i.z,c.x,c.y,c.z),l.setVelocity(o.x,o.y,o.z),a.copy(t)}}(),r.Curve=function(){},r.Curve.prototype.getPoint=function(t){return r.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},r.Curve.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},r.Curve.prototype.getPoints=function(t){t||(t=5);var e,n=[];for(e=0;t>=e;e++)n.push(this.getPoint(e/t));return n},r.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,n=[];for(e=0;t>=e;e++)n.push(this.getPointAt(e/t));return n},r.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},r.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;t>=n;n++)o+=(e=this.getPoint(n/t)).distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i,i},r.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},r.Curve.prototype.getUtoTmapping=function(t,e){var n,i=this.getLengths(),r=0,o=i.length;n=e||t*i[o-1];for(var a,s=0,l=o-1;l>=s;)if(0>(a=i[r=Math.floor(s+(l-s)/2)]-n))s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(i[r=l]==n)return r/(o-1);var c=i[r];return(r+(n-c)/(i[r+1]-c))/(o-1)},r.Curve.prototype.getTangent=function(t){var e=1e-4,n=t-e,i=t+e;0>n&&(n=0),i>1&&(i=1);var r=this.getPoint(n);return this.getPoint(i).clone().sub(r).normalize()},r.Curve.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},r.Curve.Utils={tangentQuadraticBezier:function(t,e,n,i){return 2*(1-t)*(n-e)+2*t*(i-n)},tangentCubicBezier:function(t,e,n,i,r){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*r},tangentSpline:function(t,e,n,i,r){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,n,i,r){var o=.5*(n-t),a=.5*(i-e),s=r*r;return(2*e-2*n+o+a)*(r*s)+(-3*e+3*n-2*o-a)*s+o*r+e}},r.Curve.create=function(t,e){return t.prototype=Object.create(r.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},r.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},r.CurvePath.prototype=Object.create(r.Curve.prototype),r.CurvePath.prototype.constructor=r.CurvePath,r.CurvePath.prototype.add=function(t){this.curves.push(t)},r.CurvePath.prototype.checkConnection=function(){},r.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new r.LineCurve(e,t))},r.CurvePath.prototype.getPoint=function(t){for(var e,n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var o=1-(i[r]-n)/(e=this.curves[r]).getLength();return e.getPointAt(o)}r++}return null},r.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},r.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t,e=[],n=0,i=this.curves.length;for(t=0;i>t;t++)n+=this.curves[t].getLength(),e.push(n);return this.cacheLengths=e,e},r.CurvePath.prototype.getBoundingBox=function(){var t,e,n,i,o,a,s=this.getPoints();t=e=Number.NEGATIVE_INFINITY,i=o=Number.POSITIVE_INFINITY;var l,c,u,h,d=s[0]instanceof r.Vector3;for(h=d?new r.Vector3:new r.Vector2,c=0,u=s.length;u>c;c++)(l=s[c]).x>t?t=l.x:l.x<i&&(i=l.x),l.y>e?e=l.y:l.y<o&&(o=l.y),d&&(l.z>n?n=l.z:l.z<a&&(a=l.z)),h.add(l);var f={minX:i,minY:o,maxX:t,maxY:e};return d&&(f.maxZ=n,f.minZ=a),f},r.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t,!0);return this.createGeometry(e)},r.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t,!0);return this.createGeometry(e)},r.CurvePath.prototype.createGeometry=function(t){for(var e=new r.Geometry,n=0;n<t.length;n++)e.vertices.push(new r.Vector3(t[n].x,t[n].y,t[n].z||0));return e},r.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},r.CurvePath.prototype.getTransformedPoints=function(t,e){var n,i,r=this.getPoints(t);for(e||(e=this.bends),n=0,i=e.length;i>n;n++)r=this.getWrapPoints(r,e[n]);return r},r.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var n,i,r=this.getSpacedPoints(t);for(e||(e=this.bends),n=0,i=e.length;i>n;n++)r=this.getWrapPoints(r,e[n]);return r},r.CurvePath.prototype.getWrapPoints=function(t,e){var n,i,r,o,a,s,l=this.getBoundingBox();for(n=0,i=t.length;i>n;n++){o=(r=t[n]).x,a=r.y,s=o/l.maxX,s=e.getUtoTmapping(s,o);var c=e.getPoint(s),u=e.getTangent(s);u.set(-u.y,u.x).multiplyScalar(a),r.x=c.x+u.x,r.y=c.y+u.y}return t},r.Gyroscope=function(){r.Object3D.call(this)},r.Gyroscope.prototype=Object.create(r.Object3D.prototype),r.Gyroscope.prototype.constructor=r.Gyroscope,r.Gyroscope.prototype.updateMatrixWorld=function(){var t=new r.Vector3,e=new r.Quaternion,n=new r.Vector3,i=new r.Vector3,o=new r.Quaternion,a=new r.Vector3;return function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(i,o,a),this.matrix.decompose(t,e,n),this.matrixWorld.compose(i,e,a)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);for(var s=0,l=this.children.length;l>s;s++)this.children[s].updateMatrixWorld(r)}}(),r.Path=function(t){r.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},r.Path.prototype=Object.create(r.CurvePath.prototype),r.Path.prototype.constructor=r.Path,r.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},r.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;n>e;e++)this.lineTo(t[e].x,t[e].y)},r.Path.prototype.moveTo=function(t,e){var n=Array.prototype.slice.call(arguments);this.actions.push({action:r.PathActions.MOVE_TO,args:n})},r.Path.prototype.lineTo=function(t,e){var n=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,o=i[i.length-2],a=i[i.length-1],s=new r.LineCurve(new r.Vector2(o,a),new r.Vector2(t,e));this.curves.push(s),this.actions.push({action:r.PathActions.LINE_TO,args:n})},r.Path.prototype.quadraticCurveTo=function(t,e,n,i){var o=Array.prototype.slice.call(arguments),a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1],c=new r.QuadraticBezierCurve(new r.Vector2(s,l),new r.Vector2(t,e),new r.Vector2(n,i));this.curves.push(c),this.actions.push({action:r.PathActions.QUADRATIC_CURVE_TO,args:o})},r.Path.prototype.bezierCurveTo=function(t,e,n,i,o,a){var s=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,c=l[l.length-2],u=l[l.length-1],h=new r.CubicBezierCurve(new r.Vector2(c,u),new r.Vector2(t,e),new r.Vector2(n,i),new r.Vector2(o,a));this.curves.push(h),this.actions.push({action:r.PathActions.BEZIER_CURVE_TO,args:s})},r.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],o=n[n.length-1],a=[new r.Vector2(i,o)];Array.prototype.push.apply(a,t);var s=new r.SplineCurve(a);this.curves.push(s),this.actions.push({action:r.PathActions.CSPLINE_THRU,args:e})},r.Path.prototype.arc=function(t,e,n,i,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(t+s,e+l,n,i,r,o)},r.Path.prototype.absarc=function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},r.Path.prototype.ellipse=function(t,e,n,i,r,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],c=s[s.length-1];this.absellipse(t+l,e+c,n,i,r,o,a)},r.Path.prototype.absellipse=function(t,e,n,i,o,a,s){var l=Array.prototype.slice.call(arguments),c=new r.EllipseCurve(t,e,n,i,o,a,s);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:r.PathActions.ELLIPSE,args:l})},r.Path.prototype.getSpacedPoints=function(t,e){t||(t=40);for(var n=[],i=0;t>i;i++)n.push(this.getPoint(i/t));return n},r.Path.prototype.getPoints=function(t,e){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(t,e);t=t||12;var n,i,o,a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w=[];for(n=0,i=this.actions.length;i>n;n++)switch(o=this.actions[n],a=o.action,s=o.args,a){case r.PathActions.MOVE_TO:case r.PathActions.LINE_TO:w.push(new r.Vector2(s[0],s[1]));break;case r.PathActions.QUADRATIC_CURVE_TO:for(l=s[2],c=s[3],d=s[0],f=s[1],w.length>0?(p=(v=w[w.length-1]).x,m=v.y):(p=(v=this.actions[n-1].args)[v.length-2],m=v[v.length-1]),g=1;t>=g;g++)y=g/t,b=r.Shape.Utils.b2(y,p,d,l),x=r.Shape.Utils.b2(y,m,f,c),w.push(new r.Vector2(b,x));break;case r.PathActions.BEZIER_CURVE_TO:for(l=s[4],c=s[5],d=s[0],f=s[1],u=s[2],h=s[3],w.length>0?(p=(v=w[w.length-1]).x,m=v.y):(p=(v=this.actions[n-1].args)[v.length-2],m=v[v.length-1]),g=1;t>=g;g++)y=g/t,b=r.Shape.Utils.b3(y,p,d,u,l),x=r.Shape.Utils.b3(y,m,f,h,c),w.push(new r.Vector2(b,x));break;case r.PathActions.CSPLINE_THRU:v=this.actions[n-1].args;var _=[new r.Vector2(v[v.length-2],v[v.length-1])],S=t*s[0].length;_=_.concat(s[0]);var M=new r.SplineCurve(_);for(g=1;S>=g;g++)w.push(M.getPointAt(g/S));break;case r.PathActions.ARC:var C=s[0],T=s[1],E=s[2],k=s[3],A=s[4],P=!!s[5],L=A-k,O=2*t;for(g=1;O>=g;g++)y=g/O,P||(y=1-y),R=k+y*L,b=C+E*Math.cos(R),x=T+E*Math.sin(R),w.push(new r.Vector2(b,x));break;case r.PathActions.ELLIPSE:C=s[0],T=s[1];var R,F=s[2],B=s[3];k=s[4],A=s[5],P=!!s[6],L=A-k,O=2*t;for(g=1;O>=g;g++)y=g/O,P||(y=1-y),R=k+y*L,b=C+F*Math.cos(R),x=T+B*Math.sin(R),w.push(new r.Vector2(b,x))}var D=w[w.length-1];return Math.abs(D.x-w[0].x)<1e-10&&Math.abs(D.y-w[0].y)<1e-10&&w.splice(w.length-1,1),e&&w.push(w[0]),w},r.Path.prototype.toShapes=function(t,e){function n(t){for(var e=[],n=0,i=t.length;i>n;n++){var o=t[n],a=new r.Shape;a.actions=o.actions,a.curves=o.curves,e.push(a)}return e}function i(t,e){for(var n=e.length,i=!1,r=n-1,o=0;n>o;r=o++){var a=e[r],s=e[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>1e-10){if(0>c&&(a=e[o],l=-l,s=e[r],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y==a.y){if(t.x==a.x)return!0}else{var u=c*(t.x-a.x)-l*(t.y-a.y);if(0==u)return!0;if(0>u)continue;i=!i}}else{if(t.y!=a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return i}var o=function(t){var e,n,i,o,a,s=[],l=new r.Path;for(e=0,n=t.length;n>e;e++)a=(i=t[e]).args,(o=i.action)==r.PathActions.MOVE_TO&&0!=l.actions.length&&(s.push(l),l=new r.Path),l[o].apply(l,a);return 0!=l.actions.length&&s.push(l),s}(this.actions);if(0==o.length)return[];if(!0===e)return n(o);var a,s,l,c=[];if(1==o.length)return s=o[0],(l=new r.Shape).actions=s.actions,l.curves=s.curves,c.push(l),c;var u=!r.Shape.Utils.isClockWise(o[0].getPoints());u=t?!u:u;var h,d,f,p,m,v,g=[],y=[],b=[],x=0;for(y[x]=void 0,b[x]=[],d=0,f=o.length;f>d;d++)h=(s=o[d]).getPoints(),a=r.Shape.Utils.isClockWise(h),(a=t?!a:a)?(!u&&y[x]&&x++,y[x]={s:new r.Shape,p:h},y[x].s.actions=s.actions,y[x].s.curves=s.curves,u&&x++,b[x]=[]):b[x].push({h:s,p:h[0]});if(!y[0])return n(o);if(y.length>1){for(var w=!1,_=[],S=0,M=y.length;M>S;S++)g[S]=[];for(S=0,M=y.length;M>S;S++)for(var C=b[S],T=0;T<C.length;T++){for(var E=C[T],k=!0,A=0;A<y.length;A++)i(E.p,y[A].p)&&(S!=A&&_.push({froms:S,tos:A,hole:T}),k?(k=!1,g[A].push(E)):w=!0);k&&g[S].push(E)}_.length>0&&(w||(b=g))}for(d=0,f=y.length;f>d;d++)for(l=y[d].s,c.push(l),m=0,v=(p=b[d]).length;v>m;m++)l.holes.push(p[m].h);return c},r.Shape=function(){r.Path.apply(this,arguments),this.holes=[]},r.Shape.prototype=Object.create(r.Path.prototype),r.Shape.prototype.constructor=r.Shape,r.Shape.prototype.extrude=function(t){return new r.ExtrudeGeometry(this,t)},r.Shape.prototype.makeGeometry=function(t){return new r.ShapeGeometry(this,t)},r.Shape.prototype.getPointsHoles=function(t){var e,n=this.holes.length,i=[];for(e=0;n>e;e++)i[e]=this.holes[e].getTransformedPoints(t,this.bends);return i},r.Shape.prototype.getSpacedPointsHoles=function(t){var e,n=this.holes.length,i=[];for(e=0;n>e;e++)i[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return i},r.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},r.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},r.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},r.Shape.Utils={triangulateShape:function(t,e){function n(t,e,n){return t.x!=e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function i(t,e,i,r,o){var a=e.x-t.x,s=e.y-t.y,l=r.x-i.x,c=r.y-i.y,u=t.x-i.x,h=t.y-i.y,d=s*l-a*c,f=s*u-a*h;if(Math.abs(d)>1e-10){var p;if(d>0){if(0>f||f>d)return[];if(0>(p=c*u-l*h)||p>d)return[]}else{if(f>0||d>f)return[];if((p=c*u-l*h)>0||d>p)return[]}if(0==p)return!o||0!=f&&f!=d?[t]:[];if(p==d)return!o||0!=f&&f!=d?[e]:[];if(0==f)return[i];if(f==d)return[r];var m=p/d;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!=f||c*u!=l*h)return[];var v,g,y,b,x,w,_,S,M=0==a&&0==s,C=0==l&&0==c;return M&&C?t.x!=i.x||t.y!=i.y?[]:[t]:M?n(i,r,t)?[t]:[]:C?n(t,e,i)?[i]:[]:(0!=a?(t.x<e.x?(v=t,y=t.x,g=e,b=e.x):(v=e,y=e.x,g=t,b=t.x),i.x<r.x?(x=i,_=i.x,w=r,S=r.x):(x=r,_=r.x,w=i,S=i.x)):(t.y<e.y?(v=t,y=t.y,g=e,b=e.y):(v=e,y=e.y,g=t,b=t.y),i.y<r.y?(x=i,_=i.y,w=r,S=r.y):(x=r,_=r.y,w=i,S=i.y)),_>=y?_>b?[]:b==_?o?[]:[x]:S>=b?[x,g]:[x,w]:y>S?[]:y==S?o?[]:[v]:S>=b?[v,g]:[v,w])}function o(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=n.x-t.x,s=n.y-t.y,l=i.x-t.x,c=i.y-t.y,u=r*s-o*a,h=r*c-o*l;if(Math.abs(u)>1e-10){var d=l*s-c*a;return u>0?h>=0&&d>=0:h>=0||d>=0}return h>0}for(var a,s,l,c,u,h,d={},f=t.concat(),p=0,m=e.length;m>p;p++)Array.prototype.push.apply(f,e[p]);for(a=0,s=f.length;s>a;a++)void 0!==d[u=f[a].x+":"+f[a].y]&&r.warn("THREE.Shape: Duplicate point",u),d[u]=a;var v=function(t,e){function n(t,e){var n=y.length-1,i=t-1;0>i&&(i=n);var r=t+1;r>n&&(r=0);var a=o(y[t],y[i],y[r],s[e]);if(!a)return!1;var l=s.length-1,c=e-1;0>c&&(c=l);var u=e+1;return u>l&&(u=0),!!(a=o(s[e],s[c],s[u],y[t]))}function r(t,e){var n,r;for(n=0;n<y.length;n++)if(r=n+1,r%=y.length,i(t,e,y[n],y[r],!0).length>0)return!0;return!1}function a(t,n){var r,o,a,s;for(r=0;r<b.length;r++)for(o=e[b[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,i(t,n,o[a],o[s],!0).length>0)return!0;return!1}for(var s,l,c,u,h,d,f,p,m,v,g,y=t.concat(),b=[],x=[],w=0,_=e.length;_>w;w++)b.push(w);for(var S=0,M=2*b.length;b.length>0;){if(0>--M){console.log("Infinite Loop! Holes left:"+b.length+", Probably Hole outside Shape!");break}for(c=S;c<y.length;c++){u=y[c],l=-1;for(w=0;w<b.length;w++)if(d=b[w],void 0===x[f=u.x+":"+u.y+":"+d]){s=e[d];for(var C=0;C<s.length;C++)if(h=s[C],n(c,C)&&!r(u,h)&&!a(u,h)){l=C,b.splice(w,1),p=y.slice(0,c+1),m=y.slice(c),v=s.slice(l),g=s.slice(0,l+1),y=p.concat(v).concat(g).concat(m),S=c;break}if(l>=0)break;x[f]=!0}if(l>=0)break}}return y}(t,e),g=r.FontUtils.Triangulate(v,!1);for(a=0,s=g.length;s>a;a++)for(c=g[a],l=0;3>l;l++)void 0!==(h=d[u=c[l].x+":"+c[l].y])&&(c[l]=h);return g.concat()},isClockWise:function(t){return r.FontUtils.Triangulate.area(t)<0},b2p0:function(t,e){var n=1-t;return n*n*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,n,i){return this.b2p0(t,e)+this.b2p1(t,n)+this.b2p2(t,i)},b3p0:function(t,e){var n=1-t;return n*n*n*e},b3p1:function(t,e){var n=1-t;return 3*n*n*t*e},b3p2:function(t,e){return 3*(1-t)*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,n,i,r){return this.b3p0(t,e)+this.b3p1(t,n)+this.b3p2(t,i)+this.b3p3(t,r)}},r.LineCurve=function(t,e){this.v1=t,this.v2=e},r.LineCurve.prototype=Object.create(r.Curve.prototype),r.LineCurve.prototype.constructor=r.LineCurve,r.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},r.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},r.LineCurve.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},r.QuadraticBezierCurve=function(t,e,n){this.v0=t,this.v1=e,this.v2=n},r.QuadraticBezierCurve.prototype=Object.create(r.Curve.prototype),r.QuadraticBezierCurve.prototype.constructor=r.QuadraticBezierCurve,r.QuadraticBezierCurve.prototype.getPoint=function(t){var e=new r.Vector2;return e.x=r.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=r.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e},r.QuadraticBezierCurve.prototype.getTangent=function(t){var e=new r.Vector2;return e.x=r.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),e.y=r.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y),e.normalize()},r.CubicBezierCurve=function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},r.CubicBezierCurve.prototype=Object.create(r.Curve.prototype),r.CubicBezierCurve.prototype.constructor=r.CubicBezierCurve,r.CubicBezierCurve.prototype.getPoint=function(t){var e,n;return e=r.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=r.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new r.Vector2(e,n)},r.CubicBezierCurve.prototype.getTangent=function(t){var e,n;e=r.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=r.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var i=new r.Vector2(e,n);return i.normalize(),i},r.SplineCurve=function(t){this.points=null==t?[]:t},r.SplineCurve.prototype=Object.create(r.Curve.prototype),r.SplineCurve.prototype.constructor=r.SplineCurve,r.SplineCurve.prototype.getPoint=function(t){var e=this.points,n=(e.length-1)*t,i=Math.floor(n),o=n-i,a=e[0==i?i:i-1],s=e[i],l=e[i>e.length-2?e.length-1:i+1],c=e[i>e.length-3?e.length-1:i+2],u=new r.Vector2;return u.x=r.Curve.Utils.interpolate(a.x,s.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(a.y,s.y,l.y,c.y,o),u},r.EllipseCurve=function(t,e,n,i,r,o,a){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},r.EllipseCurve.prototype=Object.create(r.Curve.prototype),r.EllipseCurve.prototype.constructor=r.EllipseCurve,r.EllipseCurve.prototype.getPoint=function(t){var e,n=this.aEndAngle-this.aStartAngle;0>n&&(n+=2*Math.PI),n>2*Math.PI&&(n-=2*Math.PI),e=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-n):this.aStartAngle+t*n;var i=new r.Vector2;return i.x=this.aX+this.xRadius*Math.cos(e),i.y=this.aY+this.yRadius*Math.sin(e),i},r.ArcCurve=function(t,e,n,i,o,a){r.EllipseCurve.call(this,t,e,n,n,i,o,a)},r.ArcCurve.prototype=Object.create(r.EllipseCurve.prototype),r.ArcCurve.prototype.constructor=r.ArcCurve,r.LineCurve3=r.Curve.create((function(t,e){this.v1=t,this.v2=e}),(function(t){var e=new r.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e})),r.QuadraticBezierCurve3=r.Curve.create((function(t,e,n){this.v0=t,this.v1=e,this.v2=n}),(function(t){var e=new r.Vector3;return e.x=r.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=r.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e.z=r.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),e})),r.CubicBezierCurve3=r.Curve.create((function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}),(function(t){var e=new r.Vector3;return e.x=r.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e.y=r.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e.z=r.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),e})),r.SplineCurve3=r.Curve.create((function(t){this.points=null==t?[]:t}),(function(t){var e=this.points,n=(e.length-1)*t,i=Math.floor(n),o=n-i,a=e[0==i?i:i-1],s=e[i],l=e[i>e.length-2?e.length-1:i+1],c=e[i>e.length-3?e.length-1:i+2],u=new r.Vector3;return u.x=r.Curve.Utils.interpolate(a.x,s.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(a.y,s.y,l.y,c.y,o),u.z=r.Curve.Utils.interpolate(a.z,s.z,l.z,c.z,o),u})),r.ClosedSplineCurve3=r.Curve.create((function(t){this.points=null==t?[]:t}),(function(t){var e=this.points,n=(e.length-0)*t,i=Math.floor(n),o=n-i,a=e[((i+=i>0?0:(Math.floor(Math.abs(i)/e.length)+1)*e.length)-1)%e.length],s=e[i%e.length],l=e[(i+1)%e.length],c=e[(i+2)%e.length],u=new r.Vector3;return u.x=r.Curve.Utils.interpolate(a.x,s.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(a.y,s.y,l.y,c.y,o),u.z=r.Curve.Utils.interpolate(a.z,s.z,l.z,c.z,o),u})),r.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){r.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){r.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){r.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(t){if(!0===t.initialized)return t;for(var e=0;e<t.hierarchy.length;e++){for(var n=0;n<t.hierarchy[e].keys.length;n++)if(t.hierarchy[e].keys[n].time<0&&(t.hierarchy[e].keys[n].time=0),void 0!==t.hierarchy[e].keys[n].rot&&!(t.hierarchy[e].keys[n].rot instanceof r.Quaternion)){var i=t.hierarchy[e].keys[n].rot;t.hierarchy[e].keys[n].rot=(new r.Quaternion).fromArray(i)}if(t.hierarchy[e].keys.length&&void 0!==t.hierarchy[e].keys[0].morphTargets){var o={};for(n=0;n<t.hierarchy[e].keys.length;n++)for(var a=0;a<t.hierarchy[e].keys[n].morphTargets.length;a++){o[l=t.hierarchy[e].keys[n].morphTargets[a]]=-1}t.hierarchy[e].usedMorphTargets=o;for(n=0;n<t.hierarchy[e].keys.length;n++){var s={};for(var l in o){for(a=0;a<t.hierarchy[e].keys[n].morphTargets.length;a++)if(t.hierarchy[e].keys[n].morphTargets[a]===l){s[l]=t.hierarchy[e].keys[n].morphTargetsInfluences[a];break}a===t.hierarchy[e].keys[n].morphTargets.length&&(s[l]=0)}t.hierarchy[e].keys[n].morphTargetsInfluences=s}}for(n=1;n<t.hierarchy[e].keys.length;n++)t.hierarchy[e].keys[n].time===t.hierarchy[e].keys[n-1].time&&(t.hierarchy[e].keys.splice(n,1),n--);for(n=0;n<t.hierarchy[e].keys.length;n++)t.hierarchy[e].keys[n].index=n}return t.initialized=!0,t},parse:function(t){var e=function(t,n){n.push(t);for(var i=0;i<t.children.length;i++)e(t.children[i],n)},n=[];if(t instanceof r.SkinnedMesh)for(var i=0;i<t.skeleton.bones.length;i++)n.push(t.skeleton.bones[i]);else e(t,n);return n},play:function(t){-1===this.animations.indexOf(t)&&this.animations.push(t)},stop:function(t){var e=this.animations.indexOf(t);-1!==e&&this.animations.splice(e,1)},update:function(t){for(var e=0;e<this.animations.length;e++)this.animations[e].resetBlendWeights();for(e=0;e<this.animations.length;e++)this.animations[e].update(t)}},r.Animation=function(t,e){this.root=t,this.data=r.AnimationHandler.init(e),this.hierarchy=r.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=r.AnimationHandler.LINEAR},r.Animation.prototype={constructor:r.Animation,keyTypes:["pos","rot","scl"],play:function(t,e){this.currentTime=void 0!==t?t:0,this.weight=void 0!==e?e:1,this.isPlaying=!0,this.reset(),r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,r.AnimationHandler.stop(this)},reset:function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var n=this.hierarchy[t];void 0===n.animationCache&&(n.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var i=this.data.name,r=n.animationCache.animations,o=r[i];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:n.matrix},r[i]=o);for(var a=0;3>a;a++){for(var s=this.keyTypes[a],l=this.data.hierarchy[t].keys[0],c=this.getNextKeyWith(s,t,1);c.time<this.currentTime&&c.index>l.index;)l=c,c=this.getNextKeyWith(s,t,c.index+1);o.prevKey[s]=l,o.nextKey[s]=c}}},resetBlendWeights:function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var n=this.hierarchy[t].animationCache;if(void 0!==n){var i=n.blending;i.positionWeight=0,i.quaternionWeight=0,i.scaleWeight=0}}},update:function(){var t=[],e=new r.Vector3,n=new r.Vector3,i=new r.Quaternion,o=function(t,e){var n,i,r,o,s,l,c,u,h,d=[],f=[];return r=(n=(t.length-1)*e)-(i=Math.floor(n)),d[0]=0===i?i:i-1,d[1]=i,d[2]=i>t.length-2?i:i+1,d[3]=i>t.length-3?i:i+2,l=t[d[0]],c=t[d[1]],u=t[d[2]],h=t[d[3]],s=r*(o=r*r),f[0]=a(l[0],c[0],u[0],h[0],r,o,s),f[1]=a(l[1],c[1],u[1],h[1],r,o,s),f[2]=a(l[2],c[2],u[2],h[2],r,o,s),f},a=function(t,e,n,i,r,o,a){var s=.5*(n-t),l=.5*(i-e);return(2*(e-n)+s+l)*a+(-3*(e-n)-2*s-l)*o+s*r+e};return function(a){if(!1!==this.isPlaying&&(this.currentTime+=a*this.timeScale,0!==this.weight)){var s=this.data.length;(this.currentTime>s||this.currentTime<0)&&(this.loop?(this.currentTime%=s,this.currentTime<0&&(this.currentTime+=s),this.reset()):this.stop());for(var l=0,c=this.hierarchy.length;c>l;l++)for(var u=this.hierarchy[l],h=u.animationCache.animations[this.data.name],d=u.animationCache.blending,f=0;3>f;f++){var p=this.keyTypes[f],m=h.prevKey[p],v=h.nextKey[p];if(this.timeScale>0&&v.time<=this.currentTime||this.timeScale<0&&m.time>=this.currentTime){for(m=this.data.hierarchy[l].keys[0],v=this.getNextKeyWith(p,l,1);v.time<this.currentTime&&v.index>m.index;)m=v,v=this.getNextKeyWith(p,l,v.index+1);h.prevKey[p]=m,h.nextKey[p]=v}var g=(this.currentTime-m.time)/(v.time-m.time),y=m[p],b=v[p];if(0>g&&(g=0),g>1&&(g=1),"pos"===p){if(this.interpolationType===r.AnimationHandler.LINEAR){n.x=y[0]+(b[0]-y[0])*g,n.y=y[1]+(b[1]-y[1])*g,n.z=y[2]+(b[2]-y[2])*g;var x=this.weight/(this.weight+d.positionWeight);u.position.lerp(n,x),d.positionWeight+=this.weight}else if(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){t[0]=this.getPrevKeyWith("pos",l,m.index-1).pos,t[1]=y,t[2]=b,t[3]=this.getNextKeyWith("pos",l,v.index+1).pos;var w=o(t,g=.33*g+.33);x=this.weight/(this.weight+d.positionWeight);d.positionWeight+=this.weight;var _=u.position;if(_.x=_.x+(w[0]-_.x)*x,_.y=_.y+(w[1]-_.y)*x,_.z=_.z+(w[2]-_.z)*x,this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){var S=o(t,1.01*g);e.set(S[0],S[1],S[2]),e.sub(_),e.y=0,e.normalize();var M=Math.atan2(e.x,e.z);u.rotation.set(0,M,0)}}}else if("rot"===p)if(r.Quaternion.slerp(y,b,i,g),0===d.quaternionWeight)u.quaternion.copy(i),d.quaternionWeight=this.weight;else{x=this.weight/(this.weight+d.quaternionWeight);r.Quaternion.slerp(u.quaternion,i,u.quaternion,x),d.quaternionWeight+=this.weight}else if("scl"===p){n.x=y[0]+(b[0]-y[0])*g,n.y=y[1]+(b[1]-y[1])*g,n.z=y[2]+(b[2]-y[2])*g;x=this.weight/(this.weight+d.scaleWeight);u.scale.lerp(n,x),d.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(t,e,n){var i=this.data.hierarchy[e].keys;for(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?n=n<i.length-1?n:i.length-1:n%=i.length;n<i.length;n++)if(void 0!==i[n][t])return i[n];return this.data.hierarchy[e].keys[0]},getPrevKeyWith:function(t,e,n){var i=this.data.hierarchy[e].keys;for(n=this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+i.length;n>=0;n--)if(void 0!==i[n][t])return i[n];return this.data.hierarchy[e].keys[i.length-1]}},r.KeyFrameAnimation=function(t){this.root=t.node,this.data=r.AnimationHandler.init(t),this.hierarchy=r.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var e=0,n=this.hierarchy.length;n>e;e++){var i=this.data.hierarchy[e].keys,o=this.data.hierarchy[e].sids,a=this.hierarchy[e];if(i.length&&o){for(var s=0;s<o.length;s++){var l=o[s],c=this.getNextKeyWith(l,e,0);c&&c.apply(l)}a.matrixAutoUpdate=!1,this.data.hierarchy[e].node.updateMatrix(),a.matrixWorldNeedsUpdate=!0}}},r.KeyFrameAnimation.prototype={constructor:r.KeyFrameAnimation,play:function(t){if(this.currentTime=void 0!==t?t:0,!1===this.isPlaying){this.isPlaying=!0;var e,n,i,o=this.hierarchy.length;for(e=0;o>e;e++){n=this.hierarchy[e],void 0===(i=this.data.hierarchy[e]).animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=n.matrix);var a=this.data.hierarchy[e].keys;a.length&&(i.animationCache.prevKey=a[0],i.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,r.AnimationHandler.stop(this);for(var t=0;t<this.data.hierarchy.length;t++){var e=this.hierarchy[t],n=this.data.hierarchy[t];if(void 0!==n.animationCache){var i=n.animationCache.originalMatrix;i.copy(e.matrix),e.matrix=i,delete n.animationCache}}},update:function(t){if(!1!==this.isPlaying){this.currentTime+=t*this.timeScale;var e=this.data.length;!0===this.loop&&this.currentTime>e&&(this.currentTime%=e),this.currentTime=Math.min(this.currentTime,e);for(var n=0,i=this.hierarchy.length;i>n;n++){var r=this.hierarchy[n],o=this.data.hierarchy[n],a=o.keys,s=o.animationCache;if(a.length){var l=s.prevKey,c=s.nextKey;if(c.time<=this.currentTime){for(;c.time<this.currentTime&&c.index>l.index;)c=a[(l=c).index+1];s.prevKey=l,s.nextKey=c}c.time>=this.currentTime?l.interpolate(c,this.currentTime):l.interpolate(c,c.time),this.data.hierarchy[n].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(t,e,n){var i=this.data.hierarchy[e].keys;for(n%=i.length;n<i.length;n++)if(i[n].hasTarget(t))return i[n];return i[0]},getPrevKeyWith:function(t,e,n){var i=this.data.hierarchy[e].keys;for(n=n>=0?n:n+i.length;n>=0;n--)if(i[n].hasTarget(t))return i[n];return i[i.length-1]}},r.MorphAnimation=function(t){this.mesh=t,this.frames=t.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},r.MorphAnimation.prototype={constructor:r.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(t){if(!1!==this.isPlaying){this.currentTime+=t,!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var e=this.duration/this.frames,n=Math.floor(this.currentTime/e),i=this.mesh.morphTargetInfluences;n!=this.currentFrame&&(i[this.lastFrame]=0,i[this.currentFrame]=1,i[n]=0,this.lastFrame=this.currentFrame,this.currentFrame=n),i[n]=this.currentTime%e/e,i[this.lastFrame]=1-i[n]}}},r.BoxGeometry=function(t,e,n,i,o,a){function s(t,e,n,i,o,a,s,c){var u,h,d,f=l.widthSegments,p=l.heightSegments,m=o/2,v=a/2,g=l.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?u="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(u="y",p=l.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(u="x",f=l.depthSegments);var y=f+1,b=p+1,x=o/f,w=a/p,_=new r.Vector3;for(_[u]=s>0?1:-1,d=0;b>d;d++)for(h=0;y>h;h++){var S=new r.Vector3;S[t]=(h*x-m)*n,S[e]=(d*w-v)*i,S[u]=s,l.vertices.push(S)}for(d=0;p>d;d++)for(h=0;f>h;h++){var M=h+y*d,C=h+y*(d+1),T=h+1+y*(d+1),E=h+1+y*d,k=new r.Vector2(h/f,1-d/p),A=new r.Vector2(h/f,1-(d+1)/p),P=new r.Vector2((h+1)/f,1-(d+1)/p),L=new r.Vector2((h+1)/f,1-d/p),O=new r.Face3(M+g,C+g,E+g);O.normal.copy(_),O.vertexNormals.push(_.clone(),_.clone(),_.clone()),O.materialIndex=c,l.faces.push(O),l.faceVertexUvs[0].push([k,A,L]),(O=new r.Face3(C+g,T+g,E+g)).normal.copy(_),O.vertexNormals.push(_.clone(),_.clone(),_.clone()),O.materialIndex=c,l.faces.push(O),l.faceVertexUvs[0].push([A.clone(),P,L.clone()])}}r.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:o,depthSegments:a},this.widthSegments=i||1,this.heightSegments=o||1,this.depthSegments=a||1;var l=this,c=t/2,u=e/2,h=n/2;s("z","y",-1,-1,n,e,c,0),s("z","y",1,-1,n,e,-c,1),s("x","z",1,1,t,n,u,2),s("x","z",1,-1,t,n,-u,3),s("x","y",1,-1,t,e,h,4),s("x","y",-1,-1,t,e,-h,5),this.mergeVertices()},r.BoxGeometry.prototype=Object.create(r.Geometry.prototype),r.BoxGeometry.prototype.constructor=r.BoxGeometry,r.CircleGeometry=function(t,e,n,i){r.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var o,a=[],s=new r.Vector3,l=new r.Vector2(.5,.5);for(this.vertices.push(s),a.push(l),o=0;e>=o;o++){var c=new r.Vector3,u=n+o/e*i;c.x=t*Math.cos(u),c.y=t*Math.sin(u),this.vertices.push(c),a.push(new r.Vector2((c.x/t+1)/2,(c.y/t+1)/2))}var h=new r.Vector3(0,0,1);for(o=1;e>=o;o++)this.faces.push(new r.Face3(o,o+1,0,[h.clone(),h.clone(),h.clone()])),this.faceVertexUvs[0].push([a[o].clone(),a[o+1].clone(),l.clone()]);this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,t)},r.CircleGeometry.prototype=Object.create(r.Geometry.prototype),r.CircleGeometry.prototype.constructor=r.CircleGeometry,r.CubeGeometry=function(t,e,n,i,o,a){return r.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new r.BoxGeometry(t,e,n,i,o,a)},r.CylinderGeometry=function(t,e,n,i,o,a,s,l){r.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l},t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,i=i||8,o=o||1,a=void 0!==a&&a,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var c,u,h=n/2,d=[],f=[];for(u=0;o>=u;u++){var p=[],m=[],v=u/o,g=v*(e-t)+t;for(c=0;i>=c;c++){var y=c/i,b=new r.Vector3;b.x=g*Math.sin(y*l+s),b.y=-v*n+h,b.z=g*Math.cos(y*l+s),this.vertices.push(b),p.push(this.vertices.length-1),m.push(new r.Vector2(y,1-v))}d.push(p),f.push(m)}var x,w,_=(e-t)/n;for(c=0;i>c;c++)for(0!==t?(x=this.vertices[d[0][c]].clone(),w=this.vertices[d[0][c+1]].clone()):(x=this.vertices[d[1][c]].clone(),w=this.vertices[d[1][c+1]].clone()),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*_).normalize(),w.setY(Math.sqrt(w.x*w.x+w.z*w.z)*_).normalize(),u=0;o>u;u++){var S=d[u][c],M=d[u+1][c],C=d[u+1][c+1],T=d[u][c+1],E=x.clone(),k=x.clone(),A=w.clone(),P=w.clone(),L=f[u][c].clone(),O=f[u+1][c].clone(),R=f[u+1][c+1].clone(),F=f[u][c+1].clone();this.faces.push(new r.Face3(S,M,T,[E,k,P])),this.faceVertexUvs[0].push([L,O,F]),this.faces.push(new r.Face3(M,C,T,[k.clone(),A,P.clone()])),this.faceVertexUvs[0].push([O.clone(),R,F.clone()])}if(!1===a&&t>0)for(this.vertices.push(new r.Vector3(0,h,0)),c=0;i>c;c++){S=d[0][c],M=d[0][c+1],C=this.vertices.length-1,E=new r.Vector3(0,1,0),k=new r.Vector3(0,1,0),A=new r.Vector3(0,1,0),L=f[0][c].clone(),O=f[0][c+1].clone(),R=new r.Vector2(O.x,0);this.faces.push(new r.Face3(S,M,C,[E,k,A])),this.faceVertexUvs[0].push([L,O,R])}if(!1===a&&e>0)for(this.vertices.push(new r.Vector3(0,-h,0)),c=0;i>c;c++){S=d[o][c+1],M=d[o][c],C=this.vertices.length-1,E=new r.Vector3(0,-1,0),k=new r.Vector3(0,-1,0),A=new r.Vector3(0,-1,0),L=f[o][c+1].clone(),O=f[o][c].clone(),R=new r.Vector2(O.x,1);this.faces.push(new r.Face3(S,M,C,[E,k,A])),this.faceVertexUvs[0].push([L,O,R])}this.computeFaceNormals()},r.CylinderGeometry.prototype=Object.create(r.Geometry.prototype),r.CylinderGeometry.prototype.constructor=r.CylinderGeometry,r.ExtrudeGeometry=function(t,e){return void 0===t?void(t=[]):(r.Geometry.call(this),this.type="ExtrudeGeometry",t=t instanceof Array?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())},r.ExtrudeGeometry.prototype=Object.create(r.Geometry.prototype),r.ExtrudeGeometry.prototype.constructor=r.ExtrudeGeometry,r.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;n>i;i++){var r=t[i];this.addShape(r,e)}},r.ExtrudeGeometry.prototype.addShape=function(t,e){function n(t,e,n){return e||r.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function i(t,e,n){var i,o,a=1e-10,s=1,l=t.x-e.x,c=t.y-e.y,u=n.x-t.x,h=n.y-t.y,d=l*l+c*c,f=l*h-c*u;if(Math.abs(f)>a){var p=Math.sqrt(d),m=Math.sqrt(u*u+h*h),v=e.x-c/p,g=e.y+l/p,y=((n.x-h/m-v)*h-(n.y+u/m-g)*u)/(l*h-c*u),b=(i=v+l*y-t.x)*i+(o=g+c*y-t.y)*o;if(2>=b)return new r.Vector2(i,o);s=Math.sqrt(b/2)}else{var x=!1;l>a?u>a&&(x=!0):-a>l?-a>u&&(x=!0):Math.sign(c)==Math.sign(h)&&(x=!0),x?(i=-c,o=l,s=Math.sqrt(d)):(i=l,o=c,s=Math.sqrt(d/2))}return new r.Vector2(i/s,o/s)}function o(t,e){var n,i;for(q=t.length;--q>=0;){n=q,0>(i=q-1)&&(i=t.length-1);var r=0,o=x+2*g;for(r=0;o>r;r++){var a=H*r,s=H*(r+1);l(e+n+a,e+i+a,e+i+s,e+n+s,t,r,o,n,i)}}}function a(t,e,n){A.vertices.push(new r.Vector3(t,e,n))}function s(t,e,n){t+=P,e+=P,n+=P,A.faces.push(new r.Face3(t,e,n,null,null,S));var i=C.generateTopUV(A,t,e,n);A.faceVertexUvs[0].push(i)}function l(t,e,n,i,o,a,s,l,c){t+=P,e+=P,n+=P,i+=P,A.faces.push(new r.Face3(t,e,i,null,null,M)),A.faces.push(new r.Face3(e,n,i,null,null,M));var u=C.generateSideWallUV(A,t,e,n,i);A.faceVertexUvs[0].push([u[0],u[1],u[3]]),A.faceVertexUvs[0].push([u[1],u[2],u[3]])}var c,u,h,d,f,p=void 0!==e.amount?e.amount:100,m=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:m-2,g=void 0!==e.bevelSegments?e.bevelSegments:3,y=void 0===e.bevelEnabled||e.bevelEnabled,b=void 0!==e.curveSegments?e.curveSegments:12,x=void 0!==e.steps?e.steps:1,w=e.extrudePath,_=!1,S=e.material,M=e.extrudeMaterial,C=void 0!==e.UVGenerator?e.UVGenerator:r.ExtrudeGeometry.WorldUVGenerator;w&&(c=w.getSpacedPoints(x),_=!0,y=!1,u=void 0!==e.frames?e.frames:new r.TubeGeometry.FrenetFrames(w,x,!1),h=new r.Vector3,d=new r.Vector3,f=new r.Vector3),y||(g=0,m=0,v=0);var T,E,k,A=this,P=this.vertices.length,L=t.extractPoints(b),O=L.shape,R=L.holes,F=!r.Shape.Utils.isClockWise(O);if(F){for(O=O.reverse(),E=0,k=R.length;k>E;E++)T=R[E],r.Shape.Utils.isClockWise(T)&&(R[E]=T.reverse());F=!1}var B=r.Shape.Utils.triangulateShape(O,R),D=O;for(E=0,k=R.length;k>E;E++)T=R[E],O=O.concat(T);for(var I,N,j,V,z,U,H=O.length,G=B.length,W=[],q=0,X=D.length,Y=X-1,J=q+1;X>q;q++,Y++,J++)Y===X&&(Y=0),J===X&&(J=0),W[q]=i(D[q],D[Y],D[J]);var Z,Q,K=[],$=W.concat();for(E=0,k=R.length;k>E;E++){for(T=R[E],Z=[],q=0,Y=(X=T.length)-1,J=q+1;X>q;q++,Y++,J++)Y===X&&(Y=0),J===X&&(J=0),Z[q]=i(T[q],T[Y],T[J]);K.push(Z),$=$.concat(Z)}for(I=0;g>I;I++){for(V=m*(1-(j=I/g)),N=v*Math.sin(j*Math.PI/2),q=0,X=D.length;X>q;q++)a((z=n(D[q],W[q],N)).x,z.y,-V);for(E=0,k=R.length;k>E;E++)for(T=R[E],Z=K[E],q=0,X=T.length;X>q;q++)a((z=n(T[q],Z[q],N)).x,z.y,-V)}for(N=v,q=0;H>q;q++)z=y?n(O[q],$[q],N):O[q],_?(d.copy(u.normals[0]).multiplyScalar(z.x),h.copy(u.binormals[0]).multiplyScalar(z.y),f.copy(c[0]).add(d).add(h),a(f.x,f.y,f.z)):a(z.x,z.y,0);for(Q=1;x>=Q;Q++)for(q=0;H>q;q++)z=y?n(O[q],$[q],N):O[q],_?(d.copy(u.normals[Q]).multiplyScalar(z.x),h.copy(u.binormals[Q]).multiplyScalar(z.y),f.copy(c[Q]).add(d).add(h),a(f.x,f.y,f.z)):a(z.x,z.y,p/x*Q);for(I=g-1;I>=0;I--){for(V=m*(1-(j=I/g)),N=v*Math.sin(j*Math.PI/2),q=0,X=D.length;X>q;q++)a((z=n(D[q],W[q],N)).x,z.y,p+V);for(E=0,k=R.length;k>E;E++)for(T=R[E],Z=K[E],q=0,X=T.length;X>q;q++)z=n(T[q],Z[q],N),_?a(z.x,z.y+c[x-1].y,c[x-1].x+V):a(z.x,z.y,p+V)}(function(){if(y){var t=0,e=H*t;for(q=0;G>q;q++)s((U=B[q])[2]+e,U[1]+e,U[0]+e);for(e=H*(t=x+2*g),q=0;G>q;q++)s((U=B[q])[0]+e,U[1]+e,U[2]+e)}else{for(q=0;G>q;q++)s((U=B[q])[2],U[1],U[0]);for(q=0;G>q;q++)s((U=B[q])[0]+H*x,U[1]+H*x,U[2]+H*x)}})(),function(){var t=0;for(o(D,t),t+=D.length,E=0,k=R.length;k>E;E++)o(T=R[E],t),t+=T.length}()},r.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,n,i){var o=t.vertices,a=o[e],s=o[n],l=o[i];return[new r.Vector2(a.x,a.y),new r.Vector2(s.x,s.y),new r.Vector2(l.x,l.y)]},generateSideWallUV:function(t,e,n,i,o){var a=t.vertices,s=a[e],l=a[n],c=a[i],u=a[o];return Math.abs(s.y-l.y)<.01?[new r.Vector2(s.x,1-s.z),new r.Vector2(l.x,1-l.z),new r.Vector2(c.x,1-c.z),new r.Vector2(u.x,1-u.z)]:[new r.Vector2(s.y,1-s.z),new r.Vector2(l.y,1-l.z),new r.Vector2(c.y,1-c.z),new r.Vector2(u.y,1-u.z)]}},r.ShapeGeometry=function(t,e){r.Geometry.call(this),this.type="ShapeGeometry",t instanceof Array==0&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},r.ShapeGeometry.prototype=Object.create(r.Geometry.prototype),r.ShapeGeometry.prototype.constructor=r.ShapeGeometry,r.ShapeGeometry.prototype.addShapeList=function(t,e){for(var n=0,i=t.length;i>n;n++)this.addShape(t[n],e);return this},r.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var n,i,o,a=void 0!==e.curveSegments?e.curveSegments:12,s=e.material,l=void 0===e.UVGenerator?r.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,c=this.vertices.length,u=t.extractPoints(a),h=u.shape,d=u.holes,f=!r.Shape.Utils.isClockWise(h);if(f){for(h=h.reverse(),n=0,i=d.length;i>n;n++)o=d[n],r.Shape.Utils.isClockWise(o)&&(d[n]=o.reverse());f=!1}var p=r.Shape.Utils.triangulateShape(h,d);for(n=0,i=d.length;i>n;n++)o=d[n],h=h.concat(o);var m,v,g=h.length,y=p.length;for(n=0;g>n;n++)m=h[n],this.vertices.push(new r.Vector3(m.x,m.y,0));for(n=0;y>n;n++){var b=(v=p[n])[0]+c,x=v[1]+c,w=v[2]+c;this.faces.push(new r.Face3(b,x,w,null,null,s)),this.faceVertexUvs[0].push(l.generateTopUV(this,b,x,w))}},r.LatheGeometry=function(t,e,n,i){r.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=e||12,n=n||0,i=i||2*Math.PI;for(var o=1/(t.length-1),a=1/e,s=0,l=e;l>=s;s++)for(var c=n+s*a*i,u=Math.cos(c),h=Math.sin(c),d=0,f=t.length;f>d;d++){var p=t[d],m=new r.Vector3;m.x=u*p.x-h*p.y,m.y=h*p.x+u*p.y,m.z=p.z,this.vertices.push(m)}var v=t.length;for(s=0,l=e;l>s;s++)for(d=0,f=t.length-1;f>d;d++){var g=d+v*s,y=g,b=g+v,x=(u=g+1+v,g+1),w=s*a,_=d*o,S=w+a,M=_+o;this.faces.push(new r.Face3(y,b,x)),this.faceVertexUvs[0].push([new r.Vector2(w,_),new r.Vector2(S,_),new r.Vector2(w,M)]),this.faces.push(new r.Face3(b,u,x)),this.faceVertexUvs[0].push([new r.Vector2(S,_),new r.Vector2(S,M),new r.Vector2(w,M)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},r.LatheGeometry.prototype=Object.create(r.Geometry.prototype),r.LatheGeometry.prototype.constructor=r.LatheGeometry,r.PlaneGeometry=function(t,e,n,i){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),r.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new r.PlaneBufferGeometry(t,e,n,i))},r.PlaneGeometry.prototype=Object.create(r.Geometry.prototype),r.PlaneGeometry.prototype.constructor=r.PlaneGeometry,r.PlaneBufferGeometry=function(t,e,n,i){r.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};for(var o=t/2,a=e/2,s=n||1,l=i||1,c=s+1,u=l+1,h=t/s,d=e/l,f=new Float32Array(c*u*3),p=new Float32Array(c*u*3),m=new Float32Array(c*u*2),v=0,g=0,y=0;u>y;y++)for(var b=y*d-a,x=0;c>x;x++){var w=x*h-o;f[v]=w,f[v+1]=-b,p[v+2]=1,m[g]=x/s,m[g+1]=1-y/l,v+=3,g+=2}v=0;var _=new(f.length/3>65535?Uint32Array:Uint16Array)(s*l*6);for(y=0;l>y;y++)for(x=0;s>x;x++){var S=x+c*y,M=x+c*(y+1),C=x+1+c*(y+1),T=x+1+c*y;_[v]=S,_[v+1]=M,_[v+2]=T,_[v+3]=M,_[v+4]=C,_[v+5]=T,v+=6}this.addAttribute("index",new r.BufferAttribute(_,1)),this.addAttribute("position",new r.BufferAttribute(f,3)),this.addAttribute("normal",new r.BufferAttribute(p,3)),this.addAttribute("uv",new r.BufferAttribute(m,2))},r.PlaneBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.PlaneBufferGeometry.prototype.constructor=r.PlaneBufferGeometry,r.RingGeometry=function(t,e,n,i,o,a){r.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:o,thetaLength:a},t=t||0,e=e||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var s,l,c=[],u=t,h=(e-t)/(i=void 0!==i?Math.max(1,i):8);for(s=0;i+1>s;s++){for(l=0;n+1>l;l++){var d=new r.Vector3,f=o+l/n*a;d.x=u*Math.cos(f),d.y=u*Math.sin(f),this.vertices.push(d),c.push(new r.Vector2((d.x/e+1)/2,(d.y/e+1)/2))}u+=h}var p=new r.Vector3(0,0,1);for(s=0;i>s;s++){var m=s*(n+1);for(l=0;n>l;l++){var v=f=l+m,g=f+n+1,y=f+n+2;this.faces.push(new r.Face3(v,g,y,[p.clone(),p.clone(),p.clone()])),this.faceVertexUvs[0].push([c[v].clone(),c[g].clone(),c[y].clone()]),v=f,g=f+n+2,y=f+1,this.faces.push(new r.Face3(v,g,y,[p.clone(),p.clone(),p.clone()])),this.faceVertexUvs[0].push([c[v].clone(),c[g].clone(),c[y].clone()])}}this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,u)},r.RingGeometry.prototype=Object.create(r.Geometry.prototype),r.RingGeometry.prototype.constructor=r.RingGeometry,r.SphereGeometry=function(t,e,n,i,o,a,s){r.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,a=void 0!==a?a:0,s=void 0!==s?s:Math.PI;var l,c,u=[],h=[];for(c=0;n>=c;c++){var d=[],f=[];for(l=0;e>=l;l++){var p=l/e,m=c/n,v=new r.Vector3;v.x=-t*Math.cos(i+p*o)*Math.sin(a+m*s),v.y=t*Math.cos(a+m*s),v.z=t*Math.sin(i+p*o)*Math.sin(a+m*s),this.vertices.push(v),d.push(this.vertices.length-1),f.push(new r.Vector2(p,1-m))}u.push(d),h.push(f)}for(c=0;n>c;c++)for(l=0;e>l;l++){var g=u[c][l+1],y=u[c][l],b=u[c+1][l],x=u[c+1][l+1],w=this.vertices[g].clone().normalize(),_=this.vertices[y].clone().normalize(),S=this.vertices[b].clone().normalize(),M=this.vertices[x].clone().normalize(),C=h[c][l+1].clone(),T=h[c][l].clone(),E=h[c+1][l].clone(),k=h[c+1][l+1].clone();Math.abs(this.vertices[g].y)===t?(C.x=(C.x+T.x)/2,this.faces.push(new r.Face3(g,b,x,[w,S,M])),this.faceVertexUvs[0].push([C,E,k])):Math.abs(this.vertices[b].y)===t?(E.x=(E.x+k.x)/2,this.faces.push(new r.Face3(g,y,b,[w,_,S])),this.faceVertexUvs[0].push([C,T,E])):(this.faces.push(new r.Face3(g,y,x,[w,_,M])),this.faceVertexUvs[0].push([C,T,k]),this.faces.push(new r.Face3(y,b,x,[_.clone(),S,M.clone()])),this.faceVertexUvs[0].push([T.clone(),E,k.clone()]))}this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,t)},r.SphereGeometry.prototype=Object.create(r.Geometry.prototype),r.SphereGeometry.prototype.constructor=r.SphereGeometry,r.TextGeometry=function(t,e){e=e||{};var n=r.FontUtils.generateShapes(t,e);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),r.ExtrudeGeometry.call(this,n,e),this.type="TextGeometry"},r.TextGeometry.prototype=Object.create(r.ExtrudeGeometry.prototype),r.TextGeometry.prototype.constructor=r.TextGeometry,r.TorusGeometry=function(t,e,n,i,o){r.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:o},t=t||100,e=e||40,n=n||8,i=i||6,o=o||2*Math.PI;for(var a=new r.Vector3,s=[],l=[],c=0;n>=c;c++)for(var u=0;i>=u;u++){var h=u/i*o,d=c/n*Math.PI*2;a.x=t*Math.cos(h),a.y=t*Math.sin(h);var f=new r.Vector3;f.x=(t+e*Math.cos(d))*Math.cos(h),f.y=(t+e*Math.cos(d))*Math.sin(h),f.z=e*Math.sin(d),this.vertices.push(f),s.push(new r.Vector2(u/i,c/n)),l.push(f.clone().sub(a).normalize())}for(c=1;n>=c;c++)for(u=1;i>=u;u++){var p=(i+1)*c+u-1,m=(i+1)*(c-1)+u-1,v=(i+1)*(c-1)+u,g=(i+1)*c+u,y=new r.Face3(p,m,g,[l[p].clone(),l[m].clone(),l[g].clone()]);this.faces.push(y),this.faceVertexUvs[0].push([s[p].clone(),s[m].clone(),s[g].clone()]),y=new r.Face3(m,v,g,[l[m].clone(),l[v].clone(),l[g].clone()]),this.faces.push(y),this.faceVertexUvs[0].push([s[m].clone(),s[v].clone(),s[g].clone()])}this.computeFaceNormals()},r.TorusGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusGeometry.prototype.constructor=r.TorusGeometry,r.TorusKnotGeometry=function(t,e,n,i,o,a,s){function l(t,e,n,i,o){var a=Math.cos(t),s=Math.sin(t),l=e/n*t,c=Math.cos(l),u=i*(2+c)*.5*a,h=i*(2+c)*s*.5,d=o*i*Math.sin(l)*.5;return new r.Vector3(u,h,d)}r.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,p:o,q:a,heightScale:s},t=t||100,e=e||40,n=n||64,i=i||8,o=o||2,a=a||3,s=s||1;for(var c=new Array(n),u=new r.Vector3,h=new r.Vector3,d=new r.Vector3,f=0;n>f;++f){c[f]=new Array(i);var p=f/n*2*o*Math.PI,m=l(p,a,o,t,s),v=l(p+.01,a,o,t,s);u.subVectors(v,m),h.addVectors(v,m),d.crossVectors(u,h),h.crossVectors(d,u),d.normalize(),h.normalize();for(var g=0;i>g;++g){var y=g/i*2*Math.PI,b=-e*Math.cos(y),x=e*Math.sin(y),w=new r.Vector3;w.x=m.x+b*h.x+x*d.x,w.y=m.y+b*h.y+x*d.y,w.z=m.z+b*h.z+x*d.z,c[f][g]=this.vertices.push(w)-1}}for(f=0;n>f;++f)for(g=0;i>g;++g){var _=(f+1)%n,S=(g+1)%i,M=c[f][g],C=c[_][g],T=c[_][S],E=c[f][S],k=new r.Vector2(f/n,g/i),A=new r.Vector2((f+1)/n,g/i),P=new r.Vector2((f+1)/n,(g+1)/i),L=new r.Vector2(f/n,(g+1)/i);this.faces.push(new r.Face3(M,C,E)),this.faceVertexUvs[0].push([k,A,L]),this.faces.push(new r.Face3(C,T,E)),this.faceVertexUvs[0].push([A.clone(),P,L.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},r.TorusKnotGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusKnotGeometry.prototype.constructor=r.TorusKnotGeometry,r.TubeGeometry=function(t,e,n,i,o,a){function s(t,e,n){return A.vertices.push(new r.Vector3(t,e,n))-1}r.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:n,radialSegments:i,closed:o},e=e||64,n=n||1,i=i||8,o=o||!1,a=a||r.TubeGeometry.NoTaper;var l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M,C,T,E,k=[],A=this,P=e+1,L=new r.Vector3,O=new r.TubeGeometry.FrenetFrames(t,e,o),R=O.tangents,F=O.normals,B=O.binormals;for(this.tangents=R,this.normals=F,this.binormals=B,v=0;P>v;v++)for(k[v]=[],u=v/(P-1),m=t.getPointAt(u),R[v],l=F[v],c=B[v],d=n*a(u),g=0;i>g;g++)h=g/i*2*Math.PI,f=-d*Math.cos(h),p=d*Math.sin(h),L.copy(m),L.x+=f*l.x+p*c.x,L.y+=f*l.y+p*c.y,L.z+=f*l.z+p*c.z,k[v][g]=s(L.x,L.y,L.z);for(v=0;e>v;v++)for(g=0;i>g;g++)y=o?(v+1)%e:v+1,b=(g+1)%i,x=k[v][g],w=k[y][g],_=k[y][b],S=k[v][b],M=new r.Vector2(v/e,g/i),C=new r.Vector2((v+1)/e,g/i),T=new r.Vector2((v+1)/e,(g+1)/i),E=new r.Vector2(v/e,(g+1)/i),this.faces.push(new r.Face3(x,w,S)),this.faceVertexUvs[0].push([M,C,E]),this.faces.push(new r.Face3(w,_,S)),this.faceVertexUvs[0].push([C.clone(),T,E.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.TubeGeometry.prototype=Object.create(r.Geometry.prototype),r.TubeGeometry.prototype.constructor=r.TubeGeometry,r.TubeGeometry.NoTaper=function(t){return 1},r.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},r.TubeGeometry.FrenetFrames=function(t,e,n){var i,o,a,s,l,c,u,h=new r.Vector3,d=[],f=[],p=[],m=new r.Vector3,v=new r.Matrix4,g=e+1;for(this.tangents=d,this.normals=f,this.binormals=p,c=0;g>c;c++)u=c/(g-1),d[c]=t.getTangentAt(u),d[c].normalize();for(f[0]=new r.Vector3,p[0]=new r.Vector3,o=Number.MAX_VALUE,a=Math.abs(d[0].x),s=Math.abs(d[0].y),l=Math.abs(d[0].z),o>=a&&(o=a,h.set(1,0,0)),o>=s&&(o=s,h.set(0,1,0)),o>=l&&h.set(0,0,1),m.crossVectors(d[0],h).normalize(),f[0].crossVectors(d[0],m),p[0].crossVectors(d[0],f[0]),c=1;g>c;c++)f[c]=f[c-1].clone(),p[c]=p[c-1].clone(),m.crossVectors(d[c-1],d[c]),m.length()>1e-4&&(m.normalize(),i=Math.acos(r.Math.clamp(d[c-1].dot(d[c]),-1,1)),f[c].applyMatrix4(v.makeRotationAxis(m,i))),p[c].crossVectors(d[c],f[c]);if(n)for(i=Math.acos(r.Math.clamp(f[0].dot(f[g-1]),-1,1)),i/=g-1,d[0].dot(m.crossVectors(f[0],f[g-1]))>0&&(i=-i),c=1;g>c;c++)f[c].applyMatrix4(v.makeRotationAxis(d[c],i*c)),p[c].crossVectors(d[c],f[c])},r.PolyhedronGeometry=function(t,e,n,i){function o(t){var e=t.normalize().clone();e.index=u.vertices.push(e)-1;var n=l(t)/2/Math.PI+.5,i=function(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}(t)/Math.PI+.5;return e.uv=new r.Vector2(n,1-i),e}function a(t,e,n){var i=new r.Face3(t.index,e.index,n.index,[t.clone(),e.clone(),n.clone()]);u.faces.push(i),b.copy(t).add(e).add(n).divideScalar(3);var o=l(b);u.faceVertexUvs[0].push([c(t.uv,t,o),c(e.uv,e,o),c(n.uv,n,o)])}function s(t,e){for(var n=Math.pow(2,e),i=o(u.vertices[t.a]),r=o(u.vertices[t.b]),s=o(u.vertices[t.c]),l=[],c=0;n>=c;c++){l[c]=[];for(var h=o(i.clone().lerp(s,c/n)),d=o(r.clone().lerp(s,c/n)),f=n-c,p=0;f>=p;p++)l[c][p]=0==p&&c==n?h:o(h.clone().lerp(d,p/f))}for(c=0;n>c;c++)for(p=0;2*(n-c)-1>p;p++){var m=Math.floor(p/2);p%2==0?a(l[c][m+1],l[c+1][m],l[c][m]):a(l[c][m+1],l[c+1][m+1],l[c+1][m])}}function l(t){return Math.atan2(t.z,-t.x)}function c(t,e,n){return 0>n&&1===t.x&&(t=new r.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new r.Vector2(n/2/Math.PI+.5,t.y)),t.clone()}r.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},n=n||1,i=i||0;for(var u=this,h=0,d=t.length;d>h;h+=3)o(new r.Vector3(t[h],t[h+1],t[h+2]));var f=this.vertices,p=[],m=(h=0,0);for(d=e.length;d>h;h+=3,m++){var v=f[e[h]],g=f[e[h+1]],y=f[e[h+2]];p[m]=new r.Face3(v.index,g.index,y.index,[v.clone(),g.clone(),y.clone()])}var b=new r.Vector3;for(h=0,d=p.length;d>h;h++)s(p[h],i);for(h=0,d=this.faceVertexUvs[0].length;d>h;h++){var x=this.faceVertexUvs[0][h],w=x[0].x,_=x[1].x,S=x[2].x,M=Math.max(w,Math.max(_,S)),C=Math.min(w,Math.min(_,S));M>.9&&.1>C&&(.2>w&&(x[0].x+=1),.2>_&&(x[1].x+=1),.2>S&&(x[2].x+=1))}for(h=0,d=this.vertices.length;d>h;h++)this.vertices[h].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,n)},r.PolyhedronGeometry.prototype=Object.create(r.Geometry.prototype),r.PolyhedronGeometry.prototype.constructor=r.PolyhedronGeometry,r.DodecahedronGeometry=function(t,e){this.parameters={radius:t,detail:e};var n=(1+Math.sqrt(5))/2,i=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];r.PolyhedronGeometry.call(this,o,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e)},r.DodecahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.DodecahedronGeometry.prototype.constructor=r.DodecahedronGeometry,r.IcosahedronGeometry=function(t,e){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];r.PolyhedronGeometry.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},r.IcosahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.IcosahedronGeometry.prototype.constructor=r.IcosahedronGeometry,r.OctahedronGeometry=function(t,e){this.parameters={radius:t,detail:e};r.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},r.OctahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.OctahedronGeometry.prototype.constructor=r.OctahedronGeometry,r.TetrahedronGeometry=function(t,e){r.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},r.TetrahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.TetrahedronGeometry.prototype.constructor=r.TetrahedronGeometry,r.ParametricGeometry=function(t,e,n){r.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var i,o,a,s,l,c,u,h,d,f,p,m,v=this.vertices,g=this.faces,y=this.faceVertexUvs[0],b=e+1;for(i=0;n>=i;i++)for(s=i/n,o=0;e>=o;o++)a=t(o/e,s),v.push(a);for(i=0;n>i;i++)for(o=0;e>o;o++)l=i*b+o,c=i*b+o+1,u=(i+1)*b+o+1,h=(i+1)*b+o,d=new r.Vector2(o/e,i/n),f=new r.Vector2((o+1)/e,i/n),p=new r.Vector2((o+1)/e,(i+1)/n),m=new r.Vector2(o/e,(i+1)/n),g.push(new r.Face3(l,c,h)),y.push([d,f,m]),g.push(new r.Face3(c,u,h)),y.push([f.clone(),p,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.ParametricGeometry.prototype=Object.create(r.Geometry.prototype),r.ParametricGeometry.prototype.constructor=r.ParametricGeometry,r.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new r.BufferGeometry;i.addAttribute("position",new r.BufferAttribute(e,3)),i.addAttribute("color",new r.BufferAttribute(n,3));var o=new r.LineBasicMaterial({vertexColors:r.VertexColors});r.Line.call(this,i,o,r.LinePieces)},r.AxisHelper.prototype=Object.create(r.Line.prototype),r.AxisHelper.prototype.constructor=r.AxisHelper,r.ArrowHelper=function(){var t=new r.Geometry;t.vertices.push(new r.Vector3(0,0,0),new r.Vector3(0,1,0));var e=new r.CylinderGeometry(0,.5,1,5,1);return e.applyMatrix((new r.Matrix4).makeTranslation(0,-.5,0)),function(n,i,o,a,s,l){r.Object3D.call(this),void 0===a&&(a=16776960),void 0===o&&(o=1),void 0===s&&(s=.2*o),void 0===l&&(l=.2*s),this.position.copy(i),this.line=new r.Line(t,new r.LineBasicMaterial({color:a})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new r.Mesh(e,new r.MeshBasicMaterial({color:a})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(o,s,l)}}(),r.ArrowHelper.prototype=Object.create(r.Object3D.prototype),r.ArrowHelper.prototype.constructor=r.ArrowHelper,r.ArrowHelper.prototype.setDirection=function(){var t,e=new r.Vector3;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),r.ArrowHelper.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,t-e,1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},r.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},r.BoxHelper=function(t){var e=new r.BufferGeometry;e.addAttribute("position",new r.BufferAttribute(new Float32Array(72),3)),r.Line.call(this,e,new r.LineBasicMaterial({color:16776960}),r.LinePieces),void 0!==t&&this.update(t)},r.BoxHelper.prototype=Object.create(r.Line.prototype),r.BoxHelper.prototype.constructor=r.BoxHelper,r.BoxHelper.prototype.update=function(t){var e=t.geometry;null===e.boundingBox&&e.computeBoundingBox();var n=e.boundingBox.min,i=e.boundingBox.max,r=this.geometry.attributes.position.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=n.x,r[4]=i.y,r[5]=i.z,r[6]=n.x,r[7]=i.y,r[8]=i.z,r[9]=n.x,r[10]=n.y,r[11]=i.z,r[12]=n.x,r[13]=n.y,r[14]=i.z,r[15]=i.x,r[16]=n.y,r[17]=i.z,r[18]=i.x,r[19]=n.y,r[20]=i.z,r[21]=i.x,r[22]=i.y,r[23]=i.z,r[24]=i.x,r[25]=i.y,r[26]=n.z,r[27]=n.x,r[28]=i.y,r[29]=n.z,r[30]=n.x,r[31]=i.y,r[32]=n.z,r[33]=n.x,r[34]=n.y,r[35]=n.z,r[36]=n.x,r[37]=n.y,r[38]=n.z,r[39]=i.x,r[40]=n.y,r[41]=n.z,r[42]=i.x,r[43]=n.y,r[44]=n.z,r[45]=i.x,r[46]=i.y,r[47]=n.z,r[48]=i.x,r[49]=i.y,r[50]=i.z,r[51]=i.x,r[52]=i.y,r[53]=n.z,r[54]=n.x,r[55]=i.y,r[56]=i.z,r[57]=n.x,r[58]=i.y,r[59]=n.z,r[60]=n.x,r[61]=n.y,r[62]=i.z,r[63]=n.x,r[64]=n.y,r[65]=n.z,r[66]=i.x,r[67]=n.y,r[68]=i.z,r[69]=i.x,r[70]=n.y,r[71]=n.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},r.BoundingBoxHelper=function(t,e){var n=void 0!==e?e:8947848;this.object=t,this.box=new r.Box3,r.Mesh.call(this,new r.BoxGeometry(1,1,1),new r.MeshBasicMaterial({color:n,wireframe:!0}))},r.BoundingBoxHelper.prototype=Object.create(r.Mesh.prototype),r.BoundingBoxHelper.prototype.constructor=r.BoundingBoxHelper,r.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},r.CameraHelper=function(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){i.vertices.push(new r.Vector3),i.colors.push(new r.Color(e)),void 0===a[t]&&(a[t]=[]),a[t].push(i.vertices.length-1)}var i=new r.Geometry,o=new r.LineBasicMaterial({color:16777215,vertexColors:r.FaceColors}),a={},s=16755200,l=16711680,c=43775,u=3355443;e("n1","n2",s),e("n2","n4",s),e("n4","n3",s),e("n3","n1",s),e("f1","f2",s),e("f2","f4",s),e("f4","f3",s),e("f3","f1",s),e("n1","f1",s),e("n2","f2",s),e("n3","f3",s),e("n4","f4",s),e("p","n1",l),e("p","n2",l),e("p","n3",l),e("p","n4",l),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",16777215),e("p","c",u),e("cn1","cn2",u),e("cn3","cn4",u),e("cf1","cf2",u),e("cf3","cf4",u),r.Line.call(this,i,o,r.LinePieces),this.camera=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()},r.CameraHelper.prototype=Object.create(r.Line.prototype),r.CameraHelper.prototype.constructor=r.CameraHelper,r.CameraHelper.prototype.update=function(){var t,e,n=new r.Vector3,i=new r.Camera,o=function(r,o,a,s){n.set(o,a,s).unproject(i);var l=e[r];if(void 0!==l)for(var c=0,u=l.length;u>c;c++)t.vertices[l[c]].copy(n)};return function(){t=this.geometry,e=this.pointMap;i.projectionMatrix.copy(this.camera.projectionMatrix),o("c",0,0,-1),o("t",0,0,1),o("n1",-1,-1,-1),o("n2",1,-1,-1),o("n3",-1,1,-1),o("n4",1,1,-1),o("f1",-1,-1,1),o("f2",1,-1,1),o("f3",-1,1,1),o("f4",1,1,1),o("u1",.7,1.1,-1),o("u2",-.7,1.1,-1),o("u3",0,2,-1),o("cf1",-1,0,1),o("cf2",1,0,1),o("cf3",0,-1,1),o("cf4",0,1,1),o("cn1",-1,0,-1),o("cn2",1,0,-1),o("cn3",0,-1,-1),o("cn4",0,1,-1),t.verticesNeedUpdate=!0}}(),r.DirectionalLightHelper=function(t,e){r.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var n=new r.Geometry;n.vertices.push(new r.Vector3(-e,e,0),new r.Vector3(e,e,0),new r.Vector3(e,-e,0),new r.Vector3(-e,-e,0),new r.Vector3(-e,e,0));var i=new r.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new r.Line(n,i),this.add(this.lightPlane),(n=new r.Geometry).vertices.push(new r.Vector3,new r.Vector3),(i=new r.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new r.Line(n,i),this.add(this.targetLine),this.update()},r.DirectionalLightHelper.prototype=Object.create(r.Object3D.prototype),r.DirectionalLightHelper.prototype.constructor=r.DirectionalLightHelper,r.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},r.DirectionalLightHelper.prototype.update=function(){var t=new r.Vector3,e=new r.Vector3,n=new r.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),r.EdgesHelper=function(t,e,n){var i=void 0!==e?e:16777215;n=void 0!==n?n:1;var o,a=Math.cos(r.Math.degToRad(n)),s=[0,0],l={},c=function(t,e){return t-e},u=["a","b","c"],h=new r.BufferGeometry;t.geometry instanceof r.BufferGeometry?(o=new r.Geometry).fromBufferGeometry(t.geometry):o=t.geometry.clone(),o.mergeVertices(),o.computeFaceNormals();for(var d=o.vertices,f=o.faces,p=0,m=0,v=f.length;v>m;m++)for(var g=f[m],y=0;3>y;y++){s[0]=g[u[y]],s[1]=g[u[(y+1)%3]],s.sort(c),void 0===l[w=s.toString()]?(l[w]={vert1:s[0],vert2:s[1],face1:m,face2:void 0},p++):l[w].face2=m}var b=new Float32Array(2*p*3),x=0;for(var w in l){var _=l[w];if(void 0===_.face2||f[_.face1].normal.dot(f[_.face2].normal)<=a){var S=d[_.vert1];b[x++]=S.x,b[x++]=S.y,b[x++]=S.z,S=d[_.vert2],b[x++]=S.x,b[x++]=S.y,b[x++]=S.z}}h.addAttribute("position",new r.BufferAttribute(b,3)),r.Line.call(this,h,new r.LineBasicMaterial({color:i}),r.LinePieces),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},r.EdgesHelper.prototype=Object.create(r.Line.prototype),r.EdgesHelper.prototype.constructor=r.EdgesHelper,r.FaceNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;for(var o=void 0!==n?n:16776960,a=void 0!==i?i:1,s=new r.Geometry,l=0,c=this.object.geometry.faces.length;c>l;l++)s.vertices.push(new r.Vector3,new r.Vector3);r.Line.call(this,s,new r.LineBasicMaterial({color:o,linewidth:a}),r.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new r.Matrix3,this.update()},r.FaceNormalsHelper.prototype=Object.create(r.Line.prototype),r.FaceNormalsHelper.prototype.constructor=r.FaceNormalsHelper,r.FaceNormalsHelper.prototype.update=function(){var t=this.geometry.vertices,e=this.object,n=e.geometry.vertices,i=e.geometry.faces,r=e.matrixWorld;e.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(r);for(var o=0,a=0,s=i.length;s>o;o++,a+=2){var l=i[o];t[a].copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(r),t[a+1].copy(l.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(t[a])}return this.geometry.verticesNeedUpdate=!0,this},r.GridHelper=function(t,e){var n=new r.Geometry,i=new r.LineBasicMaterial({vertexColors:r.VertexColors});this.color1=new r.Color(4473924),this.color2=new r.Color(8947848);for(var o=-t;t>=o;o+=e){n.vertices.push(new r.Vector3(-t,0,o),new r.Vector3(t,0,o),new r.Vector3(o,0,-t),new r.Vector3(o,0,t));var a=0===o?this.color1:this.color2;n.colors.push(a,a,a,a)}r.Line.call(this,n,i,r.LinePieces)},r.GridHelper.prototype=Object.create(r.Line.prototype),r.GridHelper.prototype.constructor=r.GridHelper,r.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},r.HemisphereLightHelper=function(t,e){r.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new r.Color,new r.Color];var n=new r.SphereGeometry(e,4,2);n.applyMatrix((new r.Matrix4).makeRotationX(-Math.PI/2));for(var i=0;8>i;i++)n.faces[i].color=this.colors[4>i?0:1];var o=new r.MeshBasicMaterial({vertexColors:r.FaceColors,wireframe:!0});this.lightSphere=new r.Mesh(n,o),this.add(this.lightSphere),this.update()},r.HemisphereLightHelper.prototype=Object.create(r.Object3D.prototype),r.HemisphereLightHelper.prototype.constructor=r.HemisphereLightHelper,r.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},r.HemisphereLightHelper.prototype.update=function(){var t=new r.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),r.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var n=new r.SphereGeometry(e,4,2),i=new r.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},r.PointLightHelper.prototype=Object.create(r.Mesh.prototype),r.PointLightHelper.prototype.constructor=r.PointLightHelper,r.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},r.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},r.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new r.Geometry,n=0;n<this.bones.length;n++){this.bones[n].parent instanceof r.Bone&&(e.vertices.push(new r.Vector3),e.vertices.push(new r.Vector3),e.colors.push(new r.Color(0,0,1)),e.colors.push(new r.Color(0,1,0)))}var i=new r.LineBasicMaterial({vertexColors:r.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});r.Line.call(this,e,i,r.LinePieces),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},r.SkeletonHelper.prototype=Object.create(r.Line.prototype),r.SkeletonHelper.prototype.constructor=r.SkeletonHelper,r.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof r.Bone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},r.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new r.Matrix4).getInverse(this.root.matrixWorld),n=new r.Matrix4,i=0,o=0;o<this.bones.length;o++){var a=this.bones[o];a.parent instanceof r.Bone&&(n.multiplyMatrices(e,a.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(e,a.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},r.SpotLightHelper=function(t){r.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var e=new r.CylinderGeometry(0,1,1,8,1,!0);e.applyMatrix((new r.Matrix4).makeTranslation(0,-.5,0)),e.applyMatrix((new r.Matrix4).makeRotationX(-Math.PI/2));var n=new r.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new r.Mesh(e,n),this.add(this.cone),this.update()},r.SpotLightHelper.prototype=Object.create(r.Object3D.prototype),r.SpotLightHelper.prototype.constructor=r.SpotLightHelper,r.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},r.SpotLightHelper.prototype.update=function(){var t=new r.Vector3,e=new r.Vector3;return function(){var n=this.light.distance?this.light.distance:1e4,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),r.VertexNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;for(var o=void 0!==n?n:16711680,a=void 0!==i?i:1,s=new r.Geometry,l=t.geometry.faces,c=0,u=l.length;u>c;c++)for(var h=0,d=l[c].vertexNormals.length;d>h;h++)s.vertices.push(new r.Vector3,new r.Vector3);r.Line.call(this,s,new r.LineBasicMaterial({color:o,linewidth:a}),r.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new r.Matrix3,this.update()},r.VertexNormalsHelper.prototype=Object.create(r.Line.prototype),r.VertexNormalsHelper.prototype.constructor=r.VertexNormalsHelper,r.VertexNormalsHelper.prototype.update=function(t){var e=new r.Vector3;return function(t){var n=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,c=o.length;c>l;l++)for(var u=o[l],h=0,d=u.vertexNormals.length;d>h;h++){var f=r[u[n[h]]],p=u.vertexNormals[h];i[s].copy(f).applyMatrix4(a),e.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),e.add(i[s]),i[s+=1].copy(e),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),r.VertexTangentsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;for(var o=void 0!==n?n:255,a=void 0!==i?i:1,s=new r.Geometry,l=t.geometry.faces,c=0,u=l.length;u>c;c++)for(var h=0,d=l[c].vertexTangents.length;d>h;h++)s.vertices.push(new r.Vector3),s.vertices.push(new r.Vector3);r.Line.call(this,s,new r.LineBasicMaterial({color:o,linewidth:a}),r.LinePieces),this.matrixAutoUpdate=!1,this.update()},r.VertexTangentsHelper.prototype=Object.create(r.Line.prototype),r.VertexTangentsHelper.prototype.constructor=r.VertexTangentsHelper,r.VertexTangentsHelper.prototype.update=function(t){var e=new r.Vector3;return function(t){var n=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,c=o.length;c>l;l++)for(var u=o[l],h=0,d=u.vertexTangents.length;d>h;h++){var f=r[u[n[h]]],p=u.vertexTangents[h];i[s].copy(f).applyMatrix4(a),e.copy(p).transformDirection(a).multiplyScalar(this.size),e.add(i[s]),i[s+=1].copy(e),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),r.WireframeHelper=function(t,e){var n=void 0!==e?e:16777215,i=[0,0],o={},a=function(t,e){return t-e},s=["a","b","c"],l=new r.BufferGeometry;if(t.geometry instanceof r.Geometry){for(var c=t.geometry.vertices,u=t.geometry.faces,h=0,d=new Uint32Array(6*u.length),f=0,p=u.length;p>f;f++)for(var m=u[f],v=0;3>v;v++){i[0]=m[s[v]],i[1]=m[s[(v+1)%3]],i.sort(a),void 0===o[E=i.toString()]&&(d[2*h]=i[0],d[2*h+1]=i[1],o[E]=!0,h++)}var g=new Float32Array(2*h*3);for(f=0,p=h;p>f;f++)for(v=0;2>v;v++){var y=c[d[2*f+v]];g[(C=6*f+3*v)+0]=y.x,g[C+1]=y.y,g[C+2]=y.z}l.addAttribute("position",new r.BufferAttribute(g,3))}else if(t.geometry instanceof r.BufferGeometry)if(void 0!==t.geometry.attributes.index){c=t.geometry.attributes.position.array;var b=t.geometry.attributes.index.array,x=t.geometry.drawcalls;h=0;0===x.length&&(x=[{count:b.length,index:0,start:0}]);d=new Uint32Array(2*b.length);for(var w=0,_=x.length;_>w;++w)for(var S=x[w].start,M=x[w].count,C=x[w].index,T=(f=S,S+M);T>f;f+=3)for(v=0;3>v;v++){var E;i[0]=C+b[f+v],i[1]=C+b[f+(v+1)%3],i.sort(a),void 0===o[E=i.toString()]&&(d[2*h]=i[0],d[2*h+1]=i[1],o[E]=!0,h++)}for(g=new Float32Array(2*h*3),f=0,p=h;p>f;f++)for(v=0;2>v;v++){C=6*f+3*v;var k=3*d[2*f+v];g[C+0]=c[k],g[C+1]=c[k+1],g[C+2]=c[k+2]}l.addAttribute("position",new r.BufferAttribute(g,3))}else{var A=(h=(c=t.geometry.attributes.position.array).length/3)/3;for(g=new Float32Array(2*h*3),f=0,p=A;p>f;f++)for(v=0;3>v;v++){var P=9*f+3*v;g[(C=18*f+6*v)+0]=c[P],g[C+1]=c[P+1],g[C+2]=c[P+2];k=9*f+(v+1)%3*3;g[C+3]=c[k],g[C+4]=c[k+1],g[C+5]=c[k+2]}l.addAttribute("position",new r.BufferAttribute(g,3))}r.Line.call(this,l,new r.LineBasicMaterial({color:n}),r.LinePieces),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},r.WireframeHelper.prototype=Object.create(r.Line.prototype),r.WireframeHelper.prototype.constructor=r.WireframeHelper,r.ImmediateRenderObject=function(){r.Object3D.call(this),this.render=function(t){}},r.ImmediateRenderObject.prototype=Object.create(r.Object3D.prototype),r.ImmediateRenderObject.prototype.constructor=r.ImmediateRenderObject,r.MorphBlendMesh=function(t,e){r.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",o=n-1,a=n/1;this.createAnimation(i,0,o,a),this.setAnimationWeight(i,1)},r.MorphBlendMesh.prototype=Object.create(r.Mesh.prototype),r.MorphBlendMesh.prototype.constructor=r.MorphBlendMesh,r.MorphBlendMesh.prototype.createAnimation=function(t,e,n,i){var r={startFrame:e,endFrame:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},r.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/,i={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o].name.match(n);if(s&&s.length>1)i[l=s[1]]||(i[l]={start:1/0,end:-1/0}),o<(c=i[l]).start&&(c.start=o),o>c.end&&(c.end=o),e||(e=l)}for(var l in i){var c=i[l];this.createAnimation(l,c.start,c.end,t)}this.firstAnimation=e},r.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},r.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},r.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},r.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},r.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},r.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},r.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,n=this.animationsMap[t];return n&&(e=n.time),e},r.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,n=this.animationsMap[t];return n&&(e=n.duration),e},r.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):r.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},r.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},r.MorphBlendMesh.prototype.update=function(t){for(var e=0,n=this.animationsList.length;n>e;e++){var i=this.animationsList[e];if(i.active){var o=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var a=i.startFrame+r.Math.clamp(Math.floor(i.time/o),0,i.length-1),s=i.weight;a!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*s,this.morphTargetInfluences[a]=0,i.lastFrame=i.currentFrame,i.currentFrame=a);var l=i.time%o/o;i.directionBackwards&&(l=1-l),this.morphTargetInfluences[i.currentFrame]=l*s,this.morphTargetInfluences[i.lastFrame]=(1-l)*s}}},void 0!==t&&t.exports&&(e=t.exports=r),e.THREE=r},function(t,e,n){window,function(t){"use strict";var e=["buffers","bufferViews","images","videos","samplers","textures","shaders","programs","techniques","materials","accessors","meshes","cameras","lights","skins","nodes","scenes","animations"],n=Object.create(Object.prototype,{_rootDescription:{value:null,writable:!0},rootDescription:{set:function(t){this._rootDescription=t},get:function(){return this._rootDescription}},baseURL:{value:null,writable:!0},_isAbsolutePath:{value:function(t){var e=new RegExp("^"+window.location.protocol,"i");return!!t.match(e)}},resolvePathIfNeeded:{value:function(t){return this._isAbsolutePath(t)?t:this.baseURL+t}},_resolvePathsForCategories:{value:function(t){t.forEach((function(t){var e=this.json[t];e&&Object.keys(e).forEach((function(t){var n=e[t];n.uri=this.resolvePathIfNeeded(n.uri)}),this)}),this)}},_json:{value:null,writable:!0},json:{enumerable:!0,get:function(){return this._json},set:function(t){this._json!==t&&(this._json=t,this._resolvePathsForCategories(["buffers","shaders","images","videos"]))}},_path:{value:null,writable:!0},getEntryDescription:{value:function(t,e){var n=null,i=e;return(n=this.rootDescription[i])?n?n[t]:null:(console.log("ERROR:CANNOT find expected category named:"+i),null)}},_stepToNextCategory:{value:function(){return this._state.categoryIndex=this.getNextCategoryIndex(this._state.categoryIndex+1),-1!==this._state.categoryIndex&&(this._state.categoryState.index=0,!0)}},_stepToNextDescription:{enumerable:!1,value:function(){var t=this._state.categoryState,e=t.keys;return e?(t.index++,t.keys=null,t.index>=e.length&&this._stepToNextCategory()):(console.log("INCONSISTENCY ERROR"),!1)}},hasCategory:{value:function(t){return!!this.rootDescription[t]}},_handleState:{value:function(){for(var t={buffers:this.handleBuffer,bufferViews:this.handleBufferView,shaders:this.handleShader,programs:this.handleProgram,techniques:this.handleTechnique,materials:this.handleMaterial,meshes:this.handleMesh,cameras:this.handleCamera,lights:this.handleLight,nodes:this.handleNode,scenes:this.handleScene,images:this.handleImage,animations:this.handleAnimation,accessors:this.handleAccessor,skins:this.handleSkin,samplers:this.handleSampler,textures:this.handleTexture,videos:this.handleVideo},n=!0;-1!==this._state.categoryIndex;){var i=e[this._state.categoryIndex],r=this._state.categoryState,o=r.keys;if(o||(r.keys=o=Object.keys(this.rootDescription[i]),!o||0!=o.length)){var a=i,s=o[r.index],l=this.getEntryDescription(s,a);if(l){if(t[a]&&!1===t[a].call(this,s,l,this._state.userInfo)){n=!1;break}this._stepToNextDescription()}else if(this.handleError){this.handleError("INCONSISTENCY ERROR: no description found for entry "+s),n=!1;break}}else this._stepToNextDescription()}this.handleLoadCompleted&&this.handleLoadCompleted(n)}},_loadJSONIfNeeded:{enumerable:!0,value:function(t){var e=this;if(this._json)t&&t(this.json);else{var n=this._path,i=n.lastIndexOf("/");this.baseURL=0!==i?n.substring(0,i+1):"";var r=new XMLHttpRequest;r.open("GET",n,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status)&&(e.json=JSON.parse(r.responseText),t&&t(e.json))},r.send(null)}}},_buildLoader:{value:function(t){function e(e){n.rootDescription=e,t&&t(this)}var n=this;this._loadJSONIfNeeded(e)}},_state:{value:null,writable:!0},_getEntryType:{value:function(t){for(var n=e,i=0;i<n.length;i++)if(this.rootDescription[n[i]])return n[i];return null}},getNextCategoryIndex:{value:function(t){for(var n=t;n<e.length;n++)if(this.hasCategory(e[n]))return n;return-1}},load:{enumerable:!0,value:function(t,e){var n=this;this._buildLoader((function(i){var r=n.getNextCategoryIndex.call(n,0);-1!==r&&(n._state={userInfo:t,options:e,categoryIndex:r,categoryState:{index:"0"}},n._handleState())}))}},initWithPath:{value:function(t){return this._path=t,this._json=null,this}},_knownURLs:{writable:!0,value:{}},loaderContext:{value:function(){return void 0===this._knownURLs[this._path]&&(this._knownURLs[this._path]=Object.keys(this._knownURLs).length),"__"+this._knownURLs[this._path]}},initWithJSON:{value:function(t,e){return this.json=t,this.baseURL=e,e||console.log("WARNING: no base URL passed to Reader:initWithJSON"),this}}});t&&(t.glTFParser=n)}(t.exports)},function(t,e,n){(function(t){t.glTFAnimator=function(){var t=[];return{add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},update:function(){for(i=0;i<t.length;i++)t[i].update()}}}(),t.glTFAnimation=function(t){this.running=!1,this.loop=!1,this.duration=0,this.startTime=0,this.interps=[],t&&this.createInterpolators(t)},t.glTFAnimation.prototype.createInterpolators=function(e){var n,i=e.length;for(n=0;i>n;n++){var r=new t.glTFInterpolator(e[n]);this.interps.push(r),this.duration=Math.max(this.duration,r.duration)}},t.glTFAnimation.prototype.play=function(){this.running||(this.startTime=Date.now(),this.running=!0,t.glTFAnimator.add(this))},t.glTFAnimation.prototype.stop=function(){this.running=!1,t.glTFAnimator.remove(this)},t.glTFAnimation.prototype.update=function(){if(this.running){var t=(Date.now()-this.startTime)/1e3,e=t%this.duration;if(Math.floor(t/this.duration)>=1&&!this.loop){this.running=!1;var n=this.interps.length;for(i=0;n>i;i++)this.interps[i].interp(this.duration);return void this.stop()}var i;n=this.interps.length;for(i=0;n>i;i++)this.interps[i].interp(e)}},t.glTFInterpolator=function(e){this.keys=e.keys,this.values=e.values,this.count=e.count,this.type=e.type,this.path=e.path,this.isRot=!1;var n=e.target;switch(n.updateMatrix(),n.matrixAutoUpdate=!0,this.targetNode=n,e.path){case"translation":this.target=n.position,this.originalValue=n.position.clone();break;case"rotation":this.target=n.quaternion,this.originalValue=n.quaternion.clone(),this.isRot=!0;break;case"scale":this.target=n.scale,this.originalValue=n.scale.clone()}this.duration=this.keys[this.count-1],this.vec1=new t.Vector3,this.vec2=new t.Vector3,this.vec3=new t.Vector3,this.quat1=new t.Quaternion,this.quat2=new t.Quaternion,this.quat3=new t.Quaternion},t.glTFInterpolator.prototype.interp=function(e){var n;if(e==this.keys[0])this.isRot?this.quat3.set(this.values[0],this.values[1],this.values[2],this.values[3]):this.vec3.set(this.values[0],this.values[1],this.values[2]);else if(e<this.keys[0])this.isRot?(this.quat1.set(this.originalValue.x,this.originalValue.y,this.originalValue.z,this.originalValue.w),this.quat2.set(this.values[0],this.values[1],this.values[2],this.values[3]),t.Quaternion.slerp(this.quat1,this.quat2,this.quat3,e/this.keys[0])):(this.vec3.set(this.originalValue.x,this.originalValue.y,this.originalValue.z),this.vec2.set(this.values[0],this.values[1],this.values[2]),this.vec3.lerp(this.vec2,e/this.keys[0]));else if(e>=this.keys[this.count-1])this.isRot?this.quat3.set(this.values[4*(this.count-1)],this.values[4*(this.count-1)+1],this.values[4*(this.count-1)+2],this.values[4*(this.count-1)+3]):this.vec3.set(this.values[3*(this.count-1)],this.values[3*(this.count-1)+1],this.values[3*(this.count-1)+2]);else for(n=0;n<this.count-1;n++){var i=this.keys[n],r=this.keys[n+1];e>=i&&r>=e&&(this.isRot?(this.quat1.set(this.values[4*n],this.values[4*n+1],this.values[4*n+2],this.values[4*n+3]),this.quat2.set(this.values[4*(n+1)],this.values[4*(n+1)+1],this.values[4*(n+1)+2],this.values[4*(n+1)+3]),t.Quaternion.slerp(this.quat1,this.quat2,this.quat3,(e-i)/(r-i))):(this.vec3.set(this.values[3*n],this.values[3*n+1],this.values[3*n+2]),this.vec2.set(this.values[3*(n+1)],this.values[3*(n+1)+1],this.values[3*(n+1)+2]),this.vec3.lerp(this.vec2,(e-i)/(r-i))))}this.target&&this.copyValue(this.target)},t.glTFInterpolator.prototype.copyValue=function(t){this.isRot?t.copy(this.quat3):t.copy(this.vec3)}}).call(e,n(2))},function(t,e,n){(function(t){t.GLTFLoaderUtils=Object.create(Object,{MISSING_DESCRIPTION:{value:"MISSING_DESCRIPTION"},INVALID_PATH:{value:"INVALID_PATH"},INVALID_TYPE:{value:"INVALID_TYPE"},XMLHTTPREQUEST_STATUS_ERROR:{value:"XMLHTTPREQUEST_STATUS_ERROR"},NOT_FOUND:{value:"NOT_FOUND"},ARRAY_BUFFER:{value:"ArrayBuffer"},_streams:{value:{},writable:!0},_streamsStatus:{value:{},writable:!0},_resources:{value:{},writable:!0},_resourcesStatus:{value:{},writable:!0},init:{value:function(){this._streams={},this._streamsStatus={},this._resources={},this._resourcesStatus={}}},_containsResource:{enumerable:!1,value:function(t){return!!this._resources[t]}},_storeResource:{enumerable:!1,value:function(t,e){return t?(this._containsResource[t]&&console.log("WARNING: resource:"+t+" is already stored, overriding"),void(this._resources[t]=e)):void console.log("ERROR: entry does not contain id, cannot store")}},_getResource:{enumerable:!1,value:function(t){return this._resources[t]}},_loadStream:{value:function(e,n,i){if(n)if(e){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType=n===this.ARRAY_BUFFER?"arraybuffer":"text",r.setRequestHeader("If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),r.onload=function(n){0==r.status||200==r.status||206==r.status?i.streamAvailable(e,r.response):i.handleError(t.GLTFLoaderUtils.XMLHTTPREQUEST_STATUS_ERROR,this.status)},r.send(null)}else i.handleError(t.GLTFLoaderUtils.INVALID_PATH);else i.handleError(t.GLTFLoaderUtils.INVALID_TYPE,null)}},send:{value:0,writable:!0},requested:{value:0,writable:!0},_handleRequest:{value:function(t){this._resourcesStatus[t.id]?this._resourcesStatus[t.id]++:this._resourcesStatus[t.id]=1;var e=this._streamsStatus[t.uri];if(e&&"loading"===e.status)e.requests.push(t);else{this._streamsStatus[t.uri]={status:"loading",requests:[t]};var n=this,i={streamAvailable:function(t,e){n._streamsStatus[t].requests.forEach((function(t){var i=e.slice(t.range[0],t.range[1]),r=t.delegate.convert(i,t.ctx);n._storeResource(t.id,r),t.delegate.resourceAvailable(r,t.ctx),--n._resourcesStatus[t.id]}),this),delete n._streamsStatus[t]},handleError:function(e,n){t.delegate.handleError(e,n)}};this._loadStream(t.uri,t.type,i)}}},_elementSizeForGLType:{value:function(t,e){var n=0;switch(e){case"SCALAR":n=1;break;case"VEC2":n=2;break;case"VEC3":n=3;break;case"VEC4":case"MAT2":n=4;break;case"MAT3":n=9;break;case"MAT4":n=16}switch(t){case WebGLRenderingContext.FLOAT:return Float32Array.BYTES_PER_ELEMENT*n;case WebGLRenderingContext.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT*n;case WebGLRenderingContext.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT*n;default:return null}}},_handleWrappedBufferViewResourceLoading:{value:function(t,e,n){var i=t.bufferView,r=i.buffer,o=t.byteOffset+i.description.byteOffset,a=[o,this._elementSizeForGLType(t.componentType,t.type)*t.count+o];this._handleRequest({id:t.id,range:a,type:r.description.type,uri:r.description.uri,delegate:e,ctx:n},null)}},getBuffer:{value:function(t,e,n){var i=this._getResource(t.id);return i||(this._handleWrappedBufferViewResourceLoading(t,e,n),null)}},getFile:{value:function(t,e,n){return t.delegate=e,t.ctx=n,this._handleRequest({id:t.id,uri:t.uri,range:[0],type:"text",delegate:e,ctx:n},null),null}}})}).call(e,n(2))},function(t,e,n){(function(t,e){t.glTFLoader=function(e){this.useBufferGeometry=void 0===t.glTFLoader.useBufferGeometry||t.glTFLoader.useBufferGeometry,this.meshesRequested=0,this.meshesLoaded=0,this.pendingMeshes=[],this.animationsRequested=0,this.animationsLoaded=0,this.animations=[],this.shadersRequested=0,this.shadersLoaded=0,this.shaders={},t.Loader.call(this,e)},t.glTFLoader.prototype=new t.Loader,t.glTFLoader.prototype.constructor=t.glTFLoader,t.glTFLoader.prototype.load=function(n,i){function r(t){if(!t)return 4294967295;return(255<<24)+(Math.floor(255*t[0])<<16)+(Math.floor(255*t[1])<<8)+Math.floor(255*t[2])}function o(e,n){var i,r=new t.Quaternion,o=new t.Vector3;for(new t.Vector3,i=0;n>i;i++){o.set(e[4*i],e[4*i+1],e[4*i+2]).normalize();var a=e[4*i+3];r.setFromAxisAngle(o,a),e[4*i]=r.x,e[4*i+1]=r.y,e[4*i+2]=r.z,e[4*i+3]=r.w}}function a(t){switch(t){case"SCALAR":nElements=1;break;case"VEC2":nElements=2;break;case"VEC3":nElements=3;break;case"VEC4":case"MAT2":nElements=4;break;case"MAT3":nElements=9;break;case"MAT4":nElements=16}return nElements}function s(e){return e?t.ImageUtils.loadTexture(e):null}var l=this,c=function(){l.useBufferGeometry?this.geometry=new t.BufferGeometry:this.geometry=new t.Geometry,this.totalAttributes=0,this.loadedAttributes=0,this.indicesLoaded=!1,this.finished=!1,this.onload=null,this.uvs=null,this.indexArray=null};c.prototype.constructor=c,c.prototype.buildArrayGeometry=function(){var e,n,i,r,o,a=this.geometry,s=a.normals,l=this.indexArray,c=this.uvs,u=null;for(r=0,o=this.indexArray.length;o>r;r+=3)e=l[r],n=l[r+1],i=l[r+2],s&&(u=[s[e],s[n],s[i]]),a.faces.push(new t.Face3(e,n,i,u,null,null)),c&&a.faceVertexUvs[0].push([c[e],c[n],c[i]]);a.computeBoundingBox(),a.computeBoundingSphere(),a.computeFaceNormals(),s||a.computeVertexNormals()},c.prototype.buildBufferGeometry=function(){var e=this.geometry;e.addAttribute("index",new t.BufferAttribute(this.indexArray,1));var n={start:0,index:0,count:this.indexArray.length};e.offsets.push(n),e.computeBoundingSphere()},c.prototype.checkFinished=function(){this.indexArray&&this.loadedAttributes===this.totalAttributes&&(l.useBufferGeometry?this.buildBufferGeometry():this.buildArrayGeometry(),this.finished=!0,this.onload&&this.onload())};var u=function(){};u.prototype.handleError=function(t,e){console.log("ERROR(IndicesDelegate):"+t+":"+e)},u.prototype.convert=function(t,e){return new Uint16Array(t,0,e.indices.count)},u.prototype.resourceAvailable=function(t,e){var n=e.geometry;return n.indexArray=t,n.checkFinished(),!0};var h=new u,d=function(t,e){this.indices=t,this.geometry=e},f=function(){};f.prototype.handleError=function(t,e){console.log("ERROR(VertexAttributeDelegate):"+t+":"+e)},f.prototype.convert=function(t,e){return t},f.prototype.arrayResourceAvailable=function(e,n){var i,r,o,s=n.geometry,l=n.attribute,c=n.semantic;if("POSITION"==c)for(r=0,o=(i=new Float32Array(e,0,l.count*a(l.type))).length;o>r;r+=3)s.geometry.vertices.push(new t.Vector3(i[r],i[r+1],i[r+2]));else if("NORMAL"==c)for(s.geometry.normals=[],r=0,o=(i=new Float32Array(e,0,l.count*a(l.type))).length;o>r;r+=3)s.geometry.normals.push(new t.Vector3(i[r],i[r+1],i[r+2]));else if("TEXCOORD_0"==c||"TEXCOORD"==c)for(s.uvs=[],r=0,o=(i=new Float32Array(e,0,l.count*a(l.type))).length;o>r;r+=2)s.uvs.push(new t.Vector2(i[r],1-i[r+1]));else if("WEIGHT"==c)for(nComponents=a(l.type),r=0,o=(i=new Float32Array(e,0,l.count*nComponents)).length;o>r;r+=4)s.geometry.skinWeights.push(new t.Vector4(i[r],i[r+1],i[r+2],i[r+3]));else if("JOINT"==c)for(nComponents=a(l.type),r=0,o=(i=new Float32Array(e,0,l.count*nComponents)).length;o>r;r+=4)s.geometry.skinIndices.push(new t.Vector4(i[r],i[r+1],i[r+2],i[r+3]))},f.prototype.bufferResourceAvailable=function(e,n){var i,r,o,s=n.geometry,l=n.attribute,c=n.semantic;if("POSITION"==c)i=new Float32Array(e,0,l.count*a(l.type)),s.geometry.addAttribute("position",new t.BufferAttribute(i,3));else if("NORMAL"==c)o=a(l.type),i=new Float32Array(e,0,l.count*o),s.geometry.addAttribute("normal",new t.BufferAttribute(i,3));else if("TEXCOORD_0"==c||"TEXCOORD"==c){for(o=a(l.type),i=new Float32Array(e,0,l.count*o),r=0;r<i.length/2;r++)i[2*r+1]=1-i[2*r+1];s.geometry.addAttribute("uv",new t.BufferAttribute(i,o))}else"WEIGHT"==c?(o=a(l.type),i=new Float32Array(e,0,l.count*o),s.geometry.addAttribute("skinWeight",new t.BufferAttribute(i,o))):"JOINT"==c&&(o=a(l.type),i=new Float32Array(e,0,l.count*o),s.geometry.addAttribute("skinIndex",new t.BufferAttribute(i,o)))},f.prototype.resourceAvailable=function(t,e){l.useBufferGeometry?this.bufferResourceAvailable(t,e):this.arrayResourceAvailable(t,e);var n=e.geometry;return n.loadedAttributes++,n.checkFinished(),!0};var p=new f,m=function(t,e,n){this.attribute=t,this.semantic=e,this.geometry=n},v=function(){this.primitives=[],this.materialsPending=[],this.loadedGeometry=0,this.onCompleteCallbacks=[]};v.prototype.addPrimitive=function(t,e){var n=this;t.onload=function(){n.loadedGeometry++,n.checkComplete()},this.primitives.push({geometry:t,material:e,mesh:null})},v.prototype.onComplete=function(t){this.onCompleteCallbacks.push(t),this.checkComplete()},v.prototype.checkComplete=function(){var t=this;this.onCompleteCallbacks.length&&this.primitives.length==this.loadedGeometry&&(this.onCompleteCallbacks.forEach((function(e){e(t)})),this.onCompleteCallbacks=[])},v.prototype.attachToNode=function(e){this.primitives.forEach((function(n){var i=n.material;i instanceof t.Material||(i=l.createShaderMaterial(i));var r=new t.Mesh(n.geometry.geometry,i);r.castShadow=!0,e.add(r)}))};var g=function(t){this.params=t},y=function(){};y.prototype.handleError=function(t,e){console.log("ERROR(AnimationParameterDelegate):"+t+":"+e)},y.prototype.convert=function(t,e){var n=e.parameter,i=null;switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":i=new Float32Array(t,0,n.count*a(n.type))}return i},y.prototype.resourceAvailable=function(t,e){var n=e.animation,i=e.parameter;return i.data=t,n.handleParameterLoaded(i),!0};var b=new y,x=function(t,e){this.parameter=t,this.animation=e},w=function(){this.totalParameters=0,this.loadedParameters=0,this.parameters={},this.finishedLoading=!1,this.onload=null};w.prototype.constructor=w,w.prototype.handleParameterLoaded=function(t){this.parameters[t.name]=t,this.loadedParameters++,this.checkFinished()},w.prototype.checkFinished=function(){this.loadedParameters===this.totalParameters&&(this.finishedLoading=!0,this.onload&&this.onload())};var _=function(){};_.prototype.handleError=function(t,e){console.log("ERROR(InverseBindMatricesDelegate):"+t+":"+e)},_.prototype.convert=function(t,e){var n=e.parameter,i=null;if("MAT4"===n.type)i=new Float32Array(t,0,n.count*a(n.type));return i},_.prototype.resourceAvailable=function(t,e){return e.skin.inverseBindMatrices=t,!0};var S=new _,M=function(t,e){this.parameter=t,this.skin=e},C=function(){};C.prototype.handleError=function(t,e){console.log("ERROR(ShaderDelegate):"+t+":"+e)},C.prototype.convert=function(t,e){return t},C.prototype.resourceAvailable=function(t,e){return l.shadersLoaded++,l.shaders[e.id]=t,l.checkComplete(),!0};var T=new C,E=function(t,e){this.id=t,this.uri=e},k=function(t,e,n){this.entryID=t,this.object=e,this.description=n},A=function(){this._entries={}};A.prototype.setEntry=function(t,e,n){return t?(this._entries[t]&&console.warn("entry["+t+"] is being overwritten"),void(this._entries[t]=new k(t,e,n))):void console.error("No EntryID provided, cannot store",n)},A.prototype.getEntry=function(t){return this._entries[t]},A.prototype.clearEntries=function(){this._entries={}};var P=function(){};P.prototype.loadCompleted=function(t,e){t.call(Window,e)};var L=Object.create(t.GLTFLoaderUtils),O=Object.create(e,{load:{enumerable:!0,value:function(t,n){this.resources=new A,this.cameras=[],this.lights=[],this.animations=[],this.joints={},this.skeltons={},L.init(),e.load.call(this,t,n)}},cameras:{enumerable:!0,writable:!0,value:[]},lights:{enumerable:!0,writable:!0,value:[]},animations:{enumerable:!0,writable:!0,value:[]},handleBuffer:{value:function(t,e,n){return this.resources.setEntry(t,null,e),e.type="ArrayBuffer",!0}},handleBufferView:{value:function(t,e,n){this.resources.setEntry(t,null,e);var i=this.resources.getEntry(e.buffer);return e.type="ArrayBufferView",this.resources.getEntry(t).buffer=i,!0}},handleShader:{value:function(t,e,n){this.resources.setEntry(t,null,e);var i={id:t,uri:e.uri},r=new E(t,e.uri);return l.shadersRequested++,L.getFile(i,T,r),!0}},handleProgram:{value:function(t,e,n){return this.resources.setEntry(t,null,e),!0}},handleTechnique:{value:function(t,e,n){return this.resources.setEntry(t,null,e),!0}},createShaderMaterial:{value:function(e){var n=l.shaders[e.params.fragmentShader];if(!n)return console.log("ERROR: Missing fragment shader definition:",e.params.fragmentShader),new t.MeshPhongMaterial;var i=l.shaders[e.params.vertexShader];if(!n)return console.log("ERROR: Missing vertex shader definition:",e.params.vertexShader),new t.MeshPhongMaterial;return new t.ShaderMaterial({fragmentShader:n,vertexShader:i,uniforms:{}}),new t.MeshPhongMaterial(e.params)}},createShaderParams:{value:function(t,e,n,i){var r=this.resources.getEntry(i.program);r&&(n.fragmentShader=r.description.fragmentShader,n.vertexShader=r.description.vertexShader,n.attributes=i.attributes,n.uniforms=i.uniforms)}},threeJSMaterialType:{value:function(e,n,i,o){var a=t.MeshPhongMaterial,l=null;if(n&&n.description&&n.description.passes&&(l=n.description.passes.defaultPass),l)if(l.details&&l.details.commonProfile){var c=n.description.passes.defaultPass.details.commonProfile;if(c){switch(c.lightingModel){case"Blinn":case"Phong":a=t.MeshPhongMaterial;break;case"Lambert":a=t.MeshLambertMaterial;break;default:a=t.MeshBasicMaterial}c.extras&&c.extras.doubleSided&&(o.side=t.DoubleSide)}}else if(l.instanceProgram){var u=l.instanceProgram;this.createShaderParams(e,i,o,u);a=g}var h=null,d=null,f=i.diffuse;f&&((y=f)&&(p=this.resources.getEntry(y))&&((m=this.resources.getEntry(p.description.source))&&(h=m.description.uri),(v=this.resources.getEntry(p.description.sampler))&&(d=v.description)));(y=s(h))&&d&&(d.wrapS==WebGLRenderingContext.REPEAT&&(y.wrapS=t.RepeatWrapping),d.wrapT==WebGLRenderingContext.REPEAT&&(y.wrapT=t.RepeatWrapping),d.magFilter==WebGLRenderingContext.LINEAR&&(y.magFilter=t.LinearFilter),o.map=y);var p,m,v,y,b=null,x=null,w=i.reflective;w&&((y=w)&&(p=this.resources.getEntry(y))&&((m=this.resources.getEntry(p.description.source))&&(b=m.description.uri),(v=this.resources.getEntry(p.description.sampler))&&(x=v.description)));(y=s(b))&&x&&(x.wrapS==WebGLRenderingContext.REPEAT&&(y.wrapS=t.RepeatWrapping),x.wrapT==WebGLRenderingContext.REPEAT&&(y.wrapT=t.RepeatWrapping),x.magFilter==WebGLRenderingContext.LINEAR&&(y.magFilter=t.LinearFilter),o.envMap=y);var _=i.shininesss||i.shininess,S=h?null:f,M=1;if(i.hasOwnProperty("transparency")){M=i.transparency}return o.color=r(S),o.opacity=M,o.transparent=1>M,void 0!==_&&(o.shininess=_),void 0!==i.ambient&&"string"!=typeof i.ambient&&(o.ambient=r(i.ambient)),void 0!==i.emission&&(o.emissive=r(i.emission)),void 0!==i.specular&&(o.specular=r(i.specular)),a}},handleMaterial:{value:function(t,e,n){var i=this.resources.getEntry(e.instanceTechnique.technique),r={},o=e.instanceTechnique.values,a=new(this.threeJSMaterialType(t,i,o,r))(r);return a.name=t,this.resources.setEntry(t,a,e),!0}},handleMesh:{value:function(t,e,n){var i=new v;i.name=t,this.resources.setEntry(t,i,e);var r=e.primitives;if(!r)return console.log("MISSING_PRIMITIVES for mesh:"+t),!1;for(var o=0;o<r.length;o++){var a=r[o];if(a.primitive===WebGLRenderingContext.TRIANGLES){var s=new c,l=this.resources.getEntry(a.material);i.addPrimitive(s,l.object);var u=this.resources.getEntry(a.indices),f={bufferView:this.resources.getEntry(u.description.bufferView),byteOffset:u.description.byteOffset,count:u.description.count,id:u.entryID,componentType:u.description.componentType,type:u.description.type},g=new d(f,s);(L.getBuffer(f,h,g),Object.keys(a.attributes)).forEach((function(t){s.totalAttributes++;var n,i=a.attributes[t],r=this.resources.getEntry(i);if(r){(n=r.object).id=i;var o=this.resources.getEntry(n.bufferView)}else{(n=e.attributes[i]).id=i,this.resources.setEntry(i,n,n);o=this.resources.getEntry(n.bufferView);r=this.resources.getEntry(i)}var l={bufferView:o,byteOffset:n.byteOffset,byteStride:n.byteStride,count:n.count,max:n.max,min:n.min,componentType:n.componentType,type:n.type,id:i},c=new m(l,t,s);L.getBuffer(l,p,c)}),this)}}return!0}},handleCamera:{value:function(e,n,i){var r;if("perspective"==n.type){var o=n.perspective.znear,a=n.perspective.zfar,s=n.perspective.yfov,l=n.perspective.xfov,c=n.perspective.aspect_ratio;c||(c=1),void 0===s&&l&&(s=l/c),s&&(r=new t.PerspectiveCamera(s,c,o,a))}else r=new t.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,o,a);return r&&this.resources.setEntry(e,r,n),!0}},handleLight:{value:function(e,n,i){var o=null,a=n.type;if(a&&n[a]){var s=r(n[a].color);switch(a){case"directional":(o=new t.DirectionalLight(s)).position.set(0,0,1);break;case"point":o=new t.PointLight(s);break;case"spot ":(o=new t.SpotLight(s)).position.set(0,0,1);break;case"ambient":o=new t.AmbientLight(s)}}return o&&this.resources.setEntry(e,o,n),!0}},addPendingMesh:{value:function(t,e){l.pendingMeshes.push({mesh:t,node:e})}},handleNode:{value:function(e,n,i){var r=null;n.jointName?((r=new t.Bone).jointName=n.jointName,this.joints[n.jointName]=e):r=new t.Object3D,r.name=n.name,this.resources.setEntry(e,r,n);var a=n.matrix;if(a)r.matrixAutoUpdate=!1,r.applyMatrix((new t.Matrix4).set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]));else{var s=n.translation,c=n.rotation,u=n.scale,h=s?new t.Vector3(s[0],s[1],s[2]):new t.Vector3;c&&o(c,1);var d=c?new t.Quaternion(c[0],c[1],c[2],c[3]):new t.Quaternion,f=u?new t.Vector3(u[0],u[1],u[2]):new t.Vector3(1,1,1),p=new t.Matrix4;p.compose(h,d,f),r.matrixAutoUpdate=!1,r.applyMatrix(p)}var m,v=this;if(n.mesh&&(m=this.resources.getEntry(n.mesh),l.meshesRequested++,m.object.onComplete((function(t){v.addPendingMesh(t,r),l.meshesLoaded++,l.checkComplete()}))),n.meshes&&n.meshes.forEach((function(t){m=this.resources.getEntry(t),l.meshesRequested++,m.object.onComplete((function(t){v.addPendingMesh(t,r),l.meshesLoaded++,l.checkComplete()}))}),this),n.instanceSkin){var g=this.resources.getEntry(n.instanceSkin.skin);if(g){var y=g.object;n.instanceSkin.skin=y,r.instanceSkin=n.instanceSkin;var b=n.instanceSkin.meshes;y.meshes=[],b.forEach((function(e){m=this.resources.getEntry(e),l.meshesRequested++,t.glTFLoader.totalMeshesRequested++,m.object.onComplete((function(e){y.meshes.push(e),l.meshesLoaded++,t.glTFLoader.totalMeshesLoaded++,l.checkComplete()}))}),this)}}if(n.camera){var x=this.resources.getEntry(n.camera);x&&(r.add(x.object),this.cameras.push(x.object))}if(n.light){var w=this.resources.getEntry(n.light);w&&(r.add(w.object),this.lights.push(w.object))}return!0}},buildNodeHirerachy:{value:function(t,e){var n=this.resources.getEntry(t),i=n.object;e.add(i);var r=n.description.children;return r&&r.forEach((function(t){this.buildNodeHirerachy(t,i)}),this),i}},buildSkin:{value:function(e){var n=e.instanceSkin.skin;n&&e.instanceSkin.skeletons.forEach((function(i){var r=this.resources.getEntry(i);if(r){var o,a=r.object,s=n.meshes.length;for(o=0;s>o;o++){var l=n.meshes[o],c=null;l.primitives.forEach((function(r){var o=r.material;o instanceof t.Material||(o=this.createShaderMaterial(o)),(c=new t.SkinnedMesh(r.geometry.geometry,o,!1)).add(a);var s,l=r.geometry.geometry;if(l.vertices)for(s=0;s<l.vertices.length;s++)l.vertices[s].applyMatrix4(n.bindShapeMatrix);else if(l.attributes.position){var u=l.attributes.position.array,h=new t.Vector3;for(s=0;s<u.length/3;s++)h.set(u[3*s],u[3*s+1],u[3*s+2]),h.applyMatrix4(n.bindShapeMatrix),u[3*s]=h.x,u[3*s+1]=h.y,u[3*s+2]=h.z}if(c){o.skinning=!0;var d=n.jointNames,f=[];c.skeleton.bones=[],c.skeleton.boneInverses=[],c.skeleton.boneMatrices=new Float32Array(16*d.length);var p,m=d.length;for(p=0;m>p;p++){var v=d[p],g=this.joints[v],y=this.resources.getEntry(g).object;if(y){y.skin=c,f.push(y),c.skeleton.bones.push(y);var b=n.inverseBindMatrices,x=(new t.Matrix4).set(b[16*p+0],b[16*p+4],b[16*p+8],b[16*p+12],b[16*p+1],b[16*p+5],b[16*p+9],b[16*p+13],b[16*p+2],b[16*p+6],b[16*p+10],b[16*p+14],b[16*p+3],b[16*p+7],b[16*p+11],b[16*p+15]);c.skeleton.boneInverses.push(x),c.skeleton.pose()}else console.log("WARNING: jointName:"+v+" cannot be found in skeleton:"+i)}}c&&(c.castShadow=!0,e.add(c))}),this)}}}),this)}},buildSkins:{value:function(t){t.instanceSkin&&this.buildSkin(t);var e=t.children;e&&e.forEach((function(t){this.buildSkins(t)}),this)}},createMeshAnimations:{value:function(t){this.buildSkins(t)}},handleScene:{value:function(t,e,n){return e.nodes?(e.nodes.forEach((function(t){this.buildNodeHirerachy(t,n.rootObj)}),this),this.delegate&&this.delegate.loadCompleted(n.callback,n.rootObj),!0):(console.log("ERROR: invalid file required nodes property is missing from scene"),!1)}},handleImage:{value:function(t,e,n){return this.resources.setEntry(t,null,e),!0}},addNodeAnimationChannel:{value:function(t,e,n){this.nodeAnimationChannels||(this.nodeAnimationChannels={}),this.nodeAnimationChannels[t]||(this.nodeAnimationChannels[t]=[]),this.nodeAnimationChannels[t].push(n)}},createAnimations:{value:function(){for(var e in this.nodeAnimationChannels){var n=this.nodeAnimationChannels[e],i=(n.length,new t.glTFAnimation(n));i.name="animation_"+e,this.animations.push(i)}}},buildAnimation:{value:function(t){var e,n=[],i=t.channels.length;for(e=0;i>e;e++){var r=t.channels[e],a=t.samplers[r.sampler];if(a){var s=t.parameters[a.input];if(s&&s.data){var l=t.parameters[a.output];if(l&&l.data){var c=r.target,u=this.resources.getEntry(c.id);if(u){var h=c.path;"rotation"==h&&o(l.data,l.count);var d={keys:s.data,values:l.data,count:s.count,target:u.object,path:h,type:a.interpolation};this.addNodeAnimationChannel(c.id,r,d),n.push(d)}}}}}}},handleAnimation:{value:function(t,e,n){l.animationsRequested++;var i=new w;i.name=t,i.onload=function(){l.animationsLoaded++,l.animations.push(i),l.checkComplete()},i.channels=e.channels,i.samplers=e.samplers,this.resources.setEntry(t,i,e);var r=e.parameters;return r?(Object.keys(r).forEach((function(t){i.totalParameters++;var e=r[t],n=this.resources.getEntry(e);n=n.object;var o={bufferView:this.resources.getEntry(n.bufferView),byteOffset:n.byteOffset,count:n.count,componentType:n.componentType,type:n.type,id:n.bufferView,name:t},a=new x(o,i);L.getBuffer(o,b,a)}),this),!0):(console.log("MISSING_PARAMETERS for animation:"+t),!1)}},handleAccessor:{value:function(t,e,n){return this.resources.setEntry(t,e,e),!0}},handleSkin:{value:function(e,n,i){var r={},o=n.bindShapeMatrix;r.bindShapeMatrix=(new t.Matrix4).set(o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14],o[3],o[7],o[11],o[15]),r.jointNames=n.jointNames;var a=this.resources.getEntry(n.inverseBindMatrices);a=a.description,r.inverseBindMatricesDescription=a,r.inverseBindMatricesDescription.id=n.inverseBindMatrices;var s={bufferView:this.resources.getEntry(a.bufferView),byteOffset:a.byteOffset,count:a.count,componentType:a.componentType,type:a.type,id:a.bufferView,name:r.inverseBindMatricesDescription.id},l=new M(s,r),c=(L.getBuffer(s,S,l),this.resources.getEntry(r.inverseBindMatricesDescription.bufferView));return r.inverseBindMatricesDescription.bufferView=c.object,this.resources.setEntry(e,r,n),!0}},handleSampler:{value:function(t,e,n){return this.resources.setEntry(t,e,e),!0}},handleTexture:{value:function(t,e,n){return this.resources.setEntry(t,null,e),!0}},handleError:{value:function(t){throw new Error(t)}},_delegate:{value:new P,writable:!0},delegate:{enumerable:!0,get:function(){return this._delegate},set:function(t){this._delegate=t}}}),R=new t.Object3D,F=Object.create(O);return F.initWithPath(n),F.load(new function(t,e){this.rootObj=t,this.callback=e}(R,(function(t){})),null),this.loader=F,this.callback=i,this.rootObj=R,R},t.glTFLoader.prototype.callLoadedCallback=function(){var t={scene:this.rootObj,cameras:this.loader.cameras,animations:this.loader.animations};this.callback(t)},t.glTFLoader.prototype.checkComplete=function(){if(this.meshesLoaded==this.meshesRequested&&this.shadersLoaded==this.shadersRequested&&this.animationsLoaded==this.animationsRequested){for(var t=0;t<this.pendingMeshes.length;t++){var e=this.pendingMeshes[t];e.mesh.attachToNode(e.node)}for(t=0;t<this.animationsLoaded;t++){var n=this.animations[t];this.loader.buildAnimation(n)}this.loader.createAnimations(),this.loader.createMeshAnimations(this.rootObj),this.callLoadedCallback()}}}).call(e,n(2),n(7))},function(t,e,n){var i;(function(){window,function(e,n){void 0===(i=function(){return n(e)}.apply(false,[]))||(t.exports=i)}(this,(function(t){"use strict";var e=["buffers","bufferViews","images","videos","samplers","textures","shaders","programs","techniques","materials","accessors","meshes","cameras","lights","skins","nodes","scenes","animations"],n=Object.create(Object.prototype,{_rootDescription:{value:null,writable:!0},rootDescription:{set:function(t){this._rootDescription=t},get:function(){return this._rootDescription}},baseURL:{value:null,writable:!0},_isAbsolutePath:{value:function(t){var e=new RegExp("^"+window.location.protocol,"i");return!!t.match(e)}},resolvePathIfNeeded:{value:function(t){return this._isAbsolutePath(t)?t:this.baseURL+t}},_resolvePathsForCategories:{value:function(t){t.forEach((function(t){var e=this.json[t];e&&Object.keys(e).forEach((function(t){var n=e[t];n.uri=this.resolvePathIfNeeded(n.uri)}),this)}),this)}},_json:{value:null,writable:!0},json:{enumerable:!0,get:function(){return this._json},set:function(t){this._json!==t&&(this._json=t,this._resolvePathsForCategories(["buffers","shaders","images","videos"]))}},_path:{value:null,writable:!0},getEntryDescription:{value:function(t,e){var n,i=e;return(n=this.rootDescription[i])?n?n[t]:null:(console.log("ERROR:CANNOT find expected category named:"+i),null)}},_stepToNextCategory:{value:function(){return this._state.categoryIndex=this.getNextCategoryIndex(this._state.categoryIndex+1),-1!==this._state.categoryIndex&&(this._state.categoryState.index=0,!0)}},_stepToNextDescription:{enumerable:!1,value:function(){var t=this._state.categoryState,e=t.keys;return e?(t.index++,t.keys=null,t.index>=e.length&&this._stepToNextCategory()):(console.log("INCONSISTENCY ERROR"),!1)}},hasCategory:{value:function(t){return!!this.rootDescription[t]}},_handleState:{value:function(){for(var t={buffers:this.handleBuffer,bufferViews:this.handleBufferView,shaders:this.handleShader,programs:this.handleProgram,techniques:this.handleTechnique,materials:this.handleMaterial,meshes:this.handleMesh,cameras:this.handleCamera,lights:this.handleLight,nodes:this.handleNode,scenes:this.handleScene,images:this.handleImage,animations:this.handleAnimation,accessors:this.handleAccessor,skins:this.handleSkin,samplers:this.handleSampler,textures:this.handleTexture,videos:this.handleVideo},n=!0;-1!==this._state.categoryIndex;){var i=e[this._state.categoryIndex],r=this._state.categoryState,o=r.keys;if(o||(r.keys=o=Object.keys(this.rootDescription[i]),!o||0!=o.length)){var a=i,s=o[r.index],l=this.getEntryDescription(s,a);if(l){if(t[a]&&!1===t[a].call(this,s,l,this._state.userInfo)){n=!1;break}this._stepToNextDescription()}else if(this.handleError){this.handleError("INCONSISTENCY ERROR: no description found for entry "+s),n=!1;break}}else this._stepToNextDescription()}this.handleLoadCompleted&&this.handleLoadCompleted(n)}},_loadJSONIfNeeded:{enumerable:!0,value:function(t){var e=this;if(this._json)t&&t(this.json);else{var n=this._path,i=n.lastIndexOf("/");this.baseURL=0!==i?n.substring(0,i+1):"";var r=new XMLHttpRequest;r.open("GET",n,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status)&&(e.json=JSON.parse(r.responseText),t&&t(e.json))},r.send(null)}}},_buildLoader:{value:function(t){var e=this;this._loadJSONIfNeeded((function(n){e.rootDescription=n,t&&t(this)}))}},_state:{value:null,writable:!0},_getEntryType:{value:function(t){for(var n=e,i=0;i<n.length;i++){if(this.rootDescription[n[i]])return n[i]}return null}},getNextCategoryIndex:{value:function(t){for(var n=t;n<e.length;n++)if(this.hasCategory(e[n]))return n;return-1}},load:{enumerable:!0,value:function(t,e){var n=this;this._buildLoader((function(i){var r=n.getNextCategoryIndex.call(n,0);-1!==r&&(n._state={userInfo:t,options:e,categoryIndex:r,categoryState:{index:"0"}},n._handleState())}))}},initWithPath:{value:function(t){return this._path=t,this._json=null,this}},_knownURLs:{writable:!0,value:{}},loaderContext:{value:function(){return void 0===this._knownURLs[this._path]&&(this._knownURLs[this._path]=Object.keys(this._knownURLs).length),"__"+this._knownURLs[this._path]}},initWithJSON:{value:function(t,e){return this.json=t,this.baseURL=e,e||console.log("WARNING: no base URL passed to Reader:initWithJSON"),this}}});return t&&(t.glTFParser=n),n})),t.exports=window.glTFParser}).call(window)},function(t,e,n){(function(t){t.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")}}).call(e,n(2))},function(t,e,n){(function(t){t.ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{type:"t",value:null},uImageIncrement:{type:"v2",value:new t.Vector2(.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(t){function e(t,e){return Math.exp(-t*t/(2*e*e))}var n,i,r,o,a=2*Math.ceil(3*t)+1;for(a>25&&(a=25),o=.5*(a-1),i=new Array(a),r=0,n=0;a>n;++n)i[n]=e(n-o,t),r+=i[n];for(n=0;a>n;++n)i[n]/=r;return i}}}).call(e,n(2))},function(t,e,n){(function(t){t.DotScreenShader={uniforms:{tDiffuse:{type:"t",value:null},tSize:{type:"v2",value:new t.Vector2(256,256)},center:{type:"v2",value:new t.Vector2(.5,.5)},angle:{type:"f",value:1.57},scale:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")}}).call(e,n(2))},function(t,e,n){(function(t){t.FilmShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},nIntensity:{type:"f",value:.5},sIntensity:{type:"f",value:.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float x = vUv.x * vUv.y * time *  1000.0;","x = mod( x, 13.0 ) * mod( x, 123.0 );","float dx = mod( x, 0.01 );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")}}).call(e,n(2))},function(t,e,n){(function(t){t.EffectComposer=function(e,n){if(this.renderer=e,void 0===n){var i=e.getPixelRatio(),r=Math.floor(e.context.canvas.width/i)||1,o=Math.floor(e.context.canvas.height/i)||1,a={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat,stencilBuffer:!1};n=new t.WebGLRenderTarget(r,o,a)}this.renderTarget1=n,this.renderTarget2=n.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===t.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new t.ShaderPass(t.CopyShader)},t.EffectComposer.prototype={swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t)},insertPass:function(t,e){this.passes.splice(e,0,t)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var n,i,r=!1,o=this.passes.length;for(i=0;o>i;i++)if((n=this.passes[i]).enabled){if(n.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),n.needsSwap){if(r){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}n instanceof t.MaskPass?r=!0:n instanceof t.ClearMaskPass&&(r=!1)}},reset:function(t){if(void 0===t){t=this.renderTarget1.clone();var e=this.renderer.getPixelRatio();t.width=Math.floor(this.renderer.context.canvas.width/e),t.height=Math.floor(this.renderer.context.canvas.height/e)}this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){var n=this.renderTarget1.clone();n.width=t,n.height=e,this.reset(n)}}}).call(e,n(2))},function(t,e,n){(function(t){t.ShaderPass=function(e,n){this.textureID=void 0!==n?n:"tDiffuse",this.uniforms=t.UniformsUtils.clone(e.uniforms),this.material=new t.ShaderMaterial({defines:e.defines||{},uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new t.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new t.Scene,this.quad=new t.Mesh(new t.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},t.ShaderPass.prototype={render:function(t,e,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}}}).call(e,n(2))},function(t,e,n){(function(t){t.MaskPass=function(t,e){this.scene=t,this.camera=e,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},t.MaskPass.prototype={render:function(t,e,n,i){var r,o,a=t.context;a.colorMask(!1,!1,!1,!1),a.depthMask(!1),this.inverse?(r=0,o=1):(r=1,o=0),a.enable(a.STENCIL_TEST),a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),a.stencilFunc(a.ALWAYS,r,4294967295),a.clearStencil(o),t.render(this.scene,this.camera,n,this.clear),t.render(this.scene,this.camera,e,this.clear),a.colorMask(!0,!0,!0,!0),a.depthMask(!0),a.stencilFunc(a.EQUAL,1,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)}},t.ClearMaskPass=function(){this.enabled=!0},t.ClearMaskPass.prototype={render:function(t,e,n,i){var r=t.context;r.disable(r.STENCIL_TEST)}}}).call(e,n(2))},function(t,e,n){(function(t){t.RenderPass=function(e,n,i,r,o){this.scene=e,this.camera=n,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=void 0!==o?o:1,this.oldClearColor=new t.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},t.RenderPass.prototype={render:function(t,e,n,i){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),t.render(this.scene,this.camera,n,this.clear),this.clearColor&&t.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}}}).call(e,n(2))},function(t,e,n){(function(t){t.BloomPass=function(e,n,i,r){e=void 0!==e?e:1,n=void 0!==n?n:25,i=void 0!==i?i:4,r=void 0!==r?r:256;var o={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBFormat};this.renderTargetX=new t.WebGLRenderTarget(r,r,o),this.renderTargetY=new t.WebGLRenderTarget(r,r,o),void 0===t.CopyShader&&console.error("THREE.BloomPass relies on THREE.CopyShader");var a=t.CopyShader;this.copyUniforms=t.UniformsUtils.clone(a.uniforms),this.copyUniforms.opacity.value=e,this.materialCopy=new t.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,blending:t.AdditiveBlending,transparent:!0}),void 0===t.ConvolutionShader&&console.error("THREE.BloomPass relies on THREE.ConvolutionShader");var s=t.ConvolutionShader;this.convolutionUniforms=t.UniformsUtils.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=t.BloomPass.blurX,this.convolutionUniforms.cKernel.value=t.ConvolutionShader.buildKernel(i),this.materialConvolution=new t.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:n.toFixed(1),KERNEL_SIZE_INT:n.toFixed(0)}}),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new t.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new t.Scene,this.quad=new t.Mesh(new t.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},t.BloomPass.prototype={render:function(e,n,i,r,o){o&&e.context.disable(e.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=i,this.convolutionUniforms.uImageIncrement.value=t.BloomPass.blurX,e.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX,this.convolutionUniforms.uImageIncrement.value=t.BloomPass.blurY,e.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY,o&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,i,this.clear)}},t.BloomPass.blurX=new t.Vector2(.001953125,0),t.BloomPass.blurY=new t.Vector2(0,.001953125)}).call(e,n(2))},function(t,e,n){(function(t){t.FilmPass=function(e,n,i,r){void 0===t.FilmShader&&console.error("THREE.FilmPass relies on THREE.FilmShader");var o=t.FilmShader;this.uniforms=t.UniformsUtils.clone(o.uniforms),this.material=new t.ShaderMaterial({uniforms:this.uniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==n&&(this.uniforms.sIntensity.value=n),void 0!==i&&(this.uniforms.sCount.value=i),this.enabled=!0,this.renderToScreen=!1,this.needsSwap=!0,this.camera=new t.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new t.Scene,this.quad=new t.Mesh(new t.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},t.FilmPass.prototype={render:function(t,e,n,i){this.uniforms.tDiffuse.value=n,this.uniforms.time.value+=i,this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,!1)}}}).call(e,n(2))},function(t,e,n){(function(t){t.DotScreenPass=function(e,n,i){void 0===t.DotScreenShader&&console.error("THREE.DotScreenPass relies on THREE.DotScreenShader");var r=t.DotScreenShader;this.uniforms=t.UniformsUtils.clone(r.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==n&&(this.uniforms.angle.value=n),void 0!==i&&(this.uniforms.scale.value=i),this.material=new t.ShaderMaterial({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.enabled=!0,this.renderToScreen=!1,this.needsSwap=!0,this.camera=new t.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new t.Scene,this.quad=new t.Mesh(new t.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},t.DotScreenPass.prototype={render:function(t,e,n,i){this.uniforms.tDiffuse.value=n,this.uniforms.tSize.value.set(n.width,n.height),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,!1)}}}).call(e,n(2))},function(t,e){var n=function(){function t(t,e,n,i,r,o,a,s,l,c){this.sm=t,this.gameLoop=e,this.stage=n,this.mouse=i,this.camctl=r,this.galaxy=o,this.controlAPI=a,this.fullscreenEffect=s,this.skybox=l,this.postProcess=c}return Object.defineProperty(t.prototype,"camera",{get:function(){return this.stage.camera},enumerable:!0,configurable:!0}),t.prototype.setLightColor=function(t){this.stage.setLightColor(t),this.skybox.setLightColor(t)},Object.defineProperty(t.prototype,"lightColor",{get:function(){return this.stage.lightColor},enumerable:!0,configurable:!0}),t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(22),a=n(23),s=function(t){function e(e,n){t.call(this),this.sm=e,this.env=n}return i(e,t),e.zoom=function(t){return t?.5:.05},e.zoomMin=function(t){return t?.3:.005},e.zoomMax=function(t){return t?1.1:1},e.prototype.becomeActive=function(t){var n=t&&t.firstTime;this.env.galaxy.view=o.ViewEnum.galaxy,this.env.camctl.setTargetZoom(n?.4:e.zoom(this.env.camctl.controls2D)),this.env.camctl.setZoomLimit(e.zoomMin(this.env.camctl.controls2D),e.zoomMax(this.env.camctl.controls2D)),this.env.camctl.setPitch(this.env.camctl.controls2D?0:e.pitch),this.env.camctl.previous3dPitch=e.pitch,this.env.camctl.resetPan(),this.env.camctl.useCumulativePan=!1,this.env.camctl.setSmoothDamp(a.default.smoothDampNormal)},e.prototype.becomeInactive=function(){this.env.controlAPI.dispatchHoverOut()},e.prototype.update=function(t,n){var i=this.env.galaxy.findNearestStar(this.env.mouse.positionInVP,this.env.camera),r=i&&i.shellDistanceFromCursor(this.env.mouse.positionInVP,this.env.camera)<=0;this.env.galaxy.highlightedStarSticky||(this.env.galaxy.highlightedStar=r?i:null),i&&r?(this.env.galaxy.highlightedStarSticky||(this.env.mouse.mouseB?this.env.controlAPI.dispatchHoverOut():this.env.controlAPI.dispatchHoverSystem(i.code)),this.env.mouse.mouseClick&&this.env.galaxy.ready&&this.env.controlAPI.dispatchSelectSystem(i.code,this.env.mouse.clickButton)):(this.env.mouse.mouseClick&&this.env.controlAPI.dispatchSelectNothing(this.env.mouse.clickButton),this.env.galaxy.highlightedStarSticky||this.env.controlAPI.dispatchHoverOut()),this.env.camctl.controls2D&&this.env.camctl.set2dView(),this.env.camctl.setZoomLimit(e.zoomMin(this.env.camctl.controls2D),e.zoomMax(this.env.camctl.controls2D));var o=this.env.controlAPI.goal;if(!o.done)if(o.isGalacticView){if(o.camInfo)this.env.camctl.cameraInfo=o.camInfo;else if(o.bodyPixelSize){var a=180/o.bodyPixelSize;this.env.camctl.setTargetZoom(a),this.env.camctl.setZoomLimit(a,a)}if(o.setSystemCode)(s=this.env.galaxy.getStar(o.systemCode))&&this.env.camctl.setTargetPosition(s.obj3d.position);o.setDone()}else if(o.isPlanetaryView||o.isSystemView){var s;(s=this.env.galaxy.getStar(o.systemCode))&&(o.routeInView?this.sm.changeState("StateSlideJumpPoint",{oldStar:null,newStar:s}):this.sm.changeState("StateEnterStarSystem",s))}},e.pitch=10,e}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e){var n=function(){function t(){}return t.prototype.becomeActive=function(t){},t.prototype.becomeInactive=function(){},t.prototype.update=function(t,e){},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e){!function(t){t[t.lifeforms=0]="lifeforms",t[t.economy=1]="economy",t[t.crime=2]="crime"}(e.HeatmapEnum||(e.HeatmapEnum={})),e.HeatmapEnum,function(t){t[t.galaxy=0]="galaxy",t[t.system=1]="system"}(e.ViewEnum||(e.ViewEnum={})),e.ViewEnum},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(25),a=function(t){function e(e,n,i){t.call(this),this.locked=!1,this.timeLocked=0,this.camParams={width:1,height:1,widthFreq:1,heightFreq:1,phiCorrection:.5};var r=this._controls=new o.default(e,n,this.camParams,i);r.maxDistance=5e3,r.maxPolarAngle=.95*Math.PI,r.target.set(0,0,0)}return i(e,t),e.prototype.update=function(t,e){this.locked?this.timeLocked+=e:this._controls.update(t-this.timeLocked,e)},e.prototype.addToGUI=function(t){var e=t.addFolder("Camera Drift");e.add(this.camParams,"width",0,20),e.add(this.camParams,"height",0,20),e.add(this.camParams,"widthFreq",0,10),e.add(this.camParams,"heightFreq",0,10),e.add(this.camParams,"phiCorrection",0,1)},e.prototype.changedParam=function(){},e.prototype.setTargetPosition=function(t){this._controls.target.copy(t)},e.prototype.setTargetZoom=function(t){this._controls.targetRadius=t},Object.defineProperty(e.prototype,"targetZoom",{get:function(){return this._controls.targetRadius},enumerable:!0,configurable:!0}),e.prototype.setZoomLimit=function(t,e){this._controls.minDistance=t,this._controls.maxDistance=e},e.prototype.setPitch=function(t){this._controls.targetPhi=t*Math.PI/180},e.prototype.getPitch=function(){return 180*this._controls.targetPhi/Math.PI},e.prototype.setTheta=function(t){this._controls.targetTheta=t*Math.PI/180},e.prototype.getTheta=function(){return 180*this._controls.targetTheta/Math.PI},e.prototype.setSmoothDamp=function(t){this._controls.smoothDamp=t},e.prototype.cutToCameraPosition=function(t){this._controls.cutToCameraPosition(t)},e.prototype.resetPan=function(){this._controls.targetPan.set(0,0,0)},e.prototype.seamlessChangeTargetPosition=function(t){this._controls.target.copy(t),this._controls.resetTargetsToCurrentPosition()},e.prototype.setTargetScreenCoord=function(t){this._controls.setTargetScreenCoord(t)},e.prototype.set2dView=function(){this.setPitch(5)},e.prototype.augmentTargetZoomToSee=function(t){this._controls.augmentTargetZoomToSee(t)},Object.defineProperty(e.prototype,"useCumulativePan",{set:function(t){t?this._controls.setCumulativePan():this._controls.resetCumulativePan()},enumerable:!0,configurable:!0}),e.prototype.setThetaPhiTargetToLookThroughTargetTowardsObjective=function(t){this._controls.setThetaPhiTargetToLookThroughTargetTowardsObjective(t)},Object.defineProperty(e.prototype,"controls2D",{get:function(){return this._controls.controls2D},set:function(t){t!=this._controls.controls2D&&(this._controls.controls2D=t,t?this.previous3dPitch=this.getPitch():this.setPitch(this.previous3dPitch))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cameraInfo",{get:function(){return{pitch:this.getPitch(),tetha:this.getTheta(),radius:this._controls.targetRadius,target:{x:this._controls.target.x,y:this._controls.target.y,z:this._controls.target.z},pan:{x:this._controls.targetPan.x,y:this._controls.targetPan.y}}},set:function(t){this.setPitch(t.pitch),this.setTheta(t.tetha),this.setTargetZoom(t.radius),this._controls.target.set(t.target.x,t.target.y,t.target.z),this._controls.targetPan.set(t.pan.x,t.pan.y,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomGuardBand",{get:function(){return this._controls.bottomGuardBand},set:function(t){this._controls.bottomGuardBand=t},enumerable:!0,configurable:!0}),e.prototype.translateWorld=function(t){this._controls.translateWorld(t)},e.smoothDampNormal={delay:.3,panDelay:.1,radiusDelay:.1,targetDelay:.1},e.smoothDampSlidel={delay:.05,panDelay:.05,radiusDelay:.05,targetDelay:.05},e.smoothDampTransition={delay:.3,panDelay:.3,radiusDelay:.3,targetDelay:.3},e}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){(function(t){var n=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.render=function(t){},e.prototype.initPostProcessing=function(t){},e.prototype.addToGUI=function(t,e){},e.prototype.onWindowResize=function(t,e){},e.prototype.update=function(t,e){},e.prototype.lateUpdate=function(t,e){},e.prototype.afterPreload=function(){},e.prototype.start=function(){},e.prototype.preload=function(){return null},e}(t.EventDispatcher);Object.defineProperty(e,"__esModule",{value:!0}),e.default=i}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(26),o=n(27),a=function(e){function n(n,i,r,o){var a=this;e.call(this),this.camera=n,this.domElement=i,this.camParams=r,this.enabled=!0,this.target=new t.Vector3,this.dampedTarget=new t.Vector3,this.targetPan=new t.Vector3,this.targetRadius=5,this.targetPhi=1,this.targetTheta=0,this.cumulativePan=new t.Vector3,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.smoothDamp={delay:.3,panDelay:.3,radiusDelay:.3,targetDelay:.3},this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:t.MOUSE.LEFT,ZOOM:t.MOUSE.MIDDLE,PAN:t.MOUSE.RIGHT},this.bottomGuardBand=130,this.controls2D=!1,this.lastTime=0,this.lastResetTime=0,this.EPS=.1,this.rotateStart=new t.Vector2,this.rotateEnd=new t.Vector2,this.panStart=new t.Vector2,this.panEnd=new t.Vector2,this.panDelta=new t.Vector2,this.panOffset=new t.Vector3,this.offset=new t.Vector3,this.dollyStart=new t.Vector2,this.dollyEnd=new t.Vector2,this.dollyDelta=new t.Vector2,this.theta=0,this.phi=0,this.smoothDampVel={phi:0,theta:0,radius:0,pan:new t.Vector3(0,0,0),target:new t.Vector3(0,0,0)},this.scale=1,this.lastPosition=new t.Vector3,this.lastQuaternion=new t.Quaternion,this.STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},this.useCumulativePan=!0,this.changeEvent={type:"change"},this.startEvent={type:"start"},this.endEvent={type:"end"},this.cutToCameraPosition=function(t){this.update(0,0,t)},this.setThetaPhiTargetToLookThroughTargetTowardsObjective=function(t){var e=this.dampedTarget.clone().sub(t);this.targetTheta=Math.atan2(e.x,e.z),this.targetPhi=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y)},this.onMouseDown=function(t){if(!1!==a.enabled){if(t.preventDefault(),t.button===a.mouseButtons.ORBIT)if(a.controls2D){if(!0===a.noPan)return;a.state=a.STATE.PAN,a.panStart.set(t.clientX,t.clientY)}else{if(!0===a.noRotate)return;a.state=a.STATE.ROTATE,a.rotateStart.set(t.clientX,t.clientY)}else if(t.button===a.mouseButtons.ZOOM){if(!0===a.noZoom)return;a.state=a.STATE.DOLLY,a.dollyStart.set(t.clientX,t.clientY)}else if(t.button===a.mouseButtons.PAN)if(a.controls2D){if(!0===a.noRotate)return;a.state=a.STATE.ROTATE,a.rotateStart.set(t.clientX,t.clientY)}else{if(!0===a.noPan)return;a.state=a.STATE.PAN,a.panStart.set(t.clientX,t.clientY)}a.state!==a.STATE.NONE&&(a.domElement.addEventListener("mousemove",a.onMouseMove,!1),a.domElement.addEventListener("mouseup",a.onMouseUp,!1),a.domElement.addEventListener("mouseout",a.onMouseUp,!1),a.dispatchEvent(a.startEvent))}},this.soundRotate=function(t){a.controlAPI.dispatchCameraRotationSoundEvent(t.length())},this.soundDolly=function(t){a.controlAPI.dispatchCameraDollySoundEvent(t)},this.soundPan=function(t){a.controlAPI.dispatchCameraPanSoundEvent(t.length())},this.onMouseMove=function(e){if(!1!==a.enabled){e.preventDefault();var n=a.domElement===document?a.domElement.body:a.domElement;if(a.state===a.STATE.ROTATE){if(!0===a.noRotate)return;if(a.rotateEnd.set(e.clientX,e.clientY),a.controls2D){var i=a.getScreenRotationCenter(),r=a.rotateStart.clone().sub(i).normalize(),o=a.rotateEnd.clone().sub(i).normalize(),s=Math.asin(r.x*o.y-r.y*o.x);a.rotateLeft(-s),a.soundRotate(new t.Vector2(-s,0))}else{var l=a.rotateEnd.clone().sub(a.rotateStart),c=2*Math.PI*l.x/n.clientWidth*a.rotateSpeed,u=2*Math.PI*l.y/n.clientHeight*a.rotateSpeed;a.rotateLeft(c),a.rotateUp(u),a.soundRotate(new t.Vector2(c,u))}a.rotateStart.copy(a.rotateEnd)}else if(a.state===a.STATE.DOLLY){if(!0===a.noZoom)return;a.dollyEnd.set(e.clientX,e.clientY),a.dollyDelta.subVectors(a.dollyEnd,a.dollyStart),a.dollyDelta.y>0?a.dollyIn():a.dollyDelta.y<0&&a.dollyOut(),a.dollyStart.copy(a.dollyEnd)}else if(a.state===a.STATE.PAN){if(!0===a.noPan)return;a.panEnd.set(e.clientX,e.clientY),a.panDelta.subVectors(a.panEnd,a.panStart),a.pan(a.panDelta.x,a.panDelta.y),a.panStart.copy(a.panEnd)}}},this.onMouseUp=function(){!1!==a.enabled&&(a.domElement.removeEventListener("mousemove",a.onMouseMove,!1),a.domElement.removeEventListener("mouseup",a.onMouseUp,!1),a.domElement.removeEventListener("mouseout",a.onMouseUp,!1),a.dispatchEvent(a.endEvent),a.state=a.STATE.NONE)},this.onMouseWheel=function(t){if(!1!==a.enabled&&!0!==a.noZoom&&a.state===a.STATE.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?a.dollyOut():0>e&&a.dollyIn(),a.dispatchEvent(a.startEvent),a.dispatchEvent(a.endEvent)}},this.onKeyDown=function(t){if(!1!==a.enabled&&!0!==a.noKeys&&!0!==a.noPan)switch(t.keyCode){case a.keys.UP:a.pan(0,a.keyPanSpeed);break;case a.keys.BOTTOM:a.pan(0,-a.keyPanSpeed);break;case a.keys.LEFT:a.pan(a.keyPanSpeed,0);break;case a.keys.RIGHT:a.pan(-a.keyPanSpeed,0)}},this.touchstart=function(t){if(!1!==a.enabled){switch(t.touches.length){case 1:if(!0===a.noRotate)return;a.state=a.STATE.TOUCH_ROTATE,a.rotateStart.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===a.noZoom)return;a.state=a.STATE.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);a.dollyStart.set(0,i);break;case 3:if(!0===a.noPan)return;a.state=a.STATE.TOUCH_PAN,a.panStart.set(t.touches[0].pageX,t.touches[0].pageY);break;default:a.state=a.STATE.NONE}a.state!==a.STATE.NONE&&a.dispatchEvent(a.startEvent)}},this.touchmove=function(e){if(!1!==a.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!0===a.noRotate)return;if(a.state!==a.STATE.TOUCH_ROTATE)return;a.rotateEnd.set(e.touches[0].pageX,e.touches[0].pageY);var n=a.rotateEnd.clone().sub(a.rotateStart),i=2*Math.PI*n.x/a.element.clientWidth*a.rotateSpeed,r=2*Math.PI*n.y/a.element.clientHeight*a.rotateSpeed;a.rotateLeft(i),a.rotateUp(r),a.soundRotate(new t.Vector2(i,r)),a.rotateStart.copy(a.rotateEnd);break;case 2:if(!0===a.noZoom)return;if(a.state!==a.STATE.TOUCH_DOLLY)return;var o=e.touches[0].pageX-e.touches[1].pageX,s=e.touches[0].pageY-e.touches[1].pageY,l=Math.sqrt(o*o+s*s);a.dollyEnd.set(0,l),a.dollyDelta.subVectors(a.dollyEnd,a.dollyStart),a.dollyDelta.y>0?a.dollyOut():a.dollyDelta.y<0&&a.dollyIn(),a.dollyStart.copy(a.dollyEnd);break;case 3:if(!0===a.noPan)return;if(a.state!==a.STATE.TOUCH_PAN)return;a.panEnd.set(e.touches[0].pageX,e.touches[0].pageY),a.panDelta.subVectors(a.panEnd,a.panStart),a.pan(a.panDelta.x,a.panDelta.y),a.panStart.copy(a.panEnd);break;default:a.state=a.STATE.NONE}},this.touchend=function(){!1!==a.enabled&&(a.dispatchEvent(a.endEvent),a.state=a.STATE.NONE)},this.controlAPI=o,this.domElement=void 0!==i?i:document,this.element=this.domElement===document?this.domElement.body:this.domElement,this.state=this.STATE.NONE,this.target0=this.target.clone(),this.position0=this.camera.position.clone(),this.zoom0=this.camera.zoom,this.domElement.addEventListener("contextmenu",(function(t){t.preventDefault()}),!1),this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("mousewheel",this.onMouseWheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.onMouseWheel,!1),this.domElement.addEventListener("touchstart",this.touchstart,!1),this.domElement.addEventListener("touchend",this.touchend,!1),this.domElement.addEventListener("touchmove",this.touchmove,!1),this.update()}return i(n,e),n.prototype.rotateLeft=function(t){void 0===t&&(t=this.getAutoRotationAngle()),this.targetTheta-=t},n.prototype.rotateUp=function(t){void 0===t&&(t=this.getAutoRotationAngle()),this.targetPhi-=t},n.prototype.panLeft=function(t){this.targetPan.x-=t},n.prototype.panUp=function(t){this.targetPan.y+=t},n.prototype.getPanFactor=function(){return 2*this.camera.position.distanceTo(this.target)*Math.tan(this.camera.fov/2*Math.PI/180)/this.element.clientHeight},n.prototype.pan=function(e,n){if(this.camera instanceof t.PerspectiveCamera){var i=this.getPanFactor();this.panLeft(e*i),this.panUp(n*i),this.soundPan(new t.Vector2(e*i,n*i))}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},n.prototype.getScreenRotationCenter=function(){return new t.Vector2(-this.targetPan.x,this.targetPan.y).multiplyScalar(1/this.getPanFactor()).add(new t.Vector2(.5*this.element.clientWidth,.5*this.element.clientHeight))},n.prototype.dollyIn=function(e){void 0===e&&(e=this.getZoomScale()),this.camera instanceof t.PerspectiveCamera?(this.targetRadius/=e,this.targetRadius>=this.minDistance&&this.targetRadius<=this.maxDistance&&this.soundDolly(1/e)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},n.prototype.dollyOut=function(e){void 0===e&&(e=this.getZoomScale()),this.camera instanceof t.PerspectiveCamera?(this.targetRadius*=e,this.targetRadius>=this.minDistance&&this.targetRadius<=this.maxDistance&&this.soundDolly(e)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},n.prototype.resetTargetsToCurrentPosition=function(){var t=this.target.clone().applyMatrix4(this.camera.matrixWorldInverse);this.cumulativePan.x=-t.x,this.cumulativePan.y=-t.y,this.targetPan.copy(this.cumulativePan),this.dampedTarget.copy(this.target),this.camera.translateOnAxis(this.cumulativePan,-1);var e=this.camera.position;this.offset.copy(e).sub(this.dampedTarget),this.controls2D||(this.targetTheta=this.theta=Math.atan2(this.offset.x,this.offset.z),this.phi=Math.atan2(Math.sqrt(this.offset.x*this.offset.x+this.offset.z*this.offset.z),this.offset.y),this.targetPhi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.phi)),this.targetPhi=Math.max(this.EPS,Math.min(Math.PI-this.EPS,this.targetPhi)));var n=this.offset.length();this.targetRadius=Math.max(this.minDistance,Math.min(this.maxDistance,n)),this.camera.translateOnAxis(this.cumulativePan,1),this.lastResetTime=this.lastTime},n.prototype.setTargetScreenCoord=function(e){var n=this.target.clone().applyMatrix4(this.camera.matrixWorldInverse),i=new t.Vector3,r=Math.tan(.5*this.camera.fov*Math.PI/180)*Math.abs(n.z);i.set(r*this.camera.aspect*(e.x/this.element.clientWidth*2-1),r*(-e.y/this.element.clientHeight*2+1),0),this.targetPan.set(this.cumulativePan.x+n.x-i.x,this.cumulativePan.y+n.y-i.y,0)},n.prototype.augmentTargetZoomToSee=function(e){var n=new t.Vector3;n.x=this.targetRadius*Math.sin(this.targetPhi)*Math.sin(this.targetTheta),n.y=this.targetRadius*Math.cos(this.targetPhi),n.z=this.targetRadius*Math.sin(this.targetPhi)*Math.cos(this.targetTheta);var i=this.camera.clone();i.position.copy(this.target).add(n),i.lookAt(this.target),i.translateOnAxis(this.targetPan,1),i.updateMatrixWorld(!0),i.updateProjectionMatrix();var r=e.clone().project(i),o=-i.worldToLocal(e.clone()).z,a=r.y<0?r.y*this.element.clientHeight/(this.element.clientHeight-2*this.bottomGuardBand):r.y,s=Math.max(Math.abs(r.x),Math.abs(a));(s>.8||0>o)&&(o>0?this.targetRadius+=(s/.8-1)*o:this.targetRadius-=o+s*o/.8)},n.prototype.updateTargetCamera=function(){},n.prototype.resetCumulativePan=function(){this.useCumulativePan=!1,this.cumulativePan.applyQuaternion(this.camera.quaternion),this.dampedTarget.add(this.cumulativePan),this.cumulativePan.set(0,0,0),this.targetPan.applyQuaternion(this.camera.quaternion),this.target.add(this.targetPan),this.targetPan.set(0,0,0)},n.prototype.setCumulativePan=function(){this.useCumulativePan=!0},n.prototype.translateWorld=function(t){this.camera.position.add(t),this.camera.updateMatrixWorld(!0),this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld),this.target.add(t),this.dampedTarget.add(t)},n.prototype.update=function(t,e,n){this.lastTime=t,this.camera.translateOnAxis(this.cumulativePan,-1);var i=this.camera.position;n&&i.copy(n),this.offset.copy(i).sub(this.dampedTarget),this.theta=Math.atan2(this.offset.x,this.offset.z),this.phi=Math.atan2(Math.sqrt(this.offset.x*this.offset.x+this.offset.z*this.offset.z),this.offset.y),this.autoRotate&&this.state===this.STATE.NONE&&this.rotateLeft(this.getAutoRotationAngle()),this.targetRadius=Math.max(this.minDistance,Math.min(this.maxDistance,this.targetRadius)),this.targetPhi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.targetPhi)),this.targetPhi=Math.max(this.EPS,Math.min(Math.PI-this.EPS,this.targetPhi));var a=this.offset.length();if(n)this.targetTheta=this.theta,this.targetPhi=this.phi,this.targetRadius=a;else if(e){for(;this.targetTheta-this.theta>Math.PI;)this.targetTheta-=2*Math.PI;for(;this.targetTheta-this.theta<-Math.PI;)this.targetTheta+=2*Math.PI;var s=this.targetPhi,l=this.targetTheta;if(!this.controls2D){var c=r.default.clamp01(t-this.lastResetTime),u=this.camParams.phiCorrection*Math.sin(this.targetPhi)+1*(1-this.camParams.phiCorrection);for(s=this.targetPhi+c*u*this.camParams.height*.01*Math.sin(.2*t*this.camParams.heightFreq),l=this.targetTheta+c*u*this.camParams.width*.05*Math.cos(.2*t*this.camParams.widthFreq),s=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,s));l-this.theta>Math.PI;)l-=2*Math.PI;for(;l-this.theta<-Math.PI;)l+=2*Math.PI}this.theta=r.default.smoothDamp(this.theta,l,this.smoothDampVel,"theta",this.smoothDamp.delay,e),this.phi=r.default.smoothDamp(this.phi,s,this.smoothDampVel,"phi",this.smoothDamp.delay,e),this.useCumulativePan?this.cumulativePan.copy(o.default.smoothDamp(this.cumulativePan,this.targetPan,this.smoothDampVel.pan,this.smoothDamp.panDelay,e)):(this.cumulativePan.set(0,0,0),this.targetPan.applyQuaternion(this.camera.quaternion),this.target.add(this.targetPan),this.targetPan.set(0,0,0)),this.dampedTarget.copy(o.default.smoothDamp(this.dampedTarget,this.target,this.smoothDampVel.target,this.smoothDamp.targetDelay,e));var h=a,d=(a=r.default.smoothDamp(a,this.targetRadius,this.smoothDampVel,"radius",this.smoothDamp.radiusDelay,e))/h;this.cumulativePan.multiplyScalar(d),this.targetPan.multiplyScalar(d)}else this.theta=this.targetTheta,this.phi=this.targetPhi,a=this.targetRadius,this.cumulativePan.copy(this.targetPan),this.dampedTarget.copy(this.target);this.offset.x=a*Math.sin(this.phi)*Math.sin(this.theta),this.offset.y=a*Math.cos(this.phi),this.offset.z=a*Math.sin(this.phi)*Math.cos(this.theta),i.copy(this.dampedTarget).add(this.offset),this.camera.lookAt(this.dampedTarget),this.camera.translateOnAxis(this.cumulativePan,1),this.camera.updateMatrixWorld(!0);(this.lastPosition.distanceToSquared(this.camera.position)>this.EPS||8*(1-function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}(this.lastQuaternion,this.camera.quaternion))>this.EPS)&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.camera.position),this.lastQuaternion.copy(this.camera.quaternion))},n.prototype.reset=function(){this.state=this.STATE.NONE,this.target.copy(this.target0),this.camera.position.copy(this.position0),this.camera.zoom=this.zoom0,this.camera.updateProjectionMatrix(),this.dispatchEvent(this.changeEvent),this.update()},n.prototype.getPolarAngle=function(){return this.phi},n.prototype.getAzimuthalAngle=function(){return this.theta},n.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed},n.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},n}(t.EventDispatcher);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a}).call(e,n(2))},function(t,e){var n=function(){function t(){}return t.lerp=function(t,e,n){return(1-n)*t+n*e},t.clamp01=function(t){return 0>t?0:1>t?t:1},t.smoothstep=function(e){return t.clamp01(e*e*(3-2*e))},t.gotoValue=function(t,e,n){return e>t?e>t+n?t+n:e:t-n>e?t-n:e},t.goto02Value=function(e,n,i){var r=n?1:0;return e>r&&(r+=2),(e=t.gotoValue(e,r,i))>=2&&(e-=2),e},t.smoothDamp=function(t,e,n,i,r,o){var a=2/(r=Math.max(1e-4,r)),s=a*o,l=1/(1+s+.48*s*s+.235*s*s*s),c=t-e,u=e,h=n[i],d=(h+a*c)*o;n[i]=(h-a*d)*l;var f=e+(c+d)*l;return u-t>0==f>u&&(h=((f=u)-u)/o),f},t.rnd=function(t){return Math.floor(Math.random()*t)},t.randomElem=function(e){return e.length>0?e[t.rnd(e.length)]:null},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){(function(t){var n=function(){function e(){}return e.smoothDamp=function(e,n,i,r,o){var a=2/(r=Math.max(1e-4,r)),s=a*o,l=1/(1+s+.48*s*s+.235*s*s*s),c=(new t.Vector3).subVectors(e,n),u=(new t.Vector3).addVectors(i,(new t.Vector3).copy(c).multiplyScalar(a)).multiplyScalar(o);i.sub((new t.Vector3).copy(u).multiplyScalar(a)).multiplyScalar(l);var h=(new t.Vector3).addVectors(c,u).multiplyScalar(l).add(n);return c.dot((new t.Vector3).subVectors(h,n))<0&&(h=n,i.set(0,0,0)),h},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(29),a=n(30),s=n(46),l=function(e){function n(){var t=this;e.call(this),this.routeSelection={small:!1,medium:!1,large:!1},this.factionSelection={},this.lrScannerSelection={lifeforms:!1,economy:!1,crime:!1},this.lrScannerHeatmap={lifeforms:!1,economy:!1,crime:!1},this.factionHeatmap={},this.goal=new o.default(o.GoalEnum.galacticView),this.hovering=null,this.info={system:"SOL",body:"EARTH"},this.defaultSelectSystem=function(e){0===e.button?t.gotoSystemView().setSystemCode(e.systemCode):t.setSystemPivot(e.systemCode)},this.defaultSelectBody=function(e){0===e.button?t.gotoPlanetaryView().setPlanetaryCode(e.planetaryCode):t.setPlanetaryPivot(e.systemCode,e.planetaryCode)},this.defaultSelectJumpPoint=function(e){0===e.button?t.goal.planetaryCode===e.planetaryCode?t.gotoSystemView().setSystemCode(e.gotoCode):t.gotoPlanetaryView().setPlanetaryCode(e.planetaryCode):t.gotoSystemView().setSystemCode(e.gotoCode)},this.defaultSelectNothing=function(e){t.goal.isGalacticView&&2===e.button?t.releaseSystemPivot():t.goal.isPlanetaryView?t.gotoSystemView().setSystemCode(t.goal.systemCode):t.gotoGalacticView()},this.defaultDblClick=function(t){},this.defaultHoverEvent=function(t){},this.defaultEvent=function(t){console.log("Event "+t.name)},this.setDirty=function(){return t.dispatchEvent({type:"updateSelection",target:t})}}return i(n,e),Object.defineProperty(n.prototype,"camctrl",{get:function(){return this.env.camctl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"affiliationCodes",{get:function(){return this.env.galaxy.affiliationCodes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"affiliations",{get:function(){return this.env.galaxy.affiliations},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"affiliationColors",{get:function(){return this.env.galaxy.affiliationColors},enumerable:!0,configurable:!0}),n.prototype.start=function(){this.env.gameLoop.start(),this.env.controlAPI.dispatchSoundEvent("StartGalaxyAmbiance"),this.env.sm.changeState("StateGalaxy",{firstTime:!0})},n.prototype.showLoadingScreen=function(t){this.env.postProcess.showLoadingScreen(t)},n.prototype.addToGUI=function(t){var e=this,n=t.addFolder("ControlAPI");n.add(this.info,"system"),n.add({centerGalaxy:function(){return e.gotoGalacticView().setSystemCode(e.info.system)}},"centerGalaxy"),n.add({gotoSystem:function(){return e.gotoSystemView().setSystemCode(e.info.system)}},"gotoSystem");for(var i=n.addFolder("Factions"),r=n.addFolder("Heatmap Factions"),o=0,a=this.env.galaxy.affiliationCodes;o<a.length;o++){var s=a[o];i.add(this.factionSelection,s).onChange(this.setDirty),r.add(this.factionHeatmap,s).onChange(this.setDirty)}var l=n.addFolder("Routes");l.add(this.routeSelection,"small").onChange(this.setDirty),l.add(this.routeSelection,"medium").onChange(this.setDirty),l.add(this.routeSelection,"large").onChange(this.setDirty);var c={showRandomRoute:function(){e.env.galaxy.showRandomRoutingFound()},hideRoute:function(){e.showRouting(null)},next:function(){e.env.gameLoop.doNotShowGUI(),e.routingNext()},previous:function(){e.env.gameLoop.doNotShowGUI(),e.routingPrevious()}};l.add(c,"showRandomRoute"),l.add(c,"next"),l.add(c,"previous"),l.add(c,"hideRoute");var u=n.addFolder("Long-Range Scanner");u.add(this.lrScannerSelection,"lifeforms").onChange(this.setDirty),u.add(this.lrScannerSelection,"economy").onChange(this.setDirty),u.add(this.lrScannerSelection,"crime").onChange(this.setDirty);var h=n.addFolder("Heatmap Scanner");h.add(this.lrScannerHeatmap,"lifeforms").onChange(this.setDirty),h.add(this.lrScannerHeatmap,"economy").onChange(this.setDirty),h.add(this.lrScannerHeatmap,"crime").onChange(this.setDirty);n.add({controls2d:!1},"controls2d").onChange((function(t){return e.controls2D=t}))},n.prototype.afterPreload=function(){for(var t=0,e=this.env.galaxy.affiliationCodes;t<e.length;t++){var n=e[t];this.factionSelection[n]=!0,this.factionHeatmap[n]=!1}},n.prototype.setSystemPivot=function(t){this.env.camctl.useCumulativePan=!0,this.env.camctl.seamlessChangeTargetPosition(this.env.galaxy.getSystemPosition(t))},n.prototype.releaseSystemPivot=function(){this.env.camctl.useCumulativePan=!1},n.prototype.setPlanetaryPivot=function(t,e){this.env.camctl.useCumulativePan=!0,this.env.camctl.seamlessChangeTargetPosition(this.env.galaxy.getPlanetaryPosition(t,e))},n.prototype.setPivotScreenCoord=function(e,n){this.env.camctl.setTargetScreenCoord(new t.Vector2(e,n))},n.prototype.getSystemScreenCoord=function(t){return this.env.galaxy.getSystemScreenCoord(t)},n.prototype.getPlanetaryScreenCoord=function(t,e){return this.env.galaxy.getPlanetaryScreenCoord(t,e)},n.prototype.setSystemStickyHovering=function(t){this.env.galaxy.setSystemStickyHovering(t)},n.prototype.releaseSystemStickyHovering=function(){this.env.galaxy.releaseSystemStickyHovering()},n.prototype.setPlanetaryStickyHovering=function(t,e){this.env.galaxy.setPlanetaryStickyHovering(t,e)},n.prototype.releasePlanetaryStickyHovering=function(t){this.env.galaxy.releasePlanetaryStickyHovering(t)},n.prototype.forceSystemHighlight=function(t){this.env.galaxy.forceSystemHighlight(t)},n.prototype.releaseSystemHighlight=function(t){this.env.galaxy.releaseSystemHighlight(t)},n.prototype.forcePlanetaryHovered=function(t,e){this.env.galaxy.forcePlanetaryHovered(t,e)},n.prototype.releasePlanetaryHovered=function(t,e){this.env.galaxy.releasePlanetaryHovered(t,e)},n.prototype.setLandingZoneHighlight=function(t,e,n,i){this.env.galaxy.setLandingZoneHighlight(t,e,n,i)},Object.defineProperty(n.prototype,"bottomGuardBand",{get:function(){return this.env.camctl.bottomGuardBand},set:function(t){this.env.camctl.bottomGuardBand=t},enumerable:!0,configurable:!0}),n.prototype.lockCamera=function(){this.camctrl.locked=!0},n.prototype.unlockCamera=function(){this.camctrl.locked=!1},Object.defineProperty(n.prototype,"cameraInfo",{get:function(){return this.camctrl.cameraInfo},enumerable:!0,configurable:!0}),n.prototype.showRouting=function(t){t&&t.length>1?t[0].raw?this.env.galaxy.showRouting(t):this.env.galaxy.showRouting(t.map(s.toRouteSegmentAPI)):this.env.galaxy.showRouting(null)},n.prototype.routingNext=function(){this.isOnRoute||this.env.galaxy.resetCurrentRoute(),this.env.galaxy.routingNextSystem(),this.routingCurrent()},n.prototype.routingPrevious=function(){this.isOnRoute||this.env.galaxy.resetCurrentRoute(),this.env.galaxy.routingPreviousSystem(),this.routingCurrent()},n.prototype.getCurrentRoutingSystem=function(){return this.env.galaxy.currentRoutingSegment?this.env.galaxy.currentRoutingSegment.system_code:null},n.prototype.setCurrentRoutingSystem=function(t){return this.env.galaxy.routingFirstInSystem(t),this.gotoSystemView().setSystemCode(t).setRouteInView()},Object.defineProperty(n.prototype,"isOnRoute",{get:function(){return this.env.galaxy.currentRoutingSegment?!this.goal.isGalacticView&&this.goal.systemCode===this.env.galaxy.currentRoutingSegment.system_code:this.goal.isGalacticView},enumerable:!0,configurable:!0}),n.prototype.routingCurrent=function(){return this.env.galaxy.currentRoutingSegment?this.gotoSystemView().setSystemCode(this.env.galaxy.currentRoutingSystemCode).setRouteInView():this.gotoGalacticView()},n.prototype.setGoal=function(t){var e=new o.default(t);return this.goal&&!this.goal.done&&this.goal.abort(),this.goal=e,e},n.prototype.getJumpPointDestination=function(t){return this.env.galaxy.getJumpPointDestination(t)},n.prototype.getJumpPointInfo=function(t){return this.env.galaxy.getJumpPointInfo(t)},n.prototype.load=function(){return this.env.gameLoop.load()},n.prototype.gotoGalacticView=function(){return this.setGoal(o.GoalEnum.galacticView)},n.prototype.gotoSystemView=function(){return this.setGoal(o.GoalEnum.systemView)},n.prototype.gotoPlanetaryView=function(){return this.setGoal(o.GoalEnum.planetaryView)},n.prototype.dispatchSelectSystem=function(t,e){this.dispatchEvent({type:"selectSystem",target:this,systemCode:t,button:e})},n.prototype.dispatchSelectBody=function(t,e,n){this.dispatchEvent({type:"selectBody",target:this,systemCode:t,planetaryCode:e,button:n})},n.prototype.dispatchSelectJumpPoint=function(t,e,n,i){this.dispatchEvent({type:"selectJumpPoint",target:this,systemCode:t,planetaryCode:e,gotoCode:n,button:i})},n.prototype.dispatchSelectNothing=function(t){this.dispatchEvent({type:"selectNothing",target:this,button:t})},n.prototype.dispatchHoverSystem=function(t){this.hovering&&this.hovering.systemCode===t&&!this.hovering.planetaryCode||(this.dispatchHoverOut(),this.hovering={systemCode:t},this.dispatchEvent({type:"hoverSystemIn",target:this,systemCode:t}),this.dispatchSoundEvent("HoverSystemIn"))},n.prototype.dispatchHoverBody=function(t,e){this.hovering&&this.hovering.systemCode===t&&this.hovering.planetaryCode===e&&!this.hovering.gotoCode||(this.dispatchHoverOut(),this.hovering={systemCode:t,planetaryCode:e},this.dispatchEvent({type:"hoverBodyIn",target:this,systemCode:t,planetaryCode:e}),this.dispatchSoundEvent("HoverBodyIn"))},n.prototype.dispatchHoverJumpPoint=function(t,e,n){this.hovering&&this.hovering.systemCode===t&&this.hovering.planetaryCode===e&&this.hovering.gotoCode===n||(this.dispatchHoverOut(),this.hovering={systemCode:t,planetaryCode:e,gotoCode:n},this.dispatchEvent({type:"hoverJumpPointIn",target:this,systemCode:t,planetaryCode:e,gotoCode:n}),this.dispatchSoundEvent("HoverJumpPointIn"))},n.prototype.dispatchHoverOut=function(){this.hovering&&(this.hovering.gotoCode?(this.dispatchEvent({type:"hoverJumpPointOut",target:this,systemCode:this.hovering.systemCode,planetaryCode:this.hovering.planetaryCode,gotoCode:this.hovering.gotoCode}),this.dispatchSoundEvent("HoverJumpPointOut")):this.hovering.planetaryCode?(this.dispatchEvent({type:"hoverBodyOut",target:this,systemCode:this.hovering.systemCode,planetaryCode:this.hovering.planetaryCode}),this.dispatchSoundEvent("HoverBodyOut")):(this.dispatchEvent({type:"hoverSystemOut",target:this,systemCode:this.hovering.systemCode}),this.dispatchSoundEvent("HoverSystemOut")),this.hovering=null)},n.prototype.dispatchGenericEvent=function(t){this.dispatchEvent({type:"event",target:this,name:t})},n.prototype.showLongRangeScanner=function(t,e){void 0===e&&(e=1),this.env.galaxy.longRangeScanner.show(t,e)},n.prototype.setLongRangeScannerData=function(t,e,n,i){void 0===i&&(i=1),this.env.galaxy.longRangeScanner.setData(t,e,n,i)},n.prototype.setLongRangeScannerPosition=function(t,e){this.env.galaxy.longRangeScanner.setCanvasPosition(t,e)},n.prototype.setLongRangeScannerSize=function(t,e){this.env.galaxy.longRangeScanner.setCanvasSize(t,e)},n.prototype.dispatchSoundEvent=function(t){this.dispatchEvent({type:"soundEvent",target:this,name:t})},n.prototype.dispatchCameraRotationSoundEvent=function(t){this.dispatchEvent({type:"cameraRotationSoundEvent",target:this,rotation:t})},n.prototype.dispatchCameraDollySoundEvent=function(t){this.dispatchEvent({type:"cameraDollySoundEvent",target:this,dolly:t})},n.prototype.dispatchCameraPanSoundEvent=function(t){this.dispatchEvent({type:"cameraPanSoundEvent",target:this,pan:t})},n.prototype.getInfo=function(){return this.env.galaxy.bootup},n.prototype.getSystemInfo=function(t){var e=this.env.galaxy.stars[t];return e.data.detail||e.brief},n.prototype.getBodyInfo=function(t,e){var n=this.env.galaxy.stars[t].starSystem.bodiesByCode[e];return n.data.detail||n.info},Object.defineProperty(n.prototype,"controls2D",{get:function(){return this.camctrl.controls2D},set:function(t){this.camctrl.controls2D=t},enumerable:!0,configurable:!0}),n.prototype.addDefaultListeners=function(){this.addEventListener("selectSystem",this.defaultSelectSystem),this.addEventListener("selectBody",this.defaultSelectBody),this.addEventListener("selectJumpPoint",this.defaultSelectJumpPoint),this.addEventListener("selectNothing",this.defaultSelectNothing),this.addEventListener("selectSystemDblClick",this.defaultDblClick),this.addEventListener("selectBodyDblClick",this.defaultDblClick),this.addEventListener("selectJumpPointDblClick",this.defaultDblClick),this.addEventListener("selectNothingDblClick",this.defaultDblClick),this.addEventListener("event",this.defaultEvent),this.addEventListener("hoverSystemIn",this.defaultHoverEvent),this.addEventListener("hoverBodyIn",this.defaultHoverEvent),this.addEventListener("hoverJumpPointIn",this.defaultHoverEvent),this.addEventListener("hoverJumpPointOut",this.defaultHoverEvent),this.addEventListener("hoverBodyOut",this.defaultHoverEvent),this.addEventListener("hoverSystemOut",this.defaultHoverEvent)},n.prototype.removeDefaultListeners=function(){this.removeEventListener("selectSystem",this.defaultSelectSystem),this.removeEventListener("selectBody",this.defaultSelectBody),this.removeEventListener("selectJumpPoint",this.defaultSelectJumpPoint),this.removeEventListener("selectNothing",this.defaultSelectNothing),this.removeEventListener("selectSystemDblClick",this.defaultDblClick),this.removeEventListener("selectBodyDblClick",this.defaultDblClick),this.removeEventListener("selectJumpPointDblClick",this.defaultDblClick),this.removeEventListener("selectNothingDblClick",this.defaultDblClick),this.removeEventListener("event",this.defaultEvent),this.removeEventListener("hoverSystemIn",this.defaultHoverEvent),this.removeEventListener("hoverBodyIn",this.defaultHoverEvent),this.removeEventListener("hoverJumpPointIn",this.defaultHoverEvent),this.removeEventListener("hoverJumpPointOut",this.defaultHoverEvent),this.removeEventListener("hoverBodyOut",this.defaultHoverEvent),this.removeEventListener("hoverSystemOut",this.defaultHoverEvent)},Object.defineProperty(n.prototype,"loadingObjects",{get:function(){return a.default.objectsLoading},enumerable:!0,configurable:!0}),n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=l}).call(e,n(2))},function(t,e){!function(t){t[t.galacticView=0]="galacticView",t[t.systemView=1]="systemView",t[t.planetaryView=2]="planetaryView"}(e.GoalEnum||(e.GoalEnum={}));var n=e.GoalEnum,i=function(){function t(e){this.type=e,this.systemCode=null,this.planetaryCode=null,this.routeInView=!1,this.camInfo=null,this.callback=null,this.done=!1,this.aborted=!1,this.bodyPixelSize=null,this.typeInfo=t.typesInfo[n[e]]}return Object.defineProperty(t.prototype,"isGalacticView",{get:function(){return this.typeInfo.isGalacticView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSystemView",{get:function(){return this.typeInfo.isSystemView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlanetaryView",{get:function(){return this.typeInfo.isPlanetaryView},enumerable:!0,configurable:!0}),t.prototype.setSystemCode=function(t){return this.systemCode=t,this},t.prototype.setPlanetaryCode=function(t){return this.planetaryCode=t,this},t.prototype.setCameraInfo=function(t){return this.camInfo=t,this},t.prototype.setBodyPixelSize=function(t){return this.bodyPixelSize=t,this},t.prototype.setRouteInView=function(){return this.routeInView=!0,this},t.prototype.onDone=function(t){return this.callback=t,this},t.prototype.setDone=function(){this.aborted||this.done||(this.done=!0,this.callback&&this.callback(!1))},t.prototype.abort=function(){this.aborted||this.done||(this.aborted=!0,this.done=!0,this.callback&&this.callback(!0))},t.typesInfo={galacticView:{isGalacticView:!0},systemView:{isSystemView:!0},planetaryView:{isPlanetaryView:!0}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){(function(t){var i,r=n(31),o=n(32),a=n(45);!function(t){t[t.COLLADA=0]="COLLADA",t[t.GLTF=1]="GLTF"}(i||(i={}));var s=function(){function e(t,e,n){this.type=t,this.model=e,this.animations=n}return e.prototype.update=function(t,e,n){if(this.type===i.COLLADA)for(var r=0,o=this.animations;r<o.length;r++){o[r].update(n)}else for(var a=0,s=this.animations;a<s.length;a++){s[a].update()}},e.prototype.dispose=function(){},e.prototype.clone=function(){var n={},r=function(t){var e=t.clone(void 0,!1);if(n[t.uuid]=e,t.children)for(var i=0,o=t.children.length;o>i;i++)e.add(r(t.children[i]));return e},o=function(t){var e=t.clone(n[t.root.uuid]);return e.play(),e},a=function(e){var i=new t.glTFAnimation(e.interps.map((function(t){return{keys:t.keys,values:t.values,count:t.count,type:t.type,path:t.path,target:n[t.targetNode.uuid]}})));return i.loop=e.loop,i.play(),i},s=r(this.model),l=[];if(this.type===i.COLLADA)for(var c=0,u=this.animations.length;u>c;c++)l.push(o(this.animations[c]));else for(c=0,u=this.animations.length;u>c;c++)l.push(a(this.animations[c]));return new e(this.type,s,l)},e.prototype.play=function(){for(var t=0,e=this.animations;t<e.length;t++){e[t].play()}},e.makeColladaObject=function(t,n){t.scale.x=t.scale.y=t.scale.z=1;for(var a=[],s=0;s<n.length;++s){var l=n[s],c=new r.default(l.node,l);c.loop=!0,a.push(c)}return o.default.collapseMaterialsPerName(t),o.default.convertMeshesWithThinlineMaterial(t),o.default.convertIncludedAdditiveMaterial(t),new e(i.COLLADA,t,a)},e.makeGLTFObject=function(t,n){t.scale.x=t.scale.y=t.scale.z=100;for(var r=0;r<n.length;r++){var a=n[r];a.loop=!0,a.play()}return o.default.collapseMaterialsPerName(t),o.default.convertMeshesWithThinlineMaterial(t),o.default.convertIncludedAdditiveMaterial(t),new e(i.GLTF,t,n)},e.loadObject=function(n){return new Promise((function(i,r){if(e.objectsLoading[n]=!0,(new Date).getTime(),a.default.strEndsWith(n,".dae"))(new t.ColladaLoader).load(n,(function(t){delete e.objectsLoading[n],i(e.makeColladaObject(t.scene,t.animations))}));else if(a.default.strEndsWith(n,".gltf")){(new t.glTFLoader).load(n,(function(t){delete e.objectsLoading[n],i(e.makeGLTFObject(t.scene,t.animations))}))}else r(new Error("not a dae or a gltf"))}))},e.objectsLoading={},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,window.LObject=s}).call(e,n(2))},function(t,e){var n=function(t){for(var e=0;e<t.keys.length;e++)t.keys[e].time<0&&(t.keys[e].time=0),t.keys[e].index=e;return t},i=function(){function t(e,i){this.root=e,i instanceof t?(this.duration=i.duration,this.data=i.data,this.timeScale=i.timeScale,this.loop=i.loop):(this.duration=i.length,this.data=n(i.hierarchy[0]),this.timeScale=1,this.loop=!0),this.currentTime=0,this.isPlaying=!1,this.isPaused=!0,this.transforms=[],this.animatedTransforms=[],this.prevKey=null,this.nextKey=null,this.init()}return t.prototype.init=function(){for(var t=0,e=this.data.node.transforms.length;e>t;t++)this.transforms.push(this.data.node.transforms[t].clone());for(var n=this.data.keys[0],i=(t=0,n.targets.length);i>t;t++)for(var r=n.targets[t],o=0,a=this.data.node.transforms.length;a>o;o++){this.data.node.transforms[o]===r.transform&&this.animatedTransforms.push(this.transforms[o])}this.root.matrixAutoUpdate=!1,this.root.matrixWorldNeedsUpdate=!0,this.update(0)},t.prototype.clone=function(e){return new t(e,this)},t.prototype.play=function(t){if(void 0===t&&(t=0),this.currentTime=void 0!==t?t:0,!1===this.isPlaying){this.isPlaying=!0,this.root,this.data;var e=this.data.keys;e.length&&(this.prevKey=e[0],this.nextKey=e[1]),this.update(0)}this.isPaused=!1},t.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1},t.prototype.update=function(t){if(!1!==this.isPlaying){this.currentTime+=t*this.timeScale;var e=this.duration;!0===this.loop&&this.currentTime>e&&(this.currentTime%=e),this.currentTime=Math.min(this.currentTime,e);var n=this.data.keys;if(n.length&&n.length>1){var i=this.prevKey,r=this.nextKey;if(this.currentTime<i.time&&(this.prevKey=i=n[0],this.nextKey=r=n[1]),r.time<=this.currentTime){for(;r.time<this.currentTime&&r.index>i.index;)r=n[(i=r).index+1];this.prevKey=i,this.nextKey=r}r.time>=this.currentTime?this.key_interpolate(i,r,this.currentTime):this.key_interpolate(i,r,r.time),this.updateMatrix()}}},t.prototype.updateMatrix=function(){this.root.matrix.identity();for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(this.root.matrix);this.root.matrixWorldNeedsUpdate=!0},t.prototype.key_interpolate=function(t,e,n){for(var i=0,r=t.targets.length;r>i;i++){var o,a=t.targets[i],s=e.targets[i],l=this.animatedTransforms[i];if("matrix"!==l.type&&s){var c=(n-t.time)/(e.time-t.time),u=s.data,h=a.data;if(0>c&&(c=0),c>1&&(c=1),h.length){o=[];for(var d=0;d<h.length;++d)o[d]=h[d]+(u[d]-h[d])*c}else o=h+(u-h)*c}else o=a.data;l.update(o,a.member)}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){(function(t){var i=function(){function e(){}return e.replaceColorGradient=function(t,e,n,i,r,o,a){for(var s=t.getAttribute("color"),l=s.length/18,c=0,u=1/(l+1),h=e.clone(),d=s.array,f=0;l>f;f++){var p=18*f;o&&a>c?(d[p+0]=d[p+3]=d[p+15]=o.r,d[p+1]=d[p+4]=d[p+16]=o.g,d[p+2]=d[p+5]=d[p+17]=o.b,d[p+6]=d[p+9]=d[p+12]=o.r,d[p+7]=d[p+10]=d[p+13]=o.g,d[p+8]=d[p+11]=d[p+14]=o.b,c+=u,h=e.clone().lerp(n,c)):c>r?(d[p+0]=d[p+3]=d[p+15]=i.r,d[p+1]=d[p+4]=d[p+16]=i.g,d[p+2]=d[p+5]=d[p+17]=i.b,d[p+6]=d[p+9]=d[p+12]=i.r,d[p+7]=d[p+10]=d[p+13]=i.g,d[p+8]=d[p+11]=d[p+14]=i.b):(d[p+0]=d[p+3]=d[p+15]=h.r,d[p+1]=d[p+4]=d[p+16]=h.g,d[p+2]=d[p+5]=d[p+17]=h.b,c+=u,h=e.clone().lerp(n,c),d[p+6]=d[p+9]=d[p+12]=h.r,d[p+7]=d[p+10]=d[p+13]=h.g,d[p+8]=d[p+11]=d[p+14]=h.b)}s.needsUpdate=!0},e.makeLineGeometry=function(e,n,i,r,o){for(var a=i?e.length-1:e.length/2,s=new Float32Array(18*a),l=new Float32Array(18*a),c=new Float32Array(12*a),u=0;a>u;u++){var h=i?u:2*u,d=18*u,f=12*u,p=e[h],m=e[h+1],v=(new t.Vector3).subVectors(m,p).normalize();n?(c[f+0]=c[f+2]=c[f+10]=n[h],c[f+6]=c[f+8]=c[f+4]=n[h+1]):(c[f+0]=c[f+2]=c[f+10]=0,c[f+6]=c[f+8]=c[f+4]=1),c[f+1]=c[f+5]=c[f+9]=0,c[f+3]=c[f+7]=c[f+11]=1,s[d+0]=s[d+3]=s[d+15]=p.x,s[d+1]=s[d+4]=s[d+16]=p.y,s[d+2]=s[d+5]=s[d+17]=p.z,s[d+6]=s[d+9]=s[d+12]=m.x,s[d+7]=s[d+10]=s[d+13]=m.y,s[d+8]=s[d+11]=s[d+14]=m.z,l[d+0]=l[d+3]=l[d+6]=l[d+9]=l[d+12]=l[d+15]=v.x,l[d+1]=l[d+4]=l[d+7]=l[d+10]=l[d+13]=l[d+16]=v.y,l[d+2]=l[d+5]=l[d+8]=l[d+11]=l[d+14]=l[d+17]=v.z}var g=new t.BufferGeometry;if(g.addAttribute("position",new t.BufferAttribute(s,3)),g.addAttribute("normal",new t.BufferAttribute(l,3)),g.addAttribute("uv",new t.BufferAttribute(c,2)),r){o=o||r;var y=new Float32Array(18*a),b=0,x=1/(a+1),w=r.clone();for(u=0;a>u;u++){y[(d=18*u)+0]=y[d+3]=y[d+15]=w.r,y[d+1]=y[d+4]=y[d+16]=w.g,y[d+2]=y[d+5]=y[d+17]=w.b,b+=x,w=r.clone().lerp(o,b),y[d+6]=y[d+9]=y[d+12]=w.r,y[d+7]=y[d+10]=y[d+13]=w.g,y[d+8]=y[d+11]=y[d+14]=w.b}g.addAttribute("color",new t.BufferAttribute(y,3))}return g.computeBoundingSphere(),g.computeBoundingBox(),g},e.makeCircleGeometry=function(e,n,i,r){void 0===e&&(e=1),void 0===n&&(n=32);for(var o=n,a=new Float32Array(18*o),s=new Float32Array(18*o),l=new Float32Array(12*o),c=0;o>c;c++){var u=c,h=18*c,d=12*c,f=2*Math.PI*u/n,p=2*Math.PI*(u+1)/n,m=Math.sin(f),v=Math.cos(f),g=Math.sin(p),y=Math.cos(p);l[d+0]=l[d+2]=l[d+4]=l[d+6]=l[d+8]=l[d+12]=.5,l[d+1]=l[d+5]=l[d+9]=0,l[d+3]=l[d+7]=l[d+11]=1,a[h+0]=a[h+3]=a[h+15]=e*m,a[h+1]=a[h+4]=a[h+16]=e*v,a[h+2]=a[h+5]=a[h+17]=0,a[h+6]=a[h+9]=a[h+12]=e*g,a[h+7]=a[h+10]=a[h+13]=e*y,a[h+8]=a[h+11]=a[h+14]=0,s[h+0]=s[h+3]=s[h+15]=v,s[h+1]=s[h+4]=s[h+16]=-m,s[h+2]=s[h+5]=s[h+17]=0,s[h+6]=s[h+9]=s[h+12]=y,s[h+7]=s[h+10]=s[h+13]=-g,s[h+8]=s[h+11]=s[h+14]=0}var b=new t.BufferGeometry;if(b.addAttribute("position",new t.BufferAttribute(a,3)),b.addAttribute("normal",new t.BufferAttribute(s,3)),b.addAttribute("uv",new t.BufferAttribute(l,2)),i){r=r||i;var x=new Float32Array(18*o),w=0,_=1/(o+1),S=i.clone();for(c=0;o>c;c++){x[(h=18*c)+0]=x[h+3]=x[h+15]=S.r,x[h+1]=x[h+4]=x[h+16]=S.g,x[h+2]=x[h+5]=x[h+17]=S.b,w+=_,S=i.clone().lerp(r,w),x[h+6]=x[h+9]=x[h+12]=S.r,x[h+7]=x[h+10]=x[h+13]=S.g,x[h+8]=x[h+11]=x[h+14]=S.b}b.addAttribute("color",new t.BufferAttribute(x,3))}return b.computeBoundingSphere(),b.computeBoundingBox(),b},e.makeCurveGeometry=function(e,n,i,r){var o=2*(n+1),a=new Float32Array(3*o),s=new Float32Array(3*o),l=new Float32Array(2*o),c=new Uint16Array(6*n),u=new t.BufferGeometry;u.addAttribute("position",new t.BufferAttribute(a,3)),u.addAttribute("normal",new t.BufferAttribute(s,3)),u.addAttribute("uv",new t.BufferAttribute(l,2)),u.addAttribute("index",new t.BufferAttribute(c,3));for(var h=0;n>=h;h++){var d=h/n,f=e.getPoint(d),p=e.getTangent(d),m=6*h;l[(g=4*h)+0]=l[g+2]=d*i,r(d),l[g+1]=0,l[g+3]=1,a[m+0]=a[m+3]=f.x,a[m+1]=a[m+4]=f.y,a[m+2]=a[m+5]=f.z,s[m+0]=s[m+3]=p.x,s[m+1]=s[m+4]=p.y,s[m+2]=s[m+5]=p.z}if(r){var v=new Float32Array(o);u.addAttribute("relThickness",new t.BufferAttribute(v,1));for(h=0;n>=h;h++){d=h/n;v[m=2*h]=v[m+1]=r(d)}}for(h=0;n>h;h++){var g=2*h;c[(m=6*h)+0]=g+0,c[m+1]=g+1,c[m+2]=g+2,c[m+3]=g+3,c[m+4]=g+2,c[m+5]=g+1}return u},e.make2DCircleMesh=function(n,i,r,o){return void 0===n&&(n=1),void 0===i&&(i=32),new t.Mesh(e.makeCircleGeometry(n,i),e.makeThinline2DMaterial(r,o))},e.makeThinline2DAdditiveMaterial=function(i,r){if(void 0!==r&&e.convertedMaterials[r.uuid])return e.convertedMaterials[r.uuid];i=i||{};var o=new t.ShaderMaterial({uniforms:{color:{type:"c",value:i.color?new t.Color(i.color):new t.Color(1,1,1)},intensity:{type:"f",value:i.intensity||1},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)}},vertexShader:n(33),fragmentShader:n(34)});return o.transparent=!0,o.blending=t.AdditiveBlending,o.depthTest=!1,o.depthWrite=!1,null!=r&&(o.name=r.name,e.convertedMaterials[r.uuid]=o),o},e.makeThinline2DMaterial=function(n,i){var r=e.makeThinline2DAdditiveMaterial(n,i);return r.blending=t.CustomBlending,r.blendEquation=t.AddEquation,r.blendSrc=t.SrcAlphaFactor,r.blendDst=t.OneMinusSrcAlphaFactor,r},e.makeThinline2DBeginEndMaterial=function(e){e=e||{};var i=new t.ShaderMaterial({uniforms:{color:{type:"c",value:e.color?new t.Color(e.color):new t.Color(1,1,1)},intensity:{type:"f",value:e.intensity||1},length:{type:"f",value:e.intensity||1},begin:{type:"f",value:e.intensity||0},end:{type:"f",value:e.intensity||0},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)}},vertexShader:n(35),fragmentShader:n(36)});return i.transparent=!0,i.depthTest=!1,i.depthWrite=!1,i.blending=t.CustomBlending,i.blendEquation=t.AddEquation,i.blendSrc=t.SrcAlphaFactor,i.blendDst=t.OneMinusSrcAlphaFactor,i},e.makeRouteMaterial=function(e,i,r){var o=new t.ShaderMaterial({uniforms:{time:{type:"f",value:0},devicePixelRatio:{type:"f",value:i},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)},intensity:{type:"f",value:1},length:{type:"f",value:1},twoways:{type:"f",value:e?-1:1},color:{type:"c",value:new t.Color(r.color||"rgb(80,20,0)")},colorBorder:{type:"c",value:new t.Color(r.colorBorder||"rgb(100,40,0)")},width:{type:"f",value:r.width},size:{type:"f",value:r.size},density:{type:"f",value:r.density},speed:{type:"f",value:r.speed},side:{type:"f",value:r.side},center:{type:"f",value:r.center},presence:{type:"f",value:1},highlight:{type:"f",value:0},highlightFactor:{type:"f",value:.5},depthFactor:{type:"f",value:.1},pitchEffect:{type:"f",value:r.pitchEffect},pitchIntensity:{type:"f",value:r.pitchIntensity}},attributes:{relThickness:{type:"f",value:[]}},vertexShader:n(37),fragmentShader:n(38)});return o.transparent=!0,o.blending=t.AdditiveBlending,o.depthTest=!1,o.depthWrite=!1,o},e.makeVertexColoredThinline2DMaterial=function(i,r){if(void 0!==r&&e.convertedMaterials[r.uuid])return e.convertedMaterials[r.uuid];i=i||{};var o=new t.ShaderMaterial({uniforms:{intensity:{type:"f",value:i.intensity||1},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)}},vertexShader:n(39),fragmentShader:n(40)});return o.transparent=!0,o.blending=t.CustomBlending,o.blendEquation=t.AddEquation,o.blendSrc=t.SrcAlphaFactor,o.blendDst=t.OneMinusSrcAlphaFactor,o.depthTest=!0,o.depthWrite=!1,null!=r&&(o.name=r.name,e.convertedMaterials[r.uuid]=o),o},e.makeBasicVertexColoredMaterial=function(i){if(void 0!==i&&e.convertedMaterials[i.uuid])return e.convertedMaterials[i.uuid];var r=new t.ShaderMaterial({vertexShader:n(41),fragmentShader:n(42)});return r.transparent=!0,r.blending=t.AdditiveBlending,r.depthTest=!1,r.depthWrite=!1,null!=i&&(r.name=i.name,e.convertedMaterials[i.uuid]=r),r},e.makeLineMesh=function(n,i,r){return new t.Mesh(e.makeLineGeometry(n),e.makeThinline3DMaterial(i,r))},e.convertContourMeshIntoLineMesh=function(n){if(n instanceof t.Mesh){if(n.geometry instanceof t.Geometry){for(var i=(S=n.geometry).faces,r=S.vertices,o=r.length,a=[],s=0;s<i.length;s++){var l=i[s];a.push(l.a),a.push(l.b),a.push(l.c)}for(var c={},u=[],h=[],d=0;d<a.length;d+=3)for(var f=d;d+3>f;f++){var p=a[f],m=a[d+(f+1)%3],v=a[d+(f+2)%3],g=r[p],y=r[m],b=r[v];if((A=g.distanceToSquared(y))>g.distanceToSquared(b)||A>y.distanceToSquared(b)){var x=p+o*m;if(void 0!==c[O=m+o*p]){var w=r[a[(R=c[O])-R%3+(R+2)%3]];g.distanceToSquared(b)<y.distanceToSquared(b)?(u.push((new t.Vector3).addVectors(g,b).multiplyScalar(.5)),u.push((new t.Vector3).addVectors(y,w).multiplyScalar(.5))):(u.push((new t.Vector3).addVectors(g,w).multiplyScalar(.5)),u.push((new t.Vector3).addVectors(y,b).multiplyScalar(.5)))}else c[x]=f}}var _=n.material.color.clone();return(B=Math.max(_.r,_.g,_.b))>0&&_.multiplyScalar(1/B),e.makeLineMesh(u,e.materialParams[n.material.name]||{color:_.getHex(),intensity:B},n.material)}if(n.geometry instanceof t.BufferGeometry){var S;if((S=n.geometry).getAttribute("index")){var M=S.getAttribute("position").array,C=(o=M.length/3,a=S.getAttribute("index").array,S.getAttribute("uv").array);for(c={},u=[],h=[],g=new t.Vector3,y=new t.Vector3,b=new t.Vector3,w=new t.Vector3,d=0;d<a.length;d+=3)for(f=d;d+3>f;f++){var T=3*(p=a[f]),E=3*(m=a[d+(f+1)%3]),k=3*(v=a[d+(f+2)%3]);g.set(M[T],M[T+1],M[T+2]),y.set(M[E],M[E+1],M[E+2]),b.set(M[k],M[k+1],M[k+2]);var A,P=C[2*p],L=C[2*m];if((A=g.distanceToSquared(y))>g.distanceToSquared(b)||A>y.distanceToSquared(b)){var O;x=p+o*m;if(void 0!==c[O=m+o*p]){var R,F=3*a[(R=c[O])-R%3+(R+2)%3];w.set(M[F],M[F+1],M[F+2]),h.push(P),h.push(L),g.distanceToSquared(b)<y.distanceToSquared(b)?(u.push((new t.Vector3).addVectors(g,b).multiplyScalar(.5)),u.push((new t.Vector3).addVectors(y,w).multiplyScalar(.5))):(u.push((new t.Vector3).addVectors(g,w).multiplyScalar(.5)),u.push((new t.Vector3).addVectors(y,b).multiplyScalar(.5)))}else c[x]=f}}var B;_=n.material.color.clone();return(B=Math.max(_.r,_.g,_.b))>0&&_.multiplyScalar(1/B),new t.Mesh(e.makeLineGeometry(u,h),e.makeThinline3DMaterial(e.materialParams[n.material.name]||{color:_.getHex(),intensity:B},n.material))}return console.log("BufferGeometry without index, do nothing!!!"),n}throw new Error("Expecting a THREE.Geometry")}throw new Error("Expecting a THREE.Mesh")},e.convertMeshesWithThinlineMaterial=function(n){var i=[];n.traverse((function(e){e instanceof t.Mesh&&e.material&&e.material.name&&0===e.material.name.indexOf("Thinline")&&i.push(e)}));for(var r=0;r<i.length;r++){var o=i[r],a=e.convertContourMeshIntoLineMesh(o);o.parent.add(a),o.parent.remove(o)}},e.replaceMaterial=function(e,n,i){e.traverse((function(e){e instanceof t.Mesh&&e.material&&e.material.name&&e.material.name===n&&(e.material=i)}))},e.getMaterial=function(e,n){var i=null;return e.traverse((function(e){e instanceof t.Mesh&&e.material&&e.material.name&&e.material.name===n&&(i=e.material)})),i},e.getMaterialStartingWith=function(e,n){var i={};return e.traverse((function(e){if(e instanceof t.Mesh&&e.material&&e.material.name&&0===e.material.name.indexOf(n)){var r=e;i[r.material.name]=r.material}})),i},e.convertIncludedAdditiveMaterial=function(n){n.traverse((function(n){if(n instanceof t.Mesh&&n.material&&n.material.name&&0===n.material.name.indexOf("Additive"))if(n.geometry instanceof t.Geometry&&n.geometry.faces[0].vertexColors.length){n.material=e.makeBasicVertexColoredMaterial(n.material);var i=new t.BufferGeometry,r=n.geometry;i.fromGeometry(r);for(var o=new Float32Array(9*r.faces.length),a=0;a<r.faces.length;a++){var s=9*a,l=r.faces[a];o[s]=l.vertexColors[0].r,o[s+1]=l.vertexColors[0].g,o[s+2]=l.vertexColors[0].b,o[s+3]=l.vertexColors[1].r,o[s+4]=l.vertexColors[1].g,o[s+5]=l.vertexColors[1].b,o[s+6]=l.vertexColors[2].r,o[s+7]=l.vertexColors[2].g,o[s+8]=l.vertexColors[2].b}i.addAttribute("color",new t.BufferAttribute(o,3)),n.geometry=i}else if(n.geometry instanceof t.BufferGeometry&&n.geometry.getAttribute("color")){i=n.geometry;n.material=e.makeBasicVertexColoredMaterial(n.material)}else{var c=n.material;c.transparent=!0,c.blending=t.AdditiveBlending,c.depthTest=!1,c.depthWrite=!1}}))},e.collapseMaterialsPerName=function(e){var n={};e.traverse((function(e){if(e instanceof t.Mesh&&e.material&&e.material.name){var i=e.material;n[i.name]?e.material=n[i.name]:n[i.name]=i}}))},e.updateMaterialsResolution=function(e,n,i){e.traverse((function(e){e instanceof t.Mesh&&e.material&&e.material.uniforms&&void 0!==e.material.uniforms.resolution&&e.material.uniforms.resolution.value instanceof t.Vector2&&e.material.uniforms.resolution.value.set(n,i)}))},e.appendGUI=function(e,n){var i=e.addFolder((n?n.name?n.name:n.children&&n.children[0]?n.children[0].name:null:null)||"Object"),r={};i.add(n,"visible"),n.traverse((function(e){if(e instanceof t.Mesh&&e.material){if(e.material.uniforms&&!r[e.material.uuid]){var n=(s=e.material).uniforms,o=i.addFolder(s.name),a={};r[s.uuid]=!0,n.color&&(a.color=n.color.value.getStyle(),o.addColor(a,"color").onChange((function(t){n.color.value.setStyle(t)}))),n.intensity&&(a.intensity=n.intensity.value,o.add(a,"intensity",0,1).onChange((function(t){n.intensity.value=t}))),n.fadeBack&&(a.fadeBack=n.fadeBack.value,o.add(a,"fadeBack",0,1).onChange((function(t){n.fadeBack.value=t}))),n.radiusAndInvRadius&&(a.radius=n.radiusAndInvRadius.value.x,o.add(a,"radius").min(1e-4).onChange((function(t){n.radiusAndInvRadius.value.x=t,n.radiusAndInvRadius.value.y=1/t}))),n.depth&&(a.depthMin=n.depth.value.x,a.depthMax=n.depth.value.y,o.add(a,"depthMin").onChange((function(t){n.depth.value.x=t})),o.add(a,"depthMax").onChange((function(t){n.depth.value.y=t}))),n.fade&&(a.fadeMin=n.fade.value.x,a.fadeMax=n.fade.value.y,o.add(a,"fadeMin",0,1).onChange((function(t){n.fade.value.x=t})),o.add(a,"fadeMax",0,1).onChange((function(t){n.fade.value.y=t})))}if(e.material.name&&0===e.material.name.indexOf("Additive")&&!r[e.material.uuid]){var s=e.material;o=i.addFolder(s.name),a={};r[s.uuid]=!0,a.color=s.color.getStyle(),o.addColor(a,"color").onChange((function(t){s.color.setStyle(t)}))}}}))},e.version=1,e.convertedMaterials={},e.materialParams={ThinlineGrid:{color:"#96a5ff",intensity:.36,fadeBack:1,depthMax:10,fadeMax:.2}},e.makeThinline3DMaterial=function(i,r){if(void 0!==r&&e.convertedMaterials[r.uuid])return e.convertedMaterials[r.uuid];i=i||{};var o=new t.ShaderMaterial({uniforms:{color:{type:"c",value:i.color?new t.Color(i.color):new t.Color(1,1,1)},intensity:{type:"f",value:i.intensity||1},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)},fadeBack:{type:"f",value:i.fadeBack||0},radiusAndInvRadius:{type:"v2",value:i.radiusAndInvRadius||new t.Vector2(1,1)},fade:{type:"v2",value:new t.Vector2(i.fadeMin||1,i.fadeMax||1)},depth:{type:"v2",value:new t.Vector2(i.depthMin||0,i.depthMax||1)}},vertexShader:n(43),fragmentShader:n(44)});return o.transparent=!0,o.blending=t.CustomBlending,o.blendEquation=t.AddEquation,o.blendSrc=t.SrcAlphaFactor,o.blendDst=t.OneMinusSrcAlphaFactor,o.depthTest=!1,o.depthWrite=!1,null!=r&&(o.name=r.name,e.convertedMaterials[r.uuid]=o),o},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i}).call(e,n(2))},function(t,e){t.exports="uniform vec2 resolution;\nvarying vec3 texcoord;\nvoid main() {\n\tfloat d = 6.0 * (uv.y - 0.5);\n\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\tvec4 wposN = modelViewMatrix * vec4( position + normal, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tvec4 vpn = projectionMatrix * wposN;\n\tfloat nx = vpn.x*vp.w - vpn.w*vp.x;\n\tfloat ny = vpn.y*vp.w - vpn.w*vp.y;\n\tvec3 t = normalize(vec3(nx, ny, 0));\n\tgl_Position = vp + vec4(d*vp.w*vec2(t.y/resolution.x, -t.x/resolution.y), 0, 0);\n\ttexcoord = vec3(uv.x*vp.w, uv.y*vp.w, vp.w);\n}"},function(t,e){t.exports="uniform vec3 color;\nuniform float intensity;\nvarying vec3 texcoord;\nvoid main() {\n\tfloat n = 2.0*(0.5 - abs(texcoord.y/texcoord.z-0.5));\n\tgl_FragColor = vec4(color.rgb, n * intensity);\n}"},33,function(t,e){t.exports="uniform vec3 color;\nuniform float intensity;\nuniform float length;\nuniform float begin;\nuniform float end;\n\nvarying vec3 texcoord;\n\nvoid main() {\n\tfloat n = 2.0*(0.5 - abs(texcoord.y/texcoord.z-0.5));\n\t\n\tfloat l = (texcoord.x/texcoord.z)*length;\n\t\n\tif (l < begin || l > length - end) {\n\t\tgl_FragColor = vec4(0.0,0.0,0.0,0.0);\n\t} else {\n\t\tgl_FragColor = vec4(color.rgb, n * intensity);\n\t}\n}"},function(t,e){t.exports="uniform float width;\nuniform float devicePixelRatio;\nattribute float relThickness;\nuniform vec2 resolution;\nuniform float presence;\nuniform float highlight;\nuniform float length;\nvarying vec3 texcoord;\nvarying float vZ;\nvarying float vcZ;\nvarying float pitchFactor;\n\nvoid main() {\n\tfloat thickness = devicePixelRatio * width * 50.0;\n\tfloat d = 2.0 * thickness * (uv.y - 0.5);\n//\tfloat d = 2.0 * uv.x * (uv.y - 0.5);\n//\tfloat d = 6.0 * (uv.y - 0.5);\n\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\tvZ = -wpos.z;\n\tvcZ = -(viewMatrix * vec4(0.,0.,0.,1.)).z;\n\tpitchFactor = 1.0 - abs((viewMatrix * vec4(0.,1.,0.,0.)).y);\n\tvec4 wposN = modelViewMatrix * vec4( position + normal, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tvec4 vpn = projectionMatrix * wposN;\n\tfloat nx = vpn.x*vp.w - vpn.w*vp.x;\n\tfloat ny = vpn.y*vp.w - vpn.w*vp.y;\n\tvec3 t = normalize(vec3(nx, ny, 0));\n\tgl_Position = vp + vec4(d*vp.w*vec2(t.y/resolution.x, -t.x/resolution.y), 0, 0);\n\ttexcoord = vec3(uv.x, uv.y, relThickness);\n}\n"},function(t,e){t.exports="uniform float time;\nuniform sampler2D map;\nuniform float intensity;\nvarying float vZ; \nvarying float vcZ;\nvarying float pitchFactor;\nvarying vec3 texcoord;\nuniform float length;\nuniform float twoways;\nuniform vec3 color;\nuniform vec3 colorBorder;\nuniform float width;\nuniform float size;\nuniform float density;\nuniform float speed;\nuniform float side;\nuniform float center;\nuniform float pitchEffect;\nuniform float pitchIntensity;\nuniform float presence;\nuniform float highlight;\nuniform float highlightFactor;\nuniform float depthFactor;\n\n\t\t\t\t\nfloat rand(vec2 co){\n\t\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat noisemap(vec2 uv, float sizeFactor, float densityFactor, float speedFactor) {\n\tvec2 vf = vec2(uv.x + time * speedFactor * speed * (uv.y < 0.5 ? twoways : 1.0), uv.y)*(sizeFactor * 2. * size);\t\n\tvec2 v = vec2(floor(vf.x), floor(vf.y));\n\tvec2 f = vf-v;\t\n\tfloat r = 2.0*distance(f, vec2(0.5, 0.5));\n\tfloat d = 1.0 - min(r, 1.0);\n\tfloat p = rand(v);\n\tp = p < densityFactor * 3. * density ? d*(1.0 - 2.0 * abs(uv.y - 0.5)) : 0.0;\n\treturn p;\n}\n\nvoid main() {\n\n\tfloat v = (texcoord.y-0.5)/texcoord.z+0.5;\n\tif(presence>1.) {\n\t\tfloat k = max(0., texcoord.x - (presence-1.))/(2.0-presence);\n\t\tv = (texcoord.y-0.5)/(k*texcoord.z)+0.5;\n\t}\n\tvec2 uv = vec2((texcoord.x-0.5)*length/30.0, v);\n\tfloat c = 1.0 - 2.0 * abs(uv.y - 0.5);\n\tvec3 tc = colorBorder;\n\tvec3 tcr = color;\n\tvec4 col = (uv.y >= 0.0 && uv.y <= 1.0)? \n\t\tc*vec4(tcr-vec3(0.,0.05,0.),  1.) * noisemap(uv, 6.0, 0.3, 2.0) +\n\t\tc*vec4(tcr,  1.) * noisemap(uv, 10.0, 0.3, 3.0) +\n\t\tc*vec4(tcr+vec3(0.,0.05,0.),  1.) * noisemap(uv, 16.0, 0.3, 4.0) +\n\t\tvec4(c*c*tc*2.,1.0) +\n\t\tcenter*vec4(c > 0.8 ? tcr*3.*(c-0.8) : vec3(0.), 1.0) +\n\t\tside*vec4(c < 0.2 ? tc *1. * (1.-10.*abs(c-0.1)) : vec3(0.), 1.0) \n\t\t: vec4(0,0,0,0);\n\t//float fade = mix(1.0, pitchFactor*pitchFactor+0.05, clamp(vZ/(2.0+ (vcZ > 0.? vcZ : 0.)), 0., 1.));\n\tfloat fade = mix(1.0, 0.1, clamp(vZ*(1.+5.*depthFactor)/0.75, 0., 1.));\n\tfade = mix(fade, mix(fade, pitchIntensity*2.0, pitchFactor), pitchEffect);\n\tfade = mix(fade,1.,highlight);\n\tgl_FragColor = (1. + 4.* highlightFactor *highlight) * vec4(col.rgb*intensity*fade, col.a*intensity) * \n\t\t(presence <= 1. ? (texcoord.x < presence  ? 1. : 0.) : (texcoord.x > (presence-1.) ? 1. : 0.));\n}\n"},function(t,e){t.exports="attribute vec3 color;\nuniform vec2 resolution;\nvarying vec3 texcoord;\nvarying vec3 vColor;\nvoid main() {\n\tfloat d = 6.0 * (uv.y - 0.5);\n\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\tvec4 wposN = modelViewMatrix * vec4( position + normal, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tvec4 vpn = projectionMatrix * wposN;\n\tfloat nx = vpn.x*vp.w - vpn.w*vp.x;\n\tfloat ny = vpn.y*vp.w - vpn.w*vp.y;\n\tvec3 t = normalize(vec3(nx, ny, 0));\n\tgl_Position = vp + vec4(d*vp.w*vec2(t.y/resolution.x, -t.x/resolution.y), 0, 0);\n\ttexcoord = vec3(uv.x*vp.w, uv.y*vp.w, vp.w);\n\tvColor = color;\n}"},function(t,e){t.exports="varying vec3 vColor;\nuniform float intensity;\nvarying vec3 texcoord;\nvoid main() {\n\tfloat n = 3.0*(0.5 - abs(texcoord.y/texcoord.z-0.5));\n\tgl_FragColor = vec4(vColor.rgb, n * intensity);\n}"},function(t,e){t.exports="attribute vec3 color;\nvarying vec3 vColor;\nvoid main() {\n\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tgl_Position = vp;\n\tvColor = color;\n}"},function(t,e){t.exports="varying vec3 vColor;\nuniform float intensity;\nvoid main() {\n\tgl_FragColor = vec4(vColor.rgb, 1);\n}"},function(t,e){t.exports="uniform vec2 resolution;\nuniform vec3 color;\nuniform float intensity;\n//\nuniform vec2 radiusAndInvRadius;\nuniform float fadeBack;\n//\n////varying vec2 texcoord;\nvarying vec3 texcoord;\nvarying vec4 vcolor;\nvarying vec4 wpos;\nvoid main() {\n\tfloat d = 6.0 * (uv.y - 0.5);\n\twpos = modelViewMatrix * vec4( position, 1.0 );\n\tvec4 wposN = modelViewMatrix * vec4( position + normal, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tvec4 vpn = projectionMatrix * wposN;\n\tfloat nx = vpn.x*vp.w - vpn.w*vp.x;\n\tfloat ny = vpn.y*vp.w - vpn.w*vp.y;\n\tvec3 t = normalize(vec3(nx, ny, 0));\n\tgl_Position = vp + vec4(d*vp.w*vec2(t.y/resolution.x, -t.x/resolution.y), 0, 0);\n//+ \t//texcoord = uv;\n\ttexcoord = vec3(uv.x*vp.w, uv.y*vp.w, vp.w);\n\n//\tvec4 o = modelViewMatrix * vec4(0.0,0.0,0.0,1.0);\n\tvec3 o = modelViewMatrix[3].xyz;\n\n\tvec3 lo = vec3(dot(o, modelViewMatrix[0].xyz), dot(o, modelViewMatrix[1].xyz), dot(o, modelViewMatrix[2].xyz));\n\tfloat z = -dot(lo, position)/length(lo);\n\n\tfloat alpha;\n\n\tif (z < -radiusAndInvRadius.x) {\n\t\talpha = fadeBack;\n\t} else if (z < radiusAndInvRadius.x) {\n\t\talpha = fadeBack + (1.0 - fadeBack) * (radiusAndInvRadius.x + z) * 0.5 * radiusAndInvRadius.y;\n\t} else {\n\t\talpha = 1.0;\n\t}\n\t\t\t\n\tvcolor = vec4(color,alpha*intensity);\n\n//\tvcolor = color;\n\n}\n"},function(t,e){t.exports="//varying vec2 texcoord;\nvarying vec4 vcolor;\nvarying vec3 texcoord;\nvarying vec4 wpos;\nuniform vec2 fade;\nuniform vec2 depth;\nfloat lerp(float a, float b, float t) { return (1.0-t)*a + t*b; }\nfloat clamp01(float a) { return a < 0.0? 0.0 : a < 1.0? a : 1.0; }\nvoid main() {\n\tfloat n = 2.0*(0.5 - abs(texcoord.y/texcoord.z-0.5));\n//\tfloat d = clamp01(depth.y/abs(wpos.z));\n//\tgl_FragColor = vec4(vcolor.rgb, 2.0 * n * d * vcolor.a);\n\tfloat d = lerp(fade.x, fade.y, clamp01((abs(wpos.z)-depth.x)/(depth.y-depth.x)));\n\tgl_FragColor = vec4(vcolor.rgb, 2.0 * n * d * d * vcolor.a);\n}"},function(t,e){var n=function(){function t(){}return t.foreach=function(t,e){if(t instanceof Array)for(var n=0,i=t.length;i>n;n++)e(t[n]);else for(var r in t)e(t[r])},t.strStartsWith=function(t,e){return 0===t.indexOf(e)},t.strEndsWith=function(t,e){var n=t.length,i=e.length;return n>=i&&t.substring(n-i,n)===e},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e){function n(t){return void 0===t?void 0:null===t?null:Number(t)}function i(t){return null==t?0:Number(t)}function r(t){return t&&"0"!==t}function o(t){return t?{raw:t,id:n(t.id),name:t.name,type:m[t.type]}:null}function a(t){return{raw:t,id:n(t.id),status:f[t.status],time_modified:t.time_modified,type:p[t.type],name:t.name,code:t.code,position_x:n(t.position_x),position_y:n(t.position_y),position_z:n(t.position_z),affiliation:t.affiliation,aggregated_age:n(t.aggregated_age),aggregated_size:n(t.aggregated_size),aggregated_population:i(t.aggregated_population),aggregated_economy:i(t.aggregated_economy),aggregated_danger:i(t.aggregated_danger)}}function s(t){var e=a(t);return e.shader_data=t.shader_data,e.habitable_zone_inner=n(t.habitable_zone_inner),e.habitable_zone_outer=n(t.habitable_zone_outer),e.frost_line=n(t.frost_line),e.description=t.description,e.celestial_objects=t.celestial_objects.map(l),e}function l(t){var e={raw:t,id:n(t.id),parent_id:n(t.parent_id),time_modified:t.time_modified,type:m[t.type],designation:t.designation,name:t.name,code:t.code,appearance:v[t.appearance],age:n(t.age),distance:n(t.distance),latitude:n(t.latitude),longitude:n(t.longitude),description:t.description,sensor_danger:i(t.sensor_danger),sensor_economy:i(t.sensor_economy),sensor_population:i(t.sensor_population),habitable:r(t.habitable),shader_data:t.shader_data,size:n(t.size),star_classification:t.star_classification,subtype_id:n(t.subtype_id),subtype:o(t.subtype),affiliation:t.affiliation,population:t.population,children:t.children?t.children.map(l):[],show_orbitlines:r(t.show_orbitlines),show_label:r(t.show_label)};return t.axial_tilt&&(e.axial_tilt=n(t.axial_tilt)),t.orbit_period&&(e.orbit_period=n(t.orbit_period)),t.star_system_id&&(e.star_system_id=n(t.star_system_id)),t.model&&(e.model=t.model),t.texture&&(e.texture=t.texture),t.thumbnail&&(e.thumbnail=t.thumbnail),e}function c(t){var e={raw:t,id:n(t.id),name:t.name,size:g[t.size],direction:y[t.direction],entry_id:n(t.entry_id),entry:t.entry?l(t.entry):null,exit_id:n(t.entry_id),exit:t.exit?l(t.exit):null};return e.entry&&void 0===e.entry.type&&(e.entry.type=m.JUMPPOINT),e.exit&&void 0===e.exit.type&&(e.exit.type=m.JUMPPOINT),e}function u(t){return{leastjumps:t.leastjumps?h(t.leastjumps):null,shortest:t.shortest?h(t.shortest):null}}function h(t){return{raw:t,name:t.name,label:t.label,first_jump:t.first_jump,flight_distance:t.flight_distance,jumps:t.jumps,segments:t.segments.map(d)}}function d(t){return{raw:t,id:n(t.id),name:t.name,system_id:n(t.system_id),object_id:n(t.object_id),system_code:t.system_code,object_code:t.object_code,segment_type:b[t.segment_type],segment_distance:t.segment_distance,is_departure:!!t.is_departure,is_destination:!!t.is_destination}}e.toSubTypeAPI=o,function(t){t[t.D=0]="D",t[t.R=1]="R",t[t.U=2]="U",t[t.N=3]="N",t[t.S=4]="S",t[t.P=5]="P"}(e.StatusCodeEnum||(e.StatusCodeEnum={}));var f=e.StatusCodeEnum;!function(t){t[t.draft=0]="draft",t[t.review=1]="review",t[t.undiscovered=2]="undiscovered",t[t.nodata=3]="nodata",t[t.stub=4]="stub",t[t.published=5]="published"}(e.StatusLabelEnum||(e.StatusLabelEnum={})),e.StatusLabelEnum,function(t){t[t.SINGLE_STAR=0]="SINGLE_STAR",t[t.BINARY=1]="BINARY"}(e.StarSystemTypeEnum||(e.StarSystemTypeEnum={}));var p=e.StarSystemTypeEnum;e.toSystemDetailAPI=s,function(t){t[t.STAR=0]="STAR",t[t.PLANET=1]="PLANET",t[t.SATELLITE=2]="SATELLITE",t[t.ASTEROID_BELT=3]="ASTEROID_BELT",t[t.ASTEROID_FIELD=4]="ASTEROID_FIELD",t[t.ANOMALY=5]="ANOMALY",t[t.MANMADE=6]="MANMADE",t[t.JUMPPOINT=7]="JUMPPOINT",t[t.LZ=8]="LZ",t[t.BLACKHOLE=9]="BLACKHOLE",t[t.POI=10]="POI"}(e.CelestialBodyType||(e.CelestialBodyType={}));var m=e.CelestialBodyType;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.PLANET_BLUE=1]="PLANET_BLUE",t[t.PLANET_GREEN=2]="PLANET_GREEN",t[t.PLANET_BROWN=3]="PLANET_BROWN",t[t.PLANET_GAS=4]="PLANET_GAS",t[t.CUSTOM=5]="CUSTOM"}(e.CelestialBodyAppearance||(e.CelestialBodyAppearance={}));var v=e.CelestialBodyAppearance;e.toCelestialBodyAPI=l,function(t){t[t.S=0]="S",t[t.M=1]="M",t[t.L=2]="L"}(e.TunnelSizeCodeEnum||(e.TunnelSizeCodeEnum={}));var g=e.TunnelSizeCodeEnum;!function(t){t[t.small=0]="small",t[t.medium=1]="medium",t[t.large=2]="large"}(e.TunnelSizeLabelEnum||(e.TunnelSizeLabelEnum={})),e.TunnelSizeLabelEnum,function(t){t[t.B=0]="B",t[t.U=1]="U"}(e.TunnelDirectionCodeEnum||(e.TunnelDirectionCodeEnum={}));var y=e.TunnelDirectionCodeEnum;!function(t){t[t.bidirectional=0]="bidirectional",t[t.unidirectional=1]="unidirectional"}(e.TunnelDirectionLabelEnum||(e.TunnelDirectionLabelEnum={})),e.TunnelDirectionLabelEnum,e.toTunnelAPI=c,e.getTunnelEntry=function(t){return t.entry},e.getTunnelExit=function(t){return t.exit},function(t){t[t.S=0]="S",t[t.M=1]="M",t[t.L=2]="L"}(e.ShipSizeCode||(e.ShipSizeCode={})),e.ShipSizeCode,e.toRoutesAPI=u,function(t){t[t.F=0]="F",t[t.J=1]="J"}(e.RouteSegmentCodeEnum||(e.RouteSegmentCodeEnum={}));var b=e.RouteSegmentCodeEnum;!function(t){t[t.flight=0]="flight",t[t.jump=1]="jump"}(e.RouteSegmentLabelEnum||(e.RouteSegmentLabelEnum={})),e.RouteSegmentLabelEnum,e.toRouteSegmentAPI=d,e.cleanBootupResponse=function(t){return{config:t.data.config,systems:t.data.systems.resultset.map(a),tunnels:t.data.tunnels.resultset.map(c),species:t.data.species.resultset,affiliations:t.data.affiliations.resultset}},e.cleanLoadResponse=function(t){return t.data},e.cleanSystemsResponse=function(t){return t.data.resultset.map(a)},e.cleanSystemDetailResponse=function(t){return s(t.data.resultset[0])},e.cleanCelestialBodyResponse=function(t){return l(t.data.resultset[0])},e.cleanTunnelsResponse=function(t){return t.data.resultset.map(c)},e.cleanSpeciesResponse=function(t){return t.data.resultset},e.cleanAffiliations=function(t){return t.data.resultset},e.cleanRoutesResponse=function(t){return u(t.data)}},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(48),o=n(53),a=n(55),s=n(57),l=n(24),c=n(32),u=n(22),h=n(46),d=n(52),f=n(58),p=n(61),m=n(26),v=n(62),g=function(e){function n(n,i,r,o,a,s,l,c,h){var d=this;e.call(this),this.scene=n,this.camera=i,this.window=r,this.controlAPI=s,this.starmapapi=l,this.resourcePath=c,this.getHeader=h,this.ready=!1,this.stars={},this.starsById={},this.jumpPointOtherEnd={},this.jumpPointRoute={},this.highlightedRoutes=null,this.highlightedObject={},this.routingSegments=null,this.currentRoutingSegment=null,this.routes=[],this.controllers={},this.highlightedStar=null,this.highlightedStarSticky=!1,this.started=!1,this.gui={nebula:!0},this.worldOffset=new t.Vector3(0,0,0),this.routeSizeSelectionArray=[!1,!1,!1],this.showLRScanner=!1,this.showRoutes=!1,this.pixelSizeOverZ=new t.Vector3,this.presenceRatio=1,this._view=u.ViewEnum.galaxy,this.affiliationCodes=[],this.speciesCodes=[],this.affiliations={},this.species={},this.affiliationColors={},this.systemCurrentlyViewed=null,this.jumpPrefabs=[],this.initConfig={stars:{radiusFactor:20,maxRadius:50,useStarFading:!0,fadeStart:3.5,pitchEffect:.5,pitchIntensity:.5,colorD1:"rgb(0,0,255)",colorD2:"rgb(128,128,255)",colorL1:"rgb(0,255,0)",colorL2:"rgb(128,255,129)",colorC1:"rgb(255,0,0)",colorC2:"rgb(255,128,128)"},routes:[{width:.24,color:"rgb(80,3,0)",colorBorder:"rgb(115,53,0)",size:.5,density:.5,speed:.5,side:0,center:0,pitchEffect:.5,pitchIntensity:.5,highlightFactor:.5,depthFactor:.1},{width:.39,color:"rgb(80,32,0)",colorBorder:"rgb(115,76,0)",size:.5,density:.5,speed:.5,side:0,center:0,pitchEffect:.5,pitchIntensity:.5,highlightFactor:.5,depthFactor:.1},{width:.54,color:"rgb(80,60,0)",colorBorder:"rgb(115,98,0)",size:.5,density:.5,speed:.5,side:0,center:0,pitchEffect:.5,pitchIntensity:.5,highlightFactor:.5,depthFactor:.1}],longRangeScanner:{radius:1},starfield:{radius:6,count:1e3,sizeMin:1,sizeMax:1,color1:"rgb(128,128,128)",color2:"rgb(100,100,100)"}},this.updateRoutesParams=function(){for(var t=0,e=d.routes;t<e.length;t++){e[t].updateRouteParams()}},this.root=new t.Group,this.starsRoot=new t.Group,this.routesRoot=new t.Group,this.dustRoot=new t.Group,n.add(this.root),this.root.add(this.starsRoot),this.root.add(this.routesRoot),this.root.add(this.dustRoot),this.factionMaterials={},this.starSystemMgr=a,a&&(a.galaxy=this),s.addEventListener("updateSelection",(function(t){return d.updateSelection()})),this.onWindowResize(r.innerWidth,r.innerHeight)}return i(n,e),Object.defineProperty(n.prototype,"starsConfig",{get:function(){return this.config.data.stars},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"routesConfig",{get:function(){return this.config.data.routes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"starfieldConfig",{get:function(){return this.config.data.starfield},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this._view},set:function(t){this._view=t,this.updateSelection()},enumerable:!0,configurable:!0}),n.prototype.findNearestStar=function(t,e){var n=null,i=1/0,r=this.stars;for(var o in r){var a=r[o],s=a.distanceFromCursor(t,e);i>s&&(i=s,n=a)}return n},n.prototype.showJumpPointMesh=function(t){this.jumpPointMesh&&(this.jumpPointMesh.visible=!1!==t)},n.prototype.showGrid=function(t){this.grid&&(this.grid.model.visible=t)},n.prototype.updateSelection=function(){for(var t in this.showRoutes=this.controlAPI.routeSelection.small||this.controlAPI.routeSelection.medium||this.controlAPI.routeSelection.large,this.routeSizeSelectionArray[h.TunnelSizeLabelEnum.small]=this.controlAPI.routeSelection.small,this.routeSizeSelectionArray[h.TunnelSizeLabelEnum.medium]=this.controlAPI.routeSelection.medium,this.routeSizeSelectionArray[h.TunnelSizeLabelEnum.large]=this.controlAPI.routeSelection.large,this.controlAPI.lrScannerSelection.lifeforms?(this.showLRScanner||this.controlAPI.dispatchSoundEvent("ShowLongRangeScanner"),this.showLRScanner=!0,this.currentLRScanner=u.HeatmapEnum.lifeforms):this.controlAPI.lrScannerSelection.economy?(this.showLRScanner||this.controlAPI.dispatchSoundEvent("ShowLongRangeScanner"),this.showLRScanner=!0,this.currentLRScanner=u.HeatmapEnum.economy):this.controlAPI.lrScannerSelection.crime?(this.showLRScanner||this.controlAPI.dispatchSoundEvent("ShowLongRangeScanner"),this.showLRScanner=!0,this.currentLRScanner=u.HeatmapEnum.crime):(this.showLRScanner&&this.controlAPI.dispatchSoundEvent("HideLongRangeScanner"),this.showLRScanner=!1),this.stars)this.stars[t].updateSelection();for(var e=0,n=this.routes;e<n.length;e++){n[e].updateSelection()}},n.prototype.preload=function(){var t=this;return Promise.all([this.starSystemMgr.baseLoadObject(this.resourcePath+"/models/Middle_Nebula.dae").then((function(e){return d.default.setDepthWriteFalse(e.model),t.nebula=e,t.scene.add(e.model),t.nebula})),this.starSystemMgr.baseLoadObject(this.resourcePath+"/models/DustGoTrhu.dae").then((function(e){return t.dustPrefab=e})),this.starSystemMgr.baseLoadObject(this.resourcePath+"/models/JumpGoTrhu.dae").then((function(e){return t.jumpPrefabs[0]=e})),this.getJSON("/bootup").then((function(e){return t.bootup=h.cleanBootupResponse(e)})).then((function(){return t.preloadAffiliations()})).then((function(){return t.init()}))]).catch(console.log.bind(console))},n.prototype.start=function(){this.started=!0,this.longRangeScanner=new v.default(this,this.config.subConfig("longRangeScanner"))},n.prototype.update=function(t,e){if(this.started){var n=this.stars;for(var i in r.default.minZ=1/0,r.default.maxZ=-1/0,n)n[i].update(this.camera,t,e);for(var o=0,a=this.routes;o<a.length;o++){a[o].update(this.camera,t,e)}this.starfield&&this.starfield.update(t,e),this.updateControllers(t,e),this.longRangeScanner&&this.longRangeScanner.update(this.camera,t,e)}},n.prototype.addToGUI=function(t){var e=this,n=t.addFolder("Galaxis View");n.add(this.root,"visible"),this.grid&&c.default.appendGUI(n,this.grid.model),this.longRangeScanner&&this.longRangeScanner.addToGUI(n),n.add(this.gui,"nebula").onChange((function(t){e.nebula&&(e.nebula.model.visible=t)}));var i=n.addFolder("Stars");i.add(this.starsConfig,"radiusFactor"),i.add(this.starsConfig,"maxRadius"),i.addColor(this.starsConfig,"colorD1"),i.addColor(this.starsConfig,"colorD2"),i.addColor(this.starsConfig,"colorL1"),i.addColor(this.starsConfig,"colorL2"),i.addColor(this.starsConfig,"colorC1"),i.addColor(this.starsConfig,"colorC2"),i.add(this.starsConfig,"useStarFading"),i.add(this.starsConfig,"fadeStart"),i.add(this.starsConfig,"pitchEffect",0,1),i.add(this.starsConfig,"pitchIntensity",0,1),i.add(this.starfieldConfig,"radius").onChange((function(){e.makeStarfield()})),i.add(this.starfieldConfig,"count",0,5e3).onChange((function(){e.makeStarfield()})),i.add(this.starfieldConfig,"sizeMin",.1,5).onChange((function(){e.makeStarfield()})),i.add(this.starfieldConfig,"sizeMax",.1,5).onChange((function(){e.makeStarfield()})),i.addColor(this.starfieldConfig,"color1").onChange((function(){e.makeStarfield()})),i.addColor(this.starfieldConfig,"color2").onChange((function(){e.makeStarfield()}));var r=n.addFolder("Routes"),o=function(t){var n=r.addFolder(h.TunnelSizeLabelEnum[t]),i=e.routesConfig[t];n.add(i,"width",0,1).onChange(e.updateRoutesParams),n.addColor(i,"color").onChange(e.updateRoutesParams),n.addColor(i,"colorBorder").onChange(e.updateRoutesParams),n.add(i,"size",0,1).onChange(e.updateRoutesParams),n.add(i,"density",0,1).onChange(e.updateRoutesParams),n.add(i,"speed",0,1).onChange(e.updateRoutesParams),n.add(i,"side",0,1).onChange(e.updateRoutesParams),n.add(i,"center",0,1).onChange(e.updateRoutesParams),n.add(i,"pitchEffect",0,1).onChange(e.updateRoutesParams),n.add(i,"pitchIntensity",0,1).onChange(e.updateRoutesParams),n.add(i,"highlightFactor",0,1).onChange(e.updateRoutesParams),n.add(i,"depthFactor",0,1).onChange(e.updateRoutesParams)};o(0),o(1),o(2),n.add(this.config,"save")},n.prototype.onWindowResize=function(t,e){var n=2*Math.tan(.5*this.camera.fov*Math.PI/180)/e;for(var i in this.pixelSizeOverZ.set(n,n,n),this.stars){this.stars[i].onWindowResize(t,e)}},n.prototype.preloadAffiliations=function(){var e=this;this.affiliationCodes.push("NONE"),this.affiliations.NONE={id:"-1",code:"NONE",name:"none",color:"#000000"},this.affiliationColors.NONE=new t.Color("#000000");for(var n=0,i=this.bootup.affiliations;n<i.length;n++){var r=i[n];this.affiliationCodes.push(r.code),this.affiliations[r.code]=r,this.affiliationColors[r.code]=new t.Color(r.color)}for(var o=0,a=this.bootup.species;o<a.length;o++){var s=a[o];this.speciesCodes.push(s.code),this.species[s.code]=s}return Promise.all(this.affiliationCodes.map((function(t){return e.loadAffiliationIcon(t)})))},n.prototype.loadAffiliationIcon=function(e){var n=this,i=function(i){i&&(i.minFilter=t.LinearFilter);var r=new t.SpriteMaterial({map:i,color:new t.Color("white")});return r.blending=t.AdditiveBlending,r.depthTest=!1,r.depthWrite=!1,n.factionMaterials[e]=r};return d.default.loadTexture(this.resourcePath+"/sourceimages/factions/"+e+".png").then(i).catch((function(t){return console.error(t.stack),i(null)}))},n.prototype.init=function(){var t=this;this.ready=!0,this.bootup.config=this.bootup.config||{},this.config=new p.default(this.bootup.config,"main",(function(){return t.saveConfig(t.bootup.config)})),p.default.fleshConfig(this.config.data,this.initConfig),this.routeOneWayMaterial=this.config.data.routes.map((function(t){return c.default.makeRouteMaterial(!1,window.devicePixelRatio,t)})),this.routeTwoWaysMaterial=this.config.data.routes.map((function(t){return c.default.makeRouteMaterial(!0,window.devicePixelRatio,t)}));for(var e=0,n=this.bootup.systems;e<n.length;e++){var i=n[e],a=new r.default(this,i);this.stars[a.code]=a,this.starsById[a.id]=a}for(var s=0,l=this.bootup.tunnels;s<l.length;s++){var u=l[s],h=(a=null,null);if(u.entry&&u.exit&&(a=this.starsById[u.entry.star_system_id],h=this.starsById[u.exit.star_system_id]),a&&h){var d=new o.default(this,a,h,u);this.routes.push(d),a.routes.push(d),h.routes.push(d),this.jumpPointOtherEnd[u.entry.code]=h,this.jumpPointOtherEnd[u.exit.code]=a,this.jumpPointRoute[u.entry.code]=this.jumpPointRoute[u.exit.code]=d}else console.warn("Tunnel invalid "+u.id)}this.makeStarfield()},n.prototype.showRouting=function(t){if(this.currentRoutingSegment=null,this.routingSegments=t,this.highlightedObject={},t){console.log("Route codes ..."),console.log(t);for(var e=0;e<t.length;e++){var n=t[e];this.highlightedObject[n.object_code]=n}this.highlightedRoutes={};for(var i=0;i<t.length;i++){n=t[i];var r=this.jumpPointRoute[n.object_code];r&&this.highlightedObject[r.tunnel.entry.code]&&this.highlightedObject[r.tunnel.exit.code]&&(this.highlightedRoutes[r.tunnel.id]=r)}}else this.highlightedRoutes=null;this.starSystemMgr.showRouting(t)},n.prototype.resetCurrentRoute=function(){this.currentRoutingSegment=null},n.prototype.routingPrevious=function(){if(this.routingSegments){for(var t=null,e=0,n=this.routingSegments;e<n.length;e++){var i=n[e];if(this.currentRoutingSegment===i)return void(this.currentRoutingSegment=t);t=i}null===this.currentRoutingSegment?this.currentRoutingSegment=t:this.currentRoutingSegment=null}else this.currentRoutingSegment=null},n.prototype.routingPreviousSystem=function(){if(null===this.currentRoutingSegment)this.routingPrevious();else for(var t=this.currentRoutingSegment.system_code;this.currentRoutingSegment&&this.currentRoutingSegment.system_code===t;)this.routingPrevious()},n.prototype.routingNext=function(){if(this.routingSegments){for(var t=null,e=0,n=this.routingSegments;e<n.length;e++){var i=n[e];if(this.currentRoutingSegment===t)return void(this.currentRoutingSegment=i);t=i}this.currentRoutingSegment=null}else this.currentRoutingSegment=null},n.prototype.routingNextSystem=function(){if(null===this.currentRoutingSegment)this.routingNext();else for(var t=this.currentRoutingSegment.system_code;this.currentRoutingSegment&&this.currentRoutingSegment.system_code===t;)this.routingNext()},n.prototype.routingFirstInSystem=function(t){if(this.routingSegments){for(var e=0,n=this.routingSegments;e<n.length;e++){var i=n[e];if(i.system_code===t)return void(this.currentRoutingSegment=i)}this.currentRoutingSegment=null}else this.currentRoutingSegment=null},n.prototype.routingLastInSystem=function(t){if(this.routingSegments){for(var e=null,n=0,i=this.routingSegments;n<i.length;n++){var r=i[n];r.system_code===t&&(e=r)}this.currentRoutingSegment=e}else this.currentRoutingSegment=null},Object.defineProperty(n.prototype,"currentRoutingCode",{get:function(){return this.currentRoutingSegment.object_code},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentRoutingSystemCode",{get:function(){return this.currentRoutingSegment.system_code},enumerable:!0,configurable:!0}),n.prototype.makeRandomRouting=function(t){for(var e=[],n=m.default.randomElem(this.routes),i=n.starA;t-- >0;){i===n.starA?(e.push(n.tunnel.entry.code),e.push(n.tunnel.exit.code),i=n.starB):(e.push(n.tunnel.exit.code),e.push(n.tunnel.entry.code),i=n.starA);for(var r=m.default.randomElem(i.routes);r===n&&i.routes.length>1;)r=m.default.randomElem(i.routes);n=r}return e},n.prototype.showRandomRoutingFound=function(){var t=this,e=m.default.randomElem(this.routes),n=m.default.randomElem(this.routes),i=Math.random()<.5?e.tunnel.entry.code:e.tunnel.exit.code,r=Math.random()<.5?n.tunnel.entry.code:n.tunnel.exit.code;return this.findRoutes(i,r,h.ShipSizeCode.S).then((function(e){var n=Math.random()<.5?e.leastjumps:e.shortest;t.showRouting(n&&n.segments?n.segments:null)}))},n.prototype.getJumpPointDestination=function(t){var e=this.jumpPointOtherEnd[t];return e?e.code:null},n.prototype.getJumpPointInfo=function(t){var e=this.jumpPointRoute[t];return e?e.tunnel:null},n.prototype.makeStarfield=function(){this.starfield&&this.starfield.dispose(),this.starfield=new f.default(this.root,this.camera,new t.Vector3(0,0,0),this.starfieldConfig.radius,this.starfieldConfig.count,this.starfieldConfig.sizeMin,this.starfieldConfig.sizeMax,this.starfieldConfig.color1,this.starfieldConfig.color2)},n.prototype.getJSON=function(t,e){return e?(new Date,window.fetch(this.starmapapi+t,{method:"POST",body:JSON.stringify(e),headers:this.getHeader(),cors:!0,mode:"cors"}).then((function(t){return t.json()})).catch((function(e){throw console.error(e),new Error("Failed to fetch '"+t+"'")}))):(new Date,window.fetch(this.starmapapi+t,{method:"POST",headers:this.getHeader(),cors:!0,mode:"cors"}).then((function(t){return t.json()})).catch((function(e){throw console.error(e),new Error("Failed to fetch '"+t+"'")})))},n.prototype.saveJSON=function(t,e){return window.fetch(this.starmapapi+t,{method:"POST",body:JSON.stringify(e),headers:this.getHeader(),cors:!0}).then((function(t){return t.json()})).catch((function(t){return console.error(t)}))},n.prototype.saveConfig=function(t){return this.saveJSON("/config/edit",{starmap_config:t})},n.prototype.saveSystemConfig=function(t,e){return this.saveJSON("/star-systems/"+t+"/saveShaderdata",{shader_data:e})},n.prototype.saveBodyConfig=function(t,e){return this.saveJSON("/celestial-objects/"+t+"/saveShaderdata",{shader_data:e})},n.prototype.findRoutes=function(t,e,n){return this.getJSON("/routes/find",{departure:t,destination:e,ship_size:h.ShipSizeCode[n]}).then((function(t){return h.cleanRoutesResponse(t)}))},n.prototype.getStar=function(t){return this.stars[t]},n.prototype.addDust=function(t){this.dustPrefab&&this.addController(new a.default(this,this.dustPrefab,t))},n.prototype.addJumpEffect=function(t){this.jumpPrefabs&&this.addController(new s.default(this,m.default.randomElem(this.jumpPrefabs),t))},n.prototype.addController=function(t){this.controllers[t.obj3d.uuid]=t},n.prototype.updateControllers=function(t,e){var n=null;for(var i in this.controllers){this.controllers[i].update(this.camera,t,e)||(n?n.push(i):n=[i])}if(n)for(var r=0;r<n.length;r++){i=n[r];delete this.controllers[i]}},n.prototype.getSystemPosition=function(e){var n=this.stars[e];return n?n.obj3d.getWorldPosition():new t.Vector3(0,0)},n.prototype.getPlanetaryPosition=function(e,n){var i,r=this.stars[e];return r&&r.starSystem&&(i=r.starSystem.bodiesByCode[n])?i.obj3d.getWorldPosition():new t.Vector3(0,0)},n.prototype.getSystemScreenCoord=function(e){var n=this.stars[e];return n?this.getScreenCoord(n.obj3d):new t.Vector2(0,0)},n.prototype.getPlanetaryScreenCoord=function(e,n){var i,r=this.stars[e];return r&&r.starSystem&&(i=r.starSystem.bodiesByCode[n])?this.getScreenCoord(i.obj3d):new t.Vector2(0,0)},n.prototype.getScreenCoord=function(e){var n=e.getWorldPosition().clone().project(this.camera);return new t.Vector2(.5*this.window.innerWidth*(n.x+1),.5*this.window.innerHeight*(1-n.y))},n.prototype.getScreenToCamCoord=function(e,n){var i=new t.Vector3,r=Math.tan(.5*this.camera.fov*Math.PI/180);return i.set(r*this.camera.aspect*(e/this.window.innerWidth*2-1),r*(-n/this.window.innerHeight*2+1),-1),i},n.prototype.setLightColor=function(t){this.controlAPI.env.setLightColor(t)},n.prototype.setSystemStickyHovering=function(t){this.highlightedStar=this.stars[t],this.highlightedStarSticky=!0},n.prototype.releaseSystemStickyHovering=function(){this.highlightedStarSticky=!1},n.prototype.setPlanetaryStickyHovering=function(t,e){var n=this.stars[t];n&&n.starSystem?n.starSystem.setPlanetaryStickyHovering(e):console.log("'"+t+"' is not a star with a star system instantiated")},n.prototype.releasePlanetaryStickyHovering=function(t){var e=this.stars[t];e&&e.starSystem?e.starSystem.releasePlanetaryStickyHovering():console.log("'"+t+"' is not a star with a star system instantiated")},n.prototype.forceSystemHighlight=function(t){var e=this.stars[t];e?e.forceHighlight=!0:console.log("'"+t+"' is not a star")},n.prototype.releaseSystemHighlight=function(t){var e=this.stars[t];e?e.forceHighlight=!1:console.log("'"+t+"' is not a star")},n.prototype.forcePlanetaryHovered=function(t,e){var n=this.stars[t];n&&n.starSystem?n.starSystem.forcePlanetaryHovered(e):console.log("'"+t+"' is not a star with a star system instantiated")},n.prototype.releasePlanetaryHovered=function(t,e){var n=this.stars[t];n&&n.starSystem?n.starSystem.releasePlanetaryHovered(e):console.log("'"+t+"' is not a star with a star system instantiated")},n.prototype.setLandingZoneHighlight=function(t,e,n,i){var r=this.stars[t];r&&r.starSystem?r.starSystem.setLandingZoneHighlight(e,n,i):console.log("'"+t+"' is not a star with a star system instantiated")},n.prototype.translateWorld=function(t){for(var e in this.worldOffset.add(t),this.stars)this.stars[e].translateWorld(t);for(var e in this.routes)this.routes[e].translateWorld(t);this.nebula&&this.nebula.model.position.add(t),this.starfield&&this.starfield.translateWorld(t),this.starSystemMgr.translateWorld(t),this.controlAPI.env.camctl.translateWorld(t)},n}(l.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=g}).call(e,n(2))},function(t,e,n){(function(t){var i=n(22),r=n(49),o=n(50),a=n(51),s=n(26),l=n(32),c=n(52),u=n(46),h=n(22),d=function(t,e,n){this.detail=null,this.lrScanners=[],this.lrScanners[h.HeatmapEnum.lifeforms]=.1*t,this.lrScanners[h.HeatmapEnum.economy]=.1*e,this.lrScanners[h.HeatmapEnum.crime]=.1*n};e.StarData=d;var f=function(){function e(e,n){this.galaxy=e,this.brief=n,this.z=1,this.quadrantValue=0,this.showQuadrant=!1,this.circleMaterialTargetColor=new t.Color(r.default.circleSelectedColor),this.circleMaterialColorChanging=!1,this.routes=[],this.forceHighlight=!1,this.highlightRatio=0,this.starSystem=null,this._lrsMinColors=[new t.Color(e.starsConfig.colorL1),new t.Color(e.starsConfig.colorD1),new t.Color(e.starsConfig.colorC1)],this._lrsMaxColors=[new t.Color(e.starsConfig.colorL2),new t.Color(e.starsConfig.colorD2),new t.Color(e.starsConfig.colorC2)],this.data=new d(n.aggregated_population,n.aggregated_economy,n.aggregated_danger),this.data.affiliationCode=n.affiliation&&n.affiliation[0]&&n.affiliation[0].code||"NONE",this.obj3d=new t.Group,this.obj3d.position.set(n.position_x/100,n.position_z/100,-n.position_y/100),e.starsRoot.add(this.obj3d),this.labelAnchor=new t.Group;var i=a.createLabelTexture(this.name.toLocaleUpperCase(),{color:r.default.labelColor,fontsize:13,quality:window.devicePixelRatio||1}),s=new t.SpriteMaterial({map:i,color:new t.Color("rgb(255,255,255)")});s.blending=t.AdditiveBlending,s.depthTest=!1,s.depthWrite=!1,this.label=new t.Sprite(s),this.label.scale.set(i.size.x,i.size.y,1),this.label.position.set(-.5*i.size.x,.5*i.size.y,0),this.labelAnchor.add(this.label);var c=a.createLabelTexture(o.default.System.toLocaleUpperCase(),{color:r.default.sublabelColor,fontsize:12,quality:window.devicePixelRatio||1}),u=new t.SpriteMaterial({map:c,color:new t.Color("rgb(255,255,255)")});u.blending=t.AdditiveBlending,u.depthTest=!1,u.depthWrite=!1,this.labelsys=new t.Sprite(u),this.labelsys.scale.set(c.size.x,c.size.y,1),this.labelsys.position.set(-.5*c.size.x,-.5*i.size.y,0),this.labelAnchor.add(this.labelsys),this.factionSprite=new t.Sprite(e.factionMaterials[this.data.affiliationCode].clone()),this.factionSprite.scale.multiplyScalar(19),this.circleMaterial=l.default.makeThinline2DMaterial({color:r.default.circleSelectedColor}),this.quadrantMaterial=l.default.makeVertexColoredThinline2DMaterial(),this.circleMesh=new t.Mesh(l.default.makeCircleGeometry(1,32,r.default.heatQuadrantMinColor,r.default.heatQuadrantMaxColor),this.circleMaterial),l.default.replaceColorGradient(this.circleMesh.geometry,r.default.heatQuadrantMinColor,r.default.heatQuadrantMaxColor,r.default.heatQuadrantNotColor,this.quadrantValue,r.default.circleHighlightColor,this.highlightRatio),this.topQuadrantMesh=new t.Mesh(l.default.makeLineGeometry([new t.Vector3(0,0,0),new t.Vector3(0,3,0)]),l.default.makeThinline2DMaterial({color:r.default.topQuadrantColor})),this.topQuadrantMesh.visible=!1,this.setCircleMeshRadius(15,0,0),this.obj3d.add(this.labelAnchor),this.obj3d.add(this.factionSprite),this.obj3d.add(this.circleMesh),this.obj3d.add(this.topQuadrantMesh),this.focusScore=0,this.selected=!0,this.targetSize=(new t.Vector3).copy(this.galaxy.pixelSizeOverZ),this.obj3d.scale.copy(this.targetSize),this._velocityScale=new t.Vector3(0,0,0)}return Object.defineProperty(e.prototype,"highlight",{get:function(){return this.forceHighlight||this.galaxy.highlightedStar===this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.brief.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this.brief.code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.brief.name},enumerable:!0,configurable:!0}),e.prototype.onWindowResize=function(t,e){this.circleMaterial&&this.circleMaterial.uniforms.resolution.value.set(t,e),this.quadrantMaterial&&this.quadrantMaterial.uniforms.resolution.value.set(t,e)},e.prototype.setCircleMeshRadius=function(t,e,n){this.circleMesh.scale.set(t,t,t),this.labelAnchor.position.set(-15-t-e,-n,0),this.topQuadrantMesh.position.set(0,t,0)},e.prototype.update=function(e,n,i){if(!isNaN(i)){var r=(new t.Vector3).setFromMatrixPosition(this.obj3d.matrixWorld),o=(new t.Vector3).copy(r);e.worldToLocal(o);var a=-o.z,l=this.galaxy.starsConfig.radiusFactor/a,c=this.galaxy.starsConfig.maxRadius;l>c&&(l=s.default.lerp(l,c,this.galaxy.presenceRatio)),this.targetSize.copy(this.galaxy.pixelSizeOverZ),this.targetSize.multiplyScalar(a);var u=this.targetSize;this.obj3d.scale.set(u.x,u.y,u.z),this.obj3d.rotation.copy(e.rotation);this.setCircleMeshRadius(l,0,0);var h=1-Math.abs(new t.Vector3(0,1,0).applyQuaternion(e.quaternion).y);this.updateColor(i,h),this.updateQuadrant(i)}return!0},e.prototype.updateColor=function(t,n){if(void 0===n&&(n=0),this.circleMaterialTargetColor.copy(this.showQuadrant||this.highlight?r.default.heatQuadrantNotColor:this.galaxy.showRoutes&&this.selected?r.default.circleSelectedRouteColor:r.default.circleSelectedColor),this.circleMaterialColorChanging=!c.default.sameColor(this.circleMaterialColor,this.circleMaterialTargetColor),this.circleMaterialColor.lerp(this.circleMaterialTargetColor,2*t),this.selected){this.label.material.color.set(e.white),this.labelsys.material.color.set(e.white),this.factionSprite.material.color.set(e.white),this.circleMaterial.uniforms.intensity.value=1,this.quadrantMaterial.uniforms.intensity.value=1;var i=this.galaxy.starsConfig.fadeStart,o=this.galaxy.starsConfig.useStarFading?Math.min(i/this.z,1):1;1>(o*=s.default.lerp(.25,1,this.galaxy.presenceRatio))&&(o=s.default.lerp(o,s.default.lerp(o,2*this.galaxy.starsConfig.pitchIntensity,n),this.galaxy.starsConfig.pitchEffect),o=s.default.lerp(o,1,this.highlightRatio),o=s.default.lerp(.25,o,this.galaxy.presenceRatio),this.label.material.color.multiplyScalar(o),this.labelsys.material.color.multiplyScalar(o),this.factionSprite.material.color.multiplyScalar(o),this.circleMaterial.uniforms.intensity.value*=o,this.quadrantMaterial.uniforms.intensity.value*=o)}},e.prototype.updateQuadrant=function(e){(this.showQuadrant||this.highlight)&&(this.circleMesh.material=this.quadrantMaterial,this.topQuadrantMesh.visible=!this.highlight);var n=this.showQuadrant?this.data.lrScanners[this.galaxy.currentLRScanner]:0,i=s.default.gotoValue(this.highlightRatio,this.highlight?1:0,4*e),o=!1;this.circleMesh.material===this.quadrantMaterial&&((n!==this.quadrantValue||this.circleMaterialColorChanging||i!=this.highlightRatio)&&(this.quadrantValue=s.default.gotoValue(this.quadrantValue,n,e),o=this.highlightRatio<.5&&i>=.5,this.highlightRatio=i,this.galaxy.currentLRScanner,l.default.replaceColorGradient(this.circleMesh.geometry,new t.Color(this._lrsMinColors[this.galaxy.currentLRScanner]),new t.Color(this._lrsMaxColors[this.galaxy.currentLRScanner]),this.circleMaterialColor,this.quadrantValue,r.default.circleHighlightColor,this.highlightRatio)),this.showQuadrant||0!==this.quadrantValue||0!==this.highlightRatio||(this.circleMesh.material=this.circleMaterial,this.topQuadrantMesh.visible=!1)),this.circleMesh.visible=!o},e.prototype.distanceFromCursor=function(e,n){var i=(new t.Vector3).setFromMatrixPosition(this.obj3d.matrixWorld),r=(new t.Vector3).copy(i).project(n),o=new t.Vector2(n.aspect*(r.x-e.x),r.y-e.y).length();return this.focusScore=1-s.default.clamp01(Math.pow(o,1.1)/.3),o},e.prototype.shellDistanceFromCursor=function(e,n){var i=(new t.Vector3).setFromMatrixPosition(this.obj3d.matrixWorld),r=(new t.Vector3).copy(i).project(n),o=(new t.Vector3).copy(i).add(new t.Vector3(0,this.circleMesh.getWorldScale().x,0).applyQuaternion(n.quaternion)).project(n),a=Math.abs(o.y-r.y),s=new t.Vector2(n.aspect*(r.x-e.x),r.y-e.y);return Math.max(s.length()-a,0)},e.prototype.updateSelection=function(){this.galaxy.showRoutes,this.selected=this.galaxy.controlAPI.factionSelection[this.data.affiliationCode];var t=this.galaxy.view!==i.ViewEnum.galaxy&&this===this.galaxy.systemCurrentlyViewed,n=this.galaxy.showLRScanner;this.obj3d.visible=!t,this.selected?(this.label.material.color.set(e.white),this.labelsys.material.color.set(e.white),this.factionSprite.material.color.set(e.white),this.circleMaterial.uniforms.intensity.value=1):(this.label.material.color.set(r.default.labelNotSelectedModColor),this.labelsys.material.color.set(r.default.sublabelNotSelectedModColor),this.factionSprite.material.color.set(r.default.factionSpriteNotSelectedModCcolor),this.circleMaterial.uniforms.intensity.value=.4,this.galaxy.view!==i.ViewEnum.galaxy&&(this.label.material.color.multiplyScalar(.75),this.labelsys.material.color.multiplyScalar(.75),this.factionSprite.material.color.multiplyScalar(.75),this.circleMaterial.uniforms.intensity.value*=.75)),n&&this.selected?this.showQuadrant=!0:this.showQuadrant=!1,this.updateColor(0,1)},Object.defineProperty(e.prototype,"circleMaterialColor",{get:function(){return this.circleMaterial.uniforms.color.value},enumerable:!0,configurable:!0}),e.prototype.initStarSystem=function(){this.starSystem||(this.starSystem=this.galaxy.starSystemMgr.makeStarSystem(this))},e.prototype.destroyStarSystem=function(t){void 0===t&&(t=.1),this.starSystem&&(this.starSystem.setToDestroy(t),this.starSystem=null)},e.prototype.loadDetail=function(){var t=this;return this.data.detail?new Promise((function(e,n){return e(t.data.detail)})):this.galaxy.getJSON("/star-systems/"+this.code).then((function(e){return t.data.detail=u.cleanSystemDetailResponse(e)}))},Object.defineProperty(e.prototype,"config",{get:function(){return this.data.detail?this.data.detail.shader_data=this.data.detail.shader_data||{}:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightColorStr",{get:function(){return this.config.lightColor=this.config.lightColor||"#ffffff"},enumerable:!0,configurable:!0}),e.prototype.translateWorld=function(t){this.obj3d.position.add(t)},e._initSmoothTime=.3,e.white=new t.Color("#ffffff"),e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=f}).call(e,n(2))},function(t,e,n){(function(t){var n=function(){function e(){}return e.heatQuadrantMinColor=new t.Color("rgb(247,136,44)"),e.heatQuadrantMaxColor=new t.Color("rgb(210,59,7)"),e.heatQuadrantNotColor=new t.Color("rgb(13,30,42)"),e.labelColor="rgb(87,220,229)",e.sublabelColor="rgb(26,86,124)",e.labelNotSelectedModColor="#404040",e.sublabelNotSelectedModColor="#606060",e.factionSpriteNotSelectedModCcolor="#606060",e.hexagoneSpaceStationColor=new t.Color("rgb(16,103,23)"),e.labelPoiColor=new t.Color("rgb(237,7,54)"),e.trianglePoiColor=new t.Color("rgb(153,20,1)"),e.circleSelectedColor=new t.Color("rgb(26,86,124)"),e.circleSelectedRouteColor=new t.Color("rgb(220,88,33)"),e.circleHighlightColor=new t.Color("rgb(75,133,151)"),e.topQuadrantColor="rgb(245,221,135)",e.habitableZoneColor="rgb(1,44,33)",e.frostZoneColor="rgb(6,21,26)",e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}).call(e,n(2))},function(t,e){var n=function(){function t(){}return t.System="System",t.STAR="Star",t.PLANET="Planet",t.ASTEROID_BELT="Asteroid Belt",t.JUMPPOINT="Jump Point",t.BLACKHOLE="Black Hole",t.ASTEROID_FIELD="Asteroid Field",t.MANMADE="Space Station",t.JumpPoints="Jump Point",t.DEPARTURE="DEPARTURE",t.DESTINATION="DESTINATION",t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){(function(t){e.createLabelTexture=function(e,n){void 0===n&&(n={});var i=n.hasOwnProperty("fontface")?n.fontface:"Electrolize",r=n.hasOwnProperty("fontsize")?n.fontsize:12,o=n.hasOwnProperty("color")?n.color:"#3c5e66",a=(n.hasOwnProperty("opacity")&&n.opacity,n.hasOwnProperty("quality")?n.quality:4),s=document.createElement("canvas"),l=s.getContext("2d");l.font=r*a+"px "+i;var c=l.measureText(e);s.width=c.width+4,s.height=r*a+4,l.font=r*a+"px "+i,l.textAlign="center",l.textBaseline="middle";var u=new t.Color(o);l.fillStyle="rgba("+255*u.r+","+255*u.g+","+255*u.b+",0.01)",l.fillRect(0,0,s.width,s.height),l.fillStyle=o,l.fillText(e,s.width/2,s.height/2);var h=new t.Texture(s);return h.needsUpdate=!0,h.size=new t.Vector2(s.width/a,s.height/a),h.minFilter=t.LinearFilter,h}}).call(e,n(2))},function(t,e,n){(function(t){var n=function(){function e(){}return e.makeQuad=function(e){void 0===e&&(e=1);var n=new Float32Array(12),i=new Float32Array(8),r=new Uint16Array(6),o=new t.BufferGeometry;return o.addAttribute("position",new t.BufferAttribute(n,3)),o.addAttribute("uv",new t.BufferAttribute(i,2)),o.addAttribute("index",new t.BufferAttribute(r,3)),n[0]=-e,n[1]=-e,n[2]=0,n[3]=e,n[4]=-e,n[5]=0,n[6]=-e,n[7]=e,n[8]=0,n[9]=e,n[10]=e,n[11]=0,i[0]=0,i[1]=0,i[2]=1,i[3]=0,i[4]=0,i[5]=1,i[6]=1,i[7]=1,r[0]=0,r[1]=1,r[2]=2,r[3]=3,r[4]=2,r[5]=1,o},e.getRandomSaturatedColor=function(){var e=Math.random(),n=Math.random(),i=Math.random(),r=Math.min(e,n,i),o=Math.max(e,n,i);if(o>r){var a=1/(o-r);return new t.Color((e-r)*a,(n-r)*a,(i-r)*a)}return new t.Color(1,1,1)},e.sameColor=function(t,e){var n=t.r-e.r,i=t.g-e.g,r=t.b-e.b;return 1e-6>n*n+i*i+r*r},e.loadTexture=function(e,n){return t.ImageUtils.crossOrigin="",(new Date).getTime(),new Promise((function(i,r){return t.ImageUtils.loadTexture(e,n,(function(t){i(t)}),(function(t){console.log(t),r(t)}))}))},e.setDepthWriteFalse=function(e){e.traverse((function(e){e instanceof t.Mesh&&e.material&&(e.material.depthWrite=!1)}))},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}).call(e,n(2))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(54),o=n(22),a=n(26),s=function(t){function e(e,n,i,r){t.call(this,e,n.obj3d.position,i.obj3d.position,r),this.starA=n,this.starB=i,this.obj3d.visible=!1}return i(e,t),e.prototype.updateSelection=function(){this.showRoute=this.galaxy.view===o.ViewEnum.galaxy&&this.galaxy.showRoutes&&this.galaxy.routeSizeSelectionArray[this.tunnel.size]&&this.galaxy.controlAPI.factionSelection[this.starA.data.affiliationCode]&&this.galaxy.controlAPI.factionSelection[this.starB.data.affiliationCode]},e.prototype.update=function(e,n,i){this.presence=a.default.goto02Value(this.presence,this.showRoute,2*i);var r=this.galaxy.highlightedRoutes?void 0!==this.galaxy.highlightedRoutes[this.tunnel.id]:this.starA.highlight||this.starB.highlight;this.highlightRatio=a.default.gotoValue(this.highlightRatio,r?1:0,2*i),t.prototype.update.call(this,e,n,i)},e.prototype.translateWorld=function(t){this.obj3d.position.add(t)},e}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){(function(t){var i=n(32),r=n(46),o=function(){function e(n,o,a,s){var l=this;this.galaxy=n,this.pointA=o,this.pointB=a,this.tunnel=s,this.presence=0,this.highlightRatio=0;var c=o.clone().add(a).multiplyScalar(.5),u=o.clone().sub(c),h=a.clone().sub(c),d=this.makeRandomControlPoint(u,h),f=this.makeRandomControlPoint(h,u),p=new t.CubicBezierCurve3(u,d,f,h),m=u.distanceTo(h),v=u.distanceTo(h);v<e.mind&&(e.mind=v),this.material=(s.direction===r.TunnelDirectionLabelEnum.bidirectional?this.galaxy.routeTwoWaysMaterial[s.size]:this.galaxy.routeOneWayMaterial[s.size]).clone(),this.width=this.material.uniforms.width.value,this.obj3d=new t.Mesh(i.default.makeCurveGeometry(p,Math.ceil(150*m),1,(function(t){return l.relThickness(t)})),this.material),this.obj3d.position.copy(c),n.routesRoot.add(this.obj3d)}return e.prototype.makeRandomControlPoint=function(e,n){var i=n.clone().sub(e),r=i.length(),o=new t.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5).projectOnPlane(i).normalize();return i.multiplyScalar(.3).add(o.multiplyScalar(.3*Math.random()*r)).add(e)},e.prototype.relThickness=function(t){return.25+3*t*(1-t)},e.prototype.dispose=function(){this.obj3d.geometry.dispose(),this.material.dispose(),this.galaxy.routesRoot.remove(this.obj3d)},e.prototype.update=function(e,n,i){var r=this.pointA.clone().project(e),o=new t.Vector2(r.x*e.aspect,r.y),a=this.pointB.clone().project(e),s=new t.Vector2(a.x*e.aspect,a.y),l=.5*o.distanceTo(s)*this.galaxy.window.innerHeight*this.galaxy.window.devicePixelRatio;this.material.uniforms.time.value=n,this.material.uniforms.intensity.value=this.galaxy.presenceRatio,this.material.uniforms.presence.value=this.presence,this.material.uniforms.highlight.value=this.highlightRatio,this.material.uniforms.length.value=l,this.presence<=0?this.obj3d.visible=!1:this.obj3d.visible=!0},e.prototype.updateRouteParams=function(){var t=this.galaxy.routesConfig[this.tunnel.size],e=this.material.uniforms;this.width=e.width.value=t.width,e.color.value.set(t.color),e.colorBorder.value.set(t.colorBorder),e.size.value=t.size,e.density.value=t.density,e.speed.value=t.speed,e.side.value=t.side,e.center.value=t.center,e.pitchEffect.value=t.pitchEffect,e.pitchIntensity.value=t.pitchIntensity,e.highlightFactor.value=t.highlightFactor,e.depthFactor.value=t.depthFactor},e.mind=1/0,e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o}).call(e,n(2))},function(t,e,n){var i=n(56),r=function(){function t(t,e,n,r){var o=this;void 0===r&&(r=!0),this.galaxy=t,this._timer=new i.default,this._alive=!0,this.obj=e.clone(),this.obj3d=this.obj.model,t.camera.add(this.obj3d),this._timer.addPeriod(.5,1,(function(e){var i=n.clone().applyMatrix4(t.camera.matrixWorldInverse);o.obj3d.scale.set(1,1,1).multiplyScalar(1.5*e),o.obj3d.position.copy(i).multiplyScalar(10*(1-e)),r&&o.obj3d.rotation.set(0,0,-2*e*Math.PI)})),this._timer.add(3,(function(){t.camera.remove(o.obj3d),o.obj.dispose(),o._alive=!1}))}return t.prototype.update=function(t,e,n){return this._timer.update(e,n),this._alive},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){var i=n(26),r=function(t,e){this.delay=t,this.func=e},o=function(t,e,n,i){this.delay=t,this.duration=e,this.func=n,this.done=i},a=function(){function t(){this._index=0,this._timers={},this._periods={}}return t.prototype.add=function(t,e){this._timers[this._index++]=new r(t,e)},t.prototype.addPeriod=function(t,e,n,i){this._periods[this._index++]=new o(t,e,n,i),0===t&&n(0)},t.prototype.clear=function(){this._timers={},this._periods={}},t.prototype.update=function(t,e){var n=null;for(var r in this._timers){var o=this._timers[r];o.delay-=e,o.delay<0&&(o.func(),n?n.push(r):n=[r])}for(var r in this._periods){var a=this._periods[r];a.delay-=e,a.delay<0&&(a.func(i.default.clamp01(-a.delay/a.duration)),a.delay<-a.duration&&(a.done&&a.done(),n?n.push(r):n=[r]))}if(n)for(var s=0;s<n.length;s++){r=n[s];this._timers[r]?delete this._timers[r]:this._periods[r]&&delete this._periods[r]}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){var i=n(56),r=n(26),o=function(){function t(t,e,n){var o=this;this.galaxy=t,this._timer=new i.default,this._alive=!0,this.obj=e.clone(),this.obj3d=this.obj.model,t.camera.add(this.obj3d);var a=n.clone().applyMatrix4(this.galaxy.camera.matrixWorldInverse),s=r.default.lerp(-0,0,Math.random()),l=r.default.lerp(-0,0,Math.random()),c=Math.random()>.5?1:-1,u=r.default.lerp(2,6,Math.random()),h=Math.atan2(a.y,a.x);this.obj3d.rotateZ(h),this._timer.addPeriod(0,2,(function(t){var e=Math.min(1,4*t);o.obj3d.position.set(e*s*Math.sin(u*t*Math.PI*c),e*l*Math.cos(u*t*Math.PI*c),-4)})),this._timer.add(2,(function(){t.camera.remove(o.obj3d),o.obj.dispose(),o._alive=!1}))}return t.prototype.update=function(t,e,n){return 0===this._animeStart&&(this._animeStart=e),this._timer.update(e,n),this.obj.update(t,e-this._animeStart,n),this._alive},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){(function(t){var i=n(32),r=function(){function e(e,r,o,a,s,l,c,u,h){this.root=e,this.presenceRatio=1,this.skip=0,this.makeStarfieldMaterial=function(e){e=e||{};var i=new t.ShaderMaterial({uniforms:{color1:{type:"c",value:e.color1?new t.Color(e.color1):new t.Color(1,1,1)},color2:{type:"c",value:e.color2?new t.Color(e.color2):new t.Color(1,1,1)},sizeMin:{type:"f",value:e.sizeMin||1},sizeMax:{type:"f",value:e.sizeMax||2},intensity:{type:"f",value:e.intensity||1},time:{type:"f",value:e.time||0},deltaTime:{type:"f",value:e.deltaTime||.01},resolution:{type:"v2",value:new t.Vector2(window.innerWidth,window.innerHeight)},fadeBack:{type:"f",value:e.fadeBack||0},radiusAndInvRadius:{type:"v2",value:e.radiusAndInvRadius||new t.Vector2(4,.25)},fade:{type:"v2",value:new t.Vector2(e.fadeMin||1,e.fadeMax||1)},depth:{type:"v2",value:new t.Vector2(e.depthMin||0,e.depthMax||1)},previousModelViewMatrix:{type:"m4",value:this.getModelViewMatrix()}},vertexShader:n(59),fragmentShader:n(60)});return i.transparent=!0,i.side=t.DoubleSide,i.blending=t.AdditiveBlending,i.depthTest=!1,this.material=i,i},this.camera=r;for(var d=[],f=0;s>f;f++){var p=new t.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5);p.normalize();var m=Math.random();p.multiplyScalar(a*(1-m*m*m)),d.push(p.clone()),d.push(p.clone())}this.mesh=i.default.makeLineMesh(d,{color:new t.Color(1,1,1),intensity:.05,fadeBack:1}),this.mesh.name="Starfield",this.mesh.material=this.makeStarfieldMaterial({color1:u,color2:h,sizeMin:l,sizeMax:c}),this.mesh.visible=!0,this.previousModelViewMatrix=this.getModelViewMatrix(),this.mesh.position.set(o.x,o.y,o.z),e.add(this.mesh)}return e.prototype.addToGUI=function(t){i.default.appendGUI(t,this.mesh)},e.prototype.update=function(t,e){this.material.uniforms.previousModelViewMatrix.value.copy(this.previousModelViewMatrix),this.material.uniforms.time.value=t,this.material.uniforms.deltaTime.value=e,this.material.uniforms.intensity.value=this.presenceRatio,this.previousModelViewMatrix=this.getModelViewMatrix(),this.skip--},e.prototype.getModelViewMatrix=function(){return(new t.Matrix4).multiplyMatrices(this.camera.matrixWorldInverse,this.mesh.matrixWorld)},e.prototype.dispose=function(){this.mesh.geometry.dispose(),this.material.dispose(),this.root.remove(this.mesh)},e.prototype.translateWorld=function(t){this.skip=1,this.mesh.updateMatrixWorld(!0)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e){t.exports="uniform vec2 resolution;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float sizeMin;\nuniform float sizeMax;\nuniform float intensity;\n\nuniform mat4 previousModelViewMatrix;\nuniform float time;\nuniform float deltaTime;\n\n//\n////varying vec2 texcoord;\nvarying vec3 texcoord;\nvarying vec4 vcolor;\n\n\nfloat rand(vec2 co){\t\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main() {\n\tfloat size = mix(sizeMin,sizeMax, rand(position.xy));\n\tvec3 color = mix(color1, color2, rand(position.xz));\n\tfloat d = 6.0 * (uv.y - 0.5);\n\tvec3 normal2 = normalize((modelViewMatrix * vec4( position, 1.0 ) - previousModelViewMatrix * vec4( position, 1.0 )).xyz);\n\tmat4 mvm = uv.x <0.5 ? previousModelViewMatrix : modelViewMatrix;\n\tvec4 wpos = mvm * vec4( position, 1.0 );\n\tvec4 wposN = mvm * vec4( position + normal2, 1.0 );\n\tvec4 vp = projectionMatrix * wpos;\n\tvec4 vpn = projectionMatrix * wposN;\n\tfloat nx = vpn.x*vp.w - vpn.w*vp.x;\n\tfloat ny = vpn.y*vp.w - vpn.w*vp.y;\n\tvec3 t = normalize(vec3(nx, ny, 0));\n\tgl_Position = vp + vec4(\n\t\tsize*1.0*d*vp.w*vec2(t.y/resolution.x, -t.x/resolution.y)\n\t\t+ size*3.0*( uv.x >0.5 ? 1.0:-1.0)*vp.w*vec2(t.x/resolution.x, t.y/resolution.y)\n\t\t, 0, 0);\n\n\t//gl_Position = vp + 20.*vec4(uv.x >0.5 ? 5.0/resolution.x : 0.,\n\t\t\t\t\t\t//uv.y <0.5 ? 5.0/resolution.y : 0.,  0.,0.);\n\ttexcoord = vec3(uv.x*vp.w, uv.y*vp.w, vp.w);\n\n\tvcolor = vec4(color,intensity);\n\n}"},function(t,e){t.exports="//varying vec2 texcoord;\nvarying vec4 vcolor;\nvarying vec3 texcoord;\nuniform vec2 fade;\nuniform vec2 depth;\n\nfloat lerp(float a, float b, float t) { return (1.0-t)*a + t*b; }\n\nfloat clamp01(float a) { return a < 0.0? 0.0 : a < 1.0? a : 1.0; }\n\nvoid main() {\n\tfloat UVx = 2.0*(texcoord.x/texcoord.z-0.5);\n\tfloat UVy = 2.0*(texcoord.y/texcoord.z-0.5);\n\tfloat d = 1.0-length(vec2(UVx,UVy));\n\tgl_FragColor = vec4(vcolor.rgb, d * vcolor.a);\n}"},function(t,e){var n=function(){function t(e,n,i){var r=this;this.data=e,this.type=n,this.saveFunc=i,this.save=function(){r.saveFunc&&r.saveFunc()},this.copy=function(){t.clipboard[r.type]=JSON.stringify(r.data)},this.paste=function(){if(t.clipboard[r.type]){var e=JSON.parse(t.clipboard[r.type]);for(var n in r.data)delete r.data[n];for(var n in e)r.data[n]=e[n]}},e||(e={})}return t.prototype.subConfig=function(e,n){return this.data[e]||(this.data[e]={}),new t(this.data[e],n||e,this.saveFunc)},t.fleshConfig=function(e,n){for(var i in n){var r=e[i],o=n[i];if(null==r)e[i]=o;else if("object"==typeof o)if("object"!=typeof r)e[i]=o;else if(o instanceof Array)if(r instanceof Array)for(var a=0;a<o.length;a++)void 0===r[a]?r[a]=o[a]:t.fleshConfig(r[a],o[a]);else e[i]=o;else t.fleshConfig(r,o)}},t.clipboard={},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){(function(t){var i=n(56),r=n(63),o=n(26),a=function(){function e(e,n){this.galaxy=e,this._canvasPosition=new t.Vector2(500,500),this._canvasSize=new t.Vector2(260,260),this._pixelRatio=1,this._timer=new i.default,this._testTimer=new i.default,this._alive=!0,this._showing=!1,this._targetEconomyRatio=0,this._targetLifeRatio=0,this._targetCrimeRatio=0,this._galaxy=e,this.obj=new r.default("LongRangeScanner","longRangeScanner",n),this.obj3d=this.obj.model,e.camera.add(this.obj3d),this.obj3d.position.set(.5,0,-1),this._pixelRatio=.5*Math.abs(this._galaxy.getScreenToCamCoord(0,0).x-this._galaxy.getScreenToCamCoord(1,0).x)/this.obj.radius,this.setCanvasSize(260,260),this.obj.material.uniforms.alpha.value=0,this.Reset()}return e.prototype.Reset=function(){this.obj.material.uniforms.ratioD.value=0,this.obj.material.uniforms.ratioL.value=0,this.obj.material.uniforms.ratioC.value=0,this.setData(0,0,0)},e.prototype.setData=function(t,e,n,i){void 0===i&&(i=1),this._targetEconomyRatio=o.default.clamp01(t),this._targetLifeRatio=o.default.clamp01(e),this._targetCrimeRatio=o.default.clamp01(n),this._showing&&this.show(!0,i)},e.prototype.show=function(t,e){var n=this;void 0===e&&(e=1),this._showing=t;var i=this.obj.material.uniforms.alpha.value,r=this.obj.material.uniforms.ratioD.value,a=this.obj.material.uniforms.ratioL.value,s=this.obj.material.uniforms.ratioC.value;this._timer.clear(),this._showing?(this._timer.addPeriod(0,.5*e,(function(t){var e=o.default.smoothstep(t);n.obj.material.uniforms.alpha.value=o.default.lerp(i,1,e)})),this._timer.addPeriod(.25*e,1*e,(function(t){var e=o.default.smoothstep(t);n.obj.material.uniforms.ratioD.value=o.default.lerp(r,n._targetEconomyRatio,e),n.obj.material.uniforms.ratioL.value=o.default.lerp(a,n._targetLifeRatio,e),n.obj.material.uniforms.ratioC.value=o.default.lerp(s,n._targetCrimeRatio,e)}))):(this._timer.addPeriod(.5*e,.5*e,(function(t){var e=o.default.smoothstep(t);n.obj.material.uniforms.alpha.value=o.default.lerp(i,0,e)})),this._timer.addPeriod(0,.75*e,(function(t){var e=o.default.smoothstep(t);n.obj.material.uniforms.ratioD.value=o.default.lerp(r,0,e),n.obj.material.uniforms.ratioL.value=o.default.lerp(a,0,e),n.obj.material.uniforms.ratioC.value=o.default.lerp(s,0,e)})))},e.prototype.update=function(t,e,n){return this._timer.update(e,n),this._testTimer.update(e,n),this.obj.material.uniforms.time.value=e,this.obj3d.position.copy(this._galaxy.getScreenToCamCoord(this._canvasPosition.x,this._canvasPosition.y)),this._pixelRatio=.5*Math.abs(this._galaxy.getScreenToCamCoord(0,0).x-this._galaxy.getScreenToCamCoord(1,0).x)/this.obj.radius,this.obj.model.scale.set(this._canvasSize.x*this._pixelRatio,this._canvasSize.y*this._pixelRatio,1),this._alive},e.prototype.addToGUI=function(t,e){this.obj.addToGUI(t,e)},e.prototype.setCanvasPosition=function(e,n){this._canvasPosition=new t.Vector2(e,n)},e.prototype.setCanvasSize=function(e,n){this._canvasSize=new t.Vector2(e,n)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a}).call(e,n(2))},function(t,e,n){(function(t){var i=n(52),r=n(64),o=n(26),a=function(){function e(n,o,a,s,l,c){var u=this;void 0===l&&(l=100),void 0===c&&(c=100),this.name=n,this.type=o,this.config=a,this.poi=s,this.width=l,this.height=c,this.frametime=0,this.updateMaterial=function(){var t=u.fragmentShader,n=u.material.uniforms;if(t.colors)for(var i=0;i<t.colors.length;i++)n[t.colorsLabel[i]].value.set(u.config.data[t.colorsLabel[i]]);if(t.params)for(i=0;i<t.params.length;i++)n[t.paramsLabel[i]].value=u.config.data[t.paramsLabel[i]];if(void 0!==t.iterations&&(n.iterations.value=u.config.data.iterations),t.maps)for(i=0;i<t.maps.length;i++)n[t.mapsLabel[i]].value=e.textures[t.mapsChoices[u.config.data[t.mapsLabel[i]]]]},this.fleshConfig();var h=this.fragmentShader,d={time:{type:"f",value:0},frametime:{type:"f",value:0},resolution:{type:"v2",value:new t.Vector2(l,c)},speed:{type:"f",value:h.speed||1},poi:{type:"v2",value:new t.Vector2},poi3D:{type:"v3",value:new t.Vector3},camPos:{type:"v3",value:new t.Vector3},camZ:{type:"v3",value:new t.Vector3},wpoi3D:{type:"v3",value:new t.Vector3},wcenter:{type:"v3",value:new t.Vector3},start:{type:"f",value:r.time+(h.delay||0)},end:{type:"f",value:r.time+(h.delay||0)+(h.duration||0)},iterations:{type:"i",value:void 0===h.iterations?1:this.config.data.iterations}};if(h.maps)for(var f=0;f<h.maps.length;f++)d[h.mapsLabel[f]]={type:"t",value:e.textures[h.mapsChoices[this.config.data[h.mapsLabel[f]]]]};if(h.colors)for(f=0;f<h.colors.length;f++)d[h.colorsLabel[f]]={type:"c",value:new t.Color(this.config.data[h.colorsLabel[f]])};if(h.params)for(f=0;f<h.params.length;f++)d[h.paramsLabel[f]]={type:"f",value:this.config.data[h.paramsLabel[f]]};this.geometry=new t.Geometry,this.geometry.vertices.push(new t.Vector3(0,0,0)),this.material=new t.ShaderMaterial({uniforms:d,vertexShader:h.usePoi3D?e.vertexShaderPoi3D:e.vertexShader,fragmentShader:h.code,blending:h.additiveBlending?t.AdditiveBlending:t.NormalBlending,depthWrite:!1,depthTest:!!h.depthTest,transparent:!0}),this.material.side=t.DoubleSide,this.radius=h.radius,this.model=new t.Mesh(i.default.makeQuad(h.radius),this.material),this.model.name=n,this.fragmentShader.orientation&&this.model.quaternion.copy(this.fragmentShader.orientation)}return Object.defineProperty(e.prototype,"fragmentShader",{get:function(){return e.fragmentShadersLib[this.type]},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.name,this.type,this.config,this.poi,this.width,this.height)},e.prototype.resize=function(t,e){this.width=t,this.height=e,this.material.uniforms.resolution.value.set(t,e)},e.prototype.update=function(e,n,i){if(this.poi){var r=(new t.Vector3).setFromMatrixPosition(this.poi.matrixWorld),a=this.model.getWorldPosition(),s=r.clone().applyMatrix4(e.matrixWorldInverse),l=a.clone().applyMatrix4(e.matrixWorldInverse),c=r.clone().project(e);this.material.uniforms.poi.value.set(.5+.5*c.x,.5+.5*c.y),this.material.uniforms.poi3D.value.copy(r),this.material.uniforms.camPos.value.copy(e.position),this.material.uniforms.wcenter.value.copy(l),this.material.uniforms.wpoi3D.value.copy(s)}if(this.material.uniforms.camZ.value.copy(new t.Vector3(0,0,1).applyQuaternion(e.quaternion)),this.frametime=this.frametime+.01666666,this.material.uniforms.time.value=n,this.material.uniforms.frametime.value=this.frametime,this.fragmentShader.orientation||this.model.rotation.copy(e.rotation),void 0!==this.fragmentShader.scaleMin){var u=o.default.lerp(this.config.data.scaleMin,this.config.data.scaleMax,.5*(Math.sin(2*n*Math.PI/this.config.data.scalePeriod)+1));this.model.scale.set(u,u,u)}},e.prototype.fleshConfig=function(){var t=this.fragmentShader;if(t.colors||t.params||void 0!==t.iterations||void 0!==t.scaleMin){if(t.colors)for(var e=0;e<t.colors.length;e++)this.config.data[t.colorsLabel[e]]=this.config.data[t.colorsLabel[e]]||t.colors[e];if(t.params)for(e=0;e<t.params.length;e++)void 0===this.config.data[t.paramsLabel[e]]&&(this.config.data[t.paramsLabel[e]]=t.params[e]);if(t.maps)for(e=0;e<t.maps.length;e++)void 0===this.config.data[t.mapsLabel[e]]&&(this.config.data[t.mapsLabel[e]]=t.maps[e]);void 0!==t.iterations&&void 0===this.config.data.iterations&&(this.config.data.iterations=t.iterations),void 0!==t.scaleMin&&(void 0===this.config.data.scaleMin&&(this.config.data.scaleMin=t.scaleMin),void 0===this.config.data.scaleMax&&(this.config.data.scaleMax=t.scaleMax),void 0===this.config.data.scalePeriod&&(this.config.data.scalePeriod=t.scalePeriod))}},e.prototype.addToGUI=function(t,e){var n=this,i=this.fragmentShader;if(i.colors||i.params||void 0!==i.iterations||void 0!==i.scaleMin||void 0!==i.maps){var r=t.addFolder(this.type),o=function(){n.updateMaterial()};if(i.maps){for(var a=[],s=0;s<i.mapsChoices.length;s++)a.push(s);for(s=0;s<i.maps.length;s++)r.add(this.config.data,i.mapsLabel[s],a).onChange(o)}if(void 0!==i.scaleMin&&(r.add(this.config.data,"scaleMin",0,5).onChange(o),r.add(this.config.data,"scaleMax",0,5).onChange(o),r.add(this.config.data,"scalePeriod",.1,60).onChange(o)),i.colors)for(s=0;s<i.colors.length;s++)r.addColor(this.config.data,i.colorsLabel[s]).onChange(o);if(i.params)for(s=0;s<i.params.length;s++)r.add(this.config.data,i.paramsLabel[s],0,1).onChange(o);void 0!==i.iterations&&r.add(this.config.data,"iterations",0,10).onChange(o),r.add(this.config,"copy"),r.add({paste:function(){n.config.paste(),n.fleshConfig(),o(),e()}},"paste")}},e.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},e.loadTextures=function(n){var r={};for(var o in e.fragmentShadersLib){var a=e.fragmentShadersLib[o];if(a.mapsChoices)for(var s=0,l=a.mapsChoices;s<l.length;s++){r[u=l[s]]=!0}}var c=[];for(var u in r)!function(r){c.push(i.default.loadTexture(n+"/sourceimages/"+r).then((function(n){return n.wrapS=n.wrapT=t.RepeatWrapping,e.textures[r]=n,n})))}(u);return Promise.all(c)},e.textures={},e.vertexShader="\n\t\t\t\tvarying vec2 texcoord;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\tgl_Position = projectionMatrix * wpos;\n\t\t\t\t\ttexcoord = uv;\n\t\t\t\t}",e.vertexShaderPoi3D="\n\t\t\t\tuniform vec3 camPos;\n\t\t\t\tuniform vec3 poi3D;\n\t\t\t\tvarying vec2 texcoord;\n\t\t\t\tvarying vec4 wpos;\n\t\t\t\t\n\t\t\t\tvoid main() {\n\t\t\t\t\twpos = modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\tgl_Position = projectionMatrix * wpos;\n\t\t\t\t\n\t\t\t\t\ttexcoord = uv;\n\t\t\t\t}",e.fragmentShadersLib={},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a,n(66)}).call(e,n(2))},function(t,e,n){(function(t){var i=n(65);e.time=0;var r=function(){function n(n){var r=this;this.topObjects=[],this.lastTime=0,this.camera=null,this.container=document.createElement("div"),this.paused=!1,this.pausing=!1,this.started=!1,this.noGUI=!0,this.initPostProcessing=function(){r.composer=new t.EffectComposer(r.renderer);var e=new t.ShaderPass(t.CopyShader);e.renderToScreen=!0,r.topObjects.forEach((function(t){return t.initPostProcessing(r.composer)})),r.composer.addPass(e)},this.resetGUI=function(){"dat"in i.window&&(r.noGUI||(r.gui&&r.gui.destroy(),r.gui=new dat.GUI,r.gui.add(r,"doNotShowGUI"),r.topObjects.forEach((function(t){return t.addToGUI(r.gui,r.resetGUI)}))))},this.doNotShowGUI=function(){"dat"in i.window&&(r.noGUI=!0,r.gui&&r.gui.destroy(),r.gui=new dat.GUI,r.gui.add(r,"showGUI"))},this.showGUI=function(){"dat"in i.window&&(r.noGUI=!1,r.resetGUI())},this.onWindowResize=function(){r.renderer.setSize(i.window.innerWidth,i.window.innerHeight);var t=r.renderer.context,e=t.canvas.width,n=t.canvas.height;console.log("width = "+e+", height = "+n+", drawingBufferWidth = "+t.drawingBufferWidth+", innerWidth = "+i.window.innerWidth),r.topObjects.forEach((function(t){return t.onWindowResize(i.window.innerWidth,i.window.innerHeight)})),r.composer&&r.composer.reset()},this.animate=function(t){e.time=.001*t;var n=e.time-r.lastTime;r.topObjects.forEach((function(t){return t.update(e.time,n)})),r.camera&&(r.camera.updateMatrixWorld(!0),r.camera.matrixWorldInverse.getInverse(r.camera.matrixWorld)),r.topObjects.forEach((function(t){return t.lateUpdate(e.time,n)})),r.lastTime=e.time,r.renderer.autoClear=!1,r.composer.render(),r.pausing?(r.pausing=!1,r.paused=!0):requestAnimationFrame(r.animate)},n.appendChild(this.container),this.renderer=new t.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(i.window.devicePixelRatio),this.renderer.setSize(i.window.innerWidth,i.window.innerHeight),this.container.appendChild(this.renderer.domElement)}return n.prototype.pause=function(){this.paused&&this.pausing||(this.pausing=!0)},n.prototype.unpause=function(){this.pausing?this.pausing=!1:this.paused&&(this.paused=!1,requestAnimationFrame(this.animate))},n.prototype.init=function(t,e){this.topObjects=t,this.camera=e,this.initPostProcessing(),i.window.addEventListener("resize",this.onWindowResize,!1),this.animate(this.lastTime)},n.prototype.load=function(){for(var t=this,e=[],n=0,i=this.topObjects;n<i.length;n++){var r=i[n].preload();r&&e.push(r)}return Promise.all(e).then((function(){for(var e=0,n=t.topObjects;e<n.length;e++){n[e].afterPreload()}t.doNotShowGUI()}))},n.prototype.start=function(){this.started||(this.started=!0,this.topObjects.forEach((function(t){return t.start()})))},n}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e){(function(e){"undefined"!=typeof window?t.exports=window:void 0!==e?t.exports=e:"undefined"!=typeof self?t.exports=self:t.exports={}}).call(e,function(){return this}())},function(t,e,n){(function(t){var e=n(63);e.default.fragmentShadersLib.gas={usePoi3D:!1,additiveBlending:!0,radius:1.5,scaleMin:1,scaleMax:1,scalePeriod:1,code:n(67)},e.default.fragmentShadersLib.sun={usePoi3D:!1,additiveBlending:!0,radius:2,scaleMin:1,scaleMax:1,scalePeriod:1,iterations:0,mapsChoices:["suns/01_Texture.jpg","suns/02_Texture.jpg","suns/03_Texture.jpg","suns/04_Texture.jpg","suns/05_Texture.jpg","suns/06_Texture.jpg","suns/07_Texture.jpg","suns/08_Texture.jpg","suns/09_Texture.jpg"],mapsLabel:["map"],maps:[0],colorsLabel:["color1","color2"],colors:["rgb(205,166,77)","rgb(205,90,26)"],paramsLabel:["flare1","flare2","flare3","flare4","flare5","flare6","sphere","texture","corona","glow","alpha","rotation1","rotation2"],params:[.265,.5,.265,.5,.5,.1,1,1,1,.5,1,.6,.6],code:n(68)},e.default.fragmentShadersLib.tunnel={usePoi3D:!1,additiveBlending:!0,radius:1,code:n(69)},e.default.fragmentShadersLib.tunnelback={usePoi3D:!1,additiveBlending:!0,radius:1,code:n(70)},e.default.fragmentShadersLib.sphere={usePoi3D:!1,additiveBlending:!0,radius:1,scaleMin:1,scaleMax:1,scalePeriod:1,code:n(71)},e.default.fragmentShadersLib.highlight={usePoi3D:!0,additiveBlending:!0,radius:2.5,scaleMin:1,scaleMax:1,scalePeriod:1,colorsLabel:["color1","color2"],colors:["rgb(255,255,255)","rgb(255,255,255)"],paramsLabel:["alpha","atmosphere1","atmosphere2","atmosphere3"],params:[.55,.5,.5,.5],code:n(72)},e.default.fragmentShadersLib.jumppoint={usePoi3D:!1,additiveBlending:!1,radius:2,scaleMin:1,scaleMax:1,scalePeriod:1,iterations:0,mapsLabel:["map"],mapsChoices:["JumpPointEnv.png"],maps:[0],colorsLabel:["color1","color2"],colors:["rgb(255,149,0)","rgb(255,255,255)"],paramsLabel:["flare1","flare2","flare3","flare4","flare5","flare6","texture","corona","alpha","mag","ior","power","len","flareSpin","jumpSpin"],params:[.14,1,.29,1,.39,.15,1,1,1,.5,.5,.5,.32,.53,.6],code:n(73)},e.default.fragmentShadersLib.blackhole={usePoi3D:!1,additiveBlending:!1,radius:3,scaleMin:1,scaleMax:1,scalePeriod:1,iterations:0,mapsLabel:["map"],mapsChoices:["JumpPointEnv.png"],maps:[0],colorsLabel:["color1","color2"],colors:["rgb(128,128,230)","rgb(76,128,76)"],paramsLabel:["turbulence1","turbulence2","turbulence3","speed","pitch","yaw","roll"],params:[.4,.5,.4,.6,.2,.5,.55],code:n(74)},e.default.fragmentShadersLib.longRangeScanner={usePoi3D:!1,additiveBlending:!1,radius:1.5,colorsLabel:["colorD1","colorD2","colorL1","colorL2","colorC1","colorC2","colorBorder","colorGlow","colorMap"],colors:["rgb(250,183,62)","rgb(255,90,0)","rgb(250,183,62)","rgb(255,90,0)","rgb(250,183,62)","rgb(255,90,0)","rgb(250,183,62)","rgb(180,0,0)","rgb(250,183,62)"],paramsLabel:["alpha","radiusD","widthD","ratioD","radiusL","widthL","ratioL","radiusC","widthC","ratioC","radiusBorder","widthBorder","tickCount","tickLength","tickWidth","glowWidth"],params:[1,.64,.07,.59,.51,.22,.32,.36,.08,.41,.8,.1,.872,.1,.17,.38],code:n(75)},e.default.fragmentShadersLib.ring={usePoi3D:!1,orientation:(new t.Quaternion).setFromAxisAngle(new t.Vector3(1,0,0),.5*Math.PI),additiveBlending:!0,depthTest:!0,radius:2.5,colorsLabel:["color1","color2"],colors:["rgb(230,102,0)","rgb(230,102,26)"],paramsLabel:["radius1","radius2","speed","extraDensity","borderFading"],params:[.6,1,.75,.01,.2],code:n(76)}}).call(e,n(2))},function(t,e){t.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform float time;\nvarying vec2 texcoord;\n\nvoid main( void ) \n{\n  gl_FragColor = vec4( 1.0);\n}"},function(t,e){t.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\t\nuniform sampler2D map;\nuniform float time;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float flare1;\nuniform float flare2;\nuniform float flare3;\nuniform float flare4;\nuniform float flare5;\nuniform float flare6;\t\t\nuniform float sphere;\t\nuniform float texture;\t\nuniform float corona;\t\nuniform float glow;\t\nuniform float alpha;\t\nuniform float rotation1;\t\nuniform float rotation2;\nuniform int iterations;\nvarying vec2 texcoord;\nfloat freqs[4];\n\n// Noise Settings\n#define NoiseSteps 1\n#define NoiseFrequency 4.0\n\n\n\nvec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }\n\nvec4 taylorInvSqrt(vec4 r){ return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v)\n{\n\tconst vec2  C = vec2(1.0/6.0, 1.0/3.0);\n\tconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n \n\t// First corner\n\tvec3 i  = floor(v + dot(v, C.yyy));\n\tvec3 x0 = v - i + dot(i, C.xxx);\n \n\t// Other corners\n\tvec3 g = step(x0.yzx, x0.xyz);\n\tvec3 l = 1.0 - g;\n\tvec3 i1 = min(g.xyz, l.zxy);\n\tvec3 i2 = max(g.xyz, l.zxy);\n\tvec3 x1 = x0 - i1 + C.xxx;\n\tvec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n\tvec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n \n\t// Permutations\n\ti = mod289(i);\n\tvec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n \n\t// Gradients: 7x7 points over a square, mapped onto an octahedron.\n\t// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n\tfloat n_ = 0.142857142857; // 1.0/7.0\n\tvec3  ns = n_ * D.wyz - D.xzx;\n\tvec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n \n\tvec4 x_ = floor(j * ns.z);\n\tvec4 y_ = floor(j - 7.0 * x_);    // mod(j,N)\n \n\tvec4 x = x_ *ns.x + ns.yyyy;\n\tvec4 y = y_ *ns.x + ns.yyyy;\n \n\tvec4 h = 1.0 - abs(x) - abs(y);\n\tvec4 b0 = vec4(x.xy, y.xy);\n\tvec4 b1 = vec4(x.zw, y.zw);\n \n\tvec4 s0 = floor(b0) * 2.0 + 1.0;\n\tvec4 s1 = floor(b1) * 2.0 + 1.0;\n\tvec4 sh = -step(h, vec4(0.0));\n \n\tvec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n\tvec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n \n\tvec3 p0 = vec3(a0.xy, h.x);\n\tvec3 p1 = vec3(a0.zw, h.y);\n\tvec3 p2 = vec3(a1.xy, h.z);\n\tvec3 p3 = vec3(a1.zw, h.w);\n \n\t//Normalise gradients\n\tvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n \n\tp0 *= norm.x;\n\tp1 *= norm.y;\n\tp2 *= norm.z;\n\tp3 *= norm.w;\n\n\t// Mix final noise value\n\tvec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\tm = m * m;\n \n\treturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));\n}\n\nfloat Turbulence(vec3 position, float minFreq, float maxFreq, float qWidth)\n{\n\tfloat value = 0.0;\n\tfloat cutoff = clamp(0.5/qWidth, 0.0, maxFreq);\n\tfloat fade;\n\tfloat fOut = minFreq;\n \n\tfor(int i=NoiseSteps ; i>=0 ; i--)\n\t{\n\t\tif(fOut >= 0.5 * cutoff) break;\n\t\tfOut *= 2.0;\n\t\tvalue += abs(snoise(position * fOut))/fOut;\n\t}\n\tfade = clamp(2.0 * (cutoff-fOut)/cutoff, 0.0, 1.0);\n\treturn 1.0 - value - fade * abs(snoise(position * fOut)) / fOut;\n}\n\n\nfloat snoise(vec3 uv, float res)\t// by trisomie21\n{\n\tconst vec3 s = vec3(1e0, 1e2, 1e4);\n\t\n\tuv *= res;\n\t\n\tvec3 uv0 = floor(mod(uv, res))*s;\n\tvec3 uv1 = floor(mod(uv+vec3(1.), res))*s;\n\t\n\tvec3 f = fract(uv); f = f*f*(3.0-2.0*f);\n\t\n\tvec4 v = vec4(uv0.x+uv0.y+uv0.z, uv1.x+uv0.y+uv0.z,\n\t\t      \t  uv0.x+uv1.y+uv0.z, uv1.x+uv1.y+uv0.z);\n\t\n\tvec4 r = fract(sin(v*1e-3)*1e5);\n\tfloat r0 = mix(mix(r.x, r.y, f.x), mix(r.z, r.w, f.x), f.y);\n\t\n\tr = fract(sin((v + uv1.z - uv0.z)*1e-3)*1e5);\n\tfloat r1 = mix(mix(r.x, r.y, f.x), mix(r.z, r.w, f.x), f.y);\n\t\n\treturn mix(r0, r1, f.z)*2.-1.;\n}\n\nvoid main( void )\n{\n\tfreqs[0] = 0.7;\n\tfreqs[1] = 0.3;\n\tfreqs[2] = 0.2;\n\tfreqs[3] = 0.84;\n\n\tfloat brightness\t= freqs[1] * 0.25 + freqs[2] * 0.25;\n\tfloat radius\t\t= 0.24 + brightness * 0.2;\n\tfloat invRadius \t= 1.0/radius;\n\t\n\tvec3 orange\t\t\t= color1; \n\tvec3 orangeRed\t\t= color2; \n\tfloat time\t\t= time * 0.1;\n\tfloat aspect\t= 1.0;\n\tvec2 uv\t\t\t= texcoord;\n\tvec2 p \t\t\t= -0.5 + uv;\n\tp.x *= aspect;\n\t\n\tfloat fade\t\t= pow( length( 2.0 * p ), 0.5 );\n\tfloat fVal1\t\t= 1.0 - fade;\n\tfloat fVal2\t\t= 1.0 - fade;\n\t\n\tfloat angle\t\t= atan( p.x, p.y )/6.2832;\n\tfloat dist\t\t= length(p)*1.0;\n\tfloat timeflare = time*mix(0.,5.,flare3);\n\tvec3 coord\t\t= vec3( angle*floor(flare6*10.), dist, timeflare * 0.1 );\n\t\n\tfloat newTime1\t= abs( snoise( coord + vec3( 0.0, -timeflare * ( 0.35 + brightness * 0.001), timeflare * 0.015), floor(flare1 * 100.0) * 1.0 ) );\n\tfloat newTime2\t= abs( snoise( coord + vec3( 0.0, -timeflare * ( 0.15 + brightness * 0.001), timeflare * 0.015), floor(flare1 * 100.0) * 1.0 ) );\t\n\tfor( int i=1; i<=10; i++ ){\n\t\tif(i>iterations) break;\n\t\tfloat power = pow( 2.0, float(i + 1) );\n\t\tfVal1 += ( 0.5 / power ) * snoise( coord + vec3( 0.0, -timeflare, timeflare * 0.2 ), ( power * ( 10.0 ) * ( newTime1 + 1.0 ) ) );\n\t\tfVal2 += ( 0.5 / power ) * snoise( coord + vec3( 0.0, -timeflare, timeflare * 0.2 ), ( power * ( 25.0 ) * ( newTime2 + 1.0 ) ) );\n\t}\n\t\n\tfloat coronafx\t\t= pow( fVal1 * max( 1.1 - fade, 0.0 ), mix(1.2,2.8,flare4)) * 50.0;\n\tcoronafx\t\t\t\t+= pow( fVal2 * max( 1.1 - fade, 0.0 ), mix(1.2,2.8,flare5)) * 50.0;\n\tcoronafx\t\t\t\t*= 1.2 - newTime1;\n\tvec3 sphereNormal \t= vec3( 0.0, 0.0, 1.0 );\n\tvec3 dir \t\t\t= vec3( 0.0 );\n\tvec3 center\t\t\t= vec3( 0.5, 0.5, 1.0 );\n\tvec3 starSphere\t\t= vec3( 0.0 );\n\t\n\tvec2 sp = -1.0 + 2.0 * uv;\n\tsp.x *= aspect;\n\tsp *= ( 2.0 - brightness );\n  \tfloat r = dot(sp,sp);\n\tfloat f = (1.0-sqrt(abs(1.0-r)))/(r) + brightness * 0.5;\n\tif( dist < radius ){\n\t\tcoronafx\t\t\t*= pow( dist * invRadius, 24.0*flare2 );\n  \t\tvec2 newUv;\n \t\tnewUv.x = sp.x*f;\n  \t\tnewUv.y = sp.y*f;\n\t\tnewUv += vec2( time*0.35 * 5. * (rotation1-0.5), 0.0 );\n\t\t\n\t\tvec3 texSample \t= texture2D( map, newUv ).rgb;\n\t\tfloat uOff\t\t= ( texSample.g * brightness * 4.5 + time * 5. * (rotation2-0.5) );\n\t\tvec2 starUV\t\t= newUv + vec2( uOff, 0.0 );\n\t\tstarSphere\t\t= texture2D( map, starUV ).rgb;\n\t}\n\t\n\tfloat starGlow\t= min( max( 1.0 - dist * ( 1.0 - brightness ), 0.0 ), 1. ) * max(0., .5 - dist) * 2.;\n\t//fragColor.rgb\t= vec3( r );\n\tgl_FragColor.rgb\t= vec3( f * ( 0.75 + brightness * 0.3 ) * orange * sphere )  + starSphere * texture + \n\t\t\t\t\t\t\tcoronafx * orange * corona + starGlow * orangeRed * glow;\n\tgl_FragColor.a\t\t= alpha;\n}\t\t\t\t\n"},function(t,e){t.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n \nuniform float time;\nuniform vec2 poi;\nuniform vec2 resolution;\n  \nvoid main( void )\n{\n\tgl_FragColor = vec4(1.0);\n}"},function(t,e){t.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n \nuniform float time;\nuniform vec2 poi;\nuniform vec2 resolution;\n \nvoid main( void )\n{\n\tgl_FragColor = vec4(1.0);\n}"},function(t,e){t.exports="uniform float time;\nvarying vec2 texcoord;\n\nvoid main() {\n\tfloat x = texcoord.x - 0.5;\n\tfloat y = texcoord.y - 0.5;\n\tfloat r = 2.0*sqrt(x*x+y*y);\n\tfloat d;\n\tif (r < 1.0) {\n\t\td = mix(1.0,0.0,r);\n\t} else {\n\t\td = 0.0;\n\t}\n\tfloat lum = 1.0;\n\tgl_FragColor = vec4(lum*vec3(0.465, 0.203, 0.063), d);\n}"},function(t,e){t.exports="uniform float time;\nvarying vec2 texcoord;\nvarying vec4 wpos;\nuniform vec3 wpoi3D;\nuniform vec3 wcenter;\n\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float alpha;\nuniform float atmosphere1;\nuniform float atmosphere2;\nuniform float atmosphere3;\n\n#define Radius 2.5\n\nfloat nRadius = 1./Radius;\n\n/////////////////////////////////////////////////////////\n\n// parameters of the light and possible values\nvec3 u_lightAmbientIntensity = vec3(0.0, 0.0, 0.0);\nvec3 u_lightDiffuseIntensity = vec3(1.0, 1.0, 1.0);\nvec3 u_lightSpecularIntensity = vec3(1.0, 1.0, 1.0);\n\n// parameters of the material and possible values\nvec3 u_matAmbientReflectance = vec3(1.0, 1.0, 1.0);\nvec3 u_matDiffuseReflectance = vec3(1.0, 1.0, 1.0);\nvec3 u_matSpecularReflectance = vec3(1.0, 1.0, 1.0);\nfloat u_matShininess = 64.0;\n\n/////////////////////////////////////////////////////////\n\n// returns intensity of reflected ambient lighting\nvec3 ambientLighting()\n{\n   return u_matAmbientReflectance * u_lightAmbientIntensity;\n}\n\n// returns intensity of diffuse reflection\nvec3 diffuseLighting(vec3 N, vec3 L)\n{\n   // calculation as for Lambertian reflection\n   float diffuseTerm = clamp(dot(N, L), 0.0, 1.0) ;\n   return u_matDiffuseReflectance * u_lightDiffuseIntensity * diffuseTerm;\n}\n\n// returns intensity of specular reflection\nvec3 specularLighting(vec3 N, vec3 L, vec3 V)\n{\n   float specularTerm = 0.0;\n\n   // calculate specular reflection only if\n   // the surface is oriented to the light source\n   if(dot(N, L) > 0.0)\n   {\n      // half vector\n      vec3 H = normalize(L + V);\n      specularTerm = pow(dot(N, H), u_matShininess);\n   }\n   return u_matSpecularReflectance * u_lightSpecularIntensity * specularTerm;\n}\n\nvoid main() {\n\tfloat x = 2.0 * (texcoord.x - 0.5);\n\tfloat y = 2.0 * (texcoord.y - 0.5);\n\tfloat r = sqrt(x*x+y*y);\n\tfloat d;\n\t\n\tvec3 C = wcenter.xyz;\n\tvec3 P = wpos.xyz;\n\tvec3 CP = P - C;\n\tfloat R = sqrt(CP.x * CP.x + CP.y * CP.y);\n\t\n\tif (r > 0.0) {\n\t\tfloat dC2 = dot(C,C);\n\t\tfloat dP2 = dot(P,P);\n\t\tfloat dPC = dot(P,C);\n\t\tfloat sr = R * nRadius/r;\n\t\tfloat a = dP2;\n\t\tfloat b = -2.0*dPC;\n\t\tfloat c = dC2 - sr*sr;\n\t\tfloat det2 = b*b - 4.0*a*c;\n\t\t//if (det2 >= 0.0) {\n\t\t\n\t\t\tfloat det = det2 >= 0.? sqrt(det2) : 0.;\n\t\t\tfloat kk = 0.5*(-b - det)/a;\n\t\t\tvec3 Q = kk*P;\n\t\t\tvec3 CQ = Q-C;\n\t\t\t\n\t\t\tfloat rr = sqrt(abs(0.25*b*b/a - dC2))*r/R;\n\t\t\t\n\t\t\t// normalize vectors after interpolation\n\t\t\tvec3 L = normalize(wpoi3D.xyz-Q);\n\t\t\tvec3 V = normalize(-Q);\n\t\t\tvec3 N = normalize(CQ);\n\t\t\t\n\t\t\t// get Blinn-Phong reflectance components\n\t\t\tvec3 Iamb = ambientLighting();\n\t\t\tvec3 Idif = diffuseLighting(N, L);\n\t\t\tvec3 Ispe = specularLighting(N, L, V);\n\t\t\t\n\t\t\t//float zA = sqrt(1.-x*x-y*y);\n\t\t\tfloat zA = Q.z * r / R;\n\t\t\t\n\t\t\t// combination of all components and diffuse color of the object\n\t\t\t\n\t\t\tfloat k = mix(15., 9., atmosphere1);\n\t\t\tfloat atmHeight = 1.0-nRadius;\n\t\t\tfloat iA = 50.0 * atmosphere2 * zA * exp(-atmHeight*k) * exp(-(rr - nRadius)*k);\n\t\t\tfloat iLight = max(0., dot(N,L));\n\t\t\tfloat iAp = pow(max(0.,1.0-5.*min(atmHeight,abs(rr-nRadius))), mix(8., 1., atmosphere3));\n\t\n\t\t\tgl_FragColor = vec4( (rr <= nRadius ? \n\t\t\t\t(iAp * color1 + iLight * color2) : \n\t\t\t\t(iA * color1)\n\t\t\t\t), alpha);\n\n\t\t\t//gl_FragColor = vec4(1.,0.,0.,1.);\n\t\t/*} else {\n\t\t\tgl_FragColor = vec4(0.,0.,0.,0.);\n\t\t}*/\n\t} else {\n\t\tgl_FragColor = vec4(0.,0.,0.,0.);\n\t}\n\n}\t\t\t\t\n\n"},function(t,e){t.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\t\n\nuniform sampler2D map;\nuniform float time;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float flare1;\nuniform float flare2;\nuniform float flare3;\nuniform float flare4;\nuniform float flare5;\nuniform float flare6;\nuniform float texture;\t\nuniform float corona;\t\nuniform float alpha;\t\nuniform float mag;\nuniform float ior;\nuniform float power;\nuniform float len;\nuniform float flareSpin;\t\t\nuniform float jumpSpin;\t\nuniform int iterations;\nvarying vec2 texcoord;\nfloat freqs[4];\n\n// Noise Settings\n#define NoiseSteps 1\n#define NoiseFrequency 4.0\n\n\n\nvec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }\n\nvec4 taylorInvSqrt(vec4 r){ return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v)\n{\n\tconst vec2  C = vec2(1.0/6.0, 1.0/3.0);\n\tconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n \n\t// First corner\n\tvec3 i  = floor(v + dot(v, C.yyy));\n\tvec3 x0 = v - i + dot(i, C.xxx);\n \n\t// Other corners\n\tvec3 g = step(x0.yzx, x0.xyz);\n\tvec3 l = 1.0 - g;\n\tvec3 i1 = min(g.xyz, l.zxy);\n\tvec3 i2 = max(g.xyz, l.zxy);\n\tvec3 x1 = x0 - i1 + C.xxx;\n\tvec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n\tvec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n \n\t// Permutations\n\ti = mod289(i);\n\tvec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n \n\t// Gradients: 7x7 points over a square, mapped onto an octahedron.\n\t// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n\tfloat n_ = 0.142857142857; // 1.0/7.0\n\tvec3  ns = n_ * D.wyz - D.xzx;\n\tvec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n \n\tvec4 x_ = floor(j * ns.z);\n\tvec4 y_ = floor(j - 7.0 * x_);    // mod(j,N)\n \n\tvec4 x = x_ *ns.x + ns.yyyy;\n\tvec4 y = y_ *ns.x + ns.yyyy;\n \n\tvec4 h = 1.0 - abs(x) - abs(y);\n\tvec4 b0 = vec4(x.xy, y.xy);\n\tvec4 b1 = vec4(x.zw, y.zw);\n \n\tvec4 s0 = floor(b0) * 2.0 + 1.0;\n\tvec4 s1 = floor(b1) * 2.0 + 1.0;\n\tvec4 sh = -step(h, vec4(0.0));\n \n\tvec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n\tvec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n \n\tvec3 p0 = vec3(a0.xy, h.x);\n\tvec3 p1 = vec3(a0.zw, h.y);\n\tvec3 p2 = vec3(a1.xy, h.z);\n\tvec3 p3 = vec3(a1.zw, h.w);\n \n\t//Normalise gradients\n\tvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n \n\tp0 *= norm.x;\n\tp1 *= norm.y;\n\tp2 *= norm.z;\n\tp3 *= norm.w;\n\n\t// Mix final noise value\n\tvec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\tm = m * m;\n \n\treturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));\n}\n\nfloat Turbulence(vec3 position, float minFreq, float maxFreq, float qWidth)\n{\n\tfloat value = 0.0;\n\tfloat cutoff = clamp(0.5/qWidth, 0.0, maxFreq);\n\tfloat fade;\n\tfloat fOut = minFreq;\n \n\tfor(int i=NoiseSteps ; i>=0 ; i--)\n\t{\n\t\tif(fOut >= 0.5 * cutoff) break;\n\t\tfOut *= 2.0;\n\t\tvalue += abs(snoise(position * fOut))/fOut;\n\t}\n\tfade = clamp(2.0 * (cutoff-fOut)/cutoff, 0.0, 1.0);\n\treturn 1.0 - value - fade * abs(snoise(position * fOut)) / fOut;\n}\n\n\nfloat snoise(vec3 uv, float res)\t// by trisomie21\n{\n\tconst vec3 s = vec3(1e0, 1e2, 1e4);\n\t\n\tuv *= res;\n\t\n\tvec3 uv0 = floor(mod(uv, res))*s;\n\tvec3 uv1 = floor(mod(uv+vec3(1.), res))*s;\n\t\n\tvec3 f = fract(uv); f = f*f*(3.0-2.0*f);\n\t\n\tvec4 v = vec4(uv0.x+uv0.y+uv0.z, uv1.x+uv0.y+uv0.z,\n\t\t      \t  uv0.x+uv1.y+uv0.z, uv1.x+uv1.y+uv0.z);\n\t\n\tvec4 r = fract(sin(v*1e-3)*1e5);\n\tfloat r0 = mix(mix(r.x, r.y, f.x), mix(r.z, r.w, f.x), f.y);\n\t\n\tr = fract(sin((v + uv1.z - uv0.z)*1e-3)*1e5);\n\tfloat r1 = mix(mix(r.x, r.y, f.x), mix(r.z, r.w, f.x), f.y);\n\t\n\treturn mix(r0, r1, f.z)*2.-1.;\n}\n\nvoid main( void )\n{\n\tfloat PI = 3.14159265358979323846264;\n\n\tfreqs[0] = 0.7;\n\tfreqs[1] = 0.3;\n\tfreqs[2] = 0.2;\n\tfreqs[3] = 0.84;\n\n\tfloat brightness\t= freqs[1] * 0.25 + freqs[2] * 0.25;\n\tfloat radius\t\t= 0.24 + brightness * 0.2;\n\tfloat invRadius \t= 1.0/radius;\n\t\n\tfloat time\t\t= time * 0.1;\n\tfloat aspect\t= 1.0;\n\tvec2 uv\t\t\t= texcoord;\n\tvec2 p \t\t\t= -0.5 + uv;\n\tp.x *= aspect;\n\t\n\tfloat fade\t\t= pow( length( 2.0 * p ), 0.5 );\n\tfloat fVal1\t\t= 1.0 - fade;\n\tfloat fVal2\t\t= 1.0 - fade;\n\t\n\tfloat angle\t\t= time * mix(-PI, PI, flareSpin) + atan( p.x, p.y )/6.2832;\n\tfloat dist\t\t= length(p)*1.0;\n\tfloat timeflare = time*mix(0.,5.,flare3);\n\tvec3 coord\t\t= vec3( angle*floor(flare6*10.), dist, timeflare * 0.1 );\n\t\n\tfloat newTime1\t= abs( snoise( coord + vec3( 0.0, -timeflare * ( 0.35 + brightness * 0.001), timeflare * 0.015), floor(flare1 * 100.0) * 1.0 ) );\n\tfloat newTime2\t= abs( snoise( coord + vec3( 0.0, -timeflare * ( 0.15 + brightness * 0.001), timeflare * 0.015), floor(flare1 * 100.0) * 1.0 ) );\t\n\tfor( int i=1; i<=10; i++ ){\n\t\tif(i>iterations) break;\n\t\tfloat power = pow( 2.0, float(i + 1) );\n\t\tfVal1 += ( 0.5 / power ) * snoise( coord + vec3( 0.0, -timeflare, timeflare * 0.2 ), ( power * ( 10.0 ) * ( newTime1 + 1.0 ) ) );\n\t\tfVal2 += ( 0.5 / power ) * snoise( coord + vec3( 0.0, -timeflare, timeflare * 0.2 ), ( power * ( 25.0 ) * ( newTime2 + 1.0 ) ) );\n\t}\n\t\n\tfloat coronafx\t\t= pow( fVal1 * max( 1.1 - fade, 0.0 ), mix(1.2,2.8,flare4)) * 50.0;\n\tcoronafx\t\t\t\t+= pow( fVal2 * max( 1.1 - fade, 0.0 ), mix(1.2,2.8,flare5)) * 50.0;\n\tcoronafx\t\t\t\t*= 1.2 - newTime1;\n\tvec3 sphereNormal \t= vec3( 0.0, 0.0, 1.0 );\n\tvec3 dir \t\t\t= vec3( 0.0 );\n\tvec3 center\t\t\t= vec3( 0.5, 0.5, 1.0 );\n\tvec3 starSphere\t\t= vec3( 0.0 );\n\t\n\tvec2 sp = -1.0 + 2.0 * uv;\n\tsp.x *= aspect;\n\tsp *= ( 2.0 - brightness );\n  \tfloat r = dot(sp,sp);\n\tfloat f = (1.0-sqrt(abs(1.0-r)))/(r) + brightness * 0.5;\n\tif( dist < radius ){\n\t\tcoronafx\t\t\t*= pow( dist * invRadius, 24.0*flare2 );\n\n\t    vec2 p = uv - vec2(0.5,0.5);\n\t    p /= mix(0.4, 1.0, mag);\n\t    vec3 normal = normalize(vec3(normalize(p),pow(length(p) * mix(1.0,80.0,len), mix(0.1,2.0,power))));\t\t\n\t    vec2 newPos = uv + refract(vec3(0.,0.0,1.), normal, mix(0.0001, 2.0, ior)).xy*1.;\n\n\t    vec4 vd = viewMatrix * vec4(0.,0.,1.,1.);\n\n\t\tstarSphere\t\t= color2*texture2D( map, newPos + vec2(time * mix(-2., 2., jumpSpin) + atan(vd.z,vd.x)/PI, atan(vd.z,vd.y)/PI) ).rgb;\n\t}\n\t\n\t//fragColor.rgb\t= vec3( r );\n\n\tvec3 col = starSphere * texture * min(10.0*(1.0-dist),1.) + coronafx * color1 * corona;\n\n\tgl_FragColor.rgb\t= dist < radius ? col : 1.*col;\n\tfloat dr = dist/radius;\n\tfloat ma = 2.0*(1.0 - alpha);\n\tfloat i = ma > 1.0? 2.0-ma : 1.0;\n\tgl_FragColor.a\t\t= i * (dr < ma? pow(dr/ma, 2.0) : 1.0) * (dist < radius ? 2.0 : max(0.,length(col)*length(col)-0.1));\n}\t\t\t\t\n"},function(t,e){t.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\n\nuniform float time;\n\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float turbulence1;\nuniform float turbulence2;\nuniform float turbulence3;\nuniform float speed;\nuniform float pitch;\nuniform float yaw;\nuniform float roll;\nuniform vec3 camZ;\nvarying vec2 texcoord;\n\nfloat tweak(float vmin, float vmax, float k) {\n  //float r = k < 0. ? k < -1.5 ? mouse.y : mouse.x : k;\n  return mix(vmin,vmax,k);\n}\n\nvec4 smoke(vec2 uv, vec3 c1, vec3 c2)\n{\n\tuv.x += -uv.y;\n\tfloat d = 1.-uv.y;\n\tfloat a = uv.x*360.;\n\tfloat persistence = mix(.5, .8, turbulence2);\n\tfloat scale = 1./floor(mix(1.,5.,turbulence1));\n\tfloat v = 0.0;\n\tfloat p = 1.;\n\n\tuv *= vec2((1./(turbulence3>0.75 ? 6. : floor(mix(1.,5.,turbulence3))))*tweak(16.,60.,0.493),3.14159);\n\tfloat ks = mix(-5.,5.,speed);\n\t\n\tfor (int i=5; i>=0; --i)\n\t{\n\t\tv += (sin(uv.x)+cos(uv.y))*p;\n\t\tuv += sin(uv.yx+1.*vec2(ks*time, 0.9*ks*time));\n\t\tp *= persistence;\n\t\tuv /= scale;\n\t}\n\t\n\tfloat w = pow(1.-tan(v*0.3)*.05,12.);\n\t\n\tvec4 col = vec4( mix(c2,c1,w)*(d+.45), 1.0 ) *  (d>.91?1.-(d-.91)*30.:1.);\n\tif(d< -0.4) col*=0.;\n\t\n\treturn col;\n}\n\nvec4 ringV(vec2 uv, vec3 c1, vec3 c2) {\n\tvec4 uvm = vec4(uv-vec2(0.5,0.5), 1.,1.);\n\t\n\tvec4 cuv = uvm ;\n\t\n\tfloat x = cuv.x;//(cuv.x - 0.5);\n\tfloat y = cuv.y;//(cuv.y - 0.5);\n\t\t\n\t\n\tfloat r = 2.0*sqrt(x*x+y*y);\n\tfloat angle = degrees(atan(-x,-y)) + 180.;\n\tfloat a = radians(angle);\n\tfloat k = angle/360.0;\n\tvec2 q = vec2(0.,1.);\n\tfloat d = q.x + r / q.y;\n\tvec2 puv = vec2(k, d);\n\tvec4 sm = smoke(puv, c1,vec3(0.));\n\tvec4 sm2 = smoke(puv+vec2(0.3,0.4), c2,vec3(0.));\n\t\n\treturn sm+sm2;\n\t\n}\n\n\nvec2 obj0(in vec3 p){\n  return vec2(p.y +  min(0.5,1./(length(p*vec3(10.,.1,10.))*.9))-0. ,0.);\n  return vec2(p.y,0);\n}\n\nvec3 obj0_c(in vec3 p){\n return(ringV(    (vec2(0.5)+p.xz* .22 ), color1, color2).rgb);\n}\n\n\n\nvec2 inObj(in vec3 p){\n  return obj0(p);\n}\n\n\nvoid main(void){\n\t\n  float yawr = radians(mix(0.,360.,yaw));\n  float pitchr = radians(mix(-90.,90.,pitch));\n  float rollr = radians(mix(-90.,90.,roll));\t\n\t\n  vec2 vPos=-1.0+2.0*texcoord;\n  vPos = vec2(vPos.x*cos(rollr)-vPos.y*sin(rollr),vPos.y*cos(rollr)+vPos.x*sin(rollr));\n\t\n  //Camera animation\n  vec3 vuv=vec3(0,1,0);//Change camere up vector here\n  vec3 vrp=vec3(0,0.,0); //Change camere view here\n\n  float dist = 5.; \n  \n  //vec3 prp=dist*vec3(sin(yawr),sin(-pitchr),cos(yawr)); //Change camera path position here\n  vec3 prp=dist*vec3(-camZ.x,camZ.y,-camZ.z); //Change camera path position here\n  const vec3 e=vec3(0.1,0,0);\n  //Camera setup\n  vec3 vpn=normalize(vrp-prp);\n  vec3 u=normalize(cross(vuv,vpn));\n  vec3 v=cross(vpn,u);\n  vec3 vcv=(prp+vpn);\n  vec3 scrCoord=vcv+vPos.x*u+vPos.y*v;\n  vec3 scp=normalize(scrCoord-prp);\n\n  //Raymarching\n  const float maxd=10.0; //Max depth\n\n  vec2 s=vec2(0.1,0.0);\n  vec3 c,p,n;\n\n  float f=1.0;\n  for(float i=0.;i<100.;i+=1.0){\n    if (abs(s.x)<.01||f>maxd) break;\n    f+=s.x;\n    p=prp+scp*f;\n    p.y= prp.y < 0. ? -p.y : p.y;\n    s=inObj(p);\n  }\n  \n  vec4 col = vec4(0.);\n  if (f<maxd){\n    c = obj0_c(p);\n    n=normalize(vec3(s.x-inObj(p-e.xyy).x, s.x-inObj(p-e.yxy).x, s.x-inObj(p-e.yyx).x));\n    float b=dot(n,normalize(prp-p));\n    col=vec4((mix(b,1.,0.8)*c),1.0);\n    col.a = pow(max(max(col.r,col.g),col.b),1.5);\n  }\n  else col=vec4(0.,0.,0.,0.); //background color\n\t\n  gl_FragColor = col;\t\n}"},function(t,e){t.exports="//uniform sampler2D map;\nuniform float time;\nuniform vec3 colorD1;\nuniform vec3 colorD2;\nuniform vec3 colorL1;\nuniform vec3 colorL2;\nuniform vec3 colorC1;\nuniform vec3 colorC2;\nuniform vec3 colorBorder;\nuniform vec3 colorGlow;\nuniform vec3 colorMap;\nuniform vec2 resolution;\n\nuniform float alpha;\nuniform float radiusD;\nuniform float widthD;\nuniform float ratioD;\nuniform float radiusL;\nuniform float widthL;\nuniform float ratioL;\nuniform float radiusC;\nuniform float widthC;\nuniform float ratioC;\nuniform float radiusBorder;\nuniform float widthBorder;\nuniform float tickCount;\nuniform float tickLength;\nuniform float tickWidth;\nuniform float glowWidth;\n\nvarying vec2 texcoord;\n\nfloat rand(vec2 co){  \n  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat noise(in vec2 p)\n{\n    vec2 i = floor(p);\n     vec2 f = fract(p);\n     f *= f * (3.0-2.0*f);\n\n    return mix(mix(rand(i + vec2(0.,0.)), rand(i + vec2(1.,0.)),f.x),\n               mix(rand(i + vec2(0.,1.)), rand(i + vec2(1.,1.)),f.x),\n               f.y);\n}\n\nfloat wf(vec2 p)\n{\n     return noise(p*0.4)*.35 + noise(p*1.)*.25 + noise(p*2.)*.225;\n}\n\nfloat incandescence(float v, float a, float b, float m) {\n\treturn mix(a+b*noise(vec2(m*time,v)),1.0, alpha * 0.85);\n}\n\nvec4 waves( vec2 uv ) \n{\n\n\tvec2 p = uv * 2.0 - 1.0;\n\tp.x *= resolution.x/resolution.y;\n\tvec3 col = vec3( 0.0 );\n\tfor( int i=0; i < 3; ++i )\n\t{\n\t\tfloat t = abs( 1.0 / (sin(p.y + wf( vec2(p.x*30.,p.y) + time * (float(i)+.5) )) * (50.0 + float(i)*3.0)) * 0.7 );\n\t\tcol +=  t * vec3( 0.99, 0.95, 0.8 ) * 1.0;\n\t}\n\t\n\treturn vec4( col, min(1., col.r+col.g+col.b));\n\n}\n\nvec4 arcHue(vec4 col, float r, float angle, vec3 c1, vec3 c2, float radius, float w, float ratio, vec3 gc, float gw) {\n\tfloat width = w * 0.2;\n\treturn (abs(r-radius) < width && angle < ratio * 360.) ?\n\t\t\t\tvec4(mix(c1,c2,angle/(ratio*360.)),col.a)+0.4*vec4(c1*min(1.,col.r),0.0)\n\t\t\t\t: col;\n}\n\nvec4 arc(float r, float angle, vec3 c1, vec3 c2, float radius, float w, float ratio, vec3 gc, float gw) {\n\tfloat width = w * 0.2;\n\tvec4 col = (abs(r-radius) < width && angle < ratio * 360.) ?\n\t\t\t\tvec4(mix(c1,c2,angle/(ratio*360.)), mix(0., 1., 1.4*pow(1.0-abs(radius-r)/width,0.5))) \n\t\t\t\t//+ vec4(vec3(incandescence(.1,-.2,.4,radius*15.)),0.)\n\t\t\t\t:\n\t\t\t\tvec4(0.,0.,0.,0.);\n\n\tif(col.a < 0.5 && abs(r-radius) < width + gw*0.5 && (angle < 1.3 * ratio * 360. || angle > 350.)) {\n\t\tfloat gp = ( angle > 350.0 ? (1.0-(360.- angle)/10.)  :\n\t\t\t  angle > ratio * 360. ? (1.0-(angle-ratio*360.)/(.3 * ratio * 360.)) : 1.0)*\n\t\t\t0.5*pow(1.0-abs(r-radius)/(width + gw*0.5),1.);\n\t\tcol = mix(col, vec4(gc, gp), 1.0-col.a/(col.a+0.5));\n\t}\n\n\tcol *= vec4(vec3(incandescence(.1,.5,1.,radius*15.)),1.);\t\n\n\treturn col; \n}\n\nvec4 gradedCircle(float r, float angle, vec3 c, float radius, float w, \n\t\t\t\t\tfloat tickCount, float tickL, float tickW, vec3 gc, float gw) {\n\tfloat width = w * 0.2;\n\tfloat tlength = tickL * 0.2;\n\tvec4 col = vec4(0., 0., 0., 0.);\n\n\tcol += (abs(r-radius) < width) ?\n\t\t\tvec4(c, mix(0., 1., 1.4*pow(1.0-abs(radius-r)/width,0.5)))\n\t\t\t//+ vec4(vec3(incandescence(.1,-.2,.4,radius*15.)),0.)\n\t\t\t:\n\t\t\tvec4(0.,0.,0.,0.); \n\n\tcol = max(col,\n\t\t(r < radius && r > radius - width - tlength && mod(angle+360., 360./floor(1.0/((1.0-tickCount)*0.25+0.0000001))) < tickW * 5.0)  ?\n\t\t\tvec4(c, max(0.,pow(  1.0-abs(mod(angle+360., 360./floor(1.0/((1.0-tickCount)*0.25+0.0000001))) - tickW * 2.5), 2.) )) :\n\t\t\tvec4(0.,0.,0.,0.)); \n\n\tif(col.a < 0.5 && abs(r-radius) < width + gw*0.5) {\n\t\tfloat gp = 0.5*pow(1.0-abs(r-radius)/(width + gw*0.5),1.);\n\t\tcol = mix(col, vec4(gc, gp), 1.0-col.a/(col.a+0.5));\n\t}\n\n\tcol *= vec4(vec3(incandescence(.1,.5,1.,radius*15.)),1.);\t\n\n\treturn col;\n}\n\n\n\nvoid main() {\n\tfloat x = texcoord.x - 0.5;\n\tfloat y = texcoord.y - 0.5;\n\tfloat r = 2.0*sqrt(x*x+y*y);\n\tfloat angle = degrees(atan(-x,-y)) + 180.;\n\n\tfloat d;\n\tif (r < 1.0) {\n\t\td = mix(1.0,0.0,r);\n\t} else {\n\t\td = 0.0;\n\t}\n\tvec4 col = vec4(0.,0.,0.,0.);\n\tfloat wc = mix(0.0,0.65,d);\n\tvec4 wp = r > (radiusBorder-glowWidth*0.45)? vec4(0.0,0.0,0.0,0.0) : waves(vec2(angle/360., wc))*vec4(1.,0.,0.,1.);\n\n\tcol = max(col, arc(r, angle, colorD1, colorD2, radiusD, widthD, ratioD, colorGlow, glowWidth));\n\tcol = max(col, arc(r, angle, colorL1, colorL2, radiusL, widthL, ratioL, colorGlow, glowWidth));\n\tcol = max(col,arc(r, angle, colorC1, colorC2, radiusC, widthC, ratioC, colorGlow, glowWidth));\n\n\tcol = max(col,gradedCircle(r, angle, colorBorder, radiusBorder, widthBorder, \n\t\t\t\t\t\ttickCount, tickLength, tickWidth, colorGlow, glowWidth));\n\n\tcol.a = min(1.0, col.a);\n\twp.a = min(1.0, wp.a);\n\tcol = vec4(mix(wp.rgb, col.rgb*1.3, 0.75), col.a);\n\n\tcol = arcHue(col, r, angle, colorD1, colorD2, radiusD, widthD, ratioD, colorGlow, glowWidth);\n\tcol = arcHue(col, r, angle, colorL1, colorL2, radiusL, widthL, ratioL, colorGlow, glowWidth);\n\tcol = arcHue(col, r, angle, colorC1, colorC2, radiusC, widthC, ratioC, colorGlow, glowWidth);\n\n\tgl_FragColor = vec4(col.rgb, col.a * alpha);\n\n\t//vec4 tp = texture2D( map, texcoord.xy ).rgba;\n\t//tp.rgb *= colorMap;\n\t//tp.a = min(1., tp.r+tp.g+tp.b);\n\t//vec4 finalColor = mix(col,tp,tp.a);\n\t//gl_FragColor = vec4(finalColor.rgb, finalColor.a * alpha);\n}"},function(t,e){t.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform float time;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float radius1;\nuniform float radius2;\nuniform float speed;\nuniform float extraDensity;\nuniform float borderFading;\n\nvarying vec2 texcoord;\n\nfloat size = 5.;\nfloat density = 0.6;\n\nfloat rand(vec2 co){\n\t\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat noisemap(vec2 uv, float bias, float sizeFactor, float densityFactor, float speedFactor, float stretch) {\n\tsizeFactor*= (1.+floor(extraDensity*10.));\n\tvec2 vf = vec2(uv.x + uv.y * bias + time * speedFactor * (0.5-speed), uv.y * stretch)*(sizeFactor * 2. * size);\n\tvec2 v = vec2(floor(vf.x), floor(vf.y));\n\tvec2 f = vf-v;\t\n\tfloat r = 2.0*distance(f, vec2(0.5, 0.5));\n\tfloat d = 1.0 - min(r, 1.0);\n\tfloat p = rand(fract(v));\n\tp = p < densityFactor * 0.6 ? d*(1.0 - 2.0 * abs(uv.y - 0.5)) : 0.0;\n\treturn p;\n}\n\nvec4 trailmap(vec2 uv, vec3 c1, vec3 c2) {\n\tvec3 col = vec3(0.);\n\tcol += noisemap(uv, 1., .1, 0.25, .12, 15.) * c1;\n\tcol += noisemap(uv, -2., .2, 0.25, .15, 17.) * c2;\n\tcol += noisemap(uv, 3., .3, 0.25, .20, 9.) * c1;\n\tcol += noisemap(uv, -1.5, .4, 0.25, .25, 12.) * c2;\n\tcol += noisemap(uv, 2.5, .5, 0.25, .28, 20.) * c1;\n\tcol += noisemap(uv, -3.5, .6, 0.25, .37, 22.) * c2;\n\tcol += noisemap(uv, 1.1, .7, 0.25, .48, 15.) * c1;\n\tcol += noisemap(uv, -2.1, .8, 0.25, .59, 9.) * c2;\n\treturn vec4(col, 1.0);\n}\n\nvec4 ring(vec2 uv, float r1, float r2, vec3 c1, vec3 c2) {\n\n\tfloat x = (uv.x - 0.5);\n\tfloat y = (uv.y - 0.5);\n\tfloat r = 2.0*sqrt(x*x+y*y);\n\tfloat angle = degrees(atan(-x,-y)) + 180.;\n\n\tfloat d = r < 1.0 ? mix(0.0,1.0,r) : 0.0;\n\t\n\tvec2 puv = vec2(angle / 360., d); \n\t\n\tvec4 tm = trailmap(puv, c1,c2);\n\tfloat f =pow(smoothstep(r1,r2,r),mix(0.01,3.,borderFading));\n\t\n\treturn tm * f;\n\t\n}\n\nvoid main( void ) {\n\n\tvec2 uv = texcoord;\n\n\t\n\tvec4 obj  = ring(uv, radius1, radius2, color1, color2);\n\t\n\tgl_FragColor = obj;\n}\n"},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(78),a=n(86),s=n(87),l=n(63),c=n(32),u=n(30),h=n(90),d=n(52),f=function(e){function n(n,i,r,o,s,l,c){e.call(this),this.controlAPI=n,this.renderer=i,this.scene=r,this.camera=o,this.width=s,this.height=l,this.resourcePath=c,this.asteriodsPrefabs=[null,null,null],this.allPrefabs=[],this.timeAnimatedMaterials=[],this.arrowMaterial=null,this.started=!1,this.sequentialLoading=new Promise((function(t,e){return t(!0)})),this.loadedTextures={},this.loadedObjects={},this.starSystems={},this.starSystemsRoot=new t.Group,this.isReady=!1,this.starSystemsRoot.name="StarSystems",r.add(this.starSystemsRoot),this.heatmap=new a.default(n,s,l,this.camera,this.renderer)}return i(n,e),n.prototype.baseLoadObject=function(t){var e=this;return u.default.loadObject(t).then((function(t){return e.allPrefabs.push(t),t}))},n.prototype.preload=function(){var e=this,n=function(e){e&&(e.minFilter=t.LinearFilter);var n=new t.SpriteMaterial({map:e,color:new t.Color("white")});return n.blending=t.AdditiveBlending,n.depthTest=!1,n.depthWrite=!1,n};return Promise.all([Promise.all([this.baseLoadObject(this.resourcePath+"/models/JumpHead.dae"),this.baseLoadObject(this.resourcePath+"/models/JumpTail.dae")]).then((function(t){var n=t[0],i=t[1],r=c.default.getMaterialStartingWith(n.model,"Jump");for(var o in r){var a=s.default.makeJumpPointMaterial({map:r[o].map});c.default.replaceMaterial(n.model,o,a),a.name=o,e.timeAnimatedMaterials.push(a)}for(var o in r=c.default.getMaterialStartingWith(i.model,"Jump")){a=s.default.makeJumpPointMaterial({map:r[o].map});c.default.replaceMaterial(i.model,o,a),a.name=o,e.timeAnimatedMaterials.push(a)}e.jumpPointPrefabHead=n,e.jumpPointPrefabTail=i})),this.baseLoadObject(this.resourcePath+"/models/Blackhole.dae").then((function(t){return e.blackholePrefab=t})),this.baseLoadObject(this.resourcePath+"/models/SunGodRays.dae").then((function(t){d.default.setDepthWriteFalse(t.model),e.sunPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/Planet_Blue.dae").then((function(t){return e.planetBluePrefab=t})),this.baseLoadObject(this.resourcePath+"/models/Planet_Green.dae").then((function(t){return e.planetGreenPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/Planet_Brown.dae").then((function(t){return e.planetBrownPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/Planet_Gas.dae").then((function(t){return e.planetGasPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/SpaceStation.dae").then((function(t){return e.spaceStationPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/LandingZone.dae").then((function(t){return e.landingZone=new h.default(t)})),this.baseLoadObject(this.resourcePath+"/models/AsteroidsFRONT.dae").then((function(t){return e.asteriodsPrefabs[0]=t})),this.baseLoadObject(this.resourcePath+"/models/AsteroidsMIDDLE.dae").then((function(t){return e.asteriodsPrefabs[1]=t})),this.baseLoadObject(this.resourcePath+"/models/AsteroidsEND.dae").then((function(t){return e.asteriodsPrefabs[2]=t})),this.baseLoadObject(this.resourcePath+"/models/AsteroidsFAR.dae").then((function(t){return e.asteriodsFarPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/AsteroidField.dae").then((function(t){return e.asteriodFieldPrefab=t})),this.baseLoadObject(this.resourcePath+"/models/HoverGizmo.dae").then((function(t){return e.hoverGizmo=t})),this.baseLoadObject(this.resourcePath+"/models/PlanetRing.dae").then((function(t){return e.planetRingPrefab=t})),d.default.loadTexture(this.resourcePath+"/sourceimages/Chevrons32x32.png").then((function(t){return e.arrowMaterial=n(t)})),l.default.loadTextures(this.resourcePath)]).then((function(t){e.isReady=!0})).catch((function(t){return console.error(t.stack),null}))},n.prototype.start=function(){this.started=!0},n.prototype.lateUpdate=function(t,e){if(this.started){for(var n in this.starSystems){this.starSystems[n].update(this.camera,t,e)}if(this.timeAnimatedMaterials)for(var i=0,r=this.timeAnimatedMaterials;i<r.length;i++){r[i].uniforms.time.value=-t}}},n.prototype.onWindowResize=function(t,e){for(var n=0,i=this.allPrefabs;n<i.length;n++){var r=i[n];c.default.updateMaterialsResolution(r.model,t,e)}this.heatmap.resize(t,e)},n.prototype.addToGUI=function(t,e){var n=t.addFolder("System View");for(var i in this.heatmap.addToGUI(n),this.starSystems){var r=this.starSystems[i];r.isSetToDestroy||r.addToGUI(n,e)}},n.prototype.showRouting=function(t){for(var e in this.starSystems){this.starSystems[e].showRouting(t)}},n.prototype.makeStarSystem=function(t){var e=new o.default(this,t,this.camera,this.heatmap);return this.starSystems[e.obj3d.uuid]=e,e},n.prototype.destroyStarSystem=function(t){t.dispose(),delete this.starSystems[t.obj3d.uuid]},n.prototype.loadTexture=function(t){return this.loadedTextures[t]?this.loadedTextures[t]:this.loadedTextures[t]=this.sequentialLoading=this.sequentialLoading.then((function(){return d.default.loadTexture(t)}))},n.prototype.loadObject=function(t){var e=this;return this.loadedObjects[t]?this.loadedObjects[t]:this.loadedObjects[t]=this.sequentialLoading=this.sequentialLoading.then((function(){return e.baseLoadObject(t)}))},n.prototype.translateWorld=function(t){for(var e in this.starSystems)this.starSystems[e].translateWorld(t)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=f}).call(e,n(2))},function(t,e,n){(function(t){var i=n(79),r=n(84),o=n(56),a=n(49),s=n(85),l=n(45),c=n(46),u=n(61),h=n(58),d=n(26),f=function(){function e(e,n,r,l){var h=this;this.manager=e,this.mainStar=n,this.camera=r,this.heatmap=l,this.planetSizeMin=1/0,this.planetSizeMax=-1/0,this.bodiesById={},this.bodiesByCode={},this.bodyHovered=null,this.bodyHoveredSticky=!1,this.routesByUUID={},this.planetCount=0,this.timer=new o.default,this.orbitalGrid=null,this.celestialBodyGrid=null,this.isSetToDestroy=!1,this.maxDistance=1/0,this.initConfig={lightColor:"#ffffff",starfield:{radius:3,count:200,sizeMin:1,sizeMax:1,color1:"rgb(128,128,128)",color2:"rgb(100,100,100)"},planetsSize:{min:.03,max:.03,kFactor:1}},this.presenceRatio=0,this._pixelSizeOverZ=new t.Vector3,this._smoothTime=.1,this._vel={size:0},this.obj3d=new t.Group,this.obj3d.scale.set(.001,.001,.001),this.bodiesById={};var f=this.info.habitable_zone_inner,p=this.info.habitable_zone_outer;this.habitableZone=new t.Mesh(s.makeDiscGeometry(new t.Color(a.default.habitableZoneColor),[Math.max(0,d.default.lerp(f,p,-.16666)),d.default.lerp(f,p,.16666),d.default.lerp(f,p,.75),d.default.lerp(f,p,1.25)],[0,.7,.5,0]),s.makeAdditiveVertexColoredMaterial()),this.obj3d.add(this.habitableZone);var m=this.info.frost_line;this.frostZone=new t.Mesh(s.makeDiscGeometry(new t.Color(a.default.frostZoneColor),[m/1.06,m,2*m],[0,1,0]),s.makeAdditiveVertexColoredMaterial()),this.obj3d.add(this.frostZone),this.manager=e,this.camera=r;var v=n.obj3d.position,g=n.data.detail;g.shader_data=g.shader_data||{},this.config=new u.default(g.shader_data,"system",(function(){return h.galaxy.saveSystemConfig(g.code,g.shader_data)})),u.default.fleshConfig(this.config.data,this.initConfig);var y={},b=function(t){if(t.type===c.CelestialBodyType.PLANET)for(var e=0,n=g.celestial_objects;e<n.length;e++){var i=n[e];if(i.type===c.CelestialBodyType.ASTEROID_BELT&&i.parent_id===t.id)return i}return null};if(g.celestial_objects){for(var x=0,w=g.celestial_objects;x<w.length;x++){(k=w[x]).type===c.CelestialBodyType.PLANET&&(this.planetSizeMin=Math.min(this.planetSizeMin,k.size),this.planetSizeMax=Math.max(this.planetSizeMax,k.size))}for(var _=!0;_;){_=!1;for(var S=0,M=g.celestial_objects;S<M.length;S++){if(!y[(k=M[S]).id]&&(null===k.parent_id||y[k.parent_id])){var C=null===k.parent_id?null:y[k.parent_id];k.type===c.CelestialBodyType.ASTEROID_BELT&&C&&C.info.type===c.CelestialBodyType.PLANET||(y[k.id]=new i.default(this,k,b(k),C),_=!0)}}}this.maxDistance=0;for(var T=0,E=g.celestial_objects;T<E.length;T++){var k=E[T];this.maxDistance=Math.max(this.maxDistance,k.distance)}}this.obj3d.position.copy(v),this.obj3d.updateMatrixWorld(!0),e.starSystemsRoot.add(this.obj3d),this.init(y)}return e.prototype.setBodyHovered=function(t){this.bodyHoveredSticky||(this.bodyHovered=t)},Object.defineProperty(e.prototype,"info",{get:function(){return this.mainStar.data.detail},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"starfieldConfig",{get:function(){return this.config.data.starfield},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"planetsSize",{get:function(){return this.config.data.planetsSize},enumerable:!0,configurable:!0}),e.prototype.isUndiscovered=function(){return this.info.status!==c.StatusLabelEnum.published},e.prototype.computePlanetRadius=function(t){var e=this.planetsSize,n=this.planetSizeMin<this.planetSizeMax?(t-this.planetSizeMin)/(this.planetSizeMax-this.planetSizeMin):0,i=Math.pow(n,e.kFactor);return d.default.lerp(e.min,e.max,i)},e.prototype.computeCameraMaxDistance=function(t){var e=.5*t.fov*Math.PI/180,n=this.obj3d.scale.x*this.maxDistance/Math.tan(e);return 1.3*Math.max(.01,t.aspect<1?n/t.aspect:n)},Object.defineProperty(e.prototype,"hoverGizmo",{get:function(){return this.manager.hoverGizmo},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.bodiesById=t,this.bodiesByCode={};var e=[];for(var n in t){var i=t[n];this.bodiesByCode[i.code]=i,i.init(),i.isStar||i.isBelt||e.push(t[n]),i.isPlanet&&(this.planetCount+=1)}this.heatmap.createHeaters(this,e),this.makeStarfield(),this.showRouting(this.galaxy.routingSegments)},e.prototype.makeStarfield=function(){this.starfield&&this.starfield.dispose(),this.starfield=new h.default(this.obj3d,this.camera,new t.Vector3(0,0,0),this.starfieldConfig.radius,this.starfieldConfig.count,this.starfieldConfig.sizeMin,this.starfieldConfig.sizeMax,this.starfieldConfig.color1,this.starfieldConfig.color2)},e.prototype.getBody=function(t){var e=this.bodiesByCode[t];return e||console.log("Not a planetary code "+t),e},e.prototype.attachBodyRoute=function(t){this.manager.starSystemsRoot.add(t.obj3d),this.routesByUUID[t.uuid]=t},e.prototype.detachBodyRoute=function(t){this.manager.starSystemsRoot.remove(t.obj3d),delete this.routesByUUID[t.uuid]},e.prototype.dispose=function(){for(var t in this.habitableZone&&(this.habitableZone.geometry.dispose(),this.habitableZone.material.dispose()),this.frostZone&&(this.frostZone.geometry.dispose(),this.frostZone.material.dispose()),this.starfield.dispose(),l.default.foreach(this.bodiesById,(function(t){t.dispose()})),this.routesByUUID)this.routesByUUID[t].destroy();this.manager.starSystemsRoot.remove(this.obj3d)},e.prototype.initStar=function(t){this.mainStar=t},Object.defineProperty(e.prototype,"galaxy",{get:function(){return this.manager.galaxy},enumerable:!0,configurable:!0}),e.prototype.pickCelestialBody=function(t,e){var n=null,i=.1,r=this.bodiesById;for(var o in r){var a=r[o];if(!a.isBelt&&!a.isPoi){var s=a.distanceFromCursor(t,e);i>s&&(i=s,n=a)}}return n},e.prototype.hover=function(t){},e.prototype.update=function(t,e,n){for(var i in this.timer.update(e,n),this.bodiesById)this.bodiesById[i].update(this.camera,e,n);for(var r in this.heatmap&&this.heatmap.update(e,n),this.starfield&&(this.starfield.presenceRatio=this.presenceRatio,this.starfield.update(e,n)),this.routesByUUID)this.routesByUUID[r].update(t,e,n);return!0},e.prototype.setToDestroy=function(t){var e=this;this.isSetToDestroy=!0;var n=this.obj3d.scale.x;this.leftStarSystem(),this.timer.addPeriod(0,.3*t,(function(t){e.presenceRatio=(1-t)*(1-t)})),this.timer.addPeriod(0,t,(function(t){var i=n*(t+1e-5);e.obj3d.scale.set(i,i,i)}),(function(){e.manager.destroyStarSystem(e)}))},e.prototype.showLabel=function(t){for(var e in this.bodiesById)this.bodiesById[e].showLabel(t);for(var n in this.routesByUUID)this.routesByUUID[n].show(t)},e.prototype.showOrbitals=function(t,e){var n={},i=[];for(var r in this.bodiesById){var o=this.bodiesById[r];o.hasOrbital&&(n[o.distance]=o,i.push(o.distance))}i=i.sort((function(t,e){return t-e}));for(var a=0;a<i.length;a++)this.timer.add(t+e*a,function(t){return function(){return t.showOrbital(!0)}}(n[i[a]]));return i.length>0},Object.defineProperty(e.prototype,"pixelSizeOverZ",{get:function(){return this._pixelSizeOverZ.copy(this.manager.galaxy.pixelSizeOverZ),this._pixelSizeOverZ.multiplyScalar(1/this.obj3d.scale.x),this._pixelSizeOverZ},enumerable:!0,configurable:!0}),e.prototype.addToGUI=function(e,n){var i=this,r=e.addFolder("config");r.addColor(this.config.data,"lightColor").onChange((function(e){return i.galaxy.setLightColor(new t.Color(e))}));var o=r.addFolder("Stars");o.add(this.starfieldConfig,"radius").onChange((function(){i.makeStarfield()})),o.add(this.starfieldConfig,"count",0,5e3).onChange((function(){i.makeStarfield()})),o.add(this.starfieldConfig,"sizeMin",.1,5).onChange((function(){i.makeStarfield()})),o.add(this.starfieldConfig,"sizeMax",.1,5).onChange((function(){i.makeStarfield()})),o.addColor(this.starfieldConfig,"color1").onChange((function(){i.makeStarfield()})),o.addColor(this.starfieldConfig,"color2").onChange((function(){i.makeStarfield()}));var a=r.addFolder("Planets Size");for(var s in a.add(this.planetsSize,"min",.001,.1).onChange((function(){i.resetPlanetRadius()})),a.add(this.planetsSize,"max",.001,.1).onChange((function(){i.resetPlanetRadius()})),a.add(this.planetsSize,"kFactor",0,2).onChange((function(){i.resetPlanetRadius()})),r.add(this.config,"save"),this.bodiesById)this.bodiesById[s].addToGUI(e,n)},e.prototype.showRouting=function(t){for(var e in this.routesByUUID)this.routesByUUID[e].setToDestroy();var n=null;if(t)for(var i=0;i<t.length;i++){var o=t[i];if(n){var a=this.bodiesByCode[n.object_code],s=this.bodiesByCode[o.object_code];a&&s&&this.attachBodyRoute(new r.default(a,s,n,o))}n=o}},e.prototype.augmentTargetZoomToSeeRoute=function(t){for(var e in this.bodiesByCode){var n=this.bodiesByCode[e];n.isOnRoute&&t.augmentTargetZoomToSee(n.obj3d.getWorldPosition())}},e.prototype.resetPlanetRadius=function(){for(var t in this.bodiesById){var e=this.bodiesById[t];e.isPlanet&&(e.radius=this.computePlanetRadius(e.info.size),e.radiusChanged())}},e.prototype.recomputeDistanceAndPosition=function(){for(var t in this.bodiesById)this.bodiesById[t].computeDistanceAndPosition()},e.prototype.setPlanetaryStickyHovering=function(t){this.bodyHovered=this.bodiesByCode[t],this.bodyHoveredSticky=!0},e.prototype.releasePlanetaryStickyHovering=function(){this.bodyHoveredSticky=!1},e.prototype.forcePlanetaryHovered=function(t){var e=this.bodiesByCode[t];e?e.forceHovered=!0:console.log("'"+t+"' is not a body in the '"+this.info.code+"' system")},e.prototype.releasePlanetaryHovered=function(t){var e=this.bodiesByCode[t];e?e.forceHovered=!1:console.log("'"+t+"' is not a body in the '"+this.info.code+"' system")},e.prototype.setLandingZoneHighlight=function(t,e,n){var i=this.bodiesByCode[t];i?i.setLandingZoneHighlight(e,n):console.log("'"+t+"' is not a body in the '"+this.info.code+"' system")},e.prototype.beginIntersystem=function(){this.heatmap.beginIntersystem()},e.prototype.endIntersystem=function(){this.heatmap.endIntersystem()},e.prototype.leftStarSystem=function(){this.heatmap.leftStarSystem(),this.heatmap=null},e.prototype.translateWorld=function(t){for(var e in this.obj3d.position.add(t),this.routesByUUID)this.routesByUUID[e].translateWorld(t);for(var n in this.bodiesByCode)this.bodiesByCode[n].translateWorld(t);this.starfield&&this.starfield.translateWorld(t)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=f}).call(e,n(2))},function(t,e,n){(function(t){var i=n(64),r=n(48),o=n(22),a=n(80),s=n(81),l=n(51),c=n(49),u=n(50),h=n(26),d=n(32),f=n(46),p=n(61),m=n(63),v=n(82),g=n(83),y=function(t,e,n){this.detail=null,this.lrScanners=[],this.lrScanners[o.HeatmapEnum.lifeforms]=.1*t,this.lrScanners[o.HeatmapEnum.economy]=.1*e,this.lrScanners[o.HeatmapEnum.crime]=.1*n};e.CelestialBodyData=y;var b=function(){function e(e,n,i,r){var o=this;for(this.starSystem=e,this.info=n,this.ringInfo=i,this.parent=r,this.worldPosition=null,this.worldScale=0,this.sun=null,this.hoverGizmo=null,this.isOnRouteRatio=0,this.targetSize=new t.Vector3,this.labelBelow=null,this.labelBelowText=null,this.labelBelowAnchor=null,this.labelBelowIsOnTop=!1,this.labelUnderline=null,this.labelUnderlineLength=0,this.labelCallout=null,this.circleMeshRadius=0,this.orbitalStartShowingTime=0,this.rotatingBody=null,this.material=null,this.hasSatellites=!1,this.forceHovered=!1,this.landingZones={},this.showingLandingZones=!1,this.code=n.code,this.starSystem=e,this.sun=r;this.sun&&this.sun.parent;)this.sun=this.sun.parent;n.shader_data=n.shader_data||{},this.config=new p.default(n.shader_data,"body",(function(){return o.galaxy.saveBodyConfig(n.code,n.shader_data)})),this.config.data.orbitalMin=this.config.data.orbitalMin||1,this.config.data.orbitalMax=this.config.data.orbitalMax||5,this.config.data.orbitalFactor=this.config.data.orbitalFactor||1;var l=null;if(this.isStar)l=new v.default(n.name,[new m.default(n.name,"sun",this.config.subConfig("sun")),new g.default(this.manager.sunPrefab.clone())]);else if(this.isBlackHole)l=new s.default(n.name,this.config,this.manager.blackholePrefab);else if(this.isJumpPoint)l=new a.default(n.name,this.config,this.manager.jumpPointPrefabHead,this.manager.jumpPointPrefabTail);else if(this.isBelt)l=null;else if(this.isPoi)l=null;else{var h=n.appearance===f.CelestialBodyAppearance.PLANET_BLUE?this.manager.planetBluePrefab:n.appearance===f.CelestialBodyAppearance.PLANET_GREEN?this.manager.planetGreenPrefab:n.appearance===f.CelestialBodyAppearance.PLANET_BROWN?this.manager.planetBrownPrefab:n.appearance===f.CelestialBodyAppearance.PLANET_GAS?this.manager.planetGasPrefab:n.appearance===f.CelestialBodyAppearance.CUSTOM?null:this.isSpaceStation?this.manager.spaceStationPrefab:this.isAsteroidField?this.manager.asteriodFieldPrefab:this.info.habitable?this.manager.planetBluePrefab:this.manager.planetGreenPrefab;this.rotatingBody=h?new v.default(n.name,[h.clone()]):new v.default(n.name,[]);var b=[this.rotatingBody];if(i){var x=new v.default("ring",[new m.default(n.name,"ring",this.config.subConfig("ring"))]),w=i.latitude*Math.PI/180,_=-i.longitude*Math.PI/180,S=Math.sin(w),M=Math.cos(w),C=Math.sin(_),T=Math.cos(_);x.model.quaternion.multiply((new t.Quaternion).setFromUnitVectors(new t.Vector3(T,0,C),new t.Vector3(M*T,S,M*C))),b.push(x)}(l=new v.default(n.name,b)).model.rotateZ((n.axial_tilt||0)*Math.PI/180),(this.isPlanet||this.isMoon)&&(l=new v.default(n.name,[l,new m.default(n.name,"highlight",this.config.subConfig("highlight"),this.sun?this.sun.obj3d:null)]))}if(l&&(l.model.name=n.name),this.isMoon,this.radius=this.config.data.radius||this.defaultRadius,this.obj=l,this.data=new y(n.sensor_population,n.sensor_economy,n.sensor_danger),this.data.affiliationCode=n.affiliation&&n.affiliation[0]&&n.affiliation[0].code||"NONE",this.obj3d=new t.Group,this.computeDistanceAndPosition(),this.obj?(this.objs=[l],this.obj3d.add(this.obj.model)):this.objs=[],this.radiusChanged(),this.labelOrient=new t.Group,this.obj3d.add(this.labelOrient),this.info.show_label)if(this.isPoi)this.labelAnchor=new t.Group,this.labelOrient.add(this.labelAnchor),this.label=this.createLabel(n.name.toLocaleUpperCase(),c.default.labelPoiColor.getStyle(),13,.5,.5),this.labelAnchor.add(this.label),this.labelUnderlineLength=this.label.scale.x+10,this.labelUnderline=new t.Mesh(d.default.makeLineGeometry([new t.Vector3(0,0,0),new t.Vector3(this.labelUnderlineLength,0,0)]),d.default.makeThinline2DMaterial({color:c.default.trianglePoiColor})),this.labelAnchor.add(this.labelUnderline);else{this.labelAnchor=new t.Group,this.labelOrient.add(this.labelAnchor);var E=this.isSpaceStation?1:0,k=this.isSpaceStation?.5:-.5;this.label=this.createLabel((n.name||n.designation||n.code).toLocaleUpperCase(),c.default.labelColor,13,k,E+.5),this.labelAnchor.add(this.label);var A=u.default[f.CelestialBodyType[n.type]]||f.CelestialBodyType[n.type];this.labeltype=this.createLabel(A.toLocaleUpperCase(),c.default.sublabelColor,12,k,E-.5),this.labelAnchor.add(this.labeltype),this.isSpaceStation&&(this.labelUnderlineLength=Math.max(this.labeltype.scale.x,this.label.scale.x),this.labelUnderline=new t.Mesh(d.default.makeLineGeometry([new t.Vector3(-10,0,0),new t.Vector3(this.labelUnderlineLength,0,0)]),d.default.makeThinline2DMaterial({color:c.default.hexagoneSpaceStationColor})),this.labelAnchor.add(this.labelUnderline))}else this.label=this.labeltype=null,this.labelAnchor=null;this.circleMaterialBaseColor=this.isSpaceStation?c.default.hexagoneSpaceStationColor:this.isPoi?c.default.trianglePoiColor:c.default.circleSelectedColor,this.circleMaterialRouteColor=c.default.circleSelectedRouteColor,this.circleMaterial=d.default.makeThinline2DMaterial({color:this.circleMaterialBaseColor});var P=null;if(this.isPoi){var L=Math.cos(60*Math.PI/180),O=Math.sin(60*Math.PI/180),R=.5,F=new t.Vector3(0,1,0),B=new t.Vector3(O,-L,0),D=new t.Vector3(-O,-L,0),I=F.clone().multiplyScalar(R),N=B.clone().multiplyScalar(R),j=D.clone().multiplyScalar(R);P=d.default.makeLineGeometry([F,B,B,D,D,F,I,N,N,j,j,I])}else if(this.isSpaceStation){L=Math.cos(30*Math.PI/180),O=Math.sin(30*Math.PI/180),R=.5,I=(F=[new t.Vector3(O,L,0),new t.Vector3(1,0,0),new t.Vector3(O,-L,0),new t.Vector3(-O,-L,0),new t.Vector3(-1,0,0),new t.Vector3(-O,L,0)]).map((function(t){return t.clone().multiplyScalar(R)}));for(var V=[],z=0;6>z;z++)V.push(F[z]),V.push(5>z?F[z+1]:F[0]),V.push(I[z]),V.push(5>z?I[z+1]:I[0]);P=d.default.makeLineGeometry(V)}else P=d.default.makeCircleGeometry(1,this.isSpaceStation?6:64);this.circleMesh=new t.Mesh(P,this.circleMaterial),this.labelOrient.add(this.circleMesh),this.circleMesh.visible=!1,this.isSpaceStation?(this.labelCallout=new t.Mesh(d.default.makeLineGeometry([new t.Vector3(0,0,0),new t.Vector3(-1.2,.8,0)]),d.default.makeThinline2DMaterial({color:c.default.hexagoneSpaceStationColor})),this.labelOrient.add(this.labelCallout)):this.isPoi&&(this.labelCallout=new t.Mesh(d.default.makeLineGeometry([new t.Vector3(0,0,0),new t.Vector3(1.2,.8,0)]),d.default.makeThinline2DMaterial({color:c.default.trianglePoiColor})),this.labelOrient.add(this.labelCallout)),r?r.obj3d.add(this.obj3d):e.obj3d.add(this.obj3d),this.showLabel(!1)}return Object.defineProperty(e.prototype,"isStar",{get:function(){return this.info.type===f.CelestialBodyType.STAR},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBelt",{get:function(){return this.info.type===f.CelestialBodyType.ASTEROID_BELT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlanet",{get:function(){return this.info.type===f.CelestialBodyType.PLANET},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isJumpPoint",{get:function(){return this.info.type===f.CelestialBodyType.JUMPPOINT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMoon",{get:function(){return this.info.type===f.CelestialBodyType.SATELLITE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpaceStation",{get:function(){return this.info.type===f.CelestialBodyType.MANMADE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAsteroidField",{get:function(){return this.info.type===f.CelestialBodyType.ASTEROID_FIELD},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBlackHole",{get:function(){return this.info.type===f.CelestialBodyType.BLACKHOLE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPoi",{get:function(){return this.info.type===f.CelestialBodyType.POI},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOnRoute",{get:function(){return!!this.galaxy.highlightedObject[this.code]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"routeSegment",{get:function(){return this.galaxy.highlightedObject[this.code]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orbitalMin",{get:function(){return this.config.data.orbitalMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orbitalMax",{get:function(){return this.config.data.orbitalMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orbitalFactor",{get:function(){return this.config.data.orbitalFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hovered",{get:function(){return this.forceHovered||this.starSystem.bodyHovered===this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"manager",{get:function(){return this.starSystem.manager},enumerable:!0,configurable:!0}),e.prototype.computeDistanceAndPosition=function(){if(this.parent&&this.parent!=this.sun){this.parent.hasSatellites=!0;var e=this.parent.orbitalMin,n=this.parent.orbitalMax,i=this.parent.orbitalFactor,r=(n-e-i)/i,o=e*(1+r)-n,a=Math.max(1,this.info.distance/(this.parent.info.size/1496e5)),s=(n*a+o)/(a+r);this.distance=s*this.parent.radius}else this.distance=this.info.distance;var l=this.info.latitude*Math.PI/180,u=-this.info.longitude*Math.PI/180,h=Math.sin(l),f=Math.cos(l),p=Math.sin(u),m=Math.cos(u);this.obj3d.position.set(f*m*this.distance,h*this.distance,f*p*this.distance),this.info.show_orbitlines?(this.orbitalMesh&&(this.obj3d.remove(this.orbitalMesh),this.orbitalMesh.geometry.dispose(),this.orbitalMesh.material.dispose(),this.orbitalMesh=null),this.config.data.orbitalColor=this.config.data.orbitalColor||c.default.circleSelectedColor.getStyle(),this.config.data.orbitalHighlightColor=this.config.data.orbitalHighlightColor||"rgb(128,128,255)",this.orbitalColor=new t.Color(this.config.data.orbitalColor),this.orbitalHighlightColor=new t.Color(this.config.data.orbitalHighlightColor),this.orbitalMaterial=d.default.makeThinline2DAdditiveMaterial({color:this.config.data.orbitalColor}),this.orbitalMesh=new t.Mesh(d.default.makeCircleGeometry(this.distance,64),this.orbitalMaterial),this.orbitalMesh.position.copy(this.obj3d.position),this.orbitalMesh.position.multiplyScalar(-1),this.orbitalMesh.quaternion.multiply((new t.Quaternion).setFromUnitVectors(new t.Vector3(m,0,p),new t.Vector3(f*m,h,f*p))),this.orbitalMesh.rotateX(.5*Math.PI),this.obj3d.add(this.orbitalMesh),this.showOrbital(!1)):this.orbitalMesh=null},e.prototype.init=function(){this.isJumpPoint&&this.obj instanceof a.default&&this.otherStar&&this.obj.orientTail(this.star.obj3d.getWorldPosition(),this.otherStar.obj3d.getWorldPosition());this.worldPosition=this.obj3d.getWorldPosition(),this.worldScale=this.obj3d.getWorldScale().x,this.additionalLoads()},e.prototype.loadTexture=function(){var t=this;this.info.texture&&this.info.texture.source&&this.manager.loadTexture(this.info.texture.source).then((function(e){var n=d.default.getMaterial(t.rotatingBody.model,"AdditiveTexture");n?(t.material=n.clone(),t.material.map=e,d.default.replaceMaterial(t.rotatingBody.model,"AdditiveTexture",t.material)):console.warn('Expecting a material called "AdditiveTexture" on object '+t.code)})).catch((function(t){return console.log(t)}))},e.prototype.loadObject=function(){var t=this;this.info.model&&this.info.model.source&&this.manager.loadObject(this.info.model.source).then((function(e){t.rotatingBody.push(e.clone())})).then((function(){return t.loadTexture()}))},e.prototype.loadDetail=function(){var t=this;return this.data.detail?new Promise((function(e,n){return e(t.data.detail)})):this.galaxy.getJSON("/celestial-objects/"+this.code).then((function(e){return t.data.detail=f.cleanCelestialBodyResponse(e)}))},e.prototype.showLandingZone=function(){var t=this;this.showingLandingZones||(this.showingLandingZones=!0,this.loadDetail().then((function(){for(var e=0,n=t.data.detail.children;e<n.length;e++){var i=n[e];if(i.type===f.CelestialBodyType.LZ){var r=t.manager.landingZone.clone().setInfo(i);t.landingZones[i.code]=r,t.rotatingBody.push(r)}}})))},e.prototype.setLandingZoneHighlight=function(t,e){var n=this.landingZones[t];n?e?n.setHighlight():n.releaseHighlight():console.log("'"+t+"' is not a landing zone on '"+this.code+"'")},Object.defineProperty(e.prototype,"landingZoneWithHighlight",{get:function(){for(var t in this.landingZones){var e=this.landingZones[t];if(e.hasHighlight)return e}return null},enumerable:!0,configurable:!0}),e.prototype.additionalLoads=function(){this.info.appearance===f.CelestialBodyAppearance.CUSTOM?this.loadObject():this.loadTexture()},Object.defineProperty(e.prototype,"worldRadius",{get:function(){return this.worldScale*this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"star",{get:function(){return this.starSystem.mainStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherStar",{get:function(){return this.galaxy.jumpPointOtherEnd[this.info.code]},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.circleMesh&&(this.circleMesh.geometry.dispose(),this.circleMesh.material.dispose()),this.orbitalMesh&&(this.orbitalMesh.geometry.dispose(),this.orbitalMesh.material.dispose()),this.label&&(this.label.material.map.dispose(),this.label.material.dispose()),this.labeltype&&(this.labeltype.material.map.dispose(),this.labeltype.material.dispose()),this.labelUnderline&&(this.labelUnderline.geometry.dispose(),this.labelUnderline.material.dispose()),this.labelCallout&&(this.labelCallout.geometry.dispose(),this.labelCallout.material.dispose()),this.disposeLabelBelow();for(var t=0,e=this.objs;t<e.length;t++){e[t].dispose()}this.hoverGizmo&&this.hoverGizmo.dispose(),this.material&&this.material.dispose()},e.prototype.createLabel=function(e,n,i,r,o){var a=l.createLabelTexture(e,{color:n,fontsize:i,quality:window.devicePixelRatio||1}),s=new t.SpriteMaterial({map:a,color:new t.Color("rgb(255,255,255)")});s.blending=t.AdditiveBlending,s.depthTest=!1,s.depthWrite=!1;var c=new t.Sprite(s);return c.scale.set(a.size.x,a.size.y,1),c.position.set(r*a.size.x,o*a.size.y,0),c},e.prototype.rebuildAsteroidBelt=function(){if(this.objs)for(var e=0,n=this.objs;e<n.length;e++){var i=n[e];this.obj3d.remove(i.model),i.dispose()}var r=this.config.data.fullturn=void 0===this.config.data.fullturn?1:this.config.data.fullturn,o=this.info.latitude*Math.PI/180,a=-this.info.longitude*Math.PI/180,s=Math.sin(o),l=Math.cos(o),c=Math.sin(a),u=Math.cos(a),h=this.manager.asteriodsPrefabs,d=(new t.Quaternion).setFromUnitVectors(new t.Vector3(1,0,0),new t.Vector3(l*u,s,l*c)),f=new t.Vector3(s*u,-l,s*c),p=3*this.radius,m=Math.floor(2*Math.PI*(this.distance+0)/p);p=2*Math.PI*(this.distance+0)/m,m>100&&(h=[this.manager.asteriodsFarPrefab,this.manager.asteriodsFarPrefab,this.manager.asteriodsFarPrefab]);var v=(new t.Quaternion).setFromAxisAngle(f,.5*-p/(this.distance+0)),g=this.obj3d.position.clone().multiplyScalar(0/this.distance);this.objs=[h[0].clone()];for(var y=Math.floor(r*m),b=2;y>b;b++)this.objs.push(h[Math.floor(3*Math.random())].clone());this.objs.push(h[2].clone()),this.obj=this.objs[0];for(var x=0,w=this.objs;x<w.length;x++){var _=w[x];_.model.scale.set(this.radius,this.radius,this.radius),_.model.position.copy(g),_.model.rotation.setFromQuaternion(d),d.multiply(v),g.add(new t.Vector3(0,0,-p).applyQuaternion(d)),d.multiply(v),this.obj3d.add(_.model)}},Object.defineProperty(e.prototype,"defaultRadius",{get:function(){return this.isPlanet?this.starSystem.computePlanetRadius(this.info.size):this.isStar||this.isBlackHole?.1:Math.min(.5,(this.info.size||1)*(this.isMoon||this.isSpaceStation?.01:this.isJumpPoint?.03:this.isBelt?.1:.03))},enumerable:!0,configurable:!0}),e.prototype.radiusChanged=function(){this.info.type===f.CelestialBodyType.ASTEROID_BELT?this.rebuildAsteroidBelt():this.obj&&this.obj.model.scale.set(this.radius,this.radius,this.radius)},e.prototype.setCircleMeshRadius=function(t){this.circleMeshRadius=t,this.labelAnchor&&(this.isSpaceStation?this.labelAnchor.position.set(-this.labelUnderlineLength-1.2*t,.8*t,0):this.isPoi?this.labelAnchor.position.set(1.2*t,.8*t,0):this.labelAnchor.position.set(-10-1.2*t,0,0)),this.labelBelowAnchor&&(this.labelBelowIsOnTop?this.labelBelowAnchor.position.set(0,10+1.2*t,0):this.labelBelowAnchor.position.set(0,-10-1.2*t,0)),this.circleMesh.scale.set(t,t,t),this.labelCallout&&this.labelCallout.scale.set(t,t,t)},e.prototype.update=function(t,e,n){for(var i=0,o=this.objs;i<o.length;i++){o[i].update(t,e,n)}this.labelOrient&&this.labelOrient.rotation.copy(t.rotation);var a=this.worldPosition.clone();t.worldToLocal(a);var s=-a.z;this.targetSize.copy(this.starSystem.pixelSizeOverZ),this.targetSize.multiplyScalar(s);var l=this.targetSize;this.isOnRouteRatio=h.default.gotoValue(this.isOnRouteRatio,this.isOnRoute?1:0,2*n);var c=this.circleMaterial.uniforms.color.value;c.copy(this.circleMaterialBaseColor),c.lerp(this.circleMaterialRouteColor,this.isOnRouteRatio);var d=this.radius/l.x,f=this.isMoon||this.isBelt?0:5>d||this.isSpaceStation||this.isPoi?1:h.default.clamp01(1-(d-5)/5);if(this.circleMaterial.uniforms.intensity.value=h.default.lerp(f,1,this.isOnRouteRatio),this.circleMesh.visible=0!==this.isOnRouteRatio||!this.isMoon&&!this.isBelt,(this.isPoi||this.isSpaceStation)&&this.circleMesh.rotation.set(0,3*e,0),this.setCircleMeshRadius(this.isPoi?20:Math.max(1.2*d,20)),this.orbitalMaterial){var p=h.default.clamp01((e-this.orbitalStartShowingTime)/.3),m=2*Math.sin(Math.PI*p)+.8*p;this.orbitalMaterial.uniforms.color.value=this.orbitalHighlightColor.clone().lerp(this.orbitalColor,1>m?1:1-(m-1)/1.5),this.orbitalMaterial.uniforms.intensity.value=m*this.starSystem.presenceRatio}return this.labelOrient&&(l.x!=this.labelOrient.scale.x||l.y!=this.labelOrient.scale.y||l.z!=this.labelOrient.scale.z)&&this.labelOrient.scale.set(l.x,l.y,l.z),this.isSpaceStation&&(this.labelAnchor&&(this.labelAnchor.visible=this.hovered),this.labelCallout&&(this.labelCallout.visible=this.hovered)),this.hovered&&!this.hoverGizmo?(this.hoverGizmo=this.starSystem.hoverGizmo.clone(),this.hoverGizmo.model.scale.multiplyScalar(1.5*this.radius),this.obj3d.add(this.hoverGizmo.model)):!this.hovered&&this.hoverGizmo&&(this.obj3d.remove(this.hoverGizmo.model),this.hoverGizmo.dispose(),this.hoverGizmo=null),this.hoverGizmo&&this.hoverGizmo.update(t,e,n),this.rotatingBody&&(this.isPlanet||this.isMoon)&&this.rotatingBody.model.rotateY(.02*n*2*Math.PI),this.isOnRoute?this.routeSegment.is_departure?this.createLabelBelow(u.default.DEPARTURE):this.routeSegment.is_destination&&this.createLabelBelow(u.default.DESTINATION):0===this.isOnRouteRatio&&this.disposeLabelBelow(),this.labelBelow&&this.labelBelow.material.color.set(r.default.white).multiplyScalar(this.isOnRouteRatio),!0},e.prototype.createLabelBelow=function(e){this.labelBelow&&this.labelBelowText!==e&&this.disposeLabelBelow(),this.labelBelowAnchor||(this.labelBelowAnchor=new t.Group,this.labelOrient.add(this.labelBelowAnchor)),this.labelBelow||(this.labelBelow=this.createLabel(e,c.default.circleSelectedRouteColor.getStyle(),13,0,0),this.labelBelowAnchor.add(this.labelBelow))},e.prototype.disposeLabelBelow=function(){this.labelBelow&&(this.labelBelowAnchor.remove(this.labelBelow),this.labelBelow.material.map.dispose(),this.labelBelow.material.dispose(),this.labelBelow=null)},e.prototype.distanceFromCursor=function(e,n){var i=(new t.Vector3).copy(this.worldPosition).project(n),r=(new t.Vector3).copy(this.worldPosition).add(new t.Vector3(0,this.worldRadius,0).applyQuaternion(n.quaternion)).project(n),o=Math.abs(r.y-i.y),a=new t.Vector2(n.aspect*(i.x-e.x),i.y-e.y);return Math.max(a.length()-o,0)},Object.defineProperty(e.prototype,"galaxy",{get:function(){return this.starSystem.manager.galaxy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasOrbital",{get:function(){return null!==this.orbitalMesh},enumerable:!0,configurable:!0}),e.prototype.addToGUI=function(t,e){var n=this,i=t.addFolder(this.info.code);this.isPlanet||(i.add(this,"radius").onChange((function(t){t>0&&(n.config.data.radius=t),n.radiusChanged()})),i.add({resetRadius:function(){n.radius=n.defaultRadius,delete n.config.data.radius,n.radiusChanged(),e()}},"resetRadius")),this.isBelt&&i.add(this.config.data,"fullturn",0,1).onChange((function(){return n.rebuildAsteroidBelt()})),this.hasSatellites&&(i.add(this.config.data,"orbitalMin",1,3).onChange((function(){return n.starSystem.recomputeDistanceAndPosition()})),i.add(this.config.data,"orbitalMax",2,10).onChange((function(){return n.starSystem.recomputeDistanceAndPosition()})),i.add(this.config.data,"orbitalFactor",1,10).onChange((function(){return n.starSystem.recomputeDistanceAndPosition()}))),this.info.show_orbitlines&&(i.addColor(this.config.data,"orbitalColor").onChange((function(t){return n.orbitalColor.set(t)})),i.addColor(this.config.data,"orbitalHighlightColor").onChange((function(t){return n.orbitalHighlightColor.set(t)})),i.add({resetOrbitalColors:function(){n.orbitalColor.set(n.config.data.orbitalColor=c.default.circleSelectedColor),n.orbitalHighlightColor.set(n.config.data.orbitalHighlightColor="rnd(128,128,255)")}},"resetOrbitalColors"));for(var r=0,o=this.objs;r<o.length;r++){var a=o[r];a.addToGUI&&a.addToGUI(i,e)}i.add(this.config,"save")},e.prototype.lrScannerStrength=function(t){return this.data.lrScanners[t||0]},e.prototype.showOrbital=function(t){this.orbitalMesh.visible=t,t&&(this.orbitalStartShowingTime=i.time)},e.prototype.showLabel=function(t){this.labelOrient.visible=t},Object.defineProperty(e.prototype,"jumpPoint",{get:function(){return this.obj instanceof a.default?this.obj:null},enumerable:!0,configurable:!0}),e.prototype.translateWorld=function(t){this.worldPosition.add(t)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=b}).call(e,n(2))},function(t,e,n){(function(t){var i=n(63),r=function(){function e(e,n,r,o){this.name=e,this.config=n,this.updateRotation=!0,this.model=new t.Group,this.model.name="JumpPoint",this.fragObj=new i.default(e,"jumppoint",this.config.subConfig("jumppoint")),this.model.add(this.fragObj.model),this.headBase=new t.Group,this.model.add(this.headBase),this.head=r.clone(),this.tail=o.clone(),this.headBase.add(this.head.model),this.model.add(this.tail.model)}return e.prototype.update=function(t,e,n){this.updateRotation&&this.headBase.rotation.copy(t.rotation),this.fragObj.update(t,e,n),this.head.update(t,e,n),this.tail.update(t,e,n)},e.prototype.orientTail=function(e,n){var i=new t.Matrix4;i.lookAt(e,n,new t.Vector3(0,1,0)),this.tail.model.quaternion.setFromRotationMatrix(i),this.tail.model.updateMatrix()},e.prototype.addToGUI=function(t,e){this.fragObj.addToGUI(t,e)},e.prototype.dispose=function(){this.head.dispose(),this.tail.dispose(),this.fragObj.dispose()},e.prototype.clone=function(){return new e(this.name,this.config,this.head,this.tail)},Object.defineProperty(e.prototype,"power",{get:function(){return this.fragObj.material.uniforms.power.value},set:function(t){this.fragObj.material.uniforms.power.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.fragObj.material.uniforms.alpha.value},set:function(t){this.fragObj.material.uniforms.alpha.value=t},enumerable:!0,configurable:!0}),e.prototype.removeDepthWrite=function(){this.fragObj.material.depthWrite=!1,this.head.model.visible=!1,this.tail.model.visible=!1},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e,n){(function(t){var i=n(63),r=function(){function e(e,n,r){this.name=e,this.config=n,this.base=r,this.model=new t.Group,this.model.name="Blackhole",this.obj=new i.default(e,"blackhole",this.config.subConfig("blackhole")),this.model.add(this.obj.model)}return e.prototype.update=function(t,e,n){this.obj.update(t,e,n)},e.prototype.addToGUI=function(t,e){this.obj.addToGUI(t,e)},e.prototype.dispose=function(){this.obj.dispose()},e.prototype.clone=function(){return new e(this.name,this.config,this.base)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e,n){(function(t){var n=function(){function e(e,n){this.name=e,this.objs=n,this.model=new t.Group,this.model.name=e;for(var i=0;i<n.length;i++){var r=n[i];this.model.add(r.model)}}return e.prototype.push=function(t){this.objs.push(t),this.model.add(t.model)},e.prototype.update=function(t,e,n){for(var i=0,r=this.objs;i<r.length;i++){r[i].update(t,e,n)}},e.prototype.dispose=function(){for(var t=0,e=this.objs;t<e.length;t++){e[t].dispose()}},e.prototype.addToGUI=function(t,e){for(var n=0,i=this.objs;n<i.length;n++){var r=i[n];r.addToGUI&&r.addToGUI(t,e)}},e.prototype.clone=function(){return new e(this.name,this.objs.map((function(t){return t.clone()})))},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}).call(e,n(2))},function(t,e){var n=function(){function t(t){this.obj=t}return Object.defineProperty(t.prototype,"model",{get:function(){return this.obj.model},enumerable:!0,configurable:!0}),t.prototype.update=function(t,e,n){this.obj.model.rotation.copy(t.rotation),this.obj.update(t,e,n)},t.prototype.dispose=function(){this.obj.dispose()},t.prototype.addToGUI=function(t){this.obj.addToGUI&&this.obj.addToGUI(t)},t.prototype.clone=function(){return new t(this.obj.clone())},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){(function(t){var i=n(49),r=n(26),o=n(32),a=n(51),s=function(){function e(e,n,r,a){this.bodyA=e,this.bodyB=n,this.infoA=r,this.infoB=a,this.toDestroy=!1,this.intensity=0,this.starSystem=e.starSystem,this.material=o.default.makeThinline2DBeginEndMaterial({color:i.default.circleSelectedRouteColor}),this.pointA=e.obj3d.getWorldPosition().clone(),this.pointB=n.obj3d.getWorldPosition().clone();var s=this.pointA.clone().add(this.pointB).multiplyScalar(.5);this.geometry=o.default.makeLineGeometry([this.pointA.clone().sub(s),this.pointB.clone().sub(s)]),this.mesh=new t.Mesh(this.geometry,this.material),this.mesh.position.copy(s),this.obj3d=new t.Group,this.obj3d.add(this.mesh);this.arrows=[];for(var l=0;3>l;l++){var c=new t.Sprite(this.manager.arrowMaterial.clone());c.material.color.set(i.default.circleSelectedRouteColor),c.visible=!1,this.arrows.push(c),this.obj3d.add(c)}this.labelAnchor=new t.Group,this.obj3d.add(this.labelAnchor),this.label=this.createLabel(r.segment_distance.toFixed(2)+" AU",i.default.circleSelectedRouteColor.getStyle(),12,-10,0,-.5,0),this.labelAnchor.add(this.label)}return Object.defineProperty(e.prototype,"uuid",{get:function(){return this.obj3d.uuid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"manager",{get:function(){return this.starSystem.manager},enumerable:!0,configurable:!0}),e.prototype.setToDestroy=function(){this.toDestroy=!0},Object.defineProperty(e.prototype,"galaxy",{get:function(){return this.starSystem.galaxy},enumerable:!0,configurable:!0}),e.prototype.update=function(e,n,i){var o=this.pointA.clone().project(e),a=new t.Vector2(o.x*e.aspect,o.y),s=this.pointB.clone().project(e),l=new t.Vector2(s.x*e.aspect,s.y),c=this.pointA.clone(),u=this.pointB.clone();e.worldToLocal(c),e.worldToLocal(u);var h=this.pointA.clone().lerp(this.pointB,c.z/(c.z+u.z)),d=h.clone();e.worldToLocal(d),this.labelAnchor.position.copy(h),this.labelAnchor.scale.copy(this.galaxy.pixelSizeOverZ),this.labelAnchor.scale.multiplyScalar(-d.z),this.labelAnchor.rotation.copy(e.rotation);var f=l.clone().sub(a),p=.5*a.distanceTo(l)*this.galaxy.window.innerHeight;this.intensity=r.default.gotoValue(this.intensity,this.toDestroy?0:1,2*i),this.material.uniforms.intensity.value=this.intensity,this.material.uniforms.length.value=p;var m=this.bodyA.circleMeshRadius,v=this.bodyB.circleMeshRadius;this.material.uniforms.begin.value=.85*m,this.material.uniforms.end.value=.85*v,this.toDestroy&&0===this.intensity&&this.destroy();for(var g=Math.atan2(f.y,f.x),y=0,b=0,x=this.arrows;b<x.length;b++){var w=x[b],_=.25*n,S=(_-Math.floor(_)+y)/this.arrows.length,M=w.position.copy(this.pointA).lerp(this.pointB,S*c.z/((1-S)*u.z+S*c.z)),C=(new t.Vector3).copy(M);e.worldToLocal(C);var T=-C.z;w.scale.copy(this.galaxy.pixelSizeOverZ),w.scale.multiplyScalar(20*T),w.visible=S*p>m&&p-v>S*p,w.material.rotation=g,y++}},e.prototype.show=function(t){this.obj3d.visible=t},e.prototype.destroy=function(){this.starSystem.detachBodyRoute(this),this.geometry.dispose(),this.material.dispose(),this.label.material.map.dispose(),this.label.material.dispose();for(var t=0,e=this.arrows;t<e.length;t++){e[t].material.dispose()}},e.prototype.createLabel=function(e,n,i,r,o,s,l){var c=a.createLabelTexture(e,{color:n,fontsize:i,quality:window.devicePixelRatio||1}),u=new t.SpriteMaterial({map:c,color:new t.Color("rgb(255,255,255)")});u.blending=t.AdditiveBlending,u.depthTest=!1,u.depthWrite=!1;var h=new t.Sprite(u);return h.scale.set(c.size.x,c.size.y,1),h.position.set(r+s*c.size.x,o+l*c.size.y,0),h},e.prototype.translateWorld=function(t){this.mesh.position.add(t),this.pointA.add(t),this.pointB.add(t)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s}).call(e,n(2))},function(t,e,n){(function(t){e.makeDiscGeometry=function(e,n,i,r){void 0===r&&(r=128);for(var o=new t.BufferGeometry,a=n.length*r,s=2*(n.length-1)*r,l=new Float32Array(3*a),c=new Float32Array(3*a),u=new Uint16Array(3*s),h=0;h<n.length;h++)for(var d=h*r,f=n[h],p=e.clone().multiplyScalar(i[h]),m=0;r>m;m++){var v=3*(d+m),g=2*Math.PI*m/r;l[v]=f*Math.cos(g),l[v+1]=0,l[v+2]=f*Math.sin(g),c[v]=p.r,c[v+1]=p.g,c[v+2]=p.b}for(h=0;h<n.length-1;h++){var y=(d=h*r)+r-1,b=d;u[x=6*d]=y,u[x+1]=y+r,u[x+2]=b+r,u[x+3]=y,u[x+4]=b+r,u[x+5]=b;for(m=1;r>m;m++){var x;b=(y=d+m-1)+1;u[x=6*(d+m)]=y,u[x+1]=y+r,u[x+2]=b+r,u[x+3]=y,u[x+4]=b+r,u[x+5]=b}}return o.addAttribute("position",new t.BufferAttribute(l,3)),o.addAttribute("color",new t.BufferAttribute(c,3)),o.addAttribute("index",new t.BufferAttribute(u,3)),o};var n=["attribute vec3 color;","varying vec3 vColor;","varying float vAlpha;","void main() {","\tfloat d = 6.0 * (uv.y - 0.5);","\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * wpos;","\tvAlpha = 1.0; //max(color.r, max(color.g, color.b));","\tvColor = color; //(1.0/vAlpha)*color;","}"].join("\n"),i=["varying vec3 vColor;","varying float vAlpha;","void main() {","\tgl_FragColor = vec4(vColor.rgb, vAlpha);","}"].join("\n");e.makeAdditiveVertexColoredMaterial=function(){var e=new t.ShaderMaterial({vertexShader:n,fragmentShader:i});return e.transparent=!0,e.blending=t.AdditiveBlending,e.depthTest=!1,e.side=t.DoubleSide,e}}).call(e,n(2))},function(t,e,n){(function(t){var i,r,o=n(56),a=n(26),s=n(22),l=n(52),c=n(64);!function(t){t[t.enteringSystem=0]="enteringSystem",t[t.leavingSystem=1]="leavingSystem",t[t.inSystem=2]="inSystem"}(i||(i={})),function(t){t[t.faction=0]="faction",t[t.longRange=1]="longRange",t[t.none=2]="none"}(r||(r={}));var u=function(){function e(e,n,i,a,s){var l=this;this.controlAPI=e,this.width=n,this.height=i,this.camera=a,this.renderer=s,this._heaters=null,this._heatTexture=null,this._bodies=null,this._starSystem=null,this.timer=new o.default,this.lastShow=!1,this._content=r.none,this._previousContent=r.none,this.showFactions=!1,this.showLRScanner=!1,this.curvature=1,this.density=20,this._scene=new t.Scene,this.createHeaterMaterial(),this.createHeatTextureMaterial(),this.createMeshHeatTexture(n,i),e.addEventListener("updateSelection",(function(t){return l.updateSelection()}))}return e.prototype.disposeOfHeaters=function(){if(this._heaters)for(var e=0,n=this._heaters;e<n.length;e++){var i=n[e];this._scene.remove(i),i instanceof t.PointCloud&&i.geometry.dispose()}this._heaters=null,this._bodies=null,this._starSystem=null},e.prototype.createHeaters=function(e,n){var o=e.obj3d.getWorldPosition();this.disposeOfHeaters(),this._bodies=n,this._starSystem=e;for(var l=[],c=0;c<n.length;c++){(_=n[c]).isMoon||l.push(_)}var u=n.length,h=l.length,d=u+this.density*h*(h-1),f=new Float32Array(3*d),p=new Float32Array(d),m=new Float32Array(d),v=new Float32Array(3*d),g=new t.BufferGeometry;g.addAttribute("position",new t.BufferAttribute(f,3)),g.addAttribute("radius",new t.BufferAttribute(p,1)),g.addAttribute("intensity",new t.BufferAttribute(m,1)),g.addAttribute("color",new t.BufferAttribute(v,3));for(var y=this.state==i.enteringSystem||this.state==i.leavingSystem?new t.Color(.5,.5,1):new t.Color(.465,.203,.063),b=y.clone(),x=this._content==r.faction,w=0;u>w;w++){var _,S=3*w,M=(_=n[w]).worldPosition;f[S+0]=M.x,f[S+1]=M.y,f[S+2]=M.z,p[w]=_.radius,x?(y=this.controlAPI.affiliationColors[_.data.affiliationCode],v[S+0]=y.r,v[S+1]=y.g,v[S+2]=y.b,m[w]=this.controlAPI.factionHeatmap[_.data.affiliationCode]?.25:0):(y=new t.Color(this.currentLRScanner==s.HeatmapEnum.lifeforms?this.controlAPI.env.galaxy.starsConfig.colorL1:this.currentLRScanner==s.HeatmapEnum.crime?this.controlAPI.env.galaxy.starsConfig.colorC1:this.controlAPI.env.galaxy.starsConfig.colorD1),v[S+0]=y.r,v[S+1]=y.g,v[S+2]=y.b,m[w]=(_.isMoon?.01:.5)*_.lrScannerStrength(this.currentLRScanner))}for(w=u;d>w;w++){S=3*w;var C=a.default.rnd(h),T=a.default.rnd(h-1);T===C&&T++;var E=l[C],k=l[T],A=E.worldPosition,P=k.worldPosition,L=Math.random(),O=(new t.Vector3).lerpVectors(A,P,L),R=O.clone().sub(o),F=R.lengthSq()>0?R.normalize().multiplyScalar(a.default.lerp(A.distanceTo(o),P.distanceTo(o),L)).add(o):R;M=(new t.Vector3).lerpVectors(O,F,this.curvature);if(f[S+0]=M.x,f[S+1]=M.y,f[S+2]=M.z,x){var B=.5>L?E:k;b=this.controlAPI.factionHeatmap[B.data.affiliationCode]?this.controlAPI.affiliationColors[B.data.affiliationCode]:new t.Color(0,0,0),v[S+0]=b.r,v[S+1]=b.g,v[S+2]=b.b,m[w]=.05,p[w]=(.1+Math.abs(L-.3))*a.default.lerp(E.radius,k.radius,L)}else b=new t.Color(this.currentLRScanner==s.HeatmapEnum.lifeforms?this.controlAPI.env.galaxy.starsConfig.colorL2:this.currentLRScanner==s.HeatmapEnum.crime?this.controlAPI.env.galaxy.starsConfig.colorC2:this.controlAPI.env.galaxy.starsConfig.colorD2),v[S+0]=b.r,v[S+1]=b.g,v[S+2]=b.b,m[w]=.05*a.default.lerp(E.lrScannerStrength(this.currentLRScanner),k.lrScannerStrength(this.currentLRScanner),L),p[w]=.6*a.default.lerp(E.radius,k.radius,L)}this._heaters=[new t.PointCloud(g,this._heaterBaseMaterial)];for(var D=0,I=this._heaters;D<I.length;D++){var N=I[D];this._scene.add(N)}},e.prototype.disposeOfHeatTexture=function(){this._heatTexture&&(this._heatTexture.dispose(),this._heatTexture=null)},e.prototype.createHeatTexture=function(e,n){this.disposeOfHeatTexture(),this.width=e,this.height=n,this._heatTexture=new t.WebGLRenderTarget(e,n,{wrapS:t.ClampToEdgeWrapping,wrapT:t.ClampToEdgeWrapping,minFilter:t.NearestFilter,magFilter:t.NearestFilter,format:t.RGBFormat,type:t.UnsignedByteType,stencilBuffer:!1}),this._heatTextureMaterial.uniforms.map.value=this._heatTexture},e.prototype.createHeaterMaterial=function(){var e=new t.ShaderMaterial({uniforms:{basePointSize:{type:"f",value:2},time:{type:"f",value:0}},attributes:{radius:{type:"f",value:[]},intensity:{type:"f",value:[]},color:{type:"c",value:[]}},vertexShader:"\n\t\t\t\t\tuniform float basePointSize;\n\t\t\t\t\tattribute float radius;\n\t\t\t\t\tattribute float intensity;\n\t\t\t\t\tattribute vec3 color;\n\t\t\t\t\tvarying float vIntensity;\n\t\t\t\t\tvarying vec3 vColor;\n\t\t\t\t\t\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tgl_Position = projectionMatrix * wpos;\n\t\t\t\t\t\tfloat z = -wpos.z;\n\t\t\t\t\t\tgl_PointSize = basePointSize + radius/z;\n\t\t\t\t\t\tvIntensity = intensity;\n\t\t\t\t\t\tvColor = color;\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\t#ifdef GL_ES\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tuniform float time;\n\t\t\t\t\tvarying float vIntensity;\n\t\t\t\t\tvarying vec3 vColor;\n\t\t\t\t\t\n\t\t\t\t\tfloat rand(vec2 co){\n\t\t\t\t\t\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tfloat x = gl_PointCoord.x - 0.5;\n\t\t\t\t\t\tfloat y = gl_PointCoord.y - 0.5;\n\t\t\t\t\t\tfloat r = 2.0*sqrt(x*x+y*y);\n\t\t\t\t\t\tfloat d;\n\t\t\t\t\t\tif (r < 1.0) {\n\t\t\t\t\t\t\td = mix(1.0,0.0,r);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\td = 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfloat k = fract(rand(floor(gl_FragCoord.xy)) + time*0.2);\n\t\t\t\t\t\tfloat lum = mix(0.5,1.0,clamp(k,0.0,1.0));\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tgl_FragColor = vec4(lum*vColor, d*vIntensity);\n\t\t\t\t\t}"});e.transparent=!0,e.blending=t.AdditiveBlending,e.depthTest=!1,this._heaterBaseMaterial=e},e.prototype.createHeatTextureMaterial=function(){var e=new t.ShaderMaterial({uniforms:{map:{type:"t",value:this._heatTexture},intensity:{type:"f",value:1},width:{type:"f",value:1},height:{type:"f",value:1},time:{type:"f",value:0},timeShowing:{type:"f",value:-50},timeHiding:{type:"f",value:-50}},vertexShader:"\n\t\t\t\t\tvarying vec2 texcoord;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tgl_Position = projectionMatrix * wpos;\n\t\t\t\t\t\ttexcoord = uv;\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\tuniform sampler2D map;\n\t\t\t\t\tuniform float intensity;\n\t\t\t\t\tuniform float width;\n\t\t\t\t\tuniform float height;\n\t\t\t\t\tuniform float time;\n\t\t\t\t\tuniform float timeShowing;\n\t\t\t\t\tuniform float timeHiding;\n\t\t\t\t\tvarying vec2 texcoord;\n\t\t\t\t\t\n\t\t\t\t\tfloat f(float x) {\n\t\t\t\t\t\tfloat a = 16.0*(x - floor(x));\n\t\t\t\t\t\treturn a < 1.0 ? 0.5+0.5*a : a < 15.0 ? 1.0 : 0.5+0.5*(16.0-a);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfloat rand(vec2 co){\n\t\t\t\t\t\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 col = texture2D( map, texcoord );\n\t\t\t\t\t\tfloat u = texcoord.x * width;\n\t\t\t\t\t\tfloat v = texcoord.y * height;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfloat transition = timeShowing > timeHiding ? 1.0 : 0.0;\n\t\t\t\t\t\tfloat delay = 0.5;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(timeShowing + delay > time) {\n\t\t\t\t\t\t\tfloat k = max(0.0, (time - timeShowing) / delay);\n\t\t\t\t\t\t\tfloat h = floor (v) / height;\n\t\t\t\t\t\t\tfloat w = floor (u) / width;\n\t\t\t\t\t\t\tfloat q = 1.0;//floor(time*10.0);\n\t\t\t\t\t\t\tfloat r = rand(vec2(w*q,h*q));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttransition = k*k >= r*h ? k : 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(timeHiding + delay > time) {\n\t\t\t\t\t\t\tfloat k = 1.0-max(0.0, (time - timeHiding) / delay);\n\t\t\t\t\t\t\tfloat h = floor (v) / height;\n\t\t\t\t\t\t\tfloat w = floor (u) / width;\n\t\t\t\t\t\t\tfloat q = 1.0;//floor(time*10.0);\n\t\t\t\t\t\t\tfloat r = rand(vec2(w*q,h*q));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttransition = k*k >= r*h ? k : 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t    \t\t\tgl_FragColor = vec4(max(col.rgb,vec3(0.06,0.06,0.12)), col.a*transition*intensity*f(u)*f(v));\n\t\t\t\t\t}"});e.transparent=!0,e.blending=t.AdditiveBlending,e.depthTest=!1,this._heatTextureMaterial=e},e.prototype.createMeshHeatTexture=function(e,n){this._meshHeatTexture=new t.Mesh(l.default.makeQuad(1),this._heatTextureMaterial),this.camera.add(this._meshHeatTexture),this._meshHeatTexture.position.set(0,0,-1),this.resize(e,n)},e.prototype.resize=function(t,e){this.width=t,this.height=e;var n=Math.floor(t/16),i=Math.floor(e/16);this._heatTextureMaterial.uniforms.width.value=n,this._heatTextureMaterial.uniforms.height.value=i,this.createHeatTexture(n,i);var r=Math.tan(.5*this.camera.fov*Math.PI/180),o=this.camera.aspect;this._meshHeatTexture.scale.set(o*r,r,1)},e.prototype.updateSelection=function(){for(var t in this.controlAPI.lrScannerHeatmap.lifeforms?(this.showLRScanner=!0,this.currentLRScanner=s.HeatmapEnum.lifeforms):this.controlAPI.lrScannerHeatmap.economy?(this.showLRScanner=!0,this.currentLRScanner=s.HeatmapEnum.economy):this.controlAPI.lrScannerHeatmap.crime?(this.showLRScanner=!0,this.currentLRScanner=s.HeatmapEnum.crime):this.showLRScanner=!1,this.showFactions=!1,this.controlAPI.factionHeatmap)this.controlAPI.factionHeatmap[t]&&(this.showFactions=!0);this._content=this.showFactions?r.faction:this.showLRScanner?r.longRange:r.none,this.state===i.inSystem&&(this._content!=r.none&&this.createHeaters(this._starSystem,this._bodies),this.show(this._content!=r.none))},e.prototype.update=function(t,e){this.visible&&(this._heaterBaseMaterial.uniforms.time.value=t,this._heatTextureMaterial.uniforms.time.value=t,this.renderer.render(this._scene,this.camera,this._heatTexture,!0)),this.timer.update(t,e)},Object.defineProperty(e.prototype,"visible",{get:function(){return this._meshHeatTexture.visible},enumerable:!0,configurable:!0}),e.prototype.show=function(t){if(t||this.lastShow)if(this.state==i.inSystem){var e=this._previousContent==this._content?0:1;this._heatTextureMaterial.uniforms.timeShowing.value=t?e*c.time:-50,this._heatTextureMaterial.uniforms.timeHiding.value=t?-50:e*c.time,this._meshHeatTexture.visible=!0,this._heatTextureMaterial.uniforms.intensity.value=1}else this._meshHeatTexture.visible=t,this._heatTextureMaterial.uniforms.intensity.value=t?1:0;t?this.lastShow?this.controlAPI.dispatchSoundEvent("UpdateHeatmap"):this.controlAPI.dispatchSoundEvent("ShowHeatmap"):this.controlAPI.dispatchSoundEvent("HideHeatmap"),this.lastShow=t,this._previousContent=this._content},e.prototype.beginIntersystem=function(){this.state=i.enteringSystem,this._content=r.none,this._previousContent=r.none},e.prototype.endIntersystem=function(){this.state=i.inSystem},e.prototype.leftStarSystem=function(){this.state=i.leavingSystem,this._meshHeatTexture.visible=!1},e.prototype.addToGUI=function(t){var e=this,n=t.addFolder("Heatmap config");n.add(this,"density",1,100).onChange((function(){return e.updateSelection()})),n.add(this,"curvature",0,2).onChange((function(){return e.updateSelection()}))},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=u}).call(e,n(2))},function(t,e,n){(function(t){var i=function(){function e(){}return e.makeJumpPointMaterial=function(e){e=e||{};var i=new t.ShaderMaterial({uniforms:{time:{type:"f",value:0},map:{type:"t",value:e.map},fadedU:{type:"f",value:e.fadedU||4}},vertexShader:n(88),fragmentShader:n(89)});return i.transparent=!0,i.blending=t.AdditiveBlending,i.depthTest=!0,i},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i}).call(e,n(2))},function(t,e){t.exports="varying vec2 texcoord;\nvoid main() {\n\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * wpos;\n\ttexcoord = vec2(uv.x, uv.y);\n}"},function(t,e){t.exports="uniform float time;\nuniform sampler2D map;\nuniform float fadedU;\nvarying vec2 texcoord;\n\nfloat speed = 0.3;\nfloat density = 0.29;\nfloat size = 3.1;\n\nfloat rand(vec2 co){\n\t\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat noisemap(vec2 uv, float sizeFactor, float densityFactor, float speedFactor) {\n\tvec2 vf = vec2(uv.x + time * speedFactor * speed, uv.y)*(sizeFactor * 2. * size);\t\n\tvec2 v = vec2(floor(vf.x), floor(vf.y));\n\tvec2 f = vf-v;\t\n\tfloat r = 2.0*distance(f, vec2(0.5, 0.5));\n\tfloat d = 1.0 - min(r, 1.0);\n\tfloat p = rand(v);\n\tp = p < densityFactor * 3. * density ? d*sin(3.14159 * abs(uv.y - 0.5)) : 0.0;\n\treturn p;\n}\n\n\nvoid main() {\n\tvec2 uv = vec2(0.*time+texcoord.x, texcoord.y);\n\tfloat alpha = texcoord.x < fadedU? (fadedU-texcoord.x)/fadedU : 0.0;\n\n\tfloat c = 1.0 - 2.0 * abs(uv.y - 0.5);\n\tvec3 tc = 0.5*vec3(67.,56.,31.)/256.; //43381e\n\tvec3 tcr = 5.*vec3(65.,33.,0.)/256.; //#2f2100\n\tvec4 col = \n\t\tc*vec4(tcr-vec3(0.,0.05,0.),  1.) * noisemap(uv, 6.0, 0.3, 2.0) +\n\t\tc*vec4(tcr,  1.) * noisemap(uv, 10.0, 0.3, 3.0) +\n\t\tc*vec4(tcr+vec3(0.,0.05,0.),  1.) * noisemap(uv, 16.0, 0.3, 4.0) +\n\t\tvec4(c*c*tc*2.,1.0);\n\n\tgl_FragColor = vec4(col.rgb*alpha, col.a);\n}\n"},function(t,e,n){(function(t){var i=n(32),r=function(){function e(t){this.prefab=t,this.info=null,this.main=null,this.materials=[],this.colors=[],this.highlightColor="rgb(255,50,0)",this.hasHighlight=!1,this.main=t.clone();var e=i.default.getMaterialStartingWith(this.main.model,"AdditiveSelect");for(var n in e){var r=e[n].clone();i.default.replaceMaterial(this.main.model,n,r),this.materials.push(r),this.colors.push(r.color.clone().getStyle())}}return Object.defineProperty(e.prototype,"model",{get:function(){return this.main.model},enumerable:!0,configurable:!0}),e.prototype.setInfo=function(e){this.info=e;var n=e.latitude*Math.PI/180,i=-e.longitude*Math.PI/180,r=Math.sin(n),o=Math.cos(n),a=Math.sin(i),s=Math.cos(i),l=new t.Vector3(o*s,r,o*a),c=new t.Vector3(0,0,1),u=(new t.Quaternion).setFromUnitVectors(c,l);return this.model.quaternion.copy(u),this},e.prototype.setHighlight=function(){this.hasHighlight=!0;for(var t=0,e=this.materials;t<e.length;t++){e[t].color.set(this.highlightColor)}},e.prototype.releaseHighlight=function(){this.hasHighlight=!1;for(var t=0;t<this.materials.length;t++)this.materials[t].color.set(this.colors[t])},e.prototype.update=function(t,e,n){this.main.update(t,e,n)},e.prototype.addToGUI=function(t,e){this.main.addToGUI&&this.main.addToGUI(t,e)},e.prototype.dispose=function(){this.main.dispose();for(var t=0,e=this.materials;t<e.length;t++){e[t].dispose()}},e.prototype.clone=function(){return new e(this.prefab)},e}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(63),a=n(56),s=n(52),l=n(61),c=function(e){function n(n,i,r,o){e.call(this),this.width=n,this.height=i,this.camera=r,this.renderer=o,this._effectTexture=null,this.timer=new a.default,this._scene=new t.Scene,this.createEffectTextureMaterial(),this.createMeshEffectTexture(n,i),this.show(!1)}return i(n,e),Object.defineProperty(n.prototype,"sw",{get:function(){return Math.floor(this.width/2)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sh",{get:function(){return Math.floor(this.height/2)},enumerable:!0,configurable:!0}),n.prototype.disposeOfEffectTexture=function(){this._effectTexture&&(this._effectTexture.dispose(),this._effectTexture=null)},n.prototype.createEffectTexture=function(e,n){this.disposeOfEffectTexture(),this._effectTexture=new t.WebGLRenderTarget(e,n,{wrapS:t.ClampToEdgeWrapping,wrapT:t.ClampToEdgeWrapping,minFilter:t.NearestFilter,magFilter:t.NearestFilter,format:t.RGBFormat,type:t.UnsignedByteType,stencilBuffer:!1}),this._effectTextureMaterial.uniforms.map.value=this._effectTexture},n.prototype.createEffectTextureMaterial=function(){var e=new t.ShaderMaterial({uniforms:{map:{type:"t",value:this._effectTexture},intensity:{type:"f",value:1},width:{type:"f",value:1},height:{type:"f",value:1},time:{type:"f",value:0},timeShowing:{type:"f",value:-50},timeHiding:{type:"f",value:-50}},vertexShader:"\n\t\t\t\t\tvarying vec2 texcoord;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 wpos = modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tgl_Position = projectionMatrix * wpos;\n\t\t\t\t\t\ttexcoord = uv;\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\tuniform sampler2D map;\n\t\t\t\t\tuniform float intensity;\n\t\t\t\t\tuniform float width;\n\t\t\t\t\tuniform float height;\n\t\t\t\t\tuniform float time;\n\t\t\t\t\tuniform float timeShowing;\n\t\t\t\t\tuniform float timeHiding;\n\t\t\t\t\tvarying vec2 texcoord;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 col = texture2D( map, texcoord );\n\t\t\t\t\t\t\n\t\t    \t\t\tgl_FragColor = vec4(col.rgb, col.a*intensity);\n\t\t\t\t\t}"});e.transparent=!0,e.blending=t.AdditiveBlending,e.depthTest=!1,this._effectTextureMaterial=e},n.prototype.createMeshEffectTexture=function(e,n){this._meshEffectTexture=new t.Mesh(s.default.makeQuad(1),this._effectTextureMaterial),this.camera.add(this._meshEffectTexture),this._meshEffectTexture.position.set(0,0,-1),this.resize(e,n)},n.prototype.resize=function(t,e){this.width=t,this.height=e;var n=this.sw,i=this.sh;this._effectTextureMaterial.uniforms.width.value=n,this._effectTextureMaterial.uniforms.height.value=i,this.createEffectTexture(n,i);var r=Math.tan(.5*this.camera.fov*Math.PI/180),o=this.camera.aspect;this._meshEffectTexture.scale.set(o*r,r,1),this.effect&&this.effect.resize(n,i)},n.prototype.update=function(t,e){this.timer.update(t,e),this.visible&&this.effect&&(this.effect.update(this.camera,t,e),this.effect.model.position.copy(this._meshEffectTexture.getWorldPosition()),this.effect.model.rotation.copy(this._meshEffectTexture.getWorldRotation()),this.effect.model.scale.copy(this._meshEffectTexture.getWorldScale()),this._effectTextureMaterial.uniforms.time.value=t,this.renderer.render(this._scene,this.camera,this._effectTexture,!0))},Object.defineProperty(n.prototype,"visible",{get:function(){return this._meshEffectTexture.visible},enumerable:!0,configurable:!0}),n.prototype.show=function(t){this._effectTextureMaterial.uniforms.intensity.value=1,this._meshEffectTexture.visible=t},n.prototype.addToGUI=function(t){},n.prototype.showEffect=function(t,e){this.hideEffect(),this.effect=new o.default(t,t,new l.default({},t),e,this.sw,this.sh),this._scene.add(this.effect.model),this.show(!0)},n.prototype.hideEffect=function(){this.effect&&(this._scene.remove(this.effect.model),this.effect.dispose(),this.effect=null,this.show(!1))},n.prototype.hideGraduallyEffect=function(t){var e=this;this.timer.clear(),this.timer.addPeriod(0,t,(function(t){e._effectTextureMaterial.uniforms.intensity.value=1-t}),(function(){return e.hideEffect()}))},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=c}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(93),a=n(20),s=n(23),l=n(56),c=function(e){function n(t,n){e.call(this),this.sm=t,this.env=n,this._timer=new l.default}return i(n,e),n.prototype.becomeActive=function(e){var n=this;this._selectedStar=e,this.env.controlAPI.dispatchSoundEvent("SelectSystem"),this._selectedStar.loadDetail().then((function(){n.env.camctl.setTargetPosition(n._selectedStar.obj3d.position),n._selectedStar.initStarSystem(),n.env.camctl.setZoomLimit(o.default.zoomMin,a.default.zoomMax(n.env.camctl.controls2D)),n.env.camctl.resetPan(),n.env.camctl.useCumulativePan=!0,n.env.camctl.setSmoothDamp(s.default.smoothDampTransition),n.env.camctl.setTargetZoom(o.default.zoom);var e=n.env.controlAPI.goal;e.routeInView&&e.isSystemView&&e.systemCode&&e.systemCode===n._selectedStar.code&&n._selectedStar.starSystem.augmentTargetZoomToSeeRoute(n.env.camctl),!e.done&&e.systemCode===n._selectedStar.code&&e.camInfo&&(n.env.camctl.cameraInfo=e.camInfo),n.env.galaxy.addDust(n._selectedStar.obj3d.position),n._selectedStar.starSystem.beginIntersystem();var i=n.env.lightColor.clone(),r=new t.Color(n._selectedStar.lightColorStr);n.env.controlAPI.dispatchSoundEvent("StopGalaxyAmbiance"),n.env.controlAPI.dispatchSoundEvent("EnterStarSystemStart"),n._timer.addPeriod(0,1.5,(function(t){n.env.galaxy.presenceRatio=1-t,n._selectedStar.starSystem.presenceRatio=t,n.env.setLightColor(i.clone().lerp(r,t))})),n._timer.add(1.5,(function(){n._selectedStar.starSystem.showLabel(!0),n._selectedStar.starSystem.showOrbitals(.5,.1)&&n.env.controlAPI.dispatchSoundEvent("ShowOrbitals"),n.env.postProcess.setUndiscoveredFX(n._selectedStar.starSystem.isUndiscovered())})),n._timer.add(1.9,(function(){n.env.camctl.setPitch(n.env.camctl.controls2D?0:o.default.pitch),n.sm.changeState("StateStarSystem",n._selectedStar),n.env.controlAPI.dispatchSoundEvent("EnterStarSystemCompleted"),n.env.controlAPI.dispatchSoundEvent("StartStarSystemAmbiance")}))})).catch((function(t){console.error(t.stack),n.sm.changeState("StateGalaxy"),n.env.controlAPI.goal.abort()}))},n.prototype.becomeInactive=function(){this._selectedStar.starSystem&&this._selectedStar.starSystem.endIntersystem(),this._selectedStar=null,this._timer.clear(),this.env.gameLoop.resetGUI()},n.prototype.update=function(t,e){this._timer.update(t,e)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=c}).call(e,n(2))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(22),a=n(23),s=function(t){function e(e,n){t.call(this),this.sm=e,this.env=n}return i(e,t),e.prototype.becomeActive=function(t){this._selectedStar=t,this.env.galaxy.systemCurrentlyViewed=this._selectedStar,this.env.galaxy.view=o.ViewEnum.system,this.env.camctl.setTargetPosition(this._selectedStar.obj3d.position),this._selectedStar.initStarSystem(),this.env.camctl.setZoomLimit(e.zoomMin,this._selectedStar.starSystem.computeCameraMaxDistance(this.env.camera));var n=this.env.controlAPI.goal;n.routeInView&&n.isSystemView&&n.systemCode&&n.systemCode===this._selectedStar.code||this.env.camctl.setTargetZoom(e.zoom),this.env.camctl.setPitch(this.env.camctl.controls2D?0:e.pitch),this.env.camctl.previous3dPitch=e.pitch,this.env.camctl.resetPan(),this.env.camctl.useCumulativePan=!0,this.env.camctl.setSmoothDamp(a.default.smoothDampNormal),this._selectedStar.starSystem.showLabel(!0),this.env.galaxy.showJumpPointMesh(!1),this.env.galaxy.showGrid(!1),this.env.galaxy.translateWorld(this._selectedStar.obj3d.position.clone().multiplyScalar(-1))},e.prototype.becomeInactive=function(){this._selectedStar=null,this.env.controlAPI.dispatchHoverOut()},e.prototype.update=function(t,e){var n=this._selectedStar.starSystem.pickCelestialBody(this.env.mouse.positionInVP,this.env.camera);this._selectedStar.starSystem.bodyHoveredSticky||(n&&!this.env.mouse.mouseB?n.isJumpPoint&&n.otherStar?this.env.controlAPI.dispatchHoverJumpPoint(n.star.code,n.code,n.otherStar.code):this.env.controlAPI.dispatchHoverBody(n.star.code,n.code):this.env.controlAPI.dispatchHoverOut()),this.env.mouse.mouseClick?(this._selectedStar.starSystem.setBodyHovered(null),null!=n?n.isJumpPoint&&n.otherStar?this.env.controlAPI.dispatchSelectJumpPoint(n.star.code,n.code,n.otherStar.code,this.env.mouse.clickButton):this.env.controlAPI.dispatchSelectBody(n.star.code,n.code,this.env.mouse.clickButton):(this.env.controlAPI.dispatchSelectNothing(this.env.mouse.clickButton),this.env.controlAPI.dispatchSoundEvent("SelectNothing"))):this._selectedStar.starSystem.setBodyHovered(n),this.env.camctl.controls2D&&this.env.camctl.set2dView();var i=this.env.controlAPI.goal;if(!i.done)if(i.isGalacticView)this.sm.changeState("StateLeaveStarSystem",this._selectedStar);else if(i.systemCode&&i.systemCode!==this._selectedStar.code)this.sm.changeState("StateSlideJumpPoint",{oldStar:this._selectedStar,newStar:this.env.galaxy.stars[i.systemCode]});else if(i.isSystemView)i.camInfo&&(this.env.camctl.cameraInfo=i.camInfo),i.setDone();else if(i.isPlanetaryView){var r=this._selectedStar.starSystem.getBody(i.planetaryCode);r&&this.sm.changeState("StateCelestialBody",r)}},e.zoom=.002,e.zoomMin=3e-4,e.zoomMax=.2,e.pitch=60,e}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(56),a=n(22),s=n(93),l=n(20),c=n(23),u=n(26),h=function(e){function n(t,n){e.call(this),this.sm=t,this.env=n,this._timer=new o.default}return i(n,e),n.prototype.becomeActive=function(e){var n=this;this._selectedStar=e,this.env.galaxy.view=a.ViewEnum.galaxy,this.env.camctl.setZoomLimit(s.default.zoomMin,l.default.zoomMax(this.env.camctl.controls2D)),this.env.camctl.setPitch(this.env.camctl.controls2D?0:l.default.pitch),this.env.camctl.resetPan(),this.env.camctl.useCumulativePan=!0,this.env.camctl.setSmoothDamp(c.default.smoothDampTransition),this._selectedStar.starSystem.showLabel(!1);var i=this.env.camctl.targetZoom,r=this.env.lightColor.clone(),o=new t.Color(1,1,1);this.env.postProcess.setUndiscoveredFX(!1),this.env.controlAPI.dispatchSoundEvent("StopStarSystemAmbiance"),this._timer.addPeriod(0,1,(function(t){n.env.galaxy.presenceRatio=t,n.env.setLightColor(r.clone().lerp(o,t)),n.env.camctl.setTargetZoom(u.default.lerp(i,l.default.zoom(n.env.camctl.controls2D),t))})),this._selectedStar.destroyStarSystem(1.5),this.env.controlAPI.dispatchSoundEvent("LeaveStarSystemToGalaxyStart"),this._timer.add(2,(function(){n.env.controlAPI.dispatchSoundEvent("LeaveStarSystemToGalaxyCompleted"),n.env.controlAPI.dispatchSoundEvent("StartGalaxyAmbiance"),n.sm.changeState("StateGalaxy")}))},n.prototype.becomeInactive=function(){this._selectedStar=null,this._timer.clear(),this.env.gameLoop.resetGUI()},n.prototype.update=function(t,e){this._timer.update(t,e)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=h}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=function(e){function n(t,n){e.call(this),this.sm=t,this.env=n,this._selectedCelestialBody=null}return i(n,e),n.prototype.becomeActive=function(t){this._selectedCelestialBody=t;var e=this._selectedCelestialBody;this.env.controlAPI.dispatchSoundEvent(e.isStar?"SelectStar":e.isPlanet?"SelectPlanet":e.isMoon?"SelectMoon":e.isBelt||e.isAsteroidField?"SelectBelt":e.isJumpPoint?"SelectJumpPoint":e.isSpaceStation?"SelectSpaceStation":""),this.env.camctl.setTargetPosition(this._selectedCelestialBody.worldPosition),this.env.camctl.setTargetZoom(n.zoom),this.env.camctl.setZoomLimit(n.zoomMin,n.zoomMax),this.env.camctl.setPitch(this.env.camctl.controls2D?0:n.pitch),this.env.camctl.previous3dPitch=n.pitch,this.env.camctl.resetPan();var i=this.env.controlAPI.goal;!i.done&&i.isPlanetaryView&&i.planetaryCode===this._selectedCelestialBody.code&&(i.camInfo?this.env.camctl.cameraInfo=i.camInfo:i.bodyPixelSize&&this.setCameraZoomForBodyPixelSize(),i.setDone()),this._selectedCelestialBody.showLandingZone()},n.prototype.setCameraZoomForBodyPixelSize=function(){var t=this.env.controlAPI.goal;if(t.bodyPixelSize){var e=2*this._selectedCelestialBody.worldRadius/(t.bodyPixelSize*this.env.galaxy.pixelSizeOverZ.x);this.env.camctl.setTargetZoom(e),this.env.camctl.setZoomLimit(e,e)}},n.prototype.becomeInactive=function(){this._selectedCelestialBody=null,this.env.controlAPI.dispatchHoverOut()},n.prototype.update=function(e,i){var r=this._selectedCelestialBody.starSystem.pickCelestialBody(this.env.mouse.positionInVP,this.env.camera);this._selectedCelestialBody.starSystem.bodyHoveredSticky||(r&&!this.env.mouse.mouseB?r.isJumpPoint&&r.otherStar?this.env.controlAPI.dispatchHoverJumpPoint(r.star.code,r.code,r.otherStar.code):this.env.controlAPI.dispatchHoverBody(r.star.code,r.code):this.env.controlAPI.dispatchHoverOut()),this.env.mouse.mouseClick?(this._selectedCelestialBody.starSystem.setBodyHovered(null),r?r.isJumpPoint?this.env.controlAPI.dispatchSelectJumpPoint(r.star.code,r.code,r.otherStar&&r.otherStar.code,this.env.mouse.clickButton):this.env.controlAPI.dispatchSelectBody(r.star.code,r.code,this.env.mouse.clickButton):(this.env.controlAPI.dispatchSelectNothing(this.env.mouse.clickButton),this.env.controlAPI.dispatchSoundEvent("SelectNothing"))):this._selectedCelestialBody.starSystem.setBodyHovered(null),this.env.camctl.controls2D&&this.env.camctl.set2dView();var o=this.env.controlAPI.goal;if(!o.done)if(this._selectedCelestialBody.isJumpPoint&&(o.isSystemView||o.isPlanetaryView)&&this._selectedCelestialBody.otherStar&&o.systemCode===this._selectedCelestialBody.otherStar.code)this.sm.changeState("StateEnterJumpPoint",this._selectedCelestialBody);else if(o.isGalacticView||o.systemCode&&o.systemCode!==this._selectedCelestialBody.starSystem.mainStar.code)this.sm.changeState("StateLeaveStarSystem",this._selectedCelestialBody.starSystem.mainStar);else if(o.isSystemView)this.sm.changeState("StateStarSystem",this._selectedCelestialBody.starSystem.mainStar);else if(o.isPlanetaryView)if(o.planetaryCode!==this._selectedCelestialBody.code){var a=this._selectedCelestialBody.starSystem.getBody(o.planetaryCode);a&&this.sm.changeState("StateCelestialBody",a)}else o.camInfo?this.env.camctl.cameraInfo=o.camInfo:o.bodyPixelSize?this.setCameraZoomForBodyPixelSize():(this.env.camctl.setTargetZoom(n.zoom),this.env.camctl.setZoomLimit(n.zoomMin,n.zoomMax)),o.setDone();var s=this._selectedCelestialBody.landingZoneWithHighlight;if(s){s.model.updateMatrixWorld(!0);var l=new t.Vector3(0,0,1).applyMatrix4(s.model.matrixWorld).sub(s.model.getWorldPosition()),c=Math.atan2(l.x,l.z),u=Math.atan2(Math.sqrt(l.x*l.x+l.z*l.z),l.y);this.env.camctl.setTheta(180*c/Math.PI),this.env.camctl.setPitch(180*u/Math.PI)}},n.zoom=3e-4,n.zoomMin=12e-5,n.zoomMax=3e-4,n.pitch=60,n}(n(21).default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(56),a=n(26),s=n(93),l=n(20),c=n(23),u=function(e){function n(t,n){e.call(this),this.sm=t,this.env=n,this._selectedCelestialBody=null,this._timer=new o.default}return i(n,e),n.prototype.becomeActive=function(e){var n=this;this._selectedCelestialBody=e,this._selectedStar=e.otherStar,this._selectedStar.loadDetail().then((function(){n.env.camctl.resetPan();n._selectedStar.initStarSystem();var i=n._selectedStar.obj3d.position.clone().sub(e.star.obj3d.position),r=i.length(),o=new t.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5).projectOnPlane(i).normalize();n.env.camctl.setThetaPhiTargetToLookThroughTargetTowardsObjective(n._selectedStar.obj3d.position.clone().add(o.multiplyScalar(.5*r))),n.env.controlAPI.dispatchSoundEvent("EnterJumpPointStart"),n.env.controlAPI.dispatchSoundEvent("StopStarSystemAmbiance");var u=n._selectedCelestialBody.jumpPoint.power,h=new t.Group;h.matrixAutoUpdate=!1,h.rotationAutoUpdate=!1,n._timer.addPeriod(.5,.5,(function(t){var e=a.default.lerp(1,4,t),i=e*e;n._selectedCelestialBody.obj3d.scale.set(i,i,i),n._selectedCelestialBody.jumpPoint.power=(1-t)*u})),n._timer.add(.8,(function(){h.matrix.copy(n.env.camera.matrixWorldInverse.clone().multiply(n._selectedCelestialBody.obj3d.parent.matrixWorld)),n.env.camera.add(h),h.add(n._selectedCelestialBody.obj3d),n._selectedCelestialBody.jumpPoint.updateRotation=!1,n._selectedCelestialBody.jumpPoint.removeDepthWrite()})),n._timer.add(.8,(function(){n.env.galaxy.addJumpEffect(n._selectedStar.obj3d.position)})),n._timer.add(.8,(function(){n.env.postProcess.doJumpRipple()})),n._timer.addPeriod(.8,2.1,(function(t){n._selectedCelestialBody.jumpPoint.alpha=1-t})),n._timer.add(1,(function(){n.env.controlAPI.dispatchSoundEvent("EnterJumpPointMoveCamera"),n.env.camctl.setTargetPosition(n._selectedStar.obj3d.position),n.env.camctl.setZoomLimit(s.default.zoomMin,l.default.zoomMax(n.env.camctl.controls2D)),n.env.camctl.resetPan(),n.env.camctl.useCumulativePan=!0,n.env.camctl.setSmoothDamp(c.default.smoothDampTransition),n.env.camctl.setTargetZoom(s.default.zoom),n._selectedStar.starSystem.beginIntersystem();var t=n.env.controlAPI.goal;!t.done&&t.systemCode===n._selectedStar.code&&t.camInfo&&(n.env.camctl.cameraInfo=t.camInfo),t.routeInView&&t.isSystemView&&t.systemCode&&t.systemCode===n._selectedStar.code&&n._selectedStar.starSystem.augmentTargetZoomToSeeRoute(n.env.camctl)})),n._timer.addPeriod(1,1.5,(function(t){n.env.galaxy.presenceRatio=1-t,n._selectedStar.starSystem.presenceRatio=t}));var d=n.env.lightColor.clone(),f=new t.Color(n._selectedStar.lightColorStr);n._timer.addPeriod(2,.9,(function(t){n.env.setLightColor(d.clone().lerp(f,t))})),n._timer.add(2.5,(function(){n._selectedStar.starSystem.showLabel(!0),n._selectedStar.starSystem.showOrbitals(.5,.1)&&n.env.controlAPI.dispatchSoundEvent("ShowOrbitals"),n.env.controlAPI.dispatchSoundEvent("EnterJumpPointLanding"),n.env.postProcess.setUndiscoveredFX(n._selectedStar.starSystem.isUndiscovered())})),n._timer.add(2.9,(function(){n.env.camera.remove(h),n.env.camctl.setPitch(s.default.pitch),n.sm.changeState("StateStarSystem",n._selectedStar),n.env.controlAPI.dispatchSoundEvent("EnterJumpPointCompleted"),n.env.controlAPI.dispatchSoundEvent("StartStarSystemAmbiance")}))})).catch((function(t){console.error(t.stack),n.sm.changeState("StateStarSystem",n._selectedCelestialBody.star),n.env.controlAPI.goal.abort()}))},n.prototype.becomeInactive=function(){this._selectedCelestialBody.star.destroyStarSystem(),this._selectedStar.starSystem&&this._selectedStar.starSystem.endIntersystem(),this._selectedStar=null,this._timer.clear(),this.env.gameLoop.resetGUI()},n.prototype.update=function(t,e){this._timer.update(t,e),this._starfield&&this._starfield.update(t,e)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(21),o=n(56),a=n(93),s=n(20),l=n(23),c=function(e){function n(t,n){e.call(this),this.sm=t,this.env=n,this._timer=new o.default}return i(n,e),n.prototype.becomeActive=function(e){var n=this,i=e.oldStar,r=e.newStar;this._oldStar=i,this._selectedStar=r,this._selectedStar.loadDetail().then((function(){n.env.camctl.resetPan(),n._selectedStar.initStarSystem(),n.env.camctl.setPitch(n.env.camctl.controls2D?0:a.default.pitch),n.env.camctl.setTargetPosition(n._selectedStar.obj3d.position),n.env.camctl.setZoomLimit(a.default.zoomMin,s.default.zoomMax(n.env.camctl.controls2D)),n.env.camctl.resetPan(),n.env.camctl.useCumulativePan=!0,n.env.camctl.setSmoothDamp(l.default.smoothDampSlidel),n.env.camctl.setTargetZoom(a.default.zoom),n._selectedStar.starSystem.beginIntersystem(),n._oldStar&&n._oldStar.starSystem.showLabel(!1);var e=n.env.controlAPI.goal;e.routeInView&&e.isSystemView&&e.systemCode&&e.systemCode===n._selectedStar.code&&n._selectedStar.starSystem.augmentTargetZoomToSeeRoute(n.env.camctl),!e.done&&e.systemCode===n._selectedStar.code&&e.camInfo&&(n.env.camctl.cameraInfo=e.camInfo),n.env.controlAPI.dispatchSoundEvent("StopStarSystemAmbiance"),n.env.controlAPI.dispatchSoundEvent("SlideSystem");var i=n.env.lightColor.clone(),r=new t.Color(n._selectedStar.lightColorStr);n._timer.addPeriod(0,.5,(function(t){n.env.setLightColor(i.clone().lerp(r,t))})),n._timer.addPeriod(0,.1,(function(t){n._selectedStar.starSystem.presenceRatio=t,n._oldStar||(n.env.galaxy.presenceRatio=1-t)})),n._timer.add(.1,(function(){n.env.galaxy.translateWorld(n._selectedStar.obj3d.position.clone().multiplyScalar(-1)),n._selectedStar.starSystem.showLabel(!0),n._selectedStar.starSystem.showOrbitals(0,.1)&&n.env.controlAPI.dispatchSoundEvent("ShowOrbitals"),n.env.postProcess.setUndiscoveredFX(n._selectedStar.starSystem.isUndiscovered())})),n._oldStar&&n._oldStar.destroyStarSystem(.5),n._timer.add(.5,(function(){n.env.controlAPI.dispatchSoundEvent("StartStarSystemAmbiance"),n.sm.changeState("StateStarSystem",n._selectedStar)}))})).catch((function(t){console.error(t.stack),n.sm.changeState("StateGalaxy"),n.env.controlAPI.goal.abort()}))},n.prototype.becomeInactive=function(){this._selectedStar.starSystem&&this._selectedStar.starSystem.endIntersystem(),this._selectedStar=null,this._timer.clear(),this.env.gameLoop.resetGUI()},n.prototype.update=function(t,e){this._timer.update(t,e),this._starfield&&this._starfield.update(t,e)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=c}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=function(e){function n(n){var i=this;e.call(this),this.mouseUpLB=!1,this.mouseUpRB=!1,this.mouseUpMB=!1,this.mouseDownLB=!1,this.mouseDownRB=!1,this.mouseDownMB=!1,this.mouseLB=!1,this.mouseRB=!1,this.mouseMB=!1,this.lastMouseLB=!1,this.lastMouseRB=!1,this.lastMouseMB=!1,this.mouseClickLB=!1,this.mouseClickRB=!1,this.mouseClickMB=!1,this.mouseDblClickLB=!1,this.mouseDblClickRB=!1,this.mouseDblClickMB=!1,this.dragStartPosition=new t.Vector2,this.dragDelta=new t.Vector2,this.lastPosition=new t.Vector2(1/0,1/0),this.position=new t.Vector2(1/0,1/0),this.positionInVP=new t.Vector2(1/0,1/0),this.positionNormalized=new t.Vector2(1/0,1/0),this.delta=new t.Vector2,this.enabled=!0,this.clickRegion=5,this.onMouseDown=function(e){!1!==i.enabled&&(e.preventDefault(),e.button===t.MOUSE.LEFT?(i.mouseLB=!0,i.mouseMB=!1,i.mouseRB=!1):e.button===t.MOUSE.MIDDLE?(i.mouseLB=!1,i.mouseMB=!0,i.mouseRB=!1):e.button===t.MOUSE.RIGHT&&(i.mouseLB=!1,i.mouseMB=!1,i.mouseRB=!0),i.domElement.addEventListener("mouseup",i.onMouseUp,!1),i.domElement.addEventListener("mouseout",i.onMouseUp,!1))},this.onMouseMove=function(t){!1!==i.enabled&&(i.position.x=t.clientX,i.position.y=t.clientY,i.positionInVP.x=t.clientX/i.element.clientWidth*2-1,i.positionInVP.y=-t.clientY/i.element.clientHeight*2+1,i.positionNormalized.x=t.clientX/i.element.clientWidth,i.positionNormalized.y=1-t.clientY/i.element.clientHeight,t.preventDefault())},this.onMouseUp=function(){!1!==i.enabled&&(i.mouseLB=!1,i.mouseMB=!1,i.mouseRB=!1,i.domElement.removeEventListener("mouseup",i.onMouseUp,!1),i.domElement.removeEventListener("mouseout",i.onMouseUp,!1))},this.onMouseWheel=function(t){i.enabled},this.touchstart=function(t){if(!1!==i.enabled)switch(t.touches.length){case 1:i.mouseLB=!0,i.mouseMB=!1,i.mouseRB=!1;break;case 2:i.mouseLB=!1,i.mouseMB=!0,i.mouseRB=!1;break;case 3:i.mouseLB=!1,i.mouseMB=!1,i.mouseRB=!0}},this.touchmove=function(t){!1!==i.enabled&&(i.position.x=t.touches[0].pageX,i.position.y=t.touches[0].pageY,i.positionInVP.x=t.clientX/i.element.clientWidth*2-1,i.positionInVP.y=-t.clientY/i.element.clientHeight*2+1,t.preventDefault())},this.touchend=function(){!1!==i.enabled&&(i.mouseLB=!1,i.mouseMB=!1,i.mouseRB=!1)},this.domElement=void 0!==n?n:document,this.element=n===document||void 0===n?document.body:n,this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("mousewheel",this.onMouseWheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.onMouseWheel,!1),this.domElement.addEventListener("mousemove",this.onMouseMove,!1),this.domElement.addEventListener("touchstart",this.touchstart,!1),this.domElement.addEventListener("touchend",this.touchend,!1),this.domElement.addEventListener("touchmove",this.touchmove,!1)}return i(n,e),Object.defineProperty(n.prototype,"mouseClick",{get:function(){return this.mouseClickLB||this.mouseClickMB||this.mouseClickRB},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clickButton",{get:function(){return this.mouseClickLB?t.MOUSE.LEFT:this.mouseClickMB?t.MOUSE.MIDDLE:this.mouseClickRB?t.MOUSE.RIGHT:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mouseB",{get:function(){return this.mouseLB||this.mouseMB||this.mouseRB},enumerable:!0,configurable:!0}),n.prototype.update=function(t,e){var n=this.lastMouseLB||this.lastMouseRB||this.lastMouseMB;this.mouseDownLB=!this.lastMouseLB&&this.mouseLB,this.mouseDownRB=!this.lastMouseRB&&this.mouseRB,this.mouseDownMB=!this.lastMouseMB&&this.mouseMB,this.mouseUpLB=this.lastMouseLB&&!this.mouseLB,this.mouseUpRB=this.lastMouseRB&&!this.mouseRB,this.mouseUpMB=this.lastMouseMB&&!this.mouseMB,(this.mouseDownLB||this.mouseDownRB||this.mouseDownMB)&&this.dragStartPosition.copy(this.position),this.delta.subVectors(this.position,this.lastPosition),this.dragDelta.subVectors(this.position,this.dragStartPosition);var i=this.dragDelta.length()<this.clickRegion;this.mouseClickLB=n&&this.mouseUpLB&&i,this.mouseClickRB=n&&this.mouseUpRB&&i,this.mouseClickMB=n&&this.mouseUpMB&&i,this.lastPosition=this.position,this.lastMouseLB=this.mouseLB,this.lastMouseRB=this.mouseRB,this.lastMouseMB=this.mouseMB},Object.defineProperty(n.prototype,"isStill",{get:function(){return this.dragDelta.length()<this.clickRegion},enumerable:!0,configurable:!0}),n}(n(24).default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}).call(e,n(2))},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(32),a=function(e){function n(n){e.call(this),this.renderer=n,this.options={light:!0},this.scene=new t.Scene,this.camera=new t.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1e-6,1e3),this.updateProjectionMatrix(),this.scene.add(this.camera),this.camera.position.set(0,3,5),this.camera.lookAt(new t.Vector3(0,0,0)),this.pointLight=new t.PointLight(16777215,1.75),this.setLightColor(new t.Color(this.lightColor)),this.scene.add(this.pointLight),this.scene.visible=!1}return i(n,e),n.prototype.updateProjectionMatrix=function(){this.camera.updateProjectionMatrix()},n.prototype.addToGUI=function(e){var n=this,i=e.addFolder("Stage"),r={lightColor:this.lightColor.getStyle()};i.add(this.camera,"fov").onChange((function(){return n.updateProjectionMatrix()})),i.add(this.options,"light").onChange((function(t){return n.pointLight.visible=t})),i.addColor(r,"lightColor").onChange((function(e){return n.setLightColor(new t.Color(e))}))},n.prototype.onWindowResize=function(t,e){this.camera.aspect=t/e,this.updateProjectionMatrix(),o.default.updateMaterialsResolution(this.scene,t,e)},n.prototype.render=function(t){t.render(this.scene,this.camera)},n.prototype.initPostProcessing=function(e){var n=new t.RenderPass(this.scene,this.camera);e.addPass(n),n.clear=!1},n.prototype.lateUpdate=function(t,e){this.pointLight.position.copy(this.camera.position)},n.prototype.setLightColor=function(t){this.pointLight.color.set(t)},Object.defineProperty(n.prototype,"lightColor",{get:function(){return this.pointLight.color},enumerable:!0,configurable:!0}),n.prototype.start=function(){this.scene.visible=!0},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a}).call(e,n(2))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=function(t){function e(){t.call(this),this.states={},this.nextState=null,this.nextArg=null,this.currentState=null}return i(e,t),e.prototype.addState=function(t,e){this.states[t]=e},e.prototype.changeState=function(t,e){this.nextState=this.states[t],this.nextArg=e,this.nextState||console.warn("StateMachine - undefined state used !!! "+t)},e.prototype.hasState=function(t){return!!this.states[t]},e.prototype.update=function(t,e){this.nextState&&(this.currentState&&this.currentState.becomeInactive&&this.currentState.becomeInactive(),this.currentState=this.nextState,this.currentState.becomeActive&&this.currentState.becomeActive(this.nextArg),this.nextState=null),this.currentState&&this.currentState.update&&this.currentState.update(t,e)},e}(n(24).default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=function(t){function e(){t.call(this)}return i(e,t),e.prototype.addToGUI=function(t){var e=this;t.add({fullscreen:function(){return e.toggleFullscreen()}},"fullscreen")},e.prototype.toggleFullscreen=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},e}(n(24).default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(30),a=n(52),s=function(e){function n(n,i){e.call(this),this.camera=n,this.resourcePath=i,this.back=null,this.nebulas1=null,this.nebulas2=null,this.skybox={visible1:!0,visible2:!0,fov1:60,fov2:75,fov2amplitude:2,fov2frequency:.05,lightColor:"rgb(255,255,255)"},this.cameraCube=new t.PerspectiveCamera(this.skybox.fov1,window.innerWidth/window.innerHeight,.01,1e3),this.cameraCube2=new t.PerspectiveCamera(this.skybox.fov2,window.innerWidth/window.innerHeight,.01,1e3),this.sceneCube=new t.Scene,this.sceneCube2=new t.Scene,this.pointLightCube=new t.PointLight(16777215,1.75),this.sceneCube.add(this.pointLightCube),this.pointLightCube2=new t.PointLight(16777215,1.75),this.sceneCube2.add(this.pointLightCube2),this.setLightColor(new t.Color(this.skybox.lightColor)),this.sceneCube.visible=!1,this.sceneCube2.visible=!1}return i(n,e),n.prototype.preload=function(){var t=this;return Promise.all([o.default.loadObject(this.resourcePath+"/models/SpaceCube_Nebulas.dae"),o.default.loadObject(this.resourcePath+"/models/SpaceCube_Back.dae")]).then((function(e){var n=e[0],i=e[1];a.default.setDepthWriteFalse(i.model),a.default.setDepthWriteFalse(n.model),t.back=i,t.nebulas1=n,t.nebulas2=n.clone(),t.sceneCube.add(t.back.model),t.sceneCube.add(t.nebulas1.model),t.sceneCube2.add(t.nebulas2.model)}))},n.prototype.start=function(){this.sceneCube.visible=!0,this.sceneCube2.visible=!0},n.prototype.render=function(t){t.render(this.sceneCube,this.cameraCube),t.render(this.sceneCube2,this.cameraCube2)},n.prototype.initPostProcessing=function(e){var n=new t.RenderPass(this.sceneCube,this.cameraCube),i=new t.RenderPass(this.sceneCube2,this.cameraCube2);e.addPass(n),e.addPass(i),i.clear=!1},n.prototype.addToGUI=function(e){var n=this,i=e.addFolder("Skybox");i.add(this.skybox,"visible1").onChange((function(t){return n.sceneCube.visible=t})),i.add(this.skybox,"visible2").onChange((function(t){return n.sceneCube2.visible=t})),i.add(this.cameraCube,"fov").onChange((function(){return n.cameraCube.updateProjectionMatrix()})),i.add(this.skybox,"fov2"),i.add(this.skybox,"fov2amplitude"),i.add(this.skybox,"fov2frequency"),i.addColor(this.skybox,"lightColor").onChange((function(e){return n.setLightColor(new t.Color(e))}))},n.prototype.onWindowResize=function(t,e){this.cameraCube.aspect=t/e,this.cameraCube.updateProjectionMatrix(),this.cameraCube2.aspect=t/e,this.cameraCube2.updateProjectionMatrix()},n.prototype.update=function(t,e){this.cameraCube2.fov=this.skybox.fov2+this.skybox.fov2amplitude*Math.sin(t*Math.PI*this.skybox.fov2frequency),this.cameraCube2.updateProjectionMatrix(),this.cameraCube.rotation.setFromRotationMatrix(this.camera.matrixWorld),this.cameraCube2.rotation.setFromRotationMatrix(this.camera.matrixWorld)},n.prototype.setLightColor=function(t){this.pointLightCube.color.set(t),this.pointLightCube2.color.set(t)},n}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s}).call(e,n(2))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=function(t){function e(e){t.call(this),this.stats=new Stats,this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",e.appendChild(this.stats.domElement)}return i(e,t),e.prototype.update=function(t,e){this.stats.update()},e}(n(24).default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){(function(t){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(24),o=n(64),a=function(e){function r(n,i,r,o,a){e.call(this),this.initPostProcessingFunc=n,this.mouse=i,this.width=r,this.height=o,this.camera=a,this.ppParams={Bloom:{enabled:!1,strength:0,kernelSize:25,sigma:4},Ripple:{enabled:!0,amount:.34,duration:5.5,velocity:.56,ripples:1.9,apex:.29},Undiscovered:{enabled:!0,distortion:.1,distortion2:.4,speed:.09,amount:.68},LoadingScreen:{enabled:!0,distortion:.3,distortion2:2.11,speed:.09,amount:.68}},this.effects={},this.undiscovered=!1,this.actionPoint=new t.Vector2(0,0),this.actionTime=0}return i(r,e),r.prototype.initPostProcessing=function(e){this.ppParams.Bloom.enabled&&(this.effects.Bloom=new t.BloomPass(this.ppParams.Bloom.strength,this.ppParams.Bloom.kernelSize,this.ppParams.Bloom.sigma,512),e.addPass(this.effects.Bloom)),this.ppParams.Ripple.enabled&&(this.effects.Ripple=new t.ShaderPass({uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},resolution:{type:"v2",value:new t.Vector2(this.width,this.height)},mouse:{type:"v2",value:this.mouse.positionNormalized.clone()},actionPoint:{type:"v2",value:this.mouse.positionNormalized.clone()},actionTime:{type:"f",value:0},amount:{type:"f",value:this.ppParams.Ripple.amount},duration:{type:"f",value:this.ppParams.Ripple.duration},velocity:{type:"f",value:this.ppParams.Ripple.velocity},ripples:{type:"f",value:this.ppParams.Ripple.ripples},apex:{type:"f",value:this.ppParams.Ripple.apex}},vertexShader:n(105),fragmentShader:n(106)}),e.addPass(this.effects.Ripple)),this.ppParams.Undiscovered.enabled&&(this.effects.Undiscovered=new t.ShaderPass({uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},resolution:{type:"v2",value:new t.Vector2(this.width,this.height)},distortion:{type:"f",value:this.ppParams.Undiscovered.distortion},distortion2:{type:"f",value:this.ppParams.Undiscovered.distortion2},speed:{type:"f",value:this.ppParams.Undiscovered.speed},amount:{type:"f",value:this.ppParams.Undiscovered.amount}},vertexShader:n(105),fragmentShader:n(107)}),e.addPass(this.effects.Undiscovered),this.setUndiscoveredFX(this.undiscovered)),this.ppParams.LoadingScreen.enabled&&(this.effects.LoadingScreen=new t.ShaderPass({uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},resolution:{type:"v2",value:new t.Vector2(this.width,this.height)},distortion:{type:"f",value:this.ppParams.LoadingScreen.distortion},distortion2:{type:"f",value:this.ppParams.LoadingScreen.distortion2},speed:{type:"f",value:this.ppParams.LoadingScreen.speed},amount:{type:"f",value:this.ppParams.LoadingScreen.amount},alpha:{type:"f",value:1}},vertexShader:n(105),fragmentShader:n(108)}),e.addPass(this.effects.LoadingScreen),this.showLoadingScreen(0))},r.prototype.addToGUI=function(t){var e=this.ppParams,n=t.addFolder("Post Process"),i=n.addFolder("Bloom Pass");i.add(e.Bloom,"enabled").onChange(this.initPostProcessingFunc),i.add(e.Bloom,"strength",0,5).onChange(this.initPostProcessingFunc),i.add(e.Bloom,"kernelSize",1,50).onChange(this.initPostProcessingFunc),i.add(e.Bloom,"sigma",0,10).onChange(this.initPostProcessingFunc);var r=n.addFolder("Ripple Pass");r.add(e.Ripple,"enabled").onChange(this.initPostProcessingFunc),r.add(e.Ripple,"amount",0,10).onChange(this.initPostProcessingFunc),r.add(e.Ripple,"duration",0,10).onChange(this.initPostProcessingFunc),r.add(e.Ripple,"velocity",0,10).onChange(this.initPostProcessingFunc),r.add(e.Ripple,"ripples",0,10).onChange(this.initPostProcessingFunc),r.add(e.Ripple,"apex",0,1).onChange(this.initPostProcessingFunc);var o=n.addFolder("Undiscovered Pass");o.add(e.Undiscovered,"enabled").onChange(this.initPostProcessingFunc),o.add(e.Undiscovered,"distortion",0,1).onChange(this.initPostProcessingFunc),o.add(e.Undiscovered,"distortion2",0,1).onChange(this.initPostProcessingFunc),o.add(e.Undiscovered,"speed",0,1).onChange(this.initPostProcessingFunc),o.add(e.Undiscovered,"amount",0,1).onChange(this.initPostProcessingFunc);var a=n.addFolder("LoadingScreen Pass");a.add(e.LoadingScreen,"enabled").onChange(this.initPostProcessingFunc),a.add(e.LoadingScreen,"speed",0,1).onChange(this.initPostProcessingFunc),a.add(e.LoadingScreen,"amount",0,1).onChange(this.initPostProcessingFunc)},r.prototype.update=function(t,e){for(var n in this.effects){var i=this.effects[n];i.uniforms&&(i.uniforms.time&&(i.uniforms.time.value=t),i.uniforms.mouse&&i.uniforms.mouse.value.set(this.mouse.positionNormalized.x,this.mouse.positionNormalized.y),i.uniforms.actionPoint&&i.uniforms.actionPoint.value.set(this.actionPoint.x,this.actionPoint.y),i.uniforms.actionTime&&(i.uniforms.actionTime.value=this.actionTime))}},r.prototype.resize=function(t,e){for(var n in this.width=t,this.height=e,this.effects){var i=this.effects[n];i.uniforms&&i.uniforms.resolution&&i.uniforms.resolution.value.set(t,e)}},r.prototype.doJumpRipple=function(){this.actionPoint=new t.Vector2(.5,.5),this.actionTime=o.time},r.prototype.setUndiscoveredFX=function(t){this.effects.Undiscovered&&(this.undiscovered=t,this.effects.Undiscovered.enabled=t)},r.prototype.showLoadingScreen=function(t){this.effects.LoadingScreen.enabled=0!==t,this.effects.LoadingScreen.uniforms.alpha.value=t},r.textures={},r}(r.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a}).call(e,n(2))},function(t,e){t.exports="varying vec2 vUV;\n\nvoid main() {\n\n\tvUV = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}"},function(t,e){t.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D tDiffuse;\nuniform float time;\nuniform vec2 resolution;\nuniform vec2 mouse;\nuniform vec2 actionPoint;\nuniform float actionTime;\nuniform float amount;\nuniform float duration;\nuniform float velocity;\nuniform float ripples;\nuniform float apex;\n\nvarying vec2 vUV;\n\nvoid main() {\n    \n\tfloat k = (time - actionTime)/duration;\n    \n    if(k <= 1.0) {\n\n\t    float intensity = mix(0.00, 0.05, amount);\n\t\tvec2 p =-1.+2.* (vUV-actionPoint+vec2(0.5,0.5));\n\t    vec2 newUV = vUV + (normalize(p))*cos(length(p)*10.0*ripples-k*velocity*20.0)*intensity;\t   \n\t    vec3 col= texture2D(tDiffuse,mix(vUV,newUV, k < apex ? smoothstep(0.,1., k/apex) : pow(1.0-(k-apex)/(1.0-apex), 2.0)       )).rgb;\n\t\tgl_FragColor = vec4(col, 1.0);\n\n\t} else {\n\n\t\tgl_FragColor = vec4(texture2D(tDiffuse,vUV).rgb,1.0);\n\t}\n\n\t//gl_FragColor = vec4(newUV, 0., 1.0);\n\n}\n\n\n"},function(t,e){t.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float time;\nuniform float distortion;\nuniform float distortion2;\nuniform float speed;\nuniform float amount;\n\n\nvarying vec2 vUV;\n\nfloat rand(vec2 co){  \n  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n\n// Start Ashima 2D Simplex Noise\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n  vec2 i1;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  vec4 x12 = x0.xyxy + C.xxzz;\n x12.xy -= i1;\n\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n//float f(float x) {\n//  float a = 16.0*(x - floor(x));\n//  return a < 1.0 ? 0.5+0.5*a : a < 15.0 ? 1.0 : 0.5+0.5*(16.0-a);\n//}\n\n\nfloat grid(vec2 v) {\n  vec2 p = 16. * fract(v / 16.);\n  return (p.x < 1.0 ? 0.5+0.5*p.x : p.x < 15.0 ? 1.0 : 0.5+0.5*(16.0-p.x))\n  * (p.y < 1.0 ? 0.5+0.5*p.y : p.y < 15.0 ? 1.0 : 0.5+0.5*(16.0-p.y));\n}\n\n\n\n\n\n\n// End Ashima 2D Simplex Noise\n\nvoid main() {\n\n  //float offset = mix(0.,mix(0.0, pow(snoise(vec2(vUV.y*10.+time,0.)), 2.) * 0.1, 5.0*max(0.,sin(vUV.y*10.+time)-0.8)), distortion);\n  float q = fract(snoise(vec2(vUV.y+time*0.3,0.)));\n  float r = mix(0.001, 0.05, distortion);\n  float offset =  q < r ? mix(0.0, sin(3.14159* q/r), distortion2*0.2) : 0.0;\n \n  float tk = fract(time*0.25) < 0.1 ? (1.-abs(20.*fract(time*0.25)-1.0)) :0.;\n  offset = mix(0., (fract(snoise(vec2(vUV.y*150.+time*30.,0.)))-0.5)*0.05, tk);\n\n\n\n  vec2 p = vUV * resolution;\n  vec2 m = floor(p/16.);\n  vec4 col = texture2D(tDiffuse,vUV + vec2(offset, 0.));\n  vec2 pd = (vUV + vec2(offset, 0.))*resolution;\n  vec2 md = floor(pd/16.);\n  float k = pow(snoise(m+vec2(time*2.*speed,time*1.5*speed))*0.05,amount*.33);\n  k = k < 0.3 ? 0.1 : 0.9;\n  vec2 pg = m * 16.0;\n  vec4 colg = ( texture2D(tDiffuse, (pg + vec2(8., 8.))/resolution) +\n                texture2D(tDiffuse, (pg + vec2(12., 12.))/resolution) +\n                texture2D(tDiffuse, (pg + vec2(8., 4.))/resolution) +\n                texture2D(tDiffuse, (pg + vec2(4., 12.))/resolution)) * 0.25;\n\tgl_FragColor = vec4(grid(p) * mix(colg.rgb , col.rgb, k), 1.) ;//+ (offset > 0. ? 0.2:0.)*vec4(0.2,0.2,0.4,0.);\n\n}\n\n\n"},function(t,e){t.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float time;\nuniform float frametime;\nuniform float distortion;\nuniform float distortion2;\nuniform float speed;\nuniform float amount;\nuniform float alpha;\n\nvarying vec2 vUV;\n\n\n \nfloat rand(vec2 co){  \n  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n\n\n// Start Ashima 2D Simplex Noise\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n  vec2 i1;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  vec4 x12 = x0.xyxy + C.xxzz;\n x12.xy -= i1;\n\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n\n\n\nfloat grid(vec2 v) {\n  vec2 p = 16. * fract(v / 16.);\n  return (p.x < 1.0 ? 0.5+0.5*p.x : p.x < 15.0 ? 1.0 : 0.5+0.5*(16.0-p.x))\n  * (p.y < 1.0 ? 0.5+0.5*p.y : p.y < 15.0 ? 1.0 : 0.5+0.5*(16.0-p.y));\n}\n\n\n\nvec4 tunnel(vec2 uv)\n{\n  vec2 suv = vec2(uv.x * resolution.x/resolution.y, uv.y);\n  vec2 suv2 = floor(uv*resolution*0.5)/resolution;\n  vec4 p1 = \n    .03 *pow(fract(snoise(suv*200.+vec2(0.5,0.4))),10.) * vec4(0.9,0.9,0.9,1.0) +\n    0.2 * pow(fract(snoise(suv*132.+vec2(10.1,0.5)))*0.9,4.) * vec4(0.8,0.8,0.9,1.0)+\n    //5.2 * pow(snoise(suv*70.+vec2(0.3,20.4)) * 0.9,14.) * vec4(0.8,0.8,0.9,1.0)+\n    (rand(suv)<0.001 ? mix(0.4, 1.0,rand(suv)*1000.) * vec4(0.8,0.8,0.9,1.0) : vec4(0.0,0.0,0.0,0.0)) +\n    (rand(suv2)<0.0002 ? mix(0.4, 1.0,rand(suv2)*5000.) * vec4(0.8,0.8,0.9,1.0) : vec4(0.0,0.0,0.0,0.0)) +\n    3.2 * pow(snoise(suv*60.+vec2(0.3,10.8)) * 0.72,8.) * vec4(0.8,0.8,0.9,1.0)+\n    0.;\n  vec4 r = (p1 + vec4(0.,0.05 * pow(1.0-uv.y,1.2),0.15 * pow(1.0-uv.y,1.),0.)) * 0.8 + 1.2*vec4(0.05,0.08,0.1,1.);\n  return vec4(r.rgb * 0.75, r.a);\n}\n\n\nfloat vPlain(vec2 m)\n{\n  float ctime = time + 3000.;\n  float k = pow(snoise(m+vec2(ctime*2.*speed,ctime*1.5*speed))*0.05,1.*amount*.33);\n  return k < 0.3 ? 0.1 : 0.9;  \n}\n\nvoid main() {\n\n  float offset = 0.;//mix(0.0, pow(snoise(vec2(vUV.y*10.+time,0.)), 2.) * 0.1, 5.0*max(0.,sin(vUV.y*10.+time)-0.8));\n  vec2 p = vUV * resolution;\n  vec2 m = floor(p/16.);\n  vec2 m2 = floor(p/32.);\n  vec2 m3 = floor(p/48.);\n  vec4 col = tunnel(vUV + vec2(offset, 0.));\n  vec2 pd = (vUV + vec2(offset, 0.))*resolution;\n  vec2 md = floor(pd/16.);\n\n  vec2 pg = m * 16.0;\n  float k = vPlain(m)*vPlain(m2);//*vPlain(m3);\n\n  vec4 colg = ( tunnel((pg + vec2(8., 8.))/resolution) +\n                tunnel((pg + vec2(12., 12.))/resolution) +\n                tunnel((pg + vec2(8., 4.))/resolution) +\n                tunnel((pg + vec2(4., 12.))/resolution)) * 0.35;\n\n  vec4 vlines = ((fract(p.x/16.) * 16.0 >= 15.0 && k > .5 && vPlain(m+vec2(1.,0.)) <0.5) \n                || (fract(p.y/16.) * 16.0 >= 15.0 && k > .5 && vPlain(m+vec2(0.,1.)) <0.5) \n                || (fract(p.x/16.) * 16.0 <= 1.0 && k > .5 && vPlain(m-vec2(1.,0.)) <0.5) \n                || (fract(p.y/16.) * 16.0 <= 1.0 && k > .5 && vPlain(m-vec2(0.,1.)) <0.5)) \n                ? 0.*vec4(0.1, 0.1,0.1,1.0) : vec4(0.0); \n\tgl_FragColor = alpha * (vlines + vec4( grid(p) *  mix(colg.rgb , col.rgb, k), 1.)) + (1.0 - alpha) * texture2D(tDiffuse,vUV);\n   \n}\n\n\n"}]))},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(19).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=c(n(123)),d=c(n(130)),f=c(n(132)),p=c(n(128)),m=c(n(135)),v=n(137),g=s("LoadingView._elements"),y=s("LoadingView._starmap"),b=s("LoadingView._noWebgl"),x=s("ui"),w=s("events"),_=function(t){return new l((function(e){return setTimeout(e,t)}))},S=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this[g]=null,this[y]=t.starmap,this._scLogo=new h.default,this._arkLogo=new d.default,this._loading=new f.default,this[b]=t.noWebgl}return r(e,t),o(e,[{key:"serializeData",value:function(){return{fwa_sotd:window.RSI.sm_enable_fwa_sotd}}},{key:"onShow",value:function(){var t=this;return this._setup(),this[b]?void this.$el.addClass("sm-current-no-webgl"):localStorage.skip?void t.model.load().then((function(){t.model.set("loadingOverlayOpacity",0),localStorage.pause&&t.model.api.env.gameLoop.pause(),t.trigger("end")})):void this._initialAnimation()}},{key:"_setup",value:function(){this.ui.scLogoWrapper.append(this._scLogo.element),this.ui.arkLogoWrapper.prepend(this._arkLogo.element),this.ui.welcomeText.css("opacity",0),this.ui.fullscreenLaunchButton.css({opacity:0,display:"none"}),this.ui.fullscreenLaunchButtonCaption.addClass("hidden"),this.ui.launchButton.css({opacity:0,display:"none"}),this.model&&(this.model.set("loadingOverlayOpacity",1),this.model.get("soundFX").getSoundService().findGroup("loading:bgm").findSound("loading:background-music:main").play({fadeIn:500}))}},{key:"_initialAnimation",value:function(){var t=this;this.$el.addClass("sm-current-initial"),_(300).then((function(e){return t._scLogo.show()})),(new p.default).tween({from:{opacity:100},to:{opacity:0},delay:2400,duration:650,start:function(){t.model.get("soundFX").getSoundService().findGroup("loading:sfx").findSound("loading:logos:1").play()},step:function(e){var n=e.opacity;t.ui.scLogoWrapper.css("opacity",n/100)}}),(new p.default).tween({from:{top:50},to:{top:30},delay:2800,duration:250,easing:"easeOutQuad",step:function(e){var n=e.top;t.ui.scLogoWrapper.css("top",n+"%")}}),_(3e3).then((function(e){t.model.get("soundFX").getSoundService().findGroup("loading:sfx").findSound("loading:logos:2").play(),t._arkLogo.show().then((function(){return t.ui.arkLogoWrapper.addClass("sm-active")}))})),_(3850).then((function(e){t.ui.scLogoWrapper.css({opacity:1,top:"30px"}),t.ui.scLogoWrapper.addClass("small"),(new p.default).tween({from:{opacity:0},to:{opacity:100},duration:1e3,step:function(e){var n=e.opacity;t.ui.scLogoWrapper.css("opacity",n/100),t.ui.welcomeText.css("opacity",n/100)}}),(new p.default).tween({from:{opacity:0},to:{opacity:100},duration:100,start:function(){t.model.get("soundFX").getSoundService().findGroup("loading:sfx").findSound("loading:enter-button:appear").play(),t.ui.fullscreenLaunchButton.on("mouseenter",(function(){t.model.get("soundFX").getSoundService().findGroup("loading:sfx").findSound("loading:enter-button:hover").play()})),t.ui.fullscreenLaunchButton.css("display","block")},step:function(e){var n=e.opacity;t.ui.fullscreenLaunchButton.css("opacity",n/100)},finish:function(){t.ui.fullscreenLaunchButtonCaption.removeClass("hidden"),_(40).then((function(e){return t.ui.fullscreenLaunchButtonCaption.addClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.removeClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.addClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.removeClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.addClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.removeClass("on")})).then((function(t){return _(55)})).then((function(e){return t.ui.fullscreenLaunchButtonCaption.addClass("on")})).then((function(e){(new p.default).tween({from:{opacity:0},to:{opacity:100},duration:1e3,start:function(){t.ui.launchButton.css("display","block")},step:function(e){var n=e.opacity;return t.ui.launchButton.css("opacity",n/100)}})}))}})}))}},{key:"onLaunchFullscreenClick",value:function(t){t.preventDefault(),(new m.default).request(),this._loadMap()}},{key:"onLaunchClick",value:function(t){t.preventDefault(),this._loadMap()}},{key:"_loadMap",value:function(){var t=this;this.$el.removeClass("sm-current-initial"),this.model.get("soundFX").getSoundService().findGroup("loading:bgm").findSound("loading:background-music:extra").play({fadeIn:1e3}),this.$el.addClass("sm-current-loading"),this.model.load().then((function(){setTimeout((function(){t.$el.removeClass("sm-current-loading"),setTimeout((function(){t._showAcknowledgment()}),500)}),200)}))}},{key:"_showAcknowledgment",value:function(){localStorage.skipAcknowledgment?this._showInfo():this.$el.addClass("sm-current-acknowledgment")}},{key:"onAcknowledgeClick",value:function(){this.ui.dontShowAcknowledgment.get(0).checked&&(localStorage.skipAcknowledgment=!0),this.$el.removeClass("sm-current-acknowledgment"),this._showInfo()}},{key:"_showInfo",value:function(){localStorage.skipInfo?this._fadeOut():this.$el.addClass("sm-current-info")}},{key:"onInfoContinueClick",value:function(){this.ui.dontShowInfo.get(0).checked&&(localStorage.skipInfo=!0),this.$el.removeClass("sm-current-info"),this._fadeOut()}},{key:"_fadeOut",value:function(){var t=this;this.ui.fwaSOTD.removeClass("sm-active"),(new p.default).tween({from:{scale:100},to:{scale:325},delay:250,duration:750,easing:"easeInBack",step:function(e){var n=e.scale;t.ui.circleOne.css&&t.ui.circleOne.css("transform","scale("+n/100+") translateZ(0)")}}),(new p.default).tween({from:{scale:100},to:{scale:250},delay:350,duration:550,easing:"easeInBack",step:function(e){var n=e.scale;t.ui.circleTwo.css&&t.ui.circleTwo.css("transform","scale("+n/100+") translateZ(0)")}}),(new p.default).tween({from:{scale:100},to:{scale:150},delay:400,duration:350,easing:"easeInBack",step:function(e){var n=e.scale;t.ui.circleThree.css&&t.ui.circleThree.css("transform","scale("+n/100+") translateZ(0)")}}),(new p.default).tween({from:{opacity:100},to:{opacity:0},delay:200,duration:500,step:function(e){var n=e.opacity;return t.model.set("loadingOverlayOpacity",n/100)},finish:function(){t.trigger("end")}})}},{key:"template",get:function(){return v}},{key:"tagName",get:function(){return"section"}},{key:"className",get:function(){return"sm-loading-screen"}},{key:"ui",get:function(){return this[x]=this[x]||{fwaSOTD:".sm-fwa-sotd",scLogoWrapper:".sc-logo-wrapper",arkLogoWrapper:".ark-logo-wrapper",welcomeText:".welcome",fullscreenLaunchButton:".launch-fullscreen",fullscreenLaunchButtonCaption:".launch-fullscreen .caption",launchButton:".launch",circleOne:".circle-one",circleTwo:".circle-two",circleThree:".circle-three",acknowledgment:".sm-acknowledgment-scene",dontShowAcknowledgment:"#sm-dont-show-acknowledgment",acknowledge:".sm-acknowledge",info:".sm-info-scene",dontShowInfo:"#sm-dont-show-info",infoContinue:".sm-continue"}},set:function(t){this[x]=t}},{key:"events",get:function(){return this[w]=this[w]||{"click @ui.fullscreenLaunchButton":"onLaunchFullscreenClick","click @ui.launchButton":"onLaunchClick","click @ui.acknowledge":"onAcknowledgeClick","click @ui.infoContinue":"onInfoContinueClick"}},set:function(t){this[w]=t}}]),e}(u.ItemView);e.default=S,t.exports=e.default},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(97).default,a=n(124).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(128)),c=o("StarCitizenLogo._elements"),u=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?e:arguments[2];return function(){var i=t.getBBox(),r=(i.width/2+i.x).toFixed(3),o=(i.height/2+i.y).toFixed(3);return"matrix("+e+", 0, 0, "+n+", "+(r-e*r)+", "+(o-n*o)+")"}()},h=function(){function t(){r(this,t);var e=document.createElement("section");e.classList.add("sc-logo"),e.innerHTML=n(129),this[c]={root:e,background:e.querySelector("#sc-logo-background"),star:e.querySelector("#sc-logo-star"),text:e.querySelector("#sc-logo-text"),arcs:{first:e.querySelector("#sc-logo-arc-1"),second:e.querySelector("#sc-logo-arc-2"),third:e.querySelector("#sc-logo-arc-3"),fourth:e.querySelector("#sc-logo-arc-4")},chevronPairs:a(e.querySelectorAll('[id^="sc-logo-chevron-pair-"]')),bottom:e.querySelector("#sc-logo-bottom")},this[c].root.style.opacity=0}return i(t,[{key:"show",value:function(){var t=this[c],e=t.root,n=t.background,i=t.star,r=t.text,o=t.arcs,a=t.bottom,s=t.chevronPairs;n.style.opacity=0,i.setAttribute("transform",u(i,0)),r.style.opacity=0,o.first.setAttribute("transform",u(i,0)),o.second.setAttribute("transform",u(i,0)),o.third.setAttribute("transform",u(i,0)),o.fourth.setAttribute("transform",u(i,0)),a.style.opacity=0,s.forEach((function(t){return t.style.opacity=0})),e.style.opacity=1,(new l.default).tween({from:{scale:0,ratioXY:4},to:{scale:100,ratioXY:1},duration:350,step:function(t){var e=t.scale,n=t.ratioXY;return i.setAttribute("transform",u(i,e/100/n,e/100))}}),(new l.default).tween({from:{scale:10},to:{scale:100},duration:500,delay:100,easing:"easeInOutBack",step:function(t){var e=t.scale;return o.first.setAttribute("transform",u(o.first,e/100))}}),(new l.default).tween({from:{scale:10},to:{scale:100},duration:600,delay:100,easing:"easeInOutBack",step:function(t){var e=t.scale;return o.second.setAttribute("transform",u(o.second,e/100))}}),(new l.default).tween({from:{scale:10},to:{scale:100},duration:700,delay:100,easing:"easeInOutBack",step:function(t){var e=t.scale;return o.third.setAttribute("transform",u(o.third,e/100))}}),(new l.default).tween({from:{scale:10},to:{scale:100},duration:800,delay:100,easing:"easeInOutBack",step:function(t){var e=t.scale;return o.fourth.setAttribute("transform",u(o.fourth,e/100))}}),s.forEach((function(t,e){(new l.default).tween({from:{opacity:10},to:{opacity:100},duration:30,delay:750+20*e,step:function(e){var n=e.opacity;return t.style.opacity=n/100}})})),(new l.default).tween({from:{opacity:0},to:{opacity:100},duration:500,delay:850,step:function(t){var e=t.opacity;return r.style.opacity=a.style.opacity=e/100}}),(new l.default).tween({from:{opacity:0},to:{opacity:100},duration:1250,delay:850,step:function(t){var e=t.opacity;return n.style.opacity=e/100}})}},{key:"element",get:function(){return this[c].root}}]),t}();e.default=h,t.exports=e.default},function(t,e,n){t.exports={default:n(125),__esModule:!0}},function(t,e,n){n(22),n(126),t.exports=n(30).Array.from},[474,31,28,127,59,60,61,62,73],[475,25],function(t,e,n){(function(){var e=this||Function("return this")(),n=function(){"use strict";function n(){}function i(t,e){var n;for(n in t)Object.hasOwnProperty.call(t,n)&&e(n)}function r(t,e){return i(e,(function(n){t[n]=e[n]})),t}function o(t,e){i(e,(function(n){void 0===t[n]&&(t[n]=e[n])}))}function a(t,e,n,i,r,o,a){var l,c,u,h=o>t?0:(t-o)/r;for(l in e)e.hasOwnProperty(l)&&(u="function"==typeof(c=a[l])?c:d[c],e[l]=s(n[l],i[l],u,h));return e}function s(t,e,n,i){return t+(e-t)*n(i)}function l(t,e){var n=h.prototype.filter,r=t._filterArgs;i(n,(function(i){void 0!==n[i][e]&&n[i][e].apply(t,r)}))}function c(t,e,n,i,r,o,s,c,u,h,d){p=e+n+i,m=Math.min(d||w(),p),v=m>=p,g=i-(p-m),t.isPlaying()&&(v?(u(s,t._attachment,g),t.stop(!0)):(t._scheduleId=h(t._timeoutHandler,b),l(t,"beforeTween"),e+n>m?a(1,r,o,s,1,1,c):a(m,r,o,s,i,e+n,c),l(t,"afterTween"),u(r,t._attachment,g)))}function u(t,e){var n={},r=typeof e;return i(t,"string"===r||"function"===r?function(t){n[t]=e}:function(t){n[t]||(n[t]=e[t]||y)}),n}function h(t,e){this._currentState=t||{},this._configured=!1,this._scheduleFunction=f,void 0!==e&&this.setConfig(e)}var d,f,p,m,v,g,y="linear",b=1e3/60,x=Date.now?Date.now:function(){return+new Date},w="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:x;return f="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame)||setTimeout,h.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._timestamp=w(),this._start(this.get(),this._attachment),this.resume())},h.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._attachment=t.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=t.delay||0,this._start=t.start||n,this._step=t.step||n,this._finish=t.finish||n,this._duration=t.duration||500,this._currentState=r({},t.from)||this.get(),this._originalState=this.get(),this._targetState=r({},t.to)||this.get();var e=this;this._timeoutHandler=function(){c(e,e._timestamp,e._delay,e._duration,e._currentState,e._originalState,e._targetState,e._easing,e._step,e._scheduleFunction)};var i=this._currentState,a=this._targetState;return o(a,i),this._easing=u(i,t.easing||y),this._filterArgs=[i,this._originalState,a,this._easing],l(this,"tweenCreated"),this},h.prototype.get=function(){return r({},this._currentState)},h.prototype.set=function(t){this._currentState=t},h.prototype.pause=function(){return this._pausedAtTime=w(),this._isPaused=!0,this},h.prototype.resume=function(){return this._isPaused&&(this._timestamp+=w()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},h.prototype.seek=function(t){t=Math.max(t,0);var e=w();return this._timestamp+t===0||(this._timestamp=e-t,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,c(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,e),this.pause())),this},h.prototype.stop=function(t){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=n,(e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.oCancelAnimationFrame||e.msCancelAnimationFrame||e.mozCancelRequestAnimationFrame||e.clearTimeout)(this._scheduleId),t&&(l(this,"beforeTween"),a(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),l(this,"afterTween"),l(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},h.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},h.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},h.prototype.dispose=function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t]},h.prototype.filter={},h.prototype.formula={linear:function(t){return t}},d=h.prototype.formula,r(h,{now:w,each:i,tweenProps:a,tweenProp:s,applyFilter:l,shallowCopy:r,defaults:o,composeEasingObject:u}),"function"==typeof SHIFTY_DEBUG_NOW&&(e.timeoutHandler=c),t.exports=h,h}();n.shallowCopy(n.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},swingFrom:function(t){var e=1.70158;return t*t*((e+1)*t-e)},swingTo:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?2-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}}),function(){function t(t,e,n,i,r,o){function a(t){return((c*t+u)*t+h)*t}function s(t){return(3*c*t+2*u)*t+h}function l(t){return t>=0?t:0-t}var c=0,u=0,h=0,d=0,f=0,p=0;return c=1-(h=3*e)-(u=3*(i-e)-h),d=1-(p=3*n)-(f=3*(r-n)-p),function(t,e){return function(t){return((d*t+f)*t+p)*t}(function(t,e){var n,i,r,o,c,u;for(r=t,u=0;8>u;u++){if(l(o=a(r)-t)<e)return r;if(l(c=s(r))<1e-6)break;r-=o/c}if(n=0,i=1,r=t,n>r)return n;if(r>i)return i;for(;i>n;){if(l((o=a(r))-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r}(t,e))}(t,function(t){return 1/(200*t)}(o))}function e(e,n,i,r){return function(o){return t(o,e,n,i,r,1)}}n.setBezierFunction=function(t,i,r,o,a){var s=e(i,r,o,a);return s.displayName=t,s.x1=i,s.y1=r,s.x2=o,s.y2=a,n.prototype.formula[t]=s},n.unsetBezierFunction=function(t){delete n.prototype.formula[t]}}(),function(){var t=new n;t._filterArgs=[],n.interpolate=function(e,i,r,o,a){var s=n.shallowCopy({},e),l=a||0,c=n.composeEasingObject(e,o||"linear");t.set({});var u=t._filterArgs;u.length=0,u[0]=s,u[1]=e,u[2]=i,u[3]=c,n.applyFilter(t,"tweenCreated"),n.applyFilter(t,"beforeTween");var h=function(t,e,i,r,o,a){return n.tweenProps(r,e,t,i,1,a,o)}(e,s,i,r,c,l);return n.applyFilter(t,"afterTween"),h}}(),function(t){function e(t,e){var n,i=[],r=t.length;for(n=0;r>n;n++)i.push("_"+e+"_"+n);return i}function n(t){var e=t.match(m);return e?(1===e.length||t[0].match(p))&&e.unshift(""):e=["",""],e.join(x)}function i(e){t.each(e,(function(t){var n=e[t];"string"==typeof n&&n.match(b)&&(e[t]=function(t){return a(b,t,r)}(n))}))}function r(t){var e=function(t){return t=t.replace(/#/,""),3===t.length&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),w[0]=o(t.substr(0,2)),w[1]=o(t.substr(2,2)),w[2]=o(t.substr(4,2)),w}(t);return"rgb("+e[0]+","+e[1]+","+e[2]+")"}function o(t){return parseInt(t,16)}function a(t,e,n){var i=e.match(t),r=e.replace(t,x);if(i)for(var o,a=i.length,s=0;a>s;s++)o=i.shift(),r=r.replace(x,n(o));return r}function s(t){for(var e=t.match(v),n=e.length,i=t.match(y)[0],r=0;n>r;r++)i+=parseInt(e[r],10)+",";return i.slice(0,-1)+")"}function l(i){var r={};return t.each(i,(function(t){var o=i[t];if("string"==typeof o){var a=h(o);r[t]={formatString:n(o),chunkNames:e(a,t)}}})),r}function c(e,n){t.each(n,(function(t){for(var i=h(e[t]),r=i.length,o=0;r>o;o++)e[n[t].chunkNames[o]]=+i[o];delete e[t]}))}function u(e,n){t.each(n,(function(t){var i=e[t],r=function(t,e){for(var n,i={},r=e.length,o=0;r>o;o++)n=e[o],i[n]=t[n],delete t[n];return i}(e,n[t].chunkNames),o=function(t,e){_.length=0;for(var n=e.length,i=0;n>i;i++)_.push(t[e[i]]);return _}(r,n[t].chunkNames);i=function(t,e){for(var n=t,i=e.length,r=0;i>r;r++)n=n.replace(x,+e[r].toFixed(4));return n}(n[t].formatString,o),e[t]=function(t){return a(g,t,s)}(i)}))}function h(t){return t.match(v)}function d(e,n){t.each(n,(function(t){var i,r=n[t].chunkNames,o=r.length,a=e[t];if("string"==typeof a){var s=a.split(" "),l=s[s.length-1];for(i=0;o>i;i++)e[r[i]]=s[i]||l}else for(i=0;o>i;i++)e[r[i]]=a;delete e[t]}))}function f(e,n){t.each(n,(function(t){var i=n[t].chunkNames,r=i.length,o=e[i[0]];if("string"===typeof o){for(var a="",s=0;r>s;s++)a+=" "+e[i[s]],delete e[i[s]];e[t]=a.substr(1)}else e[t]=o}))}var p=/(\d|\-|\.)/,m=/([^\-0-9\.]+)/g,v=/[0-9.\-]+/g,g=new RegExp("rgb\\("+v.source+/,\s*/.source+v.source+/,\s*/.source+v.source+"\\)","g"),y=/^.*\(/,b=/#([0-9]|[a-f]){3,6}/gi,x="VAL",w=[],_=[];t.prototype.filter.token={tweenCreated:function(t,e,n,r){i(t),i(e),i(n),this._tokenData=l(t)},beforeTween:function(t,e,n,i){d(i,this._tokenData),c(t,this._tokenData),c(e,this._tokenData),c(n,this._tokenData)},afterTween:function(t,e,n,i){u(t,this._tokenData),u(e,this._tokenData),u(n,this._tokenData),f(i,this._tokenData)}}}(n)}).call(null)},function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?>\r\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n\t viewBox="0 0 309 364" xml:space="preserve">\r\n\t <g id="sc-logo-background">\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M213,41c0-6.1,0-12,0-18.2c-4-0.3-7.9-0.5-12.1-0.8\r\n\t\t\tc-0.2,7.7,0.2,15.3,0.1,22.8c0,7.5,0,15,0,22.6c-3.1-1.1-6.2-2.2-9.5-3.4c-0.2-16.1-0.4-32.4-0.6-48.7c0.8-0.1,1.4-0.1,2.1-0.1\r\n\t\t\tc7.5,0,15,0,22.5,0c1.1,0,2.3,0.1,3.4,0.3c2,0.4,3.3,1.6,3.7,3.6c0.2,1,0.3,2.1,0.3,3.2c0,7.2,0,14.4,0,21.6c0,0.9-0.1,1.8-0.3,2.7\r\n\t\t\tc-0.4,1.7-1.4,2.4-3.1,2.2c-1.1-0.1-2.2-0.5-3.3-0.7c-0.6-0.1-1.2-0.3-2.1-0.5c3.8,10.9,7.3,21.6,10.3,32.8c-0.8-0.4-1.2-0.7-1.7-1\r\n\t\t\tc-2.3-1.5-4.6-3.1-6.9-4.5c-0.9-0.6-1.4-1.3-1.7-2.3c-3.2-9.1-6.4-18.1-9.7-27.1c-0.7-2-0.8-4.1-0.6-6.5\r\n\t\t\tC206.8,39.7,209.9,40.3,213,41z M116.4,30.8c0-4,0.1-7.9,0-11.7c0-1.8-1.3-3.1-3.2-3.5c-1.2-0.3-2.5-0.4-3.8-0.4\r\n\t\t\tc-6.2,0-12.4,0.1-18.7,0.1c-3.9,0-5.7,1.8-5.8,5.7c-0.1,4.9,0,9.9,0,14.8c0,2.2,0.8,4,2.8,5.1c3.7,2.1,7.3,4.4,10.9,6.5\r\n\t\t\tc2.4,1.4,5,2.6,7.3,3.9c0,3.5,0,6.9,0,10.2c-3.8,1.7-7.5,3.3-11.5,5c0-4,0-7.7,0-11.5c-2,0.3-7.6,2.7-9.6,4.1c0,5.3,0,10.7,0,16\r\n\t\t\tc0,0.4,0.1,0.8,0.2,1.2c0.4,1.5,1.3,2,2.7,1.5c1-0.3,1.9-0.8,2.8-1.4c6.1-3.9,12.5-7.2,19.2-9.9c1.3-0.5,2.5-1.3,3.7-2.1\r\n\t\t\tc1.5-1.1,2.3-2.7,2.3-4.6c0-4,0-8.1,0.1-12.1c0-1.6-0.7-2.7-2.1-3.4c-1.1-0.5-2.1-1.1-3.2-1.7c-4.9-2.9-9.7-5.7-14.6-8.7\r\n\t\t\tc-0.6-0.4-1.4-1.1-1.4-1.6c-0.1-3.2-0.1-6.5-0.1-9.8c4.1-0.5,7.9-0.7,11.9-0.7c0,3.4,0,6.5,0,9.8C109.9,31.6,113.1,31.2,116.4,30.8\r\n\t\t\tz M257,333c-0.2,0-0.4,0.1-0.6,0.1c-1.4-2.7-2.9-5.5-4.3-8.2c-1.7-3.3-3.4-6.5-5.1-9.8c-0.3-0.6-0.9-1.3-1.4-1.4\r\n\t\t\tc-1.8-0.2-3.6-0.1-5.5-0.1c0,11.9,0,23.5,0,35.2c2.3,0,4.5,0,6.9,0c0-6.8,0-13.4,0-20c0.1,0,0.3,0,0.4-0.1\r\n\t\t\tc3.4,6.7,6.8,13.4,10.3,20.2c2.1,0,4.1,0.1,6.1-0.1c0-11.9,0-23.4,0-35.1c-2.3,0-4.4,0-6.8,0C257,320.2,257,326.6,257,333z\r\n\t\t\tM152.5,15.3c-10.4,0-20.7,0-31.1,0c-0.2,2.2-0.2,4.2,0,6.3c3.7,0.1,7.1-0.3,10.7,0c-0.1,13.1-0.3,26-0.4,39c3.5-0.5,6.7-1,9.9-1.4\r\n\t\t\tc0-0.7,0.1-1.2,0.1-1.8c0.1-7,0.1-14,0.1-21c0-4.4,0-8.9,0.1-13.3c0-0.6,0.1-1.2,0.2-2c3.6,0,7,0,10.5,0\r\n\t\t\tC152.5,19,152.5,17.2,152.5,15.3z M61.5,336.9c0,2.5,0,4.8,0,7.2c-3.1,0-6,0-8.8,0c-0.5-3-0.3-24.4,0.2-25.9c2.8,0,5.6,0,8.6,0\r\n\t\t\tc0,2.3,0,4.5,0,6.8c2.4,0,4.6,0,6.9,0c0-3,0-5.9,0-8.8c0-1.2-0.8-2-1.9-2.3c-0.7-0.2-1.5-0.3-2.3-0.3c-4.9,0-9.9,0-14.8,0\r\n\t\t\tc-2.5,0-4.1,0.7-4.1,4.1c0.1,7.9,0,15.8,0,23.8c0,1.4,0,2.8,0,4.2c0.1,1.8,0.7,2.6,2.4,3c0.8,0.2,1.5,0.3,2.3,0.3\r\n\t\t\tc4.5,0,8.9,0,13.4,0c0.8,0,1.7-0.1,2.5-0.3c1.7-0.4,2.4-1.2,2.4-3c0-2.4,0-4.8,0-7.2c0-0.5-0.1-1.1-0.2-1.6\r\n\t\t\tC66,336.9,63.9,336.9,61.5,336.9z M207.8,313.7c0,11.8,0,23.4,0,35.1c6.5,0,12.9,0,19.4,0c0-1.6,0-3,0-4.7c-2.2,0-4.2,0-6.2,0\r\n\t\t\tc-2-0.1-4,0.3-6-0.2c0-3.6,0-7,0-10.7c3.5,0,7,0,10.3,0c0-1.7,0-3,0-4.6c-3.5,0-6.9,0-10.2,0c-0.4-2.4-0.4-8.5,0.1-10.2\r\n\t\t\tc3.9,0,7.8,0,11.8,0c0-1.6,0-3.1,0-4.6C220.5,313.7,214.2,313.7,207.8,313.7z M172.8,348.8c7.2,0,14.2,0,21.3,0c0-1.7,0-3.2,0-4.9\r\n\t\t\tc-4.3,0-8.4,0-12.8,0c0.3-0.7,0.5-1.1,0.7-1.6c3.8-8,7.7-16.1,11.5-24.1c0.7-1.5,0.9-2.9,0.5-4.4c-2.9-0.5-18.8-0.3-20.2,0.1\r\n\t\t\tc0,1.5,0,2.9,0,4.5c3.9,0,7.7,0,11.8,0c-0.5,1.1-0.8,1.9-1.2,2.7c-3.7,7.8-7.4,15.6-11.1,23.3C172.6,345.9,172.4,347.2,172.8,348.8\r\n\t\t\tz M129.9,318.3c2.7,0,5.1,0,7.6,0c0-1.7,0-3.1,0-4.6c-7.5,0-14.8,0-22.3,0c0,1.6,0,3,0,4.7c2.6,0,5,0,7.6,0c0,2.8,0,5.3,0,7.8\r\n\t\t\tc0,2.5,0,4.9,0,7.4c0,2.5,0,5.1,0,7.6c0,2.5-0.1,5,0.1,7.6c2.5,0,4.7,0.1,7-0.1C129.9,338.6,129.9,328.7,129.9,318.3z M89.3,313.7\r\n\t\t\tc0,11.8,0,23.4,0,35.1c2.4,0,4.6,0,6.9,0c0-11.8,0-23.4,0-35.1C93.9,313.7,91.6,313.7,89.3,313.7z M159,313.7c-2.4,0-4.6,0-6.9,0\r\n\t\t\tc0,11.7,0,23.4,0,35.1c2.3,0,4.6,0,6.9,0C159,337.1,159,325.5,159,313.7z M172.9,15.3c-3.6,0-6.9,0-10.3,0\r\n\t\t\tc-4.2,14.4-8.5,28.7-12.8,43.2c3.4,0,6.6,0,9.9,0c0.7-2.6,1.3-5.2,2.1-8c4.1,0.3,8.1,0.7,12.2,1c0.8,3.1,1.5,6,2.2,8.9\r\n\t\t\tc3.3,0.7,6.4,1.4,9.9,2.1C181.8,46.3,177.5,30.7,172.9,15.3z M167.5,26.8c-1.4,5.9-2.9,11.9-4.4,18c3.1,0.2,6.1,0.5,9.5,0.7\r\n\t\t\tc-1.6-6.4-3.1-12.6-4.6-18.7C167.8,26.8,167.6,26.8,167.5,26.8z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M88.9,304.5c2.6,0.7,4.8,0.7,7.7,0.1\r\n\t\t\tc6.7-1.3,12.5-4.4,17.6-8.8c1-0.8,1.8-1.8,2.6-2.8c0.5-0.7,0.8-1.6,1.1-2.4c-1.5-1.2-3-1-4.5-0.9c-4.8,0.5-9.2,2.1-13.4,4.3\r\n\t\t\tc-3.8,2-7.1,4.6-9.7,8C89.8,302.9,89.4,303.7,88.9,304.5z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M191.5,290.7c0.2,1.9,1.4,3.1,2.6,4.2c5.4,5,11.6,8.5,18.9,9.8\r\n\t\t\tc2.4,0.4,4.8,0.6,7.6-0.2c-1.3-1.6-2.2-3.1-3.4-4.3c-3.7-4-8.4-6.6-13.5-8.5c-2.9-1-5.8-1.8-8.9-1.9\r\n\t\t\tC193.7,289.8,192.4,289.7,191.5,290.7z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M204.8,285.9c0.5,1.7,0.7,2.3,2.5,3.5c2.5,1.7,5.1,3.2,7.9,4.5\r\n\t\t\tc4.6,2.1,9.5,3.1,14.6,2.9c1.7-0.1,3.4-0.3,5.3-1.1c-1.1-1.2-1.9-2.3-3-3.1c-6.8-5.8-14.8-8-23.5-7.9\r\n\t\t\tC207.3,284.6,205.8,284.7,204.8,285.9z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M74.2,295.8c1,0.3,1.7,0.5,2.4,0.6c9.9,1.4,18.5-1.7,26.2-7.7\r\n\t\t\tc0.4-0.3,0.8-0.8,1.1-1.3c0.9-1.3,0.7-2-0.9-2.5c-0.3-0.1-0.7-0.2-1-0.2c-2.2,0-4.5-0.1-6.7,0.1c-6.1,0.7-11.7,2.7-16.6,6.3\r\n\t\t\tC77,292.5,75.5,293.9,74.2,295.8z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M247.6,285.1c-1.4-1.1-2.6-2.1-3.9-2.9\r\n\t\t\tc-6.2-3.8-13-4.9-20.1-4.5c-1.5,0.1-3.1,0.3-4.6,0.7c-1,0.2-2.1,0.5-2.5,1.6C220,286.5,239.6,289.9,247.6,285.1z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M92.9,279.8c-0.8-1-1.9-1.4-3-1.6c-3.5-0.8-7.1-0.8-10.7-0.4\r\n\t\t\tc-5,0.5-9.7,1.9-13.9,4.6c-1.2,0.8-2.4,1.6-3.4,3.1c1.2,0.5,2.2,0.9,3.3,1.2c3.4,1,6.8,1.1,10.3,0.7c4.8-0.5,9.4-1.8,13.7-4.1\r\n\t\t\tC90.6,282.5,92.2,281.7,92.9,279.8z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M227.8,272.4c0.8,1.4,2,2.1,3.2,2.5c2.8,0.8,5.7,1.7,8.6,2.1\r\n\t\t\tc5.3,0.8,10.6,0.5,15.6-1.5c1.3-0.5,2.4-1.2,4-2c-1.3-0.8-2.1-1.4-3-1.9c-3.5-1.9-7.2-2.7-11.1-3c-4.6-0.4-9.2,0-13.6,1.4\r\n\t\t\tC230.1,270.4,228.7,270.9,227.8,272.4z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M50.2,273.6c1.6,0.8,2.8,1.5,4.1,2c5,2,10.2,2.2,15.4,1.5\r\n\t\t\tc3-0.4,5.9-1.4,8.8-2.2c1.3-0.4,2.4-1.1,3.1-2.5c-1.1-1.6-2.8-2.1-4.5-2.6c-5.9-1.6-11.8-1.8-17.8-0.4\r\n\t\t\tC56.1,270,53.1,271.2,50.2,273.6z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M238.5,264c1.1,0.5,1.9,1.2,2.9,1.4c1.8,0.5,3.6,0.9,5.4,1\r\n\t\t\tc6.4,0.6,12.7-0.2,18.5-3.2c1.4-0.7,2.7-1.7,4.5-2.9c-1.8-0.7-3-1.4-4.3-1.8c-5.4-1.7-10.9-1.5-16.3-0.2c-2.5,0.6-5,1.5-7.4,2.5\r\n\t\t\tC240.4,261.4,239.2,262.1,238.5,264z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M40,260.4c1.9,2,4.2,3.2,6.6,4c6.6,2.4,13.3,2.8,20.2,1.3\r\n\t\t\tc0.9-0.2,1.8-0.5,2.6-0.9c1.6-0.8,1.7-1.6,0.3-2.7c-0.7-0.6-1.5-1.1-2.3-1.5c-6.5-2.9-13.3-4-20.4-2.9\r\n\t\t\tC44.5,258.3,42.2,258.9,40,260.4z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M31.8,246.4c1.2,1.1,2.1,2.1,3.1,2.8c7,5.1,14.9,6.6,23.3,5.9\r\n\t\t\tc1.2-0.1,2.5-0.3,3.3-1.5C58.7,247,40.4,242.4,31.8,246.4z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M277.6,246.2c-1.2-0.4-1.8-0.6-2.5-0.8\r\n\t\t\tc-3.1-0.8-6.3-0.9-9.4-0.5c-5.3,0.7-10.2,2.4-14.6,5.2c-1,0.6-1.9,1.5-2.7,2.3c-0.8,0.9-0.6,1.6,0.5,2c1.2,0.4,2.6,0.8,3.9,0.8\r\n\t\t\tc2.8,0,5.7-0.1,8.4-0.5c5.4-0.9,10.5-2.9,14.7-6.6C276.3,247.6,276.8,247,277.6,246.2z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M53.6,242.5c-0.4-1.9-1.7-3-3-4.1c-5.1-4.1-10.9-6.8-17.4-7.6\r\n\t\t\tc-2.5-0.3-5-0.4-7.7,0.5c1,1.7,2.1,3,3.4,4.2c6,5.1,13,7.6,20.7,8.1C50.9,243.6,52.3,243.6,53.6,242.5z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M283.8,231.6c-0.1-0.2-0.2-0.4-0.2-0.6\r\n\t\t\tc-1.1-0.1-2.2-0.4-3.3-0.4c-8.5-0.2-15.7,3-22.1,8.3c-0.8,0.7-1.5,1.5-2,2.4c-0.6,1-0.3,1.6,0.8,1.9c0.9,0.2,2,0.4,2.9,0.3\r\n\t\t\tc7.7-0.5,14.6-2.9,20.5-8.1C281.6,234.4,282.7,232.9,283.8,231.6z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M20.9,215.1c0.8,2.3,2.2,4,3.7,5.6c4.6,4.9,10.3,7.8,16.7,9.4\r\n\t\t\tc1.1,0.3,2.2,0.4,3.3,0.4c0.7,0,1.4-0.3,2.1-0.4c-0.2-2-0.5-2.6-1.9-4.1c-4.7-5.1-10.3-8.8-17.1-10.5\r\n\t\t\tC25.6,215,23.4,214.7,20.9,215.1z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M262.1,229.9c1.9,1.1,3.6,0.8,5.1,0.5\r\n\t\t\tc4.5-0.9,8.6-2.8,12.4-5.3c3.2-2.1,6-4.7,8-8.1c0.3-0.6,0.6-1.2,0.9-2c-1-0.1-1.6-0.1-2.2-0.1c-0.8,0-1.7,0.1-2.5,0.2\r\n\t\t\tc-7.9,1.3-14.2,5.3-19.4,11.2C263.4,227.3,262.9,228.5,262.1,229.9z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M18.5,199c0.4,2.3,1.2,3.8,2.2,5.3c4.1,6.3,10,10.4,17,13\r\n\t\t\tc1,0.4,2.1,0.4,3.1,0.5c0.9,0,1.3-0.5,1.1-1.4c-0.3-0.9-0.6-1.9-1.1-2.7c-4.4-6.6-10.2-11.5-17.8-13.8\r\n\t\t\tC21.6,199.4,20.2,199.3,18.5,199z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M290.9,199.2c-1.2,0.1-2.1,0.1-3,0.3\r\n\t\t\tc-6.3,1.3-11.4,4.8-15.7,9.5c-1.6,1.7-2.9,3.7-4.2,5.6c-0.6,0.8-1,1.9-0.5,3c1.7,0.7,3.2,0,4.7-0.5c4.9-1.8,9.2-4.6,12.8-8.4\r\n\t\t\tc2-2.1,3.8-4.4,4.9-7.1C290.3,200.9,290.5,200.2,290.9,199.2z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M18.2,183.3c-0.1,0.7-0.2,0.9-0.1,1.1c0.2,0.8,0.3,1.5,0.6,2.2\r\n\t\t\tc3,8.1,8.8,13.6,16.3,17.5c0.5,0.3,1.1,0.4,1.6,0.5c0.6,0.1,1.2,0,1.8,0c0.3-1.7,0.3-2.4-0.6-4.2c-3.2-6.4-7.7-11.6-14.1-15.1\r\n\t\t\tC22,184.5,20.1,184,18.2,183.3z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M291.2,183.5c-0.8,0.2-1.3,0.2-1.8,0.4\r\n\t\t\tc-8.9,3.1-14.6,9.5-18.3,18c-0.3,0.8-0.2,1.7-0.3,2.6c2,0.3,2.5,0.3,4.3-0.6c6.4-3.4,11.5-8.2,14.7-14.8\r\n\t\t\tC290.5,187.4,291.3,185.7,291.2,183.5z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M36.7,190.5c-0.1-1.2,0-2.4-0.3-3.5c-0.4-1.5-0.9-3-1.6-4.4\r\n\t\t\tc-2.7-5.7-6.4-10.6-11.9-13.9c-1.1-0.6-2.2-1.1-3.5-1.7c0,1.1-0.1,1.9,0,2.6c1.7,8.7,6.7,15.2,13.9,20.2\r\n\t\t\tC34.1,190.4,35,191,36.7,190.5z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M273.3,190.9c0.8-0.3,1.8-0.5,2.5-1\r\n\t\t\tc7.3-4.8,12.2-11.2,14.1-19.8c0.2-0.9,0.1-1.9,0.2-3.2c-1.3,0.6-2.2,0.9-3.1,1.3c-2.7,1.4-5,3.4-7,5.7c-3.5,4.1-6.1,8.6-7.3,13.9\r\n\t\t\tC272.5,188.9,272.4,189.8,273.3,190.9z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M22.1,151.2c-0.1,1.2-0.3,2.1-0.2,3\r\n\t\t\tc0.7,8.4,4.5,15.2,10.5,20.9c0.8,0.8,2,1.2,3.1,1.9c1.2-1.7,1-3.4,0.7-4.9c-1.2-6.4-3.9-12.1-8.4-16.8\r\n\t\t\tC26.2,153.6,24.5,152.2,22.1,151.2z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M287.1,151.1c-1.2,0.8-2.3,1.3-3.2,2.1\r\n\t\t\tc-6.4,5.3-9.6,12.4-10.9,20.5c-0.2,1-0.1,2.1,0.7,2.9C280.5,175.3,288.7,160,287.1,151.1z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M36.4,160.7c0.3-1,0.7-1.8,0.7-2.7c0.2-8.6-2.4-16.3-8.5-22.5\r\n\t\t\tc-0.6-0.6-1.3-1.1-2.1-1.7c-0.2,0.6-0.4,0.9-0.5,1.3c-0.6,2.7-0.5,5.3,0,8c1,5.5,3.2,10.5,6.7,14.9\r\n\t\t\tC33.5,159.2,34.4,160.3,36.4,160.7z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M282.9,133.8c-0.8,0.6-1.4,1-1.9,1.5\r\n\t\t\tc-6.3,6.1-8.7,13.8-8.8,22.4c0,1,0.2,2.1,1.1,3c1.6-0.2,2.5-1.4,3.4-2.5c3.6-4.6,5.9-9.8,6.7-15.5\r\n\t\t\tC283.8,139.8,283.9,136.9,282.9,133.8z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M39.3,146.2c1.2-0.9,1.4-2.1,1.6-3.4c0.5-2.8,0.3-5.6,0-8.4\r\n\t\t\tc-0.6-4.8-2.1-9.4-5-13.3c-0.7-0.9-1.5-1.6-2.3-2.6c-0.3,0.8-0.5,1.2-0.7,1.7c-1,3-1.1,6.1-0.9,9.2c0.4,4.9,1.8,9.5,4.3,13.8\r\n\t\t\tC36.9,144.4,37.7,145.7,39.3,146.2z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M275.7,118.7c-0.7,0.7-1.4,1.4-2,2.2c-2.7,3.5-4.2,7.6-5,12\r\n\t\t\tc-0.6,3.6-0.8,7.3-0.1,10.9c0.2,1,0.4,1.9,1.4,2.4C276.2,143.1,279.8,125.5,275.7,118.7z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M44,132.8c1.6-1,2-2.2,2.3-3.4c1.2-4.6,1.4-9.2,0.7-13.8\r\n\t\t\tc-0.5-3.4-1.6-6.6-3.5-9.4c-0.3-0.4-0.7-0.8-1.2-1.3c-0.5,1.1-1,1.8-1.3,2.7c-2.8,7.9-2,15.5,1.3,23C42.6,131.3,43.4,132,44,132.8z\r\n\t\t\t"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M265,132.6c1.2-0.4,1.8-1.4,2.2-2.4c3-7.2,3.8-14.5,1.4-22.1\r\n\t\t\tc-0.4-1.1-1-2.1-1.7-3.5c-0.8,1.1-1.4,1.8-1.8,2.6c-3.9,7.5-4.2,15.2-1.9,23.2C263.6,131.2,264,132.2,265,132.6z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M244,78.7c-0.4,1.2-0.8,2.1-1,3.1c-1.6,8,0.3,15.3,4.4,22.1\r\n\t\t\tc0.5,0.8,1.4,1.5,2.2,2.2c1.3-1.4,1.5-1.8,1.8-3.5c0.8-5.8-0.1-11.4-2.4-16.8C247.9,83.2,246.4,80.9,244,78.7z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M59.8,106.1c0.8-0.8,1.7-1.5,2.2-2.3\r\n\t\t\tc4.1-6.8,5.9-14.2,4.3-22.1c-0.2-0.9-0.6-1.8-1.1-3.1c-1.1,1.3-2.1,2.3-2.8,3.4c-4.1,6.2-5.2,13.2-4.5,20.5\r\n\t\t\tC58.1,103.7,58.3,105,59.8,106.1z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M256.3,91.2c-0.6,1.2-1.1,2-1.4,3c-2.6,7.7-1.9,15.1,1.3,22.5\r\n\t\t\tc0.4,0.9,1,1.9,2.2,2.3c1.4-0.9,1.8-2.4,2.1-3.9c1.1-4.4,1.2-9,0.4-13.4C260.2,97.9,259.1,94.4,256.3,91.2z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M51,118.9c5.6-3.9,6.7-21.4,1.7-27.6c-0.7,1.1-1.4,2-1.9,3\r\n\t\t\tc-3.4,7-3.6,14.3-1.7,21.7C49.4,117.2,49.8,118.3,51,118.9z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M79.2,69.1c-0.7,0.5-1.2,0.9-1.7,1.3\r\n\t\t\tC71.4,76.3,69.1,83.7,69,92c0,1,0.1,2.1,1.1,2.8C76.4,92.4,82,76.7,79.2,69.1z"/>\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:#347BA3;" d="M230,69.3c-0.9,3-1,4.7-0.4,8.7c0.9,5.4,3.1,10.2,6.5,14.5\r\n\t\t\tc0.8,1,1.7,2.1,3.1,2.3C243,89.6,236.9,72.8,230,69.3z"/>\r\n\t\t<path style="fill:#347BA3;" d="M199.7,172.9c-16.8-2.6-28-6.1-33.6-17.6c-5.6-11.6-7.8-28.8-8.8-41.7c-1-12.9-2.6-46.2-2.6-46.2\r\n\t\t\ts-1.7,33.2-2.6,46.1c-1,12.9-3.2,30.1-8.8,41.7c-5.6,11.6-16.8,15-33.6,17.6s-54.4,4.4-54.4,4.4c62.6,4,83.4,2.3,91.7,32.3\r\n\t\t\tc6.7,24.1,7.6,72.1,7.7,90v0c0,4.4,0,7,0,7s0-2.6,0-7c0.1-18,1-65.9,7.7-90c8.3-29.9,29.1-28.3,91.7-32.3\r\n\t\t\tC254.1,177.3,216.6,175.5,199.7,172.9z"/>\r\n\t\t<path style="fill:#347BA3;" d="M261.9,135.5c-2.9-6.8-6.5-13.3-10.7-19.4c-4.2-6-8.9-11.7-14.2-16.9c-5.3-5.2-11-9.9-17.2-13.9\r\n\t\t\tc-1.3-0.9-2.6-1.7-4-2.5c30.7,20.2,51,55.2,51,95c0,0.4,0,0.7,0,1.1c0,0.4,0,0.7,0,1.1c0,28.9-11.3,55.1-29.8,74.8\r\n\t\t\tc-20.5,22.3-49.7,36.3-82.2,36.3s-61.7-14-82.2-36.3C54,235.1,42.7,208.8,42.7,180c0-0.4,0-0.7,0-1.1c0-0.4,0-0.7,0-1.1\r\n\t\t\tc0-39.8,20.3-74.8,51-95c-1.4,0.8-2.7,1.7-4,2.5c-6.2,4.1-11.9,8.8-17.2,13.9c-5.3,5.2-10,10.9-14.2,16.9\r\n\t\t\tc-4.2,6.1-7.8,12.6-10.7,19.4c-6.1,14.1-9.1,29-9.1,44.5s3.1,30.4,9.1,44.5c2.9,6.8,6.5,13.3,10.7,19.4c4.2,6,8.9,11.7,14.2,16.9\r\n\t\t\tc5.3,5.2,11,9.9,17.2,13.9c6.2,4.1,12.9,7.7,19.8,10.5c14.3,6,29.6,9,45.3,9s30.9-3,45.3-9c6.9-2.9,13.5-6.4,19.8-10.5\r\n\t\t\tc6.2-4.1,11.9-8.8,17.2-13.9c5.3-5.2,10-10.9,14.2-16.9c4.2-6.1,7.8-12.6,10.7-19.4c6.1-14.1,9.1-29,9.1-44.5\r\n\t\t\tS267.9,149.6,261.9,135.5z"/>\r\n\t\t<path style="fill:#347BA3;" d="M154.7,74.6c57.1,0,103.3,46.3,103.3,103.3s-46.3,103.3-103.3,103.3S51.4,234.9,51.4,177.9\r\n\t\t\tS97.7,74.6,154.7,74.6 M154.7,72.5c-14.2,0-28,2.8-41,8.3c-12.6,5.3-23.8,12.9-33.5,22.6c-9.7,9.7-17.3,21-22.6,33.5\r\n\t\t\tc-5.5,13-8.3,26.8-8.3,41s2.8,28,8.3,41c5.3,12.6,12.9,23.8,22.6,33.5c9.7,9.7,21,17.3,33.5,22.6c13,5.5,26.8,8.3,41,8.3\r\n\t\t\tc14.2,0,28-2.8,41-8.3c12.6-5.3,23.8-12.9,33.5-22.6c9.7-9.7,17.3-21,22.6-33.5c5.5-13,8.3-26.8,8.3-41s-2.8-28-8.3-41\r\n\t\t\tc-5.3-12.6-12.9-23.8-22.6-33.5c-9.7-9.7-21-17.3-33.5-22.6C182.8,75.2,169,72.5,154.7,72.5z"/>\r\n\t\t<path style="fill:#347BA3;" d="M154.7,84.6c51.5,0,93.3,41.8,93.3,93.3s-41.8,93.3-93.3,93.3s-93.3-41.8-93.3-93.3\r\n\t\t\tS103.2,84.6,154.7,84.6 M154.7,81.4c-13,0-25.7,2.6-37.6,7.6c-11.5,4.9-21.8,11.8-30.7,20.7c-8.9,8.9-15.8,19.2-20.7,30.7\r\n\t\t\tc-5,11.9-7.6,24.5-7.6,37.6c0,13,2.6,25.7,7.6,37.6c4.9,11.5,11.8,21.8,20.7,30.7s19.2,15.8,30.7,20.7c11.9,5,24.5,7.6,37.6,7.6\r\n\t\t\tc13,0,25.7-2.6,37.6-7.6c11.5-4.9,21.8-11.8,30.7-20.7c8.9-8.9,15.8-19.2,20.7-30.7c5-11.9,7.6-24.5,7.6-37.6\r\n\t\t\tc0-13-2.6-25.7-7.6-37.6c-4.9-11.5-11.8-21.8-20.7-30.7c-8.9-8.9-19.2-15.8-30.7-20.7C180.4,83.9,167.8,81.4,154.7,81.4z"/>\r\n\t\t<path style="fill:#347BA3;" d="M154.7,114.1c35.3,0,63.8,28.6,63.8,63.8s-28.6,63.8-63.8,63.8s-63.8-28.6-63.8-63.8\r\n\t\t\tS119.5,114.1,154.7,114.1 M154.7,107.7c-9.5,0-18.7,1.9-27.3,5.5c-8.4,3.5-15.9,8.6-22.3,15c-6.4,6.4-11.5,14-15,22.3\r\n\t\t\tc-3.7,8.7-5.5,17.9-5.5,27.3s1.9,18.7,5.5,27.3c3.5,8.4,8.6,15.9,15,22.3c6.4,6.4,14,11.5,22.3,15c8.7,3.7,17.9,5.5,27.3,5.5\r\n\t\t\ts18.7-1.9,27.3-5.5c8.4-3.5,15.9-8.6,22.3-15c6.4-6.4,11.5-14,15-22.3c3.7-8.7,5.5-17.9,5.5-27.3s-1.9-18.7-5.5-27.3\r\n\t\t\tc-3.5-8.4-8.6-15.9-15-22.3c-6.4-6.4-14-11.5-22.3-15C173.4,109.5,164.2,107.7,154.7,107.7z"/>\r\n\t\t<path style="fill:#347BA3;" d="M128.1,296c-1.2,0.3-2,1.6-1.7,2.8l0.5,1.9c0.3,1.2,1.6,2,2.8,1.7l24.7-6.3c0.1,0,0.2-0.1,0.4-0.1\r\n\t\t\tc0.1,0,0.2,0.1,0.4,0.1l24.7,6.3c1.2,0.3,2.5-0.4,2.8-1.7l0.5-1.9c0.3-1.2-0.4-2.5-1.7-2.8l-13.3-3.4h-26.7L128.1,296z"/>\r\n\t</g>\r\n\t<g id="sc-logo-text">\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M213,41c0-6.1,0-12,0-18.2\r\n\t\t\tc-4-0.3-7.9-0.5-12.1-0.8c-0.2,7.7,0.2,15.3,0.1,22.8c0,7.5,0,15,0,22.6c-3.1-1.1-6.2-2.2-9.5-3.4c-0.2-16.1-0.4-32.4-0.6-48.7\r\n\t\t\tc0.8-0.1,1.4-0.1,2.1-0.1c7.5,0,15,0,22.5,0c1.1,0,2.3,0.1,3.4,0.3c2,0.4,3.3,1.6,3.7,3.6c0.2,1,0.3,2.1,0.3,3.2\r\n\t\t\tc0,7.2,0,14.4,0,21.6c0,0.9-0.1,1.8-0.3,2.7c-0.4,1.7-1.4,2.4-3.1,2.2c-1.1-0.1-2.2-0.5-3.3-0.7c-0.6-0.1-1.2-0.3-2.1-0.5\r\n\t\t\tc3.8,10.9,7.3,21.6,10.3,32.8c-0.8-0.4-1.2-0.7-1.7-1c-2.3-1.5-4.6-3.1-6.9-4.5c-0.9-0.6-1.4-1.3-1.7-2.3\r\n\t\t\tc-3.2-9.1-6.4-18.1-9.7-27.1c-0.7-2-0.8-4.1-0.6-6.5C206.8,39.7,209.9,40.3,213,41z M116.4,30.8c0-4,0.1-7.9,0-11.7\r\n\t\t\tc0-1.8-1.3-3.1-3.2-3.5c-1.2-0.3-2.5-0.4-3.8-0.4c-6.2,0-12.4,0.1-18.7,0.1c-3.9,0-5.7,1.8-5.8,5.7c-0.1,4.9,0,9.9,0,14.8\r\n\t\t\tc0,2.2,0.8,4,2.8,5.1c3.7,2.1,7.3,4.4,10.9,6.5c2.4,1.4,5,2.6,7.3,3.9c0,3.5,0,6.9,0,10.2c-3.8,1.7-7.5,3.3-11.5,5\r\n\t\t\tc0-4,0-7.7,0-11.5c-2,0.3-7.6,2.7-9.6,4.1c0,5.3,0,10.7,0,16c0,0.4,0.1,0.8,0.2,1.2c0.4,1.5,1.3,2,2.7,1.5c1-0.3,1.9-0.8,2.8-1.4\r\n\t\t\tc6.1-3.9,12.5-7.2,19.2-9.9c1.3-0.5,2.5-1.3,3.7-2.1c1.5-1.1,2.3-2.7,2.3-4.6c0-4,0-8.1,0.1-12.1c0-1.6-0.7-2.7-2.1-3.4\r\n\t\t\tc-1.1-0.5-2.1-1.1-3.2-1.7c-4.9-2.9-9.7-5.7-14.6-8.7c-0.6-0.4-1.4-1.1-1.4-1.6c-0.1-3.2-0.1-6.5-0.1-9.8c4.1-0.5,7.9-0.7,11.9-0.7\r\n\t\t\tc0,3.4,0,6.5,0,9.8C109.9,31.6,113.1,31.2,116.4,30.8z M257,333c-0.2,0-0.4,0.1-0.6,0.1c-1.4-2.7-2.9-5.5-4.3-8.2\r\n\t\t\tc-1.7-3.3-3.4-6.5-5.1-9.8c-0.3-0.6-0.9-1.3-1.4-1.4c-1.8-0.2-3.6-0.1-5.5-0.1c0,11.9,0,23.5,0,35.2c2.3,0,4.5,0,6.9,0\r\n\t\t\tc0-6.8,0-13.4,0-20c0.1,0,0.3,0,0.4-0.1c3.4,6.7,6.8,13.4,10.3,20.2c2.1,0,4.1,0.1,6.1-0.1c0-11.9,0-23.4,0-35.1\r\n\t\t\tc-2.3,0-4.4,0-6.8,0C257,320.2,257,326.6,257,333z M152.5,15.3c-10.4,0-20.7,0-31.1,0c-0.2,2.2-0.2,4.2,0,6.3\r\n\t\t\tc3.7,0.1,7.1-0.3,10.7,0c-0.1,13.1-0.3,26-0.4,39c3.5-0.5,6.7-1,9.9-1.4c0-0.7,0.1-1.2,0.1-1.8c0.1-7,0.1-14,0.1-21\r\n\t\t\tc0-4.4,0-8.9,0.1-13.3c0-0.6,0.1-1.2,0.2-2c3.6,0,7,0,10.5,0C152.5,19,152.5,17.2,152.5,15.3z M61.5,336.9c0,2.5,0,4.8,0,7.2\r\n\t\t\tc-3.1,0-6,0-8.8,0c-0.5-3-0.3-24.4,0.2-25.9c2.8,0,5.6,0,8.6,0c0,2.3,0,4.5,0,6.8c2.4,0,4.6,0,6.9,0c0-3,0-5.9,0-8.8\r\n\t\t\tc0-1.2-0.8-2-1.9-2.3c-0.7-0.2-1.5-0.3-2.3-0.3c-4.9,0-9.9,0-14.8,0c-2.5,0-4.1,0.7-4.1,4.1c0.1,7.9,0,15.8,0,23.8\r\n\t\t\tc0,1.4,0,2.8,0,4.2c0.1,1.8,0.7,2.6,2.4,3c0.8,0.2,1.5,0.3,2.3,0.3c4.5,0,8.9,0,13.4,0c0.8,0,1.7-0.1,2.5-0.3\r\n\t\t\tc1.7-0.4,2.4-1.2,2.4-3c0-2.4,0-4.8,0-7.2c0-0.5-0.1-1.1-0.2-1.6C66,336.9,63.9,336.9,61.5,336.9z M207.8,313.7\r\n\t\t\tc0,11.8,0,23.4,0,35.1c6.5,0,12.9,0,19.4,0c0-1.6,0-3,0-4.7c-2.2,0-4.2,0-6.2,0c-2-0.1-4,0.3-6-0.2c0-3.6,0-7,0-10.7\r\n\t\t\tc3.5,0,7,0,10.3,0c0-1.7,0-3,0-4.6c-3.5,0-6.9,0-10.2,0c-0.4-2.4-0.4-8.5,0.1-10.2c3.9,0,7.8,0,11.8,0c0-1.6,0-3.1,0-4.6\r\n\t\t\tC220.5,313.7,214.2,313.7,207.8,313.7z M172.8,348.8c7.2,0,14.2,0,21.3,0c0-1.7,0-3.2,0-4.9c-4.3,0-8.4,0-12.8,0\r\n\t\t\tc0.3-0.7,0.5-1.1,0.7-1.6c3.8-8,7.7-16.1,11.5-24.1c0.7-1.5,0.9-2.9,0.5-4.4c-2.9-0.5-18.8-0.3-20.2,0.1c0,1.5,0,2.9,0,4.5\r\n\t\t\tc3.9,0,7.7,0,11.8,0c-0.5,1.1-0.8,1.9-1.2,2.7c-3.7,7.8-7.4,15.6-11.1,23.3C172.6,345.9,172.4,347.2,172.8,348.8z M129.9,318.3\r\n\t\t\tc2.7,0,5.1,0,7.6,0c0-1.7,0-3.1,0-4.6c-7.5,0-14.8,0-22.3,0c0,1.6,0,3,0,4.7c2.6,0,5,0,7.6,0c0,2.8,0,5.3,0,7.8c0,2.5,0,4.9,0,7.4\r\n\t\t\tc0,2.5,0,5.1,0,7.6c0,2.5-0.1,5,0.1,7.6c2.5,0,4.7,0.1,7-0.1C129.9,338.6,129.9,328.7,129.9,318.3z M89.3,313.7\r\n\t\t\tc0,11.8,0,23.4,0,35.1c2.4,0,4.6,0,6.9,0c0-11.8,0-23.4,0-35.1C93.9,313.7,91.6,313.7,89.3,313.7z M159,313.7c-2.4,0-4.6,0-6.9,0\r\n\t\t\tc0,11.7,0,23.4,0,35.1c2.3,0,4.6,0,6.9,0C159,337.1,159,325.5,159,313.7z M172.9,15.3c-3.6,0-6.9,0-10.3,0\r\n\t\t\tc-4.2,14.4-8.5,28.7-12.8,43.2c3.4,0,6.6,0,9.9,0c0.7-2.6,1.3-5.2,2.1-8c4.1,0.3,8.1,0.7,12.2,1c0.8,3.1,1.5,6,2.2,8.9\r\n\t\t\tc3.3,0.7,6.4,1.4,9.9,2.1C181.8,46.3,177.5,30.7,172.9,15.3z M167.5,26.8c-1.4,5.9-2.9,11.9-4.4,18c3.1,0.2,6.1,0.5,9.5,0.7\r\n\t\t\tc-1.6-6.4-3.1-12.6-4.6-18.7C167.8,26.8,167.6,26.8,167.5,26.8z"/>\r\n\t</g>\r\n\t<g id="sc-logo-chevrons">\r\n\t\t<g id="sc-logo-chevron-pair-18">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M88.9,304.5\r\n\t\t\t\tc2.6,0.7,4.8,0.7,7.7,0.1c6.7-1.3,12.5-4.4,17.6-8.8c1-0.8,1.8-1.8,2.6-2.8c0.5-0.7,0.8-1.6,1.1-2.4c-1.5-1.2-3-1-4.5-0.9\r\n\t\t\t\tc-4.8,0.5-9.2,2.1-13.4,4.3c-3.8,2-7.1,4.6-9.7,8C89.8,302.9,89.4,303.7,88.9,304.5z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M191.5,290.7\r\n\t\t\t\tc0.2,1.9,1.4,3.1,2.6,4.2c5.4,5,11.6,8.5,18.9,9.8c2.4,0.4,4.8,0.6,7.6-0.2c-1.3-1.6-2.2-3.1-3.4-4.3c-3.7-4-8.4-6.6-13.5-8.5\r\n\t\t\t\tc-2.9-1-5.8-1.8-8.9-1.9C193.7,289.8,192.4,289.7,191.5,290.7z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-17">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M204.8,285.9\r\n\t\t\t\tc0.5,1.7,0.7,2.3,2.5,3.5c2.5,1.7,5.1,3.2,7.9,4.5c4.6,2.1,9.5,3.1,14.6,2.9c1.7-0.1,3.4-0.3,5.3-1.1c-1.1-1.2-1.9-2.3-3-3.1\r\n\t\t\t\tc-6.8-5.8-14.8-8-23.5-7.9C207.3,284.6,205.8,284.7,204.8,285.9z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M74.2,295.8\r\n\t\t\t\tc1,0.3,1.7,0.5,2.4,0.6c9.9,1.4,18.5-1.7,26.2-7.7c0.4-0.3,0.8-0.8,1.1-1.3c0.9-1.3,0.7-2-0.9-2.5c-0.3-0.1-0.7-0.2-1-0.2\r\n\t\t\t\tc-2.2,0-4.5-0.1-6.7,0.1c-6.1,0.7-11.7,2.7-16.6,6.3C77,292.5,75.5,293.9,74.2,295.8z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-16">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M247.6,285.1\r\n\t\t\t\tc-1.4-1.1-2.6-2.1-3.9-2.9c-6.2-3.8-13-4.9-20.1-4.5c-1.5,0.1-3.1,0.3-4.6,0.7c-1,0.2-2.1,0.5-2.5,1.6\r\n\t\t\t\tC220,286.5,239.6,289.9,247.6,285.1z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M92.9,279.8\r\n\t\t\t\tc-0.8-1-1.9-1.4-3-1.6c-3.5-0.8-7.1-0.8-10.7-0.4c-5,0.5-9.7,1.9-13.9,4.6c-1.2,0.8-2.4,1.6-3.4,3.1c1.2,0.5,2.2,0.9,3.3,1.2\r\n\t\t\t\tc3.4,1,6.8,1.1,10.3,0.7c4.8-0.5,9.4-1.8,13.7-4.1C90.6,282.5,92.2,281.7,92.9,279.8z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-15">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M227.8,272.4\r\n\t\t\t\tc0.8,1.4,2,2.1,3.2,2.5c2.8,0.8,5.7,1.7,8.6,2.1c5.3,0.8,10.6,0.5,15.6-1.5c1.3-0.5,2.4-1.2,4-2c-1.3-0.8-2.1-1.4-3-1.9\r\n\t\t\t\tc-3.5-1.9-7.2-2.7-11.1-3c-4.6-0.4-9.2,0-13.6,1.4C230.1,270.4,228.7,270.9,227.8,272.4z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M50.2,273.6\r\n\t\t\t\tc1.6,0.8,2.8,1.5,4.1,2c5,2,10.2,2.2,15.4,1.5c3-0.4,5.9-1.4,8.8-2.2c1.3-0.4,2.4-1.1,3.1-2.5c-1.1-1.6-2.8-2.1-4.5-2.6\r\n\t\t\t\tc-5.9-1.6-11.8-1.8-17.8-0.4C56.1,270,53.1,271.2,50.2,273.6z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-14">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M238.5,264\r\n\t\t\t\tc1.1,0.5,1.9,1.2,2.9,1.4c1.8,0.5,3.6,0.9,5.4,1c6.4,0.6,12.7-0.2,18.5-3.2c1.4-0.7,2.7-1.7,4.5-2.9c-1.8-0.7-3-1.4-4.3-1.8\r\n\t\t\t\tc-5.4-1.7-10.9-1.5-16.3-0.2c-2.5,0.6-5,1.5-7.4,2.5C240.4,261.4,239.2,262.1,238.5,264z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M40,260.4\r\n\t\t\t\tc1.9,2,4.2,3.2,6.6,4c6.6,2.4,13.3,2.8,20.2,1.3c0.9-0.2,1.8-0.5,2.6-0.9c1.6-0.8,1.7-1.6,0.3-2.7c-0.7-0.6-1.5-1.1-2.3-1.5\r\n\t\t\t\tc-6.5-2.9-13.3-4-20.4-2.9C44.5,258.3,42.2,258.9,40,260.4z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-13">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M31.8,246.4\r\n\t\t\t\tc1.2,1.1,2.1,2.1,3.1,2.8c7,5.1,14.9,6.6,23.3,5.9c1.2-0.1,2.5-0.3,3.3-1.5C58.7,247,40.4,242.4,31.8,246.4z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M277.6,246.2\r\n\t\t\t\tc-1.2-0.4-1.8-0.6-2.5-0.8c-3.1-0.8-6.3-0.9-9.4-0.5c-5.3,0.7-10.2,2.4-14.6,5.2c-1,0.6-1.9,1.5-2.7,2.3c-0.8,0.9-0.6,1.6,0.5,2\r\n\t\t\t\tc1.2,0.4,2.6,0.8,3.9,0.8c2.8,0,5.7-0.1,8.4-0.5c5.4-0.9,10.5-2.9,14.7-6.6C276.3,247.6,276.8,247,277.6,246.2z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-12">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M53.6,242.5\r\n\t\t\t\tc-0.4-1.9-1.7-3-3-4.1c-5.1-4.1-10.9-6.8-17.4-7.6c-2.5-0.3-5-0.4-7.7,0.5c1,1.7,2.1,3,3.4,4.2c6,5.1,13,7.6,20.7,8.1\r\n\t\t\t\tC50.9,243.6,52.3,243.6,53.6,242.5z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M283.8,231.6\r\n\t\t\t\tc-0.1-0.2-0.2-0.4-0.2-0.6c-1.1-0.1-2.2-0.4-3.3-0.4c-8.5-0.2-15.7,3-22.1,8.3c-0.8,0.7-1.5,1.5-2,2.4c-0.6,1-0.3,1.6,0.8,1.9\r\n\t\t\t\tc0.9,0.2,2,0.4,2.9,0.3c7.7-0.5,14.6-2.9,20.5-8.1C281.6,234.4,282.7,232.9,283.8,231.6z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-11">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M20.9,215.1\r\n\t\t\t\tc0.8,2.3,2.2,4,3.7,5.6c4.6,4.9,10.3,7.8,16.7,9.4c1.1,0.3,2.2,0.4,3.3,0.4c0.7,0,1.4-0.3,2.1-0.4c-0.2-2-0.5-2.6-1.9-4.1\r\n\t\t\t\tc-4.7-5.1-10.3-8.8-17.1-10.5C25.6,215,23.4,214.7,20.9,215.1z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M262.1,229.9\r\n\t\t\t\tc1.9,1.1,3.6,0.8,5.1,0.5c4.5-0.9,8.6-2.8,12.4-5.3c3.2-2.1,6-4.7,8-8.1c0.3-0.6,0.6-1.2,0.9-2c-1-0.1-1.6-0.1-2.2-0.1\r\n\t\t\t\tc-0.8,0-1.7,0.1-2.5,0.2c-7.9,1.3-14.2,5.3-19.4,11.2C263.4,227.3,262.9,228.5,262.1,229.9z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-10">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M18.5,199\r\n\t\t\t\tc0.4,2.3,1.2,3.8,2.2,5.3c4.1,6.3,10,10.4,17,13c1,0.4,2.1,0.4,3.1,0.5c0.9,0,1.3-0.5,1.1-1.4c-0.3-0.9-0.6-1.9-1.1-2.7\r\n\t\t\t\tc-4.4-6.6-10.2-11.5-17.8-13.8C21.6,199.4,20.2,199.3,18.5,199z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M290.9,199.2\r\n\t\t\t\tc-1.2,0.1-2.1,0.1-3,0.3c-6.3,1.3-11.4,4.8-15.7,9.5c-1.6,1.7-2.9,3.7-4.2,5.6c-0.6,0.8-1,1.9-0.5,3c1.7,0.7,3.2,0,4.7-0.5\r\n\t\t\t\tc4.9-1.8,9.2-4.6,12.8-8.4c2-2.1,3.8-4.4,4.9-7.1C290.3,200.9,290.5,200.2,290.9,199.2z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-9">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M18.2,183.3\r\n\t\t\t\tc-0.1,0.7-0.2,0.9-0.1,1.1c0.2,0.8,0.3,1.5,0.6,2.2c3,8.1,8.8,13.6,16.3,17.5c0.5,0.3,1.1,0.4,1.6,0.5c0.6,0.1,1.2,0,1.8,0\r\n\t\t\t\tc0.3-1.7,0.3-2.4-0.6-4.2c-3.2-6.4-7.7-11.6-14.1-15.1C22,184.5,20.1,184,18.2,183.3z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M291.2,183.5\r\n\t\t\t\tc-0.8,0.2-1.3,0.2-1.8,0.4c-8.9,3.1-14.6,9.5-18.3,18c-0.3,0.8-0.2,1.7-0.3,2.6c2,0.3,2.5,0.3,4.3-0.6c6.4-3.4,11.5-8.2,14.7-14.8\r\n\t\t\t\tC290.5,187.4,291.3,185.7,291.2,183.5z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-8">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M36.7,190.5\r\n\t\t\t\tc-0.1-1.2,0-2.4-0.3-3.5c-0.4-1.5-0.9-3-1.6-4.4c-2.7-5.7-6.4-10.6-11.9-13.9c-1.1-0.6-2.2-1.1-3.5-1.7c0,1.1-0.1,1.9,0,2.6\r\n\t\t\t\tc1.7,8.7,6.7,15.2,13.9,20.2C34.1,190.4,35,191,36.7,190.5z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M273.3,190.9\r\n\t\t\t\tc0.8-0.3,1.8-0.5,2.5-1c7.3-4.8,12.2-11.2,14.1-19.8c0.2-0.9,0.1-1.9,0.2-3.2c-1.3,0.6-2.2,0.9-3.1,1.3c-2.7,1.4-5,3.4-7,5.7\r\n\t\t\t\tc-3.5,4.1-6.1,8.6-7.3,13.9C272.5,188.9,272.4,189.8,273.3,190.9z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-7">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M22.1,151.2\r\n\t\t\t\tc-0.1,1.2-0.3,2.1-0.2,3c0.7,8.4,4.5,15.2,10.5,20.9c0.8,0.8,2,1.2,3.1,1.9c1.2-1.7,1-3.4,0.7-4.9c-1.2-6.4-3.9-12.1-8.4-16.8\r\n\t\t\t\tC26.2,153.6,24.5,152.2,22.1,151.2z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M287.1,151.1\r\n\t\t\t\tc-1.2,0.8-2.3,1.3-3.2,2.1c-6.4,5.3-9.6,12.4-10.9,20.5c-0.2,1-0.1,2.1,0.7,2.9C280.5,175.3,288.7,160,287.1,151.1z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-6">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M36.4,160.7\r\n\t\t\t\tc0.3-1,0.7-1.8,0.7-2.7c0.2-8.6-2.4-16.3-8.5-22.5c-0.6-0.6-1.3-1.1-2.1-1.7c-0.2,0.6-0.4,0.9-0.5,1.3c-0.6,2.7-0.5,5.3,0,8\r\n\t\t\t\tc1,5.5,3.2,10.5,6.7,14.9C33.5,159.2,34.4,160.3,36.4,160.7z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M282.9,133.8\r\n\t\t\t\tc-0.8,0.6-1.4,1-1.9,1.5c-6.3,6.1-8.7,13.8-8.8,22.4c0,1,0.2,2.1,1.1,3c1.6-0.2,2.5-1.4,3.4-2.5c3.6-4.6,5.9-9.8,6.7-15.5\r\n\t\t\t\tC283.8,139.8,283.9,136.9,282.9,133.8z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-5">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M39.3,146.2\r\n\t\t\t\tc1.2-0.9,1.4-2.1,1.6-3.4c0.5-2.8,0.3-5.6,0-8.4c-0.6-4.8-2.1-9.4-5-13.3c-0.7-0.9-1.5-1.6-2.3-2.6c-0.3,0.8-0.5,1.2-0.7,1.7\r\n\t\t\t\tc-1,3-1.1,6.1-0.9,9.2c0.4,4.9,1.8,9.5,4.3,13.8C36.9,144.4,37.7,145.7,39.3,146.2z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M275.7,118.7\r\n\t\t\t\tc-0.7,0.7-1.4,1.4-2,2.2c-2.7,3.5-4.2,7.6-5,12c-0.6,3.6-0.8,7.3-0.1,10.9c0.2,1,0.4,1.9,1.4,2.4\r\n\t\t\t\tC276.2,143.1,279.8,125.5,275.7,118.7z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-4">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M44,132.8\r\n\t\t\t\tc1.6-1,2-2.2,2.3-3.4c1.2-4.6,1.4-9.2,0.7-13.8c-0.5-3.4-1.6-6.6-3.5-9.4c-0.3-0.4-0.7-0.8-1.2-1.3c-0.5,1.1-1,1.8-1.3,2.7\r\n\t\t\t\tc-2.8,7.9-2,15.5,1.3,23C42.6,131.3,43.4,132,44,132.8z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M265,132.6\r\n\t\t\t\tc1.2-0.4,1.8-1.4,2.2-2.4c3-7.2,3.8-14.5,1.4-22.1c-0.4-1.1-1-2.1-1.7-3.5c-0.8,1.1-1.4,1.8-1.8,2.6c-3.9,7.5-4.2,15.2-1.9,23.2\r\n\t\t\t\tC263.6,131.2,264,132.2,265,132.6z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-3">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M244,78.7\r\n\t\t\t\tc-0.4,1.2-0.8,2.1-1,3.1c-1.6,8,0.3,15.3,4.4,22.1c0.5,0.8,1.4,1.5,2.2,2.2c1.3-1.4,1.5-1.8,1.8-3.5c0.8-5.8-0.1-11.4-2.4-16.8\r\n\t\t\t\tC247.9,83.2,246.4,80.9,244,78.7z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M59.8,106.1\r\n\t\t\t\tc0.8-0.8,1.7-1.5,2.2-2.3c4.1-6.8,5.9-14.2,4.3-22.1c-0.2-0.9-0.6-1.8-1.1-3.1c-1.1,1.3-2.1,2.3-2.8,3.4\r\n\t\t\t\tc-4.1,6.2-5.2,13.2-4.5,20.5C58.1,103.7,58.3,105,59.8,106.1z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-2">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M256.3,91.2\r\n\t\t\t\tc-0.6,1.2-1.1,2-1.4,3c-2.6,7.7-1.9,15.1,1.3,22.5c0.4,0.9,1,1.9,2.2,2.3c1.4-0.9,1.8-2.4,2.1-3.9c1.1-4.4,1.2-9,0.4-13.4\r\n\t\t\t\tC260.2,97.9,259.1,94.4,256.3,91.2z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M51,118.9\r\n\t\t\t\tc5.6-3.9,6.7-21.4,1.7-27.6c-0.7,1.1-1.4,2-1.9,3c-3.4,7-3.6,14.3-1.7,21.7C49.4,117.2,49.8,118.3,51,118.9z"/>\r\n\t\t</g>\r\n\t\t<g id="sc-logo-chevron-pair-1">\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M79.2,69.1\r\n\t\t\t\tc-0.7,0.5-1.2,0.9-1.7,1.3C71.4,76.3,69.1,83.7,69,92c0,1,0.1,2.1,1.1,2.8C76.4,92.4,82,76.7,79.2,69.1z"/>\r\n\t\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M230,69.3\r\n\t\t\t\tc-0.9,3-1,4.7-0.4,8.7c0.9,5.4,3.1,10.2,6.5,14.5c0.8,1,1.7,2.1,3.1,2.3C243,89.6,236.9,72.8,230,69.3z"/>\r\n\t\t</g>\r\n\t</g>\r\n\t<g id="sc-logo-star">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M199.7,172.9c-16.8-2.6-28-6.1-33.6-17.6\r\n\t\t\tc-5.6-11.6-7.8-28.8-8.8-41.7c-1-12.9-2.6-46.2-2.6-46.2s-1.7,33.2-2.6,46.1c-1,12.9-3.2,30.1-8.8,41.7\r\n\t\t\tc-5.6,11.6-16.8,15-33.6,17.6s-54.4,4.4-54.4,4.4c62.6,4,83.4,2.3,91.7,32.3c6.7,24.1,7.6,72.1,7.7,90v0c0,4.4,0,7,0,7s0-2.6,0-7\r\n\t\t\tc0.1-18,1-65.9,7.7-90c8.3-29.9,29.1-28.3,91.7-32.3C254.1,177.3,216.6,175.5,199.7,172.9z"/>\r\n\t</g>\r\n\t<g id="sc-logo-arc-4">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M261.9,135.5c-2.9-6.8-6.5-13.3-10.7-19.4\r\n\t\t\tc-4.2-6-8.9-11.7-14.2-16.9c-5.3-5.2-11-9.9-17.2-13.9c-1.3-0.9-2.6-1.7-4-2.5c30.7,20.2,51,55.2,51,95c0,0.4,0,0.7,0,1.1\r\n\t\t\tc0,0.4,0,0.7,0,1.1c0,28.9-11.3,55.1-29.8,74.8c-20.5,22.3-49.7,36.3-82.2,36.3s-61.7-14-82.2-36.3C54,235.1,42.7,208.8,42.7,180\r\n\t\t\tc0-0.4,0-0.7,0-1.1c0-0.4,0-0.7,0-1.1c0-39.8,20.3-74.8,51-95c-1.4,0.8-2.7,1.7-4,2.5c-6.2,4.1-11.9,8.8-17.2,13.9\r\n\t\t\tc-5.3,5.2-10,10.9-14.2,16.9c-4.2,6.1-7.8,12.6-10.7,19.4c-6.1,14.1-9.1,29-9.1,44.5s3.1,30.4,9.1,44.5c2.9,6.8,6.5,13.3,10.7,19.4\r\n\t\t\tc4.2,6,8.9,11.7,14.2,16.9c5.3,5.2,11,9.9,17.2,13.9c6.2,4.1,12.9,7.7,19.8,10.5c14.3,6,29.6,9,45.3,9s30.9-3,45.3-9\r\n\t\t\tc6.9-2.9,13.5-6.4,19.8-10.5c6.2-4.1,11.9-8.8,17.2-13.9c5.3-5.2,10-10.9,14.2-16.9c4.2-6.1,7.8-12.6,10.7-19.4\r\n\t\t\tc6.1-14.1,9.1-29,9.1-44.5S267.9,149.6,261.9,135.5z"/>\r\n\t\t<circle style="fill:none;" cx="154.8" cy="177.9" r="116.3"/>\r\n\t</g>\r\n\t<g id="sc-logo-arc-3">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M154.7,74.6c57.1,0,103.3,46.3,103.3,103.3\r\n\t\t\ts-46.3,103.3-103.3,103.3S51.4,234.9,51.4,177.9S97.7,74.6,154.7,74.6 M154.7,72.5c-14.2,0-28,2.8-41,8.3\r\n\t\t\tc-12.6,5.3-23.8,12.9-33.5,22.6c-9.7,9.7-17.3,21-22.6,33.5c-5.5,13-8.3,26.8-8.3,41s2.8,28,8.3,41c5.3,12.6,12.9,23.8,22.6,33.5\r\n\t\t\tc9.7,9.7,21,17.3,33.5,22.6c13,5.5,26.8,8.3,41,8.3c14.2,0,28-2.8,41-8.3c12.6-5.3,23.8-12.9,33.5-22.6c9.7-9.7,17.3-21,22.6-33.5\r\n\t\t\tc5.5-13,8.3-26.8,8.3-41s-2.8-28-8.3-41c-5.3-12.6-12.9-23.8-22.6-33.5c-9.7-9.7-21-17.3-33.5-22.6C182.8,75.2,169,72.5,154.7,72.5\r\n\t\t\tz"/>\r\n\t</g>\r\n\t<g id="sc-logo-arc-2">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M154.7,84.6c51.5,0,93.3,41.8,93.3,93.3s-41.8,93.3-93.3,93.3\r\n\t\t\ts-93.3-41.8-93.3-93.3S103.2,84.6,154.7,84.6 M154.7,81.4c-13,0-25.7,2.6-37.6,7.6c-11.5,4.9-21.8,11.8-30.7,20.7\r\n\t\t\tc-8.9,8.9-15.8,19.2-20.7,30.7c-5,11.9-7.6,24.5-7.6,37.6c0,13,2.6,25.7,7.6,37.6c4.9,11.5,11.8,21.8,20.7,30.7\r\n\t\t\ts19.2,15.8,30.7,20.7c11.9,5,24.5,7.6,37.6,7.6c13,0,25.7-2.6,37.6-7.6c11.5-4.9,21.8-11.8,30.7-20.7c8.9-8.9,15.8-19.2,20.7-30.7\r\n\t\t\tc5-11.9,7.6-24.5,7.6-37.6c0-13-2.6-25.7-7.6-37.6c-4.9-11.5-11.8-21.8-20.7-30.7c-8.9-8.9-19.2-15.8-30.7-20.7\r\n\t\t\tC180.4,83.9,167.8,81.4,154.7,81.4z"/>\r\n\t</g>\r\n\t<g id="sc-logo-arc-1">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M154.7,114.1c35.3,0,63.8,28.6,63.8,63.8s-28.6,63.8-63.8,63.8\r\n\t\t\ts-63.8-28.6-63.8-63.8S119.5,114.1,154.7,114.1 M154.7,107.7c-9.5,0-18.7,1.9-27.3,5.5c-8.4,3.5-15.9,8.6-22.3,15\r\n\t\t\tc-6.4,6.4-11.5,14-15,22.3c-3.7,8.7-5.5,17.9-5.5,27.3s1.9,18.7,5.5,27.3c3.5,8.4,8.6,15.9,15,22.3c6.4,6.4,14,11.5,22.3,15\r\n\t\t\tc8.7,3.7,17.9,5.5,27.3,5.5s18.7-1.9,27.3-5.5c8.4-3.5,15.9-8.6,22.3-15c6.4-6.4,11.5-14,15-22.3c3.7-8.7,5.5-17.9,5.5-27.3\r\n\t\t\ts-1.9-18.7-5.5-27.3c-3.5-8.4-8.6-15.9-15-22.3c-6.4-6.4-14-11.5-22.3-15C173.4,109.5,164.2,107.7,154.7,107.7z"/>\r\n\t</g>\r\n\t<g id="sc-logo-bottom">\r\n\t\t<path style="fill:none;stroke:#347BA3;stroke-miterlimit:10;" d="M128.1,296c-1.2,0.3-2,1.6-1.7,2.8l0.5,1.9c0.3,1.2,1.6,2,2.8,1.7\r\n\t\t\tl24.7-6.3c0.1,0,0.2-0.1,0.4-0.1c0.1,0,0.2,0.1,0.4,0.1l24.7,6.3c1.2,0.3,2.5-0.4,2.8-1.7l0.5-1.9c0.3-1.2-0.4-2.5-1.7-2.8\r\n\t\t\tl-13.3-3.4h-26.7L128.1,296z"/>\r\n\t</g>\r\n</svg>\r\n'},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(97).default,a=n(19).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(128)),c=o("ARKLogo._elements"),u=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?e:arguments[2];return function(){var i=t.getBBox(),r=(i.width/2+i.x).toFixed(3),o=(i.height/2+i.y).toFixed(3);return"matrix("+e+", 0, 0, "+n+", "+(r-e*r)+", "+(o-n*o)+")"}()},h=function(){function t(){r(this,t);var e=document.createElement("section");e.classList.add("ark-logo"),e.innerHTML=n(131),this[c]={root:e,background:e.querySelector("#ark-logo-background"),star:e.querySelector("#ark-logo-star"),arkLetters:{shape:e.querySelector("#ark-logo-ark-letters"),mask:e.querySelector("#ark-logo-ark-letters__mask")},starmapLetters:{shape:e.querySelector("#ark-logo-starmap-letters"),mask:e.querySelector("#ark-logo-starmap-letters__mask")},logo:{leftLine1:e.querySelector("#ark-logo-left-line-1 path"),leftLine2:e.querySelector("#ark-logo-left-line-2 path"),rightLine1:e.querySelector("#ark-logo-right-line-1 path"),rightLine2:e.querySelector("#ark-logo-right-line-2 path")}},this[c].root.style.opacity=0}return i(t,[{key:"show",value:function(){var t=this;return new a((function(e){var n=t[c],i=n.root,r=n.background,o=n.star,a=n.arkLetters,s=n.starmapLetters,h=n.logo;r.style.opacity=0,o.setAttribute("transform",u(o,0)),i.style.opacity=1,a.mask.setAttribute("transform","translate(170 0)"),s.mask.setAttribute("transform","translate(-170 0)");var d=h.leftLine1.getTotalLength();h.leftLine1.style.strokeDasharray=d,h.leftLine1.style.strokeDashoffset=d;var f=h.leftLine2.getTotalLength();h.leftLine2.style.strokeDasharray=f,h.leftLine2.style.strokeDashoffset=f;var p=h.rightLine1.getTotalLength();h.rightLine1.style.strokeDasharray=p,h.rightLine1.style.strokeDashoffset=p;var m=h.rightLine2.getTotalLength();h.rightLine2.style.strokeDasharray=m,h.rightLine2.style.strokeDashoffset=m,(new l.default).tween({from:{length1:d,length2:f},to:{length1:0,length2:0},duration:650,step:function(t){var e=t.length1,n=t.length2;h.leftLine1.style.strokeDashoffset=-.95*e,h.leftLine2.style.strokeDashoffset=n}}),(new l.default).tween({from:{length1:p,length2:m},to:{length1:0,length2:0},duration:650,step:function(t){var e=t.length1,n=t.length2;h.rightLine1.style.strokeDashoffset=e,h.rightLine2.style.strokeDashoffset=-.95*n}}),(new l.default).tween({from:{scale:0},to:{scale:100},duration:450,delay:280,easing:"easeInOutBack",step:function(t){var e=t.scale;return o.setAttribute("transform",u(o,e/100))}}),(new l.default).tween({from:{left:170},to:{left:0},duration:450,delay:125,step:function(t){var e=t.left;return a.mask.setAttribute("transform","translate("+e+" 0)")}}),(new l.default).tween({from:{left:-170},to:{left:0},duration:450,delay:125,step:function(t){var e=t.left;return s.mask.setAttribute("transform","translate("+e+" 0)")}}),(new l.default).tween({from:{opacity:0},to:{opacity:100},duration:500,delay:825,step:function(t){var e=t.opacity;return r.style.opacity=e/100},finish:e})}))}},{key:"element",get:function(){return this[c].root}}]),t}();e.default=h,t.exports=e.default},function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?>\r\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n\t viewBox="0 0 191 279.3" xml:space="preserve">\r\n\t<g id="ark-logo-background">\r\n\t\t<path style="display:inline;fill:#42CBF8;" d="M87.1,217.8c3.1,0,6.3,0,9.4,0c0.5,0.1,1,0.2,1.5,0.3c5.1,1.1,8,5.9,6.2,10.6\r\n\t\t\tc-0.7,1.8-2,3-3.8,3.9c0.2,0.2,0.3,0.3,0.4,0.4c1.5,2,2.9,4,4.4,6c-2,0-4.1,0-6.1,0c-0.7-1.1-1.5-2.2-2.2-3.3\r\n\t\t\tc-1-1.4-2.5-1.8-4.3-1.4c0,0.8,0,1.5,0,2.3c0,0.8,0,1.6,0,2.3c-1.8,0-3.6,0-5.4,0C87.1,231.9,87.1,224.9,87.1,217.8z M92.6,229.3\r\n\t\t\tc1.3,0,2.6,0.1,3.8,0c2-0.2,3.1-1.4,3.2-3.1c0.1-1.8-1-3.1-3-3.4c-1.3-0.2-2.6,0-4,0C92.6,224.9,92.6,227,92.6,229.3z M170,217.8\r\n\t\t\tc-1.5,2.2-3,4.5-4.5,6.7c-0.8,1.2-2,1.5-3.5,1.3c0-2.6,0-5.3,0-8c-1.8,0-3.6,0-5.4,0c0,7.1,0,14.2,0,21.3c1.8,0,3.6,0,5.4,0\r\n\t\t\tc0-2.7,0-5.4,0-8.1c1.8-0.4,2.6-0.1,3.5,1.2c1.6,2.3,3.1,4.6,4.6,7c2,0,4.1,0,6.1,0c-0.1-0.2-0.2-0.5-0.4-0.7\r\n\t\t\tc-1.5-2.3-3-4.6-4.6-6.8c-0.8-1.2-1.8-2.3-2.5-3.2c0.3-0.4,0.8-0.9,1.2-1.5c2.1-3,4.1-6,6.1-9C174.1,217.8,172,217.8,170,217.8z\r\n\t\t\tM24.3,217.8c1.1,0,2.2,0,3.4,0c0.9,2.1,1.8,4.2,2.7,6.3c2.1,5,4.2,10,6.3,14.9c-2,0-4.1,0-6.1,0c-0.3-0.8-0.6-1.6-0.9-2.4\r\n\t\t\tc-0.1-0.4-0.4-0.5-0.8-0.5c-1.9,0-3.9,0-5.8,0c-0.4,0-0.7,0.1-0.8,0.5c-0.3,0.8-0.6,1.6-0.9,2.4c-2,0-4.1,0-6.1,0\r\n\t\t\tc2.1-4.8,4.2-9.6,6.2-14.5C22.4,222.3,23.3,220,24.3,217.8z M23.5,232.1c1.7,0,3.2,0,4.8,0c-0.8-2-1.5-3.9-2.4-6.1\r\n\t\t\tC25.1,228.2,24.3,230.1,23.5,232.1z"/>\r\n\t\t<path style="display:inline;fill:#42CBF8;" d="M127,249.2c0,5.4,0,10.7,0,16.1c-0.8,0-1.6,0-2.4,0c0-3.8,0-7.5,0-11.3\r\n\t\t\tc0,0-0.1,0-0.1-0.1c-1.8,2.2-3.5,4.4-5.3,6.7c-1.8-2.3-3.6-4.5-5.5-6.8c0,3.9,0,7.7,0,11.5c-0.8,0-1.6,0-2.5,0c0-5.4,0-10.7,0-16.1\r\n\t\t\tc0.8-0.1,1.4-0.1,2,0.7c1.7,2.4,3.6,4.6,5.4,6.9c0.1,0.2,0.3,0.4,0.5,0.6c1.2-1.6,2.5-3.1,3.7-4.6c0.7-0.9,1.5-1.8,2.2-2.8\r\n\t\t\tC125.5,249.1,126.2,249.1,127,249.2z M95.1,260c1.3-0.7,2.1-1.8,2.5-3.4c0.7-3.4-1-6.6-3.9-7.1c-2-0.4-4.2-0.2-6.2-0.3\r\n\t\t\tc0,0-0.1,0-0.1,0.1c0,5.4,0,10.7,0,16.1c0.7,0,1.4,0,2.1,0c0-1.4,0-2.8,0-4.2c0.9,0,1.7,0,2.5,0c0.8,0,1.5,0.5,2,1.3\r\n\t\t\tc0.5,0.8,1,1.7,1.5,2.5c0.1,0.1,0.2,0.3,0.3,0.3c0.7,0,1.4,0,2.1,0c-0.6-1.6-2.2-4.1-3.3-5.1C94.8,260.2,94.9,260.1,95.1,260z\r\n\t\t\tM89.4,256.3c0-1.4,0-2.9,0-4.3c0-0.2,0.2-0.5,0.3-0.5c1.2,0,2.5,0,3.7,0.2c1.8,0.4,2.8,2.3,2.3,4.4c-0.3,1.3-1.1,2.1-2.1,2.3\r\n\t\t\tc-0.9,0.2-1.7,0.2-2.6,0.3c-0.5,0-0.9,0-1.5,0C89.4,257.9,89.4,257.1,89.4,256.3z M15.2,262.5c1.9,3.2,6.6,4.1,9.3,1.7\r\n\t\t\tc1.2-1.1,1.6-2.5,1.5-4.2c-0.2-1.8-1-2.9-2.4-3.5c-0.9-0.4-1.9-0.5-2.9-0.7c-0.8-0.2-1.6-0.3-2.4-0.7c-0.9-0.4-1.1-1.6-0.5-2.5\r\n\t\t\tc0.3-0.4,0.7-0.8,1.2-0.9c1.8-0.7,3.4-0.1,4.8,1.2c0.1,0.1,0.2,0.2,0.4,0.4c0.5-0.5,0.9-1,1.3-1.5c-0.8-1-1.8-1.8-2.9-2.2\r\n\t\t\tc-2-0.8-4-0.7-5.7,0.8c-1.2,1-1.7,2.4-1.5,4c0.2,1.7,1,2.6,2.3,3.2c0.7,0.3,1.4,0.4,2,0.6c1,0.2,2,0.4,2.9,0.7\r\n\t\t\tc0.7,0.2,1.1,0.9,1.2,1.8c0.1,1-0.3,1.7-1,2.1c-0.5,0.3-1.1,0.5-1.7,0.6c-2,0.2-3.6-0.5-4.8-2.5c-0.5,0.5-0.9,1-1.3,1.5\r\n\t\t\tC15.1,262.3,15.1,262.4,15.2,262.5z M74.6,265c-1.9-5.1-3.9-10.3-5.8-15.4c-0.2-0.6-0.6-0.3-1-0.4c-0.3,0-0.5,0-0.7,0.4\r\n\t\t\tc-1.5,4-3.1,8.1-4.6,12.1c-0.5,1.2-0.9,2.4-1.4,3.7c0.8,0,1.5,0,2.1,0c0.3,0,0.5-0.1,0.6-0.4c0.3-0.9,0.7-1.8,1-2.8\r\n\t\t\tc0.1-0.3,0.3-0.4,0.6-0.4c1.7,0,3.4,0,5,0c0.3,0,0.4,0.1,0.6,0.4c0.3,1,0.7,1.9,1.1,2.8c0.1,0.2,0.2,0.4,0.4,0.4c0.7,0,1.5,0,2.3,0\r\n\t\t\tC74.6,265.2,74.6,265.1,74.6,265z M70,259.4c-1.4,0-2.8,0-4.2,0c0.7-1.8,1.4-3.7,2.1-5.6C68.6,255.7,69.3,257.5,70,259.4z\r\n\t\t\tM42.5,251.5c0.4,0,0.6,0.1,0.6,0.7c0,4.2,0,8.3,0,12.5c0,0.2,0,0.4,0,0.7c0.7,0,1.4,0,2.1,0c0-4.6,0-9.2,0-13.8c1.3,0,2.6,0,4,0\r\n\t\t\tc0-0.8,0-1.6,0-2.3c-3.4,0-6.7,0-10,0c0,0.8,0,1.5,0,2.3C40.3,251.5,41.4,251.6,42.5,251.5z M166.3,265.4h1.5\r\n\t\t\tc0.1,0,0.3-0.1,0.3-0.3v-3.4c0-0.2,0.1-0.3,0.3-0.3c0.3,0,0.6,0,0.8,0c1-0.1,2.1,0,3.1-0.3c2.6-0.6,4.1-2.8,4.2-5.8\r\n\t\t\tc0.1-2.8-1.4-5-3.9-5.8c-0.4-0.1-0.8-0.2-1.2-0.3c0,0,0,0-0.1,0c-1.7,0-3.3,0-5,0c-0.1,0-0.3,0.1-0.3,0.3v15.6\r\n\t\t\tC166,265.2,166.1,265.4,166.3,265.4z M168.1,254.4c0-0.8,0-1.7,0-2.5c0-0.1,0.2-0.4,0.3-0.4c1.2,0,2.4,0,3.5,0.2\r\n\t\t\tc1.9,0.4,2.9,2.4,2.4,4.5c-0.3,1.2-1,2-2,2.4c-0.8,0.2-1.6,0.3-2.5,0.4c-0.5,0-1,0-1.6,0c-0.1,0-0.3-0.1-0.3-0.3\r\n\t\t\tC168.1,257.2,168.1,255.8,168.1,254.4z M145,249.9c-0.3,0.9-0.7,1.8-1,2.7c-1.6,4.1-3.2,8.2-4.8,12.4c0,0,0,0,0,0\r\n\t\t\tc-0.1,0.2,0.1,0.4,0.3,0.4h2c0.1,0,0.2-0.1,0.3-0.2c0.4-1.1,0.8-2.1,1.2-3.2c0-0.1,0.3-0.2,0.4-0.2c1.8,0,3.5,0,5.3,0\r\n\t\t\tc0.1,0,0.4,0.1,0.4,0.2c0.4,1.1,0.8,2.1,1.2,3.2c0,0.1,0.2,0.2,0.3,0.2h2c0.2,0,0.4-0.2,0.3-0.4c-0.6-1.7-1.3-3.3-1.9-5\r\n\t\t\tc-1.3-3.3-2.6-6.7-3.9-10C146,249.9,146,249.9,145,249.9z M144,258.9c0.6-1.5,1.1-2.9,1.7-4.4c0.1-0.3,0.5-0.3,0.6,0\r\n\t\t\tc0.6,1.5,1.1,3,1.7,4.4c0.1,0.2-0.1,0.4-0.3,0.4h-3.4C144.1,259.4,144,259.1,144,258.9z"/>\r\n\t\t<path style="display:inline;fill:#42CBF8;" d="M82.1,66.4V28.8l-38,36.6v41.9l42.3,40.9v50.2l-46.7-45.1v-24.3h0.1l4.3,4.3v18.1\r\n\t\t\tl38,36.6v-38.1l-42.3-40.9V63.6l46.7-45.1v49.7L61.8,93.6l0,0v-6.2L82.1,66.4z M147.3,133.5v18.1l-38,36.6v-38.1l42.3-40.9V63.6\r\n\t\t\tl-46.7-45.1v49.7l24.7,25.5l0,0v-6.2l-20.3-21V28.8l38,36.6v41.9l-42.3,40.9v50.2l46.7-45.1v-24.3h-0.1L147.3,133.5z"/>\r\n\t\t<path style="display:inline;fill:#42CBF8;" d="M88.4,106.4c2.4-0.2,4.6-2.4,4.9-4.8l2-19.9c0.2-2.4,0.6-2.4,0.9,0l2,19.9\r\n\t\t\tc0.2,2.4,2.4,4.6,4.9,4.8l20.1,2c2.4,0.2,2.4,0.6,0,0.9l-20.1,2c-2.4,0.2-4.6,2.4-4.9,4.8l-2,19.9c-0.2,2.4-0.6,2.4-0.9,0l-2-19.9\r\n\t\t\tc-0.2-2.4-2.4-4.6-4.9-4.8l-20.1-2c-2.4-0.2-2.4-0.6,0-0.9L88.4,106.4z"/>\r\n\t</g>\r\n\t<g id="ark-logo-ark-letters">\r\n\t\t<defs>\r\n\t\t\t<rect id="ark-logo-ark-letters__shape" x="11.7" y="211.6" width="168.2" height="33.5"/>\r\n\t\t</defs>\r\n\t\t<clipPath id="ark-logo-ark-letters__clip">\r\n\t\t\t<use id="ark-logo-ark-letters__mask" xlink:href="#ark-logo-ark-letters__shape"  style="overflow:visible;"/>\r\n\t\t</clipPath>\r\n\t\t<path style="clip-path:url(#ark-logo-ark-letters__clip);fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M87.1,217.8c3.1,0,6.3,0,9.4,0\r\n\t\t\tc0.5,0.1,1,0.2,1.5,0.3c5.1,1.1,8,5.9,6.2,10.6c-0.7,1.8-2,3-3.8,3.9c0.2,0.2,0.3,0.3,0.4,0.4c1.5,2,2.9,4,4.4,6c-2,0-4.1,0-6.1,0\r\n\t\t\tc-0.7-1.1-1.5-2.2-2.2-3.3c-1-1.4-2.5-1.8-4.3-1.4c0,0.8,0,1.5,0,2.3c0,0.8,0,1.6,0,2.3c-1.8,0-3.6,0-5.4,0\r\n\t\t\tC87.1,231.9,87.1,224.9,87.1,217.8z M92.6,229.3c1.3,0,2.6,0.1,3.8,0c2-0.2,3.1-1.4,3.2-3.1c0.1-1.8-1-3.1-3-3.4\r\n\t\t\tc-1.3-0.2-2.6,0-4,0C92.6,224.9,92.6,227,92.6,229.3z M170,217.8c-1.5,2.2-3,4.5-4.5,6.7c-0.8,1.2-2,1.5-3.5,1.3c0-2.6,0-5.3,0-8\r\n\t\t\tc-1.8,0-3.6,0-5.4,0c0,7.1,0,14.2,0,21.3c1.8,0,3.6,0,5.4,0c0-2.7,0-5.4,0-8.1c1.8-0.4,2.6-0.1,3.5,1.2c1.6,2.3,3.1,4.6,4.6,7\r\n\t\t\tc2,0,4.1,0,6.1,0c-0.1-0.2-0.2-0.5-0.4-0.7c-1.5-2.3-3-4.6-4.6-6.8c-0.8-1.2-1.8-2.3-2.5-3.2c0.3-0.4,0.8-0.9,1.2-1.5\r\n\t\t\tc2.1-3,4.1-6,6.1-9C174.1,217.8,172,217.8,170,217.8z M24.3,217.8c1.1,0,2.2,0,3.4,0c0.9,2.1,1.8,4.2,2.7,6.3\r\n\t\t\tc2.1,5,4.2,10,6.3,14.9c-2,0-4.1,0-6.1,0c-0.3-0.8-0.6-1.6-0.9-2.4c-0.1-0.4-0.4-0.5-0.8-0.5c-1.9,0-3.9,0-5.8,0\r\n\t\t\tc-0.4,0-0.7,0.1-0.8,0.5c-0.3,0.8-0.6,1.6-0.9,2.4c-2,0-4.1,0-6.1,0c2.1-4.8,4.2-9.6,6.2-14.5C22.4,222.3,23.3,220,24.3,217.8z\r\n\t\t\t\tM23.5,232.1c1.7,0,3.2,0,4.8,0c-0.8-2-1.5-3.9-2.4-6.1C25.1,228.2,24.3,230.1,23.5,232.1z"/>\r\n\t</g>\r\n\t<g id="ark-logo-starmap-letters">\r\n\t\t<defs>\r\n\t\t\t<rect id="ark-logo-starmap-letters__shape" x="11.7" y="245.1" width="168.2" height="25.6"/>\r\n\t\t</defs>\r\n\t\t<clipPath id="ark-logo-starmap-letters__clip">\r\n\t\t\t<use id="ark-logo-starmap-letters__mask" xlink:href="#ark-logo-starmap-letters__shape"  style="overflow:visible;"/>\r\n\t\t</clipPath>\r\n\t\t<path style="clip-path:url(#ark-logo-starmap-letters__clip);fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M127,249.2c0,5.4,0,10.7,0,16.1\r\n\t\t\tc-0.8,0-1.6,0-2.4,0c0-3.8,0-7.5,0-11.3c0,0-0.1,0-0.1-0.1c-1.8,2.2-3.5,4.4-5.3,6.7c-1.8-2.3-3.6-4.5-5.5-6.8c0,3.9,0,7.7,0,11.5\r\n\t\t\tc-0.8,0-1.6,0-2.5,0c0-5.4,0-10.7,0-16.1c0.8-0.1,1.4-0.1,2,0.7c1.7,2.4,3.6,4.6,5.4,6.9c0.1,0.2,0.3,0.4,0.5,0.6\r\n\t\t\tc1.2-1.6,2.5-3.1,3.7-4.6c0.7-0.9,1.5-1.8,2.2-2.8C125.5,249.1,126.2,249.1,127,249.2z M95.1,260c1.3-0.7,2.1-1.8,2.5-3.4\r\n\t\t\tc0.7-3.4-1-6.6-3.9-7.1c-2-0.4-4.2-0.2-6.2-0.3c0,0-0.1,0-0.1,0.1c0,5.4,0,10.7,0,16.1c0.7,0,1.4,0,2.1,0c0-1.4,0-2.8,0-4.2\r\n\t\t\tc0.9,0,1.7,0,2.5,0c0.8,0,1.5,0.5,2,1.3c0.5,0.8,1,1.7,1.5,2.5c0.1,0.1,0.2,0.3,0.3,0.3c0.7,0,1.4,0,2.1,0\r\n\t\t\tc-0.6-1.6-2.2-4.1-3.3-5.1C94.8,260.2,94.9,260.1,95.1,260z M89.4,256.3c0-1.4,0-2.9,0-4.3c0-0.2,0.2-0.5,0.3-0.5\r\n\t\t\tc1.2,0,2.5,0,3.7,0.2c1.8,0.4,2.8,2.3,2.3,4.4c-0.3,1.3-1.1,2.1-2.1,2.3c-0.9,0.2-1.7,0.2-2.6,0.3c-0.5,0-0.9,0-1.5,0\r\n\t\t\tC89.4,257.9,89.4,257.1,89.4,256.3z M15.2,262.5c1.9,3.2,6.6,4.1,9.3,1.7c1.2-1.1,1.6-2.5,1.5-4.2c-0.2-1.8-1-2.9-2.4-3.5\r\n\t\t\tc-0.9-0.4-1.9-0.5-2.9-0.7c-0.8-0.2-1.6-0.3-2.4-0.7c-0.9-0.4-1.1-1.6-0.5-2.5c0.3-0.4,0.7-0.8,1.2-0.9c1.8-0.7,3.4-0.1,4.8,1.2\r\n\t\t\tc0.1,0.1,0.2,0.2,0.4,0.4c0.5-0.5,0.9-1,1.3-1.5c-0.8-1-1.8-1.8-2.9-2.2c-2-0.8-4-0.7-5.7,0.8c-1.2,1-1.7,2.4-1.5,4\r\n\t\t\tc0.2,1.7,1,2.6,2.3,3.2c0.7,0.3,1.4,0.4,2,0.6c1,0.2,2,0.4,2.9,0.7c0.7,0.2,1.1,0.9,1.2,1.8c0.1,1-0.3,1.7-1,2.1\r\n\t\t\tc-0.5,0.3-1.1,0.5-1.7,0.6c-2,0.2-3.6-0.5-4.8-2.5c-0.5,0.5-0.9,1-1.3,1.5C15.1,262.3,15.1,262.4,15.2,262.5z M74.6,265\r\n\t\t\tc-1.9-5.1-3.9-10.3-5.8-15.4c-0.2-0.6-0.6-0.3-1-0.4c-0.3,0-0.5,0-0.7,0.4c-1.5,4-3.1,8.1-4.6,12.1c-0.5,1.2-0.9,2.4-1.4,3.7\r\n\t\t\tc0.8,0,1.5,0,2.1,0c0.3,0,0.5-0.1,0.6-0.4c0.3-0.9,0.7-1.8,1-2.8c0.1-0.3,0.3-0.4,0.6-0.4c1.7,0,3.4,0,5,0c0.3,0,0.4,0.1,0.6,0.4\r\n\t\t\tc0.3,1,0.7,1.9,1.1,2.8c0.1,0.2,0.2,0.4,0.4,0.4c0.7,0,1.5,0,2.3,0C74.6,265.2,74.6,265.1,74.6,265z M70,259.4c-1.4,0-2.8,0-4.2,0\r\n\t\t\tc0.7-1.8,1.4-3.7,2.1-5.6C68.6,255.7,69.3,257.5,70,259.4z M42.5,251.5c0.4,0,0.6,0.1,0.6,0.7c0,4.2,0,8.3,0,12.5\r\n\t\t\tc0,0.2,0,0.4,0,0.7c0.7,0,1.4,0,2.1,0c0-4.6,0-9.2,0-13.8c1.3,0,2.6,0,4,0c0-0.8,0-1.6,0-2.3c-3.4,0-6.7,0-10,0c0,0.8,0,1.5,0,2.3\r\n\t\t\tC40.3,251.5,41.4,251.6,42.5,251.5z M166.3,265.4h1.5c0.1,0,0.3-0.1,0.3-0.3v-3.4c0-0.2,0.1-0.3,0.3-0.3c0.3,0,0.6,0,0.8,0\r\n\t\t\tc1-0.1,2.1,0,3.1-0.3c2.6-0.6,4.1-2.8,4.2-5.8c0.1-2.8-1.4-5-3.9-5.8c-0.4-0.1-0.8-0.2-1.2-0.3c0,0,0,0-0.1,0c-1.7,0-3.3,0-5,0\r\n\t\t\tc-0.1,0-0.3,0.1-0.3,0.3v15.6C166,265.2,166.1,265.4,166.3,265.4z M168.1,254.4c0-0.8,0-1.7,0-2.5c0-0.1,0.2-0.4,0.3-0.4\r\n\t\t\tc1.2,0,2.4,0,3.5,0.2c1.9,0.4,2.9,2.4,2.4,4.5c-0.3,1.2-1,2-2,2.4c-0.8,0.2-1.6,0.3-2.5,0.4c-0.5,0-1,0-1.6,0\r\n\t\t\tc-0.1,0-0.3-0.1-0.3-0.3C168.1,257.2,168.1,255.8,168.1,254.4z M145,249.9c-0.3,0.9-0.7,1.8-1,2.7c-1.6,4.1-3.2,8.2-4.8,12.4\r\n\t\t\tc0,0,0,0,0,0c-0.1,0.2,0.1,0.4,0.3,0.4h2c0.1,0,0.2-0.1,0.3-0.2c0.4-1.1,0.8-2.1,1.2-3.2c0-0.1,0.3-0.2,0.4-0.2c1.8,0,3.5,0,5.3,0\r\n\t\t\tc0.1,0,0.4,0.1,0.4,0.2c0.4,1.1,0.8,2.1,1.2,3.2c0,0.1,0.2,0.2,0.3,0.2h2c0.2,0,0.4-0.2,0.3-0.4c-0.6-1.7-1.3-3.3-1.9-5\r\n\t\t\tc-1.3-3.3-2.6-6.7-3.9-10C146,249.9,146,249.9,145,249.9z M144,258.9c0.6-1.5,1.1-2.9,1.7-4.4c0.1-0.3,0.5-0.3,0.6,0\r\n\t\t\tc0.6,1.5,1.1,3,1.7,4.4c0.1,0.2-0.1,0.4-0.3,0.4h-3.4C144.1,259.4,144,259.1,144,258.9z"/>\r\n\t</g>\r\n\t<g id="ark-logo-right-line-2">\r\n\t\t<path style="fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M149.1,131.6 147.3,133.5 147.3,151.6 109.3,188.2 \r\n\t\t\t109.3,150.2 151.6,109.3 151.6,63.6 104.9,18.5 104.9,68.2 129.6,93.6 129.7,93.6 129.7,90.3 \t"/>\r\n\t</g>\r\n\t<g id="ark-logo-right-line-1">\r\n\t\t<path style="fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M129.7,90.3 129.7,87.4 109.3,66.4 109.3,28.8 \r\n\t\t\t147.3,65.5 147.3,107.4 104.9,148.3 104.9,198.6 151.6,153.4 151.6,129.2 151.6,129.2 149.1,131.6 \t"/>\r\n\t</g>\r\n\t<g id="ark-logo-left-line-1">\r\n\t\t<path style="fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M61.8,90.2 61.8,87.4 82.1,66.4 82.1,28.8 44.2,65.5 \r\n\t\t\t44.2,107.4 86.5,148.3 86.5,198.6 39.8,153.4 39.8,129.2 39.9,129.2 41.9,131.2 \t"/>\r\n\t</g>\r\n\t<g id="ark-logo-left-line-2">\r\n\t\t<path style="fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M41.9,131.2 44.2,133.5 44.2,151.6 82.1,188.2 \r\n\t\t\t82.1,150.2 39.8,109.3 39.8,63.6 86.5,18.5 86.5,68.2 61.8,93.6 61.8,93.6 61.8,90.2 \t"/>\r\n\t</g>\r\n\t<g id="ark-logo-star">\r\n\t\t<path style="fill:none;stroke:#42CBF8;stroke-miterlimit:10;" d="M88.4,106.4c2.4-0.2,4.6-2.4,4.9-4.8l2-19.9\r\n\t\t\tc0.2-2.4,0.6-2.4,0.9,0l2,19.9c0.2,2.4,2.4,4.6,4.9,4.8l20.1,2c2.4,0.2,2.4,0.6,0,0.9l-20.1,2c-2.4,0.2-4.6,2.4-4.9,4.8l-2,19.9\r\n\t\t\tc-0.2,2.4-0.6,2.4-0.9,0l-2-19.9c-0.2-2.4-2.4-4.6-4.9-4.8l-20.1-2c-2.4-0.2-2.4-0.6,0-0.9L88.4,106.4z"/>\r\n\t</g>\r\n</svg>\r\n'},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(97).default,a=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var s=a(n(133)),l=o("Loading._elements"),c=function(){function t(){r(this,t);var e=document.createElement("section");e.classList.add("loading"),e.innerHTML=n(134),this[l]={root:e,diamond:e.querySelector("#loading__shape path"),gradient:e.querySelector("#loading__shape--shape")},this[l].root.style.opacity=0}return i(t,[{key:"show",value:function(){var t=this[l],e=t.root,n=t.diamond,i=t.gradient;i.style.opacity=0;var r=n.getTotalLength();n.style.strokeDasharray=r+"px",n.style.strokeDashoffset=r+"px",e.style.opacity=1,(new s.default).tween({from:{length:r},to:{length:0},duration:750,step:function(t){var e=t.length;return n.style.strokeDashoffset=e+"px"},finish:function(){i.style.opacity=1;var t=n.getBBox(),e=t.x+t.width/2,r=t.y+t.height/2;!function t(){(new s.default).tween({from:{rotation:0},to:{rotation:359},duration:2e3,step:function(t){var n=t.rotation;return i.setAttribute("transform","rotate("+n.toFixed(2)+" "+e+" "+r+")")},finish:t})}()}})}},{key:"element",get:function(){return this[l].root}}]),t}();e.default=c,t.exports=e.default},function(t,e,n){(function(){var e=this||Function("return this")(),n=function(){"use strict";function n(){}
/*!
                     * Handy shortcut for doing a for-in loop. This is not a "normal" each
                     * function, it is optimized for Shifty.  The iterator function only receives
                     * the property name, not the value.
                     * @param {Object} obj
                     * @param {Function(string)} fn
                     */function i(t,e){var n;for(n in t)Object.hasOwnProperty.call(t,n)&&e(n)}
/*!
                     * Perform a shallow copy of Object properties.
                     * @param {Object} targetObject The object to copy into
                     * @param {Object} srcObject The object to copy from
                     * @return {Object} A reference to the augmented `targetObj` Object
                     */function r(t,e){return i(e,(function(n){t[n]=e[n]})),t}
/*!
                     * Copies each property from src onto target, but only if the property to
                     * copy to target is undefined.
                     * @param {Object} target Missing properties in this Object are filled in
                     * @param {Object} src
                     */function o(t,e){i(e,(function(n){void 0===t[n]&&(t[n]=e[n])}))}
/*!
                     * Calculates the interpolated tween values of an Object for a given
                     * timestamp.
                     * @param {Number} forPosition The position to compute the state for.
                     * @param {Object} currentState Current state properties.
                     * @param {Object} originalState: The original state properties the Object is
                     * tweening from.
                     * @param {Object} targetState: The destination state properties the Object
                     * is tweening to.
                     * @param {number} duration: The length of the tween in milliseconds.
                     * @param {number} timestamp: The UNIX epoch time at which the tween began.
                     * @param {Object} easing: This Object's keys must correspond to the keys in
                     * targetState.
                     */function a(t,e,n,i,r,o,a){var l,c,u,h=o>t?0:(t-o)/r;for(l in e)e.hasOwnProperty(l)&&(u="function"==typeof(c=a[l])?c:d[c],e[l]=s(n[l],i[l],u,h));return e}
/*!
                     * Tweens a single property.
                     * @param {number} start The value that the tween started from.
                     * @param {number} end The value that the tween should end at.
                     * @param {Function} easingFunc The easing curve to apply to the tween.
                     * @param {number} position The normalized position (between 0.0 and 1.0) to
                     * calculate the midpoint of 'start' and 'end' against.
                     * @return {number} The tweened value.
                     */function s(t,e,n,i){return t+(e-t)*n(i)}
/*!
                     * Applies a filter to Tweenable instance.
                     * @param {Tweenable} tweenable The `Tweenable` instance to call the filter
                     * upon.
                     * @param {String} filterName The name of the filter to apply.
                     */function l(t,e){var n=h.prototype.filter,r=t._filterArgs;i(n,(function(i){void 0!==n[i][e]&&n[i][e].apply(t,r)}))}
/*!
                     * Handles the update logic for one step of a tween.
                     * @param {Tweenable} tweenable
                     * @param {number} timestamp
                     * @param {number} delay
                     * @param {number} duration
                     * @param {Object} currentState
                     * @param {Object} originalState
                     * @param {Object} targetState
                     * @param {Object} easing
                     * @param {Function(Object, *, number)} step
                     * @param {Function(Function,number)}} schedule
                     * @param {number=} opt_currentTimeOverride Needed for accurate timestamp in
                     * Tweenable#seek.
                     */function c(t,e,n,i,r,o,s,c,u,h,d){p=e+n+i,m=Math.min(d||w(),p),v=m>=p,g=i-(p-m),t.isPlaying()&&(v?(u(s,t._attachment,g),t.stop(!0)):(t._scheduleId=h(t._timeoutHandler,b),l(t,"beforeTween"),e+n>m?a(1,r,o,s,1,1,c):a(m,r,o,s,i,e+n,c),l(t,"afterTween"),u(r,t._attachment,g)))}
/*!
                     * Creates a usable easing Object from a string, a function or another easing
                     * Object.  If `easing` is an Object, then this function clones it and fills
                     * in the missing properties with `"linear"`.
                     * @param {Object.<string|Function>} fromTweenParams
                     * @param {Object|string|Function} easing
                     * @return {Object.<string|Function>}
                     */function u(t,e){var n={},r=typeof e;return i(t,"string"===r||"function"===r?function(t){n[t]=e}:function(t){n[t]||(n[t]=e[t]||y)}),n}function h(t,e){this._currentState=t||{},this._configured=!1,this._scheduleFunction=f,void 0!==e&&this.setConfig(e)}var d,f,p,m,v,g,y="linear",b=1e3/60,x=Date.now?Date.now:function(){return+new Date},w="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:x;
/*!
                     * Filters are used for transforming the properties of a tween at various
                     * points in a Tweenable's life cycle.  See the README for more info on this.
                     */
return f="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame)||setTimeout,h.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._timestamp=w(),this._start(this.get(),this._attachment),this.resume())},h.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._attachment=t.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=t.delay||0,this._start=t.start||n,this._step=t.step||n,this._finish=t.finish||n,this._duration=t.duration||500,this._currentState=r({},t.from)||this.get(),this._originalState=this.get(),this._targetState=r({},t.to)||this.get();var e=this;this._timeoutHandler=function(){c(e,e._timestamp,e._delay,e._duration,e._currentState,e._originalState,e._targetState,e._easing,e._step,e._scheduleFunction)};var i=this._currentState,a=this._targetState;return o(a,i),this._easing=u(i,t.easing||y),this._filterArgs=[i,this._originalState,a,this._easing],l(this,"tweenCreated"),this},h.prototype.get=function(){return r({},this._currentState)},h.prototype.set=function(t){this._currentState=t},h.prototype.pause=function(){return this._pausedAtTime=w(),this._isPaused=!0,this},h.prototype.resume=function(){return this._isPaused&&(this._timestamp+=w()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},h.prototype.seek=function(t){t=Math.max(t,0);var e=w();return this._timestamp+t===0||(this._timestamp=e-t,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,c(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,e),this.pause())),this},h.prototype.stop=function(t){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=n,(e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.oCancelAnimationFrame||e.msCancelAnimationFrame||e.mozCancelRequestAnimationFrame||e.clearTimeout)(this._scheduleId),t&&(l(this,"beforeTween"),a(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),l(this,"afterTween"),l(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},h.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},h.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},h.prototype.dispose=function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t]},h.prototype.filter={},h.prototype.formula={linear:function(t){return t}},d=h.prototype.formula,r(h,{now:w,each:i,tweenProps:a,tweenProp:s,applyFilter:l,shallowCopy:r,defaults:o,composeEasingObject:u}),"function"==typeof SHIFTY_DEBUG_NOW&&(e.timeoutHandler=c),t.exports=h,h}();n.shallowCopy(n.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},swingFrom:function(t){var e=1.70158;return t*t*((e+1)*t-e)},swingTo:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?2-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}}),function(){function t(t,e,n,i,r,o){function a(t){return((c*t+u)*t+h)*t}function s(t){return(3*c*t+2*u)*t+h}function l(t){return t>=0?t:0-t}var c=0,u=0,h=0,d=0,f=0,p=0;return c=1-(h=3*e)-(u=3*(i-e)-h),d=1-(p=3*n)-(f=3*(r-n)-p),function(t,e){return function(t){return((d*t+f)*t+p)*t}(function(t,e){var n,i,r,o,c,u;for(r=t,u=0;8>u;u++){if(l(o=a(r)-t)<e)return r;if(l(c=s(r))<1e-6)break;r-=o/c}if(n=0,i=1,r=t,n>r)return n;if(r>i)return i;for(;i>n;){if(l((o=a(r))-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r}(t,e))}(t,function(t){return 1/(200*t)}(o))}
/*!
                 *  getCubicBezierTransition(x1, y1, x2, y2) -> Function
                 *
                 *  Generates a transition easing function that is compatible
                 *  with WebKit's CSS transitions `-webkit-transition-timing-function`
                 *  CSS property.
                 *
                 *  The W3C has more information about CSS3 transition timing functions:
                 *  http://www.w3.org/TR/css3-transitions/#transition-timing-function_tag
                 *
                 *  @param {number} x1
                 *  @param {number} y1
                 *  @param {number} x2
                 *  @param {number} y2
                 *  @return {function}
                 */function e(e,n,i,r){return function(o){return t(o,e,n,i,r,1)}}n.setBezierFunction=function(t,i,r,o,a){var s=e(i,r,o,a);return s.displayName=t,s.x1=i,s.y1=r,s.x2=o,s.y2=a,n.prototype.formula[t]=s},n.unsetBezierFunction=function(t){delete n.prototype.formula[t]}}(),function(){var t=new n;t._filterArgs=[],n.interpolate=function(e,i,r,o,a){var s=n.shallowCopy({},e),l=a||0,c=n.composeEasingObject(e,o||"linear");t.set({});var u=t._filterArgs;u.length=0,u[0]=s,u[1]=e,u[2]=i,u[3]=c,n.applyFilter(t,"tweenCreated"),n.applyFilter(t,"beforeTween");var h=function(t,e,i,r,o,a){return n.tweenProps(r,e,t,i,1,a,o)}(e,s,i,r,c,l);return n.applyFilter(t,"afterTween"),h}}(),function(t){
/*!
                 * @param {Array.number} rawValues
                 * @param {string} prefix
                 *
                 * @return {Array.<string>}
                 */
function e(t,e){var n,i=[],r=t.length;for(n=0;r>n;n++)i.push("_"+e+"_"+n);return i}
/*!
                 * @param {string} formattedString
                 *
                 * @return {string}
                 */function n(t){var e=t.match(m);return e?(1===e.length||t[0].match(p))&&e.unshift(""):e=["",""],e.join(x)}
/*!
                 * Convert all hex color values within a string to an rgb string.
                 *
                 * @param {Object} stateObject
                 *
                 * @return {Object} The modified obj
                 */function i(e){t.each(e,(function(t){var n=e[t];"string"==typeof n&&n.match(b)&&(e[t]=
/*!
                 * @param {string} str
                 *
                 * @return {string}
                 */
function(t){return a(b,t,r)}
/*!
                 * @param {string} hexString
                 *
                 * @return {string}
                 */(n))}))}function r(t){var e=
/*!
                 * Convert a hexadecimal string to an array with three items, one each for
                 * the red, blue, and green decimal values.
                 *
                 * @param {string} hex A hexadecimal string.
                 *
                 * @returns {Array.<number>} The converted Array of RGB values if `hex` is a
                 * valid string, or an Array of three 0's.
                 */
function(t){return t=t.replace(/#/,""),3===t.length&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),w[0]=o(t.substr(0,2)),w[1]=o(t.substr(2,2)),w[2]=o(t.substr(4,2)),w}
/*!
                 * Convert a base-16 number to base-10.
                 *
                 * @param {Number|String} hex The value to convert
                 *
                 * @returns {Number} The base-10 equivalent of `hex`.
                 */(t);return"rgb("+e[0]+","+e[1]+","+e[2]+")"}function o(t){return parseInt(t,16)}
/*!
                 * Runs a filter operation on all chunks of a string that match a RegExp
                 *
                 * @param {RegExp} pattern
                 * @param {string} unfilteredString
                 * @param {function(string)} filter
                 *
                 * @return {string}
                 */function a(t,e,n){var i=e.match(t),r=e.replace(t,x);if(i)for(var o,a=i.length,s=0;a>s;s++)o=i.shift(),r=r.replace(x,n(o));return r}
/*!
                 * Check for floating point values within rgb strings and rounds them.
                 *
                 * @param {string} formattedString
                 *
                 * @return {string}
                 */
/*!
                 * @param {string} rgbChunk
                 *
                 * @return {string}
                 */
function s(t){for(var e=t.match(v),n=e.length,i=t.match(y)[0],r=0;n>r;r++)i+=parseInt(e[r],10)+",";return i.slice(0,-1)+")"}
/*!
                 * @param {Object} stateObject
                 *
                 * @return {Object} An Object of formatManifests that correspond to
                 * the string properties of stateObject
                 */function l(i){var r={};return t.each(i,(function(t){var o=i[t];if("string"==typeof o){var a=h(o);r[t]={formatString:n(o),chunkNames:e(a,t)}}})),r}
/*!
                 * @param {Object} stateObject
                 * @param {Object} formatManifests
                 */function c(e,n){t.each(n,(function(t){for(var i=h(e[t]),r=i.length,o=0;r>o;o++)e[n[t].chunkNames[o]]=+i[o];delete e[t]}))}
/*!
                 * @param {Object} stateObject
                 * @param {Object} formatManifests
                 */function u(e,n){t.each(n,(function(t){var i=e[t],r=
/*!
                 * @param {Object} stateObject
                 * @param {Array.<string>} chunkNames
                 *
                 * @return {Object} The extracted value chunks.
                 */
function(t,e){for(var n,i={},r=e.length,o=0;r>o;o++)n=e[o],i[n]=t[n],delete t[n];return i}
/*!
                 * @param {Object} stateObject
                 * @param {Array.<string>} chunkNames
                 *
                 * @return {Array.<number>}
                 */(e,n[t].chunkNames),o=function(t,e){_.length=0;for(var n=e.length,i=0;n>i;i++)_.push(t[e[i]]);return _}
/*!
                 * @param {string} formatString
                 * @param {Array.<number>} rawValues
                 *
                 * @return {string}
                 */(r,n[t].chunkNames);i=function(t,e){for(var n=t,i=e.length,r=0;i>r;r++)n=n.replace(x,+e[r].toFixed(4));return n}
/*!
                 * Note: It's the duty of the caller to convert the Array elements of the
                 * return value into numbers.  This is a performance optimization.
                 *
                 * @param {string} formattedString
                 *
                 * @return {Array.<string>|null}
                 */(n[t].formatString,o),e[t]=function(t){return a(g,t,s)}(i)}))}function h(t){return t.match(v)}
/*!
                 * @param {Object} easingObject
                 * @param {Object} tokenData
                 */function d(e,n){t.each(n,(function(t){var i,r=n[t].chunkNames,o=r.length,a=e[t];if("string"==typeof a){var s=a.split(" "),l=s[s.length-1];for(i=0;o>i;i++)e[r[i]]=s[i]||l}else for(i=0;o>i;i++)e[r[i]]=a;delete e[t]}))}
/*!
                 * @param {Object} easingObject
                 * @param {Object} tokenData
                 */function f(e,n){t.each(n,(function(t){var i=n[t].chunkNames,r=i.length,o=e[i[0]];if("string"===typeof o){for(var a="",s=0;r>s;s++)a+=" "+e[i[s]],delete e[i[s]];e[t]=a.substr(1)}else e[t]=o}))}
/*!
                 * @typedef {{
                 *   formatString: string
                 *   chunkNames: Array.<string>
                 * }}
                 */var p=/(\d|\-|\.)/,m=/([^\-0-9\.]+)/g,v=/[0-9.\-]+/g,g=new RegExp("rgb\\("+v.source+/,\s*/.source+v.source+/,\s*/.source+v.source+"\\)","g"),y=/^.*\(/,b=/#([0-9]|[a-f]){3,6}/gi,x="VAL",w=[],_=[];t.prototype.filter.token={tweenCreated:function(t,e,n,r){i(t),i(e),i(n),this._tokenData=l(t)},beforeTween:function(t,e,n,i){d(i,this._tokenData),c(t,this._tokenData),c(e,this._tokenData),c(n,this._tokenData)},afterTween:function(t,e,n,i){u(t,this._tokenData),u(e,this._tokenData),u(n,this._tokenData),f(i,this._tokenData)}}}(n)}).call(null)},function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?>\r\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n\t viewBox="0 0 429 425" style="enable-background:new 0 0 429 425;" xml:space="preserve">\r\n\t<g id="loading__shape">\r\n\t\t<path style="fill-rule:evenodd;clip-rule:evenodd;fill:none;stroke:#072B45;stroke-width:6;stroke-miterlimit:10;" d="M17.6,241.1\r\n\t\t\tv-58.3L185.9,14.6h58.3l168.3,168.3v60.4L246.3,409.4H188L17.6,241.5z"/>\r\n\t</g>\r\n\t<g>\r\n\t\t<defs>\r\n\t\t\t<path id="loading__shape--mask-shape" d="M247.5,412.4h-60.7l-172.2-170v-60.8L184.6,11.6h60.7l170.1,170.1v62.9L247.5,412.4z M189.3,406.4H245\r\n\t\t\t\t\tL409.4,242v-57.9L242.9,17.6h-55.8L20.6,184.1v55.8L189.3,406.4z"/>\r\n\t\t</defs>\r\n\t\t<clipPath id="loading__shape--mask-shape">\r\n\t\t\t<use xlink:href="#loading__shape--mask-shape"  style="overflow:visible;"/>\r\n\t\t</clipPath>\r\n\t\t<linearGradient id="loading__shape--gradient" gradientUnits="userSpaceOnUse" x1="-44.7716" y1="-186.4162" x2="12.9588" y2="-186.4162" gradientTransform="matrix(-0.9099 -1.6358 0.8739 -0.4861 210.6906 179.9666)">\r\n\t\t\t<stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0"/>\r\n\t\t\t<stop offset="0.9402" style="stop-color:#FFFFFF;stop-opacity:0.4"/>\r\n\t\t\t<stop offset="1" style="stop-color:#FFFFFF;stop-opacity:0"/>\r\n\t\t</linearGradient>\r\n\t\t<g style="clip-path:url(#loading__shape--mask-shape);">\r\n\t\t\t<polygon id="loading__shape--shape" style="fill-rule:evenodd;clip-rule:evenodd;fill:url(#loading__shape--gradient);" points="180.5,153.1 \r\n\t\t\t\t246.5,271.6 -134.8,483.6 -200.7,365.1 \t\t"/>\r\n\t\t</g>\r\n\t</g>\r\n</svg>\r\n'},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(114)),u=l(n(76)),h=l(n(136)),d=s("mapping"),f={requestFullscreen:["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],exitFullscreen:["exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"],fullscreenElement:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],fullscreenEnabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],fullscreenchange:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],fullscreenerror:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},p=["fullscreenchange","fullscreenerror"],m=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),c.default.addEventListener(this.mapping.fullscreenchange,this._onStateChange.bind(this))}return r(e,t),o(e,[{key:"_initMapping",value:function(){this.mapping=u.default.mapObject(f,(function(t,e){return t.find((function(t){return t in c.default||t in c.default.documentElement||p.indexOf(e)>-1&&"on"+t in c.default}))}))}},{key:"request",value:function(t){(t=t||c.default.documentElement)[this.mapping.requestFullscreen]()}},{key:"exit",value:function(){c.default[this.mapping.exitFullscreen]()}},{key:"toggle",value:function(t){this.isFullscreen?this.exit():this.request(t)}},{key:"_onStateChange",value:function(){this.trigger("change_state",this.isFullscreen)}},{key:"mapping",get:function(){return this[d]||this._initMapping(),this[d]},set:function(t){this[d]=t}},{key:"isFullscreen",get:function(){return!!c.default[this.mapping.fullscreenElement]}}]),e}(h.default);e.default=m,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(76)),u=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"toJSON",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"toJSON",this).call(this),a=c.default.isArray(o)?"map":"mapObject",s=c.default[a](o,(function(t){return t&&c.default.isFunction(t.toJSON)?t.toJSON.apply(t,n):t}));return s}}]),e}(l.Model);e.default=u,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{i.contextOrFrameLookup(e,n,"fwa_sotd")&&(o+='\n  <a href="http://www.thefwa.com/site/star-citizen-starmap" target="_blank" class="sm-fwa-sotd sm-active"><span>FWA Site Of The Day</span></a>\n'),r(null,o+='\n\n<div class="circle-one"></div>\n<div class="circle-two"></div>\n<div class="circle-three"></div>\n\n<div class="sm-initial-scene">\n  <div class="sc-logo-wrapper"></div>\n\n  <div class="ark-logo-wrapper">\n    <p>Stellar Cartographics</p>\n  </div>\n\n  <div class="welcome">Welcome to the ARK Starmap. Use the fullscreen mode for a better experience</div>\n\n  <button type="button" class="launch-fullscreen">\n    <span class="background-wrapper">\n      <span class="background"></span>\n    </span>\n    <span class="left-light"></span>\n    <span class="right-light"></span>\n    <span class="caption">Enter full screen</span>\n  </button>\n\n  <button type="button" class="launch">Or <strong>enter in window mode</strong></button>\n</div>\n\n<div class="sm-loading-scene">\n  <label><span>Loading Ark interface</span></label>\n  <p><span></span></p>\n</div>\n\n<div class="sm-acknowledgment-scene">\n  <blockquote>\n    <p>Humanity has always been told to reach for the stars.</p>\n    <p>Well, it looks like we may have finally caught one.</p>\n    <footer><span>Nick Croshaw, Explorer, 2271</span></footer>\n  </blockquote>\n\n  <p>\n    Star Citizen is currently in development and changes are to be expected.\n    The ARK Starmap will be regularly expanded and updated as we move toward the completed game.\n    Thank you for joining us on the journey.\n  </p>\n\n  <input id="sm-dont-show-acknowledgment" type="checkbox">\n  <label for="sm-dont-show-acknowledgment"><span>Don\'t show this screen next time</span></label>\n\n  <button type="button" class="sm-acknowledge">\n    <span class="background-wrapper">\n      <span class="background"></span>\n    </span>\n    <span class="left-light"></span>\n    <span class="right-light"></span>\n    <span class="caption on">Acknowledge &amp; continue</span>\n  </button>\n</div>\n\n<div class="sm-info-scene">\n  <p>At the dawn of the 29th century, a new center of knowledge and understanding was constructed: the ARK. Not bound to any one place, species or government, the Ark was established under a simple principle: to provide a neutral repository for all galactic knowledge.</p>\n\n  <p>Currently residing in the Tayac System, the Ark and its team of dedicated archivists and researchers curate this information for the Galactapedia and the Starmap. Invaluable tools that allow all beings to better understand the universe and find their way through it.</p>\n\n  <input id="sm-dont-show-info" type="checkbox">\n  <label for="sm-dont-show-info"><span>Don\'t show this screen next time</span></label>\n\n  <button type="button" class="sm-continue">\n    <span class="background-wrapper">\n      <span class="background"></span>\n    </span>\n    <span class="left-light"></span>\n    <span class="right-light"></span>\n    <span class="caption on">Explore starmap</span>\n  </button>\n</div>\n\n<div class="sm-no-webgl-scene">\n  <div class="sm-contents">\n    <p class="sm-welcome">Welcome to the ARK Starmap</p>\n\n    <p class="sm-no-support">Your browser does not seem to support WebGL.</p>\n\n    <p class="sm-download">\n      We suggest you\n      <a href="http://www.google.com/chrome/" target="_blank">download the latest version of Google Chrome</a>.\n    </p>\n  </div>\n</div>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(139).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=c(n(135)),d=c(n(142)),f=c(n(116)),p=c(n(146)),m=n(147),v=s("ui"),g=s("events"),y=s("modelEvents"),b=s("fsHelper"),x={N:"Probe data incomplete",M:"UEE Military classified"},w=function(t){function e(t){var n=this;a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t);var r=this.model.get("soundFX");this.onUserFullscreenChange(),this.listenTo(this.model.get("interface"),"change:fullscreen",this.onFullscreenChange),this.listenTo(this.fsHelper,"change_state",this.onUserFullscreenChange),this.listenTo(this.model,"change:location",this.onLocationChange),this.listenTo(r,"change:enabled",this.render),p.default.bind("backspace",(function(t){t.preventDefault(),n.model.goToParent()})),p.default.bind("m",(function(t){var e=n.model.get("soundFX");e.set("enabled",!e.get("enabled"))})),p.default.bind("f",(function(t){var e=n.model.get("interface");e.set("fullscreen",!e.get("fullscreen")),n.render()}))}return r(e,t),o(e,[{key:"serializeData",value:function(){var t=this.model.get("soundFX"),e=this.model.get("location"),n=this.model.get("location").type;n===f.default.Types.CELESTIAL_OBJECT&&(n="BODY");var i=null,r=null,o=null,a=null;if(e.type!==f.default.Types.GALAXY){var s=(r=this._getInfo())&&r.affiliation&&r.affiliation[0];o=s&&s.code.toLowerCase(),a=s&&s.color}return r&&e.type===f.default.Types.STAR_SYSTEM&&(i=x[r.status]),{isFullscreen:this.fsHelper.isFullscreen,soundEnabled:t.get("enabled"),hasParent:e.type!==f.default.Types.GALAXY,info:r,affiliationCode:o,affiliationColor:a,systemStatusText:i,levels:l(d.default.TYPE_INFO).map((function(t){var e=d.default.TYPE_INFO[t];return e.key=t,e.active=t===n,e}))}}},{key:"_getInfo",value:function(){var t=this,e=this._locationInfo,n=this.model.get("currentAnimation"),i=this.model.get("location");if(!e)if(n)n.then((function(){t._locationInfo=t.model.getLocationInfo(i),t.render()}));else try{e=this.model.getLocationInfo(i)}catch(t){console.error("get location info threw error even without animation",t)}return this._locationInfo=null,e&&e.raw}},{key:"onUserFullscreenChange",value:function(t){this.render()}},{key:"onFullscreenChange",value:function(t,e){e?this.fsHelper.request():this.fsHelper.exit()}},{key:"onFullscreenClick",value:function(t){t.preventDefault();var e=this.model.get("interface");e.set("fullscreen",!e.get("fullscreen")),this.render()}},{key:"onLocationChange",value:function(t){this.render()}},{key:"onSoundClick",value:function(t){t.preventDefault();var e=this.model.get("soundFX");e.set("enabled",!e.get("enabled"))}},{key:"onBackClick",value:function(t){t.preventDefault(),this.model.goToParent()}},{key:"template",get:function(){return m}},{key:"className",get:function(){return"sm-header"}},{key:"ui",get:function(){return this[v]=this[v]||{back:".sm-back",fullscreen:".sm-fullscreen",sound:".sm-sound"},this[v]},set:function(t){this[v]=t}},{key:"events",get:function(){return this[g]=this[g]||{"click @ui.back":"onBackClick","click @ui.fullscreen":"onFullscreenClick","click @ui.sound":"onSoundClick"},this[g]},set:function(t){this[g]=t}},{key:"modelEvents",get:function(){return this[y]=this[y]||{"change:location":"render"},this[y]}},{key:"fsHelper",get:function(){return this[b]=this[b]||new h.default,this[b]}}]),e}(u.ItemView);e.default=w,t.exports=e.default},function(t,e,n){t.exports={default:n(140),__esModule:!0}},function(t,e,n){n(141),t.exports=n(30).Object.keys},[476,127,86],function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(136)),u=l(n(143)),h=(l(n(76)),n(116)),d=l(h),f=s("cache"),p={STAR_SYSTEM:"STAR_SYSTEM",BODY:"BODY"},m={STAR_SYSTEM:null,BODY:"system"},v=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"toURLParams",value:function(){var t=this.parent?"&system="+this.parent.get("code"):"";return this.get("code")+t}},{key:"idAttribute",get:function(){return"code"}},{key:"defaults",get:function(){return{type:null,code:null,name:null,system:null,subType:void 0}}},{key:"parent",get:function(){var t=m[this.get("type")];return t&&this.get(t)}}],[{key:"load",value:function(t){var n=e.cache.add(t);return n.set(t),n}},{key:"fromLocation",value:function(t,n){var i=t.getLocationInfo(n),r=p.STAR_SYSTEM,o=null,a=null;return n.type!==d.default.Types.STAR_SYSTEM?(r=p.BODY,o=n.objectCode,a=e.fromLocation(t,new d.default(d.default.Types.STAR_SYSTEM,n.starSystemCode))):o=n.starSystemCode,new e({type:r,code:o,name:i.name,system:a,subType:i.raw.type})}},{key:"cache",get:function(){return this[f]=this[f]||new u.default}},{key:"TYPES",get:function(){return p}},{key:"TYPE_INFO",get:function(){return{GALAXY:{name:"Galaxy",acronym:"GLX"},STAR_SYSTEM:{name:"Star System",acronym:"SYS"},BODY:{name:"Celestial Body",acronym:"OBJ"}}}},{key:"SUB_TYPE_INFO",get:function(){return{STAR:{name:"Star"},PLANET:{name:"Planet"},SATELLITE:{name:"Satellite"},LZ:{name:"Landing zone"},BLACKHOLE:{name:"Black hole"},POI:{name:"Point of interest"},ASTEROID_BELT:{name:"Asteroid belt"},ASTEROID_FIELD:{name:"Asteroid field"},MANMADE:{name:"Man-made"},JUMPPOINT:{name:"Jump point"}}}},{key:"SUB_TYPES",get:function(){return{STAR:"STAR",PLANET:"PLANET",SATELLITE:"SATELLITE",LANDING_ZONE:"LZ",BLACKHOLE:"BLACKHOLE",POI:"POI",ASTEROID_BELT:"ASTEROID_BELT",ASTEROID_FIELD:"ASTEROID_FIELD",MANMADE:"MANMADE",JUMPPOINT:"JUMPPOINT"}}}]),e}(c.default);e.default=v,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(144)),c=s(n(142)),u=(s(n(76)),function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"parse",value:function(t){if(!(t&&t.success&&t.data&&t.data.objects&&t.data.systems))return[];var e=t.data.systems.resultset.map((function(t){return t.subType=t.type,t.type=c.default.TYPES.STAR_SYSTEM,t})).concat(t.data.objects.resultset.map((function(t){return t.subType=t.type,t.type=c.default.TYPES.BODY,t.system=new c.default({type:c.default.TYPES.STAR_SYSTEM,code:t.star_system.code,name:t.star_system.name,subType:t.star_system.type}),delete t.star_system,t})));return e}},{key:"model",get:function(){return c.default}},{key:"url",get:function(){return"/api/starmap/find"}}]),e}(l.default));e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(75),u=l(n(145)),h=l(n(76)),d=s("isLoading"),f=(window.RSI.SESSION_NAME,"https://test.cloudimperiumgames.com"),p=function(t){function e(){a(this,e);for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.setSyncOptions=u.default.prototype.setSyncOptions.bind(this),this.on("request",this._onRequest),this.on("sync",this._onSync),this.on("error",this._onError)}return r(e,t),o(e,[{key:"url",value:function(){throw new Error("url not set")}},{key:"sync",value:function(t,n,r){this.setSyncOptions(t,n,r);var o=h.default.result(this,"url");return"file:"===location.protocol&&(r.url=f+o),i(Object.getPrototypeOf(e.prototype),"sync",this).call(this,t,n,r)}},{key:"parse",value:function(t){return t&&t.success&&t.data?t.data.resultset:[]}},{key:"toServerObject",value:function(){return this.toJSON()}},{key:"_onRequest",value:function(){this.isLoading=!0}},{key:"_onSync",value:function(){this.isLoading=!1}},{key:"_onError",value:function(){this.isLoading=!1}},{key:"model",get:function(){return u.default}},{key:"isLoading",get:function(){return this[d]=this[d]||!1},set:function(t){this[d]=t}}]),e}(c.Collection);e.default=p,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(114)),c=s(n(136)),u=s(n(76)),h={sessionName:window.RSI.SESSION_NAME,defaultBase:"https://test.cloudimperiumgames.com"},d=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"getUrl",value:function(t,e){throw new Error("getUrl not implemented.")}},{key:"setSyncOptions",value:function(t,e,n){(n=n||{}).type="POST",n.data=JSON.stringify(n.data||e.toServerObject()),n.contentType="application/json; charset=utf-8",n.headers=n.headers||{},n.headers["X-"+h.sessionName]=function(t){var e=new RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)").exec(l.default.cookie);return e?e[1]:null}(h.sessionName)}},{key:"sync",value:function(t,n,r){return r._method=t,this.setSyncOptions(t,n,r),r.url=this.getUrl(t,r),"file:"===location.protocol&&(r.url=h.defaultBase+r.url),i(Object.getPrototypeOf(e.prototype),"sync",this).call(this,t,n,r)}},{key:"parse",value:function(t){return t=t||{},u.default.isUndefined(t.success)?t:t.success&&u.default.isObject(t.data)?t.data:null}},{key:"toServerObject",value:function(){return this.toJSON()}}]),e}(c.default);e.default=d,t.exports=e.default},function(t,e,n){var i;!function(r,o,a){function s(t,e,n){return t.addEventListener?void t.addEventListener(e,n,!1):void t.attachEvent("on"+e,n)}function l(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return v[t.which]?v[t.which]:g[t.which]?g[t.which]:String.fromCharCode(t.which).toLowerCase()}function c(t,e){return t.sort().join(",")===e.sort().join(",")}function u(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function h(t,e,n){return n||(n=function(){if(!m)for(var t in m={},v)t>95&&112>t||v.hasOwnProperty(t)&&(m[v[t]]=t);return m}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function d(t,e){var n,i,r,o=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),r=0;r<n.length;++r)i=n[r],b[i]&&(i=b[i]),e&&"keypress"!=e&&y[i]&&(i=y[i],o.push("shift")),u(i)&&o.push(i);return{key:i,modifiers:o,action:e=h(i,o,e)}}function f(t,e){return null!==t&&t!==o&&(t===e||f(t.parentNode,e))}function p(t){function e(t){t=t||{};var e,n=!1;for(e in g)t[e]?n=!0:g[e]=0;n||(x=!1)}function n(t,e,n,i,r,o){var a,s,l=[],h=n.type;if(!m._callbacks[t])return[];for("keyup"==h&&u(t)&&(e=[t]),a=0;a<m._callbacks[t].length;++a)if(s=m._callbacks[t][a],(i||!s.seq||g[s.seq]==s.level)&&h==s.action&&("keypress"==h&&!n.metaKey&&!n.ctrlKey||c(e,s.modifiers))){var d=!i&&s.combo==r,f=i&&s.seq==i&&s.level==o;(d||f)&&m._callbacks[t].splice(a,1),l.push(s)}return l}function i(t,e,n,i){m.stopCallback(e,e.target||e.srcElement,n,i)||!1===t(e,n)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(e),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(e))}function r(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=l(t);if(e)return"keyup"==t.type&&y===e?void(y=!1):void m.handleKey(e,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t)}function a(){clearTimeout(v),v=setTimeout(e,1e3)}function h(t,n,r,o){function s(e){return function(){x=e,++g[t],a()}}function c(n){i(r,n,t),"keyup"!==o&&(y=l(n)),setTimeout(e,10)}g[t]=0;for(var u=0;u<n.length;++u){var h=u+1===n.length?c:s(o||d(n[u+1]).action);f(n[u],h,o,t,u)}}function f(t,e,i,r,o){m._directMap[t+":"+i]=e;var a,s=(t=t.replace(/\s+/g," ")).split(" ");return s.length>1?void h(t,s,e,i):(a=d(t,i),m._callbacks[a.key]=m._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},r,t,o),void m._callbacks[a.key][r?"unshift":"push"]({callback:e,modifiers:a.modifiers,action:a.action,seq:r,level:o,combo:t}))}var m=this;if(t=t||o,!(m instanceof p))return new p(t);m.target=t,m._callbacks={},m._directMap={};var v,g={},y=!1,b=!1,x=!1;m._handleKey=function(t,r,o){var a,s=n(t,r,o),l={},c=0,h=!1;for(a=0;a<s.length;++a)s[a].seq&&(c=Math.max(c,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=c)continue;h=!0,l[s[a].seq]=1,i(s[a].callback,o,s[a].combo,s[a].seq)}else h||i(s[a].callback,o,s[a].combo);var d="keypress"==o.type&&b;o.type!=x||u(t)||d||e(l),b=h&&"keydown"==o.type},m._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)f(t[i],e,n)},s(t,"keypress",r),s(t,"keydown",r),s(t,"keyup",r)}for(var m,v={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},g={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},y={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},b={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},x=1;20>x;++x)v[111+x]="f"+x;for(x=0;9>=x;++x)v[x+96]=x;p.prototype.bind=function(t,e,n){var i=this;return t=t instanceof Array?t:[t],i._bindMultiple.call(i,t,e,n),i},p.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},p.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},p.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},p.prototype.stopCallback=function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!f(e,this.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},p.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},p.init=function(){var t=p(o);for(var e in t)"_"!==e.charAt(0)&&(p[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},p.init(),r.Mousetrap=p,void 0!==t&&t.exports&&(t.exports=p),void 0===(i=function(){return p}.call(e,n,e,t))||(t.exports=i)}(window,document)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<div class="sm-back-indicator-container">\n  ',i.contextOrFrameLookup(e,n,"hasParent")&&(o+='<button class="sm-back" type="button" title="Go back"><span>Back</span></button>'),o+='<ul class="sm-indicator">\n    ',n=n.push();var a=i.contextOrFrameLookup(e,n,"levels");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("level",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+="<li ",i.memberLookup(c,"active",t.opts.autoescape)&&(o+='class="sm-active"'),o+=' title="',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+='">',o+=i.suppressValue(i.memberLookup(c,"acronym",t.opts.autoescape),t.opts.autoescape),o+="</li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-info-container">',i.contextOrFrameLookup(e,n,"info")&&(o+='<div class="sm-info sm-status-',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"info"),"status",t.opts.autoescape),t.opts.autoescape),o+=" sm-affiliation-",o+=i.suppressValue(i.contextOrFrameLookup(e,n,"affiliationCode"),t.opts.autoescape),o+='">\n      <div class="sm-info-inner">\n        <h1 style="color: ',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"affiliationColor"),t.opts.autoescape),o+=';">\n          <span class="sm-name">',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"info"),"name",t.opts.autoescape),t.opts.autoescape),o+='</span>\n          <span class="sm-designation">',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"info"),"designation",t.opts.autoescape),t.opts.autoescape),o+="</span>\n        </h1>",i.contextOrFrameLookup(e,n,"systemStatusText")&&(o+='<strong class="sm-system-status"><span>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"systemStatusText"),t.opts.autoescape),o+="</span></strong>"),o+="</div>\n    </div>"),o+='</div>\n\n<div class="sm-settings-container">\n  <div class="sm-settings">\n    <button class="sm-sound ',i.contextOrFrameLookup(e,n,"soundEnabled")&&(o+="sm-enabled"),o+='" type="button" title="Toggle sound effects">\n      <strong><span>Toggle sound effects</span></strong>\n    </button>',o+='<button class="sm-fullscreen ',i.contextOrFrameLookup(e,n,"isFullscreen")&&(o+="sm-enabled"),r(null,o+='" type="button" title="Toggle fullscreen">\n      <strong><span>Toggle fullscreen</span></strong>\n    </button>\n  </div>\n</div>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(149).default,l=n(97).default,c=n(19).default,u=n(139).default,h=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var d=h(n(114)),f=n(121),p=h(n(136)),m=h(n(76)),v=h(n(156)),g=h(n(167)),y=h(n(178)),b=h(n(180)),x=h(n(182)),w=h(n(184)),_=(h(n(142)),n(186)),S=h(_),M=h(n(113)),C=h(n(116)),T=h(n(187)),E=l("canvas"),k=l("allLoaded"),A=l("api"),P=l("Starmap._isLoading"),L=function(t){function e(t){var n=this;a(this,e);var r=t.state;delete t.state,i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.initialState=r,window.model=this,m.default.bindAll(this,"updateViewer","updateCamera"),this.listenTo(this.get("affiliations"),"change:selected",this.updateViewer),this.listenTo(this.get("routeSizes"),"change:selected",this.updateViewer),this.listenTo(this.get("scanners"),"change:selected",this.updateViewer),this.listenTo(this.get("systemScanners"),"change:selected",this.updateViewer),this.listenTo(this.get("camera"),"change",this.onCameraChange),this.on("change:camera2d",this.updateViewer),this.on("change:loadingLevel",this.onLoadingLevelChange),this.on("start",this.onStart),this[P]=!1,this.canvas=d.default.createDocumentFragment(),this.oldapi=f.starmapMain({rootElement:this.canvas,resourcePath:this.get("resourcePath"),apiBaseURL:this.get("apiBaseURL"),getSessionData:function(){var t=T.default.parse(d.default.cookie),e=window.RSI.SESSION_NAME;return{sessionName:e,sessionId:t[e]}}}),window.oldapi=this.oldapi,this.api=new M.default(this.oldapi),this._api=this.api,["start","destroy","goToLocation","selectLocation","unselectLocation","goThroughJumpPoint","getLocationInfo","getLocationCoordinates","moveSelectedElementAt","getJumpTunnelInfo","routingHide","routingShow","routingGoToSegment","addStickyHoverLocation","removeStickyHoverLocation","landingZoneHighlight","landingZoneClear"].forEach((function(t){return n[t]=n._api[t].bind(n._api)})),this.set("location",this._api.location),this.set("soundFX",new v.default({resourcePath:this.get("resourcePath"),api:this.oldapi})),this.set("interface",new g.default),this[k]=new c((function(t,e){n._resolveLoad=t,n._rejectLoad=e})),this.listenTo(this,"change:loadingOverlayOpacity",this._onLoadingOverlayOpacityChange),this._api.addEventListener("location:change",this._onLocationChange.bind(this))}return r(e,t),o(e,[{key:"load",value:function(){var t=this;if(!this[P]){this[P]=!0;var e=this.api.start(),n=this.get("soundFX").loadMusic();c.all([e,n]).then((function(e){var n=s(e,2);n[0],n[1],t.oldapi.start(),t.get("soundFX").getSoundService().findGroup("main:bgm").findSound("main:background-music").play({fadeIn:1e3}),t.get("soundFX").getSoundService().findGroup("loading:bgm").findSound("loading:background-music:extra").stop({fadeOut:2e3}),t.get("soundFX").getSoundService().findGroup("loading:bgm").findSound("loading:background-music:main").stop({fadeOut:2e3}),t.get("interface").trigger("start"),t.onStart(),t._resolveLoad(t)})).catch((function(e){return t._rejectLoad(e)}))}return this[k]}},{key:"goToParent",value:function(){this.goToParentLocation(this.get("location"))}},{key:"_onLoadingOverlayOpacityChange",value:function(){this._api.loadingOverlayOpacity=this.get("loadingOverlayOpacity")}},{key:"_onLocationChange",value:function(t){this.set({location:t.detail.location,currentAnimation:t.detail.animation})}},{key:"updateViewer",value:function(){var t=this;this.get("affiliations").each((function(e){t.oldapi.factionSelection[e.get("code")]=e.get("selected")}),this),this.get("routeSizes").each((function(e){t.oldapi.routeSelection[e.get("size")]=e.get("selected")}),this),this.get("scanners").each((function(e){t.oldapi.lrScannerSelection[e.get("type")]=e.get("selected")}),this),this.get("routeSizes").each((function(e){t.oldapi.routeSelection[e.get("size")]=e.get("selected")}),this),this.get("systemScanners").each((function(e){t.oldapi.lrScannerHeatmap[e.get("type")]=e.get("selected")}),this),this.oldapi.controls2D=this.get("camera2d"),this.oldapi.setDirty()}},{key:"onStart",value:function(){var t=this,e=this.oldapi.getInfo(),n=e.affiliations,i=e.species,r=n.map((function(t){var e=t.id,n=t.code,i=t.name,r=t.color;return{id:parseInt(e,10),code:n,name:i,color:r}})).filter((function(t){return t.id>=0})),o=i.map((function(t){var e=t.id,n=t.code,i=t.name;return{id:parseInt(e,10),code:n,name:i}})).filter((function(t){return t.id>=0})),a=u(this.oldapi.routeSelection).map((function(e){return{size:e,selected:t.oldapi.routeSelection[e]}})),s=u(this.oldapi.lrScannerSelection).map((function(e){return{type:e,selected:t.oldapi.lrScannerSelection[e]}})),l=u(this.oldapi.lrScannerHeatmap).map((function(e){return{type:e,selected:t.oldapi.lrScannerHeatmap[e]}}));this.set("camera2d",this.api.controls2D),this.get("affiliations").reset(r),this.get("routeSizes").reset(a),this.get("scanners").reset(s),this.get("systemScanners").reset(l),this.get("species").reset(o),this._setInitialState(),this.updateCamera()}},{key:"onCameraChange",value:function(){this.trigger("update_camera",this.get("camera"))}},{key:"updateCamera",value:function(){var t=this.get("camera"),e=this.oldapi.cameraInfo;t.set({pitch:e.pitch,theta:e.tetha,radius:e.radius,panX:e.pan.x,panY:e.pan.y}),requestAnimationFrame(this.updateCamera)}},{key:"toURLParams",value:function(){var t=this,e=["loadingOverlayOpacity","resourcePath"],n=this.pick(this.keys().filter((function(n){var i=t.get(n);return i&&m.default.isFunction(i.toURLParams)&&(i=i.toURLParams()),-1===e.indexOf(n)&&(m.default.isNumber(i)||m.default.isString(i))&&i!==t.defaults[n]})));return m.default.map(n,(function(t,e){return[e,t.toURLParams?t.toURLParams():t].join("=")})).join("&")}},{key:"_setInitialState",value:function(){var t=this;if(this.initialState){var e=this.initialState,n=e.location,i=e.system,r=e.camera;this.initialState=null;var o=c.resolve();if(n){var a=C.default.Types.STAR_SYSTEM;i&&(a=C.default.Types.CELESTIAL_OBJECT,n.indexOf(".JUMPPOINTS.")>-1&&(a=C.default.Types.JUMP_POINT));var s=new C.default(a,i||n,i?n:null);o=this.goToLocation(s)}r&&o.then((function(){var e=S.default.parseURLParams(r),n=t.oldapi.camctrl;n.setPitch(e.pitch),n.setTheta(e.theta),n.setTargetZoom(e.radius),n._controls.targetPan.set(e.panX,e.panY,0)}))}}},{key:"goToParentLocation",value:function(t){return(t.type===C.default.Types.CELESTIAL_OBJECT||t.type===C.default.Types.JUMP_POINT)&&this.get("soundFX").getSoundService().findGroup("main:ambient:object").stop({fadeOut:200}),this._api.goToParentLocation(t)}},{key:"canvas",get:function(){return this[E]},set:function(t){this[E]=t}},{key:"api",get:function(){return this[A]},set:function(t){this[A]=t}},{key:"defaults",get:function(){return{resourcePath:"",apiBaseURL:"",soundFX:void 0,interface:void 0,loadingOverlayOpacity:0,location:null,affiliations:new y.default,routeSizes:new b.default,scanners:new x.default,species:new w.default,systemScanners:new x.default,camera:new S.default,camera2d:!1,currentAnimation:null}}},{key:"allLoaded",get:function(){return this[k]}}]),e}(p.default);e.default=L,L.prototype.updateViewer=m.default.debounce(L.prototype.updateViewer,100),L.prototype.updateCamera=m.default.debounce(L.prototype.updateCamera,100),t.exports=e.default},function(t,e,n){"use strict";var i=n(150).default,r=n(153).default;e.default=function(t,e){if(Array.isArray(t))return t;if(r(Object(t)))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,l=i(t);!(r=(s=l.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},e.__esModule=!0},function(t,e,n){t.exports={default:n(151),__esModule:!0}},function(t,e,n){n(46),n(22),t.exports=n(152)},function(t,e,n){var i=n(56),r=n(62);t.exports=n(30).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e,n){t.exports={default:n(154),__esModule:!0}},function(t,e,n){n(46),n(22),t.exports=n(155)},function(t,e,n){var i=n(54),r=n(43)("iterator"),o=n(40);t.exports=n(30).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(19).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=c(n(136)),h=n(157),d=c(h),f=c(n(166)),p=c(n(76)),m=(c(n(128)),s("api"),s("Rotating")),v=s("Dollying"),g=s("Rotating"),y=s("Dollying"),b=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._loadPreferences(),d.default.supported?this._soundService=new d.default(new h.ResourceService,new AudioContext):(d.default.installWebkitShim(),d.default.supported?this._soundService=new d.default(new h.ResourceService,new AudioContext):this._soundService=new f.default),this.onChangeEnabled(),this.api.addEventListener("soundEvent",this._processEvent.bind(this)),this.api.addEventListener("cameraRotationSoundEvent",this._processEvent.bind(this)),this.api.addEventListener("cameraDollySoundEvent",this._processEvent.bind(this)),this[m]=!1,this[g]=null,this[v]=!1,this[y]=null,this.on("change:enabled",this.onChangeEnabled)}return r(e,t),o(e,[{key:"getSoundService",value:function(){return this._soundService}},{key:"discMenuSelection",value:function(){this._soundService.findGroup("main:sfx").findSound("main:sfx:disc:click").play()}},{key:"toggleButton",value:function(t){t?this._soundService.findGroup("main:sfx").findSound("main:sfx:button:activate").play():this._soundService.findGroup("main:sfx").findSound("main:sfx:button:deactivate").play()}},{key:"openDisc",value:function(){this._soundService.findGroup("main:sfx").findSound("main:sfx:disc:show").play()}},{key:"closeDisc",value:function(){this._soundService.findGroup("main:sfx").findSound("main:sfx:disc:hide").play()}},{key:"hoverObjectIn",value:function(){this._soundService.findGroup("main:sfx").findSound("main:sfx:disc:label").play()}},{key:"hoverObjectOut",value:function(){}},{key:"_processEvent",value:function(t){var e=this,n=this._soundService;if("soundEvent"===t.type)switch(t.name){case"SelectStar":n.findGroup("main:ambient:object").findSound("main:ambient:object:star").play({fadeIn:1e3});break;case"SelectPlanet":n.findGroup("main:ambient:object").findSound("main:ambient:object:planet").play({fadeIn:1e3});break;case"SelectMoon":n.findGroup("main:ambient:object").findSound("main:ambient:object:moon").play({fadeIn:1e3});break;case"SelectBelt":n.findGroup("main:ambient:object").findSound("main:ambient:object:belt").play({fadeIn:1e3});break;case"SelectJumpPoint":n.findGroup("main:ambient:object").findSound("main:ambient:object:jump-point").play({fadeIn:1e3});break;case"SelectSpaceStation":n.findGroup("main:ambient:object").findSound("main:ambient:object:space-station").play({fadeIn:1e3});break;case"SelectNothing":n.findGroup("main:sfx").findSound("main:sfx:select:nothing").play(),n.findGroup("main:ambient:object").stop({fadeOut:200});break;case"EnterStarSystemStart":n.findGroup("main:transitions").findSound("main:transitions:star-system:start").play({}),n.findGroup("main:ambient").findSound("main:ambient:galaxy").stop({fadeOut:1500}),n.findGroup("main:bgm").findSound("main:background-music").fadeTo(.2,2e3);break;case"EnterStarSystemCompleted":n.findGroup("main:transitions").findSound("main:transitions:star-system:end").play();break;case"ShowLongRangeScanner":n.findGroup("main:sfx").findSound("main:sfx:scanner:show").play();break;case"HideLongRangeScanner":n.findGroup("main:sfx").findSound("main:sfx:scanner:hide").play();break;case"ShowHeatmap":n.findGroup("main:sfx").findSound("main:sfx:heatmap:show").play();break;case"HideHeatmap":n.findGroup("main:sfx").findSound("main:sfx:heatmap:hide").play();break;case"UpdateHeatmap":n.findGroup("main:sfx").findSound("main:sfx:heatmap:update").play();break;case"LeaveStarSystemToGalaxyStart":n.findGroup("main:transitions").findSound("main:transitions:star-system-to-galaxy:start").play(),n.findGroup("main:ambient").findSound("main:ambient:star-system").stop({fadeOut:1500}),n.findGroup("main:ambient:object").stop({fadeOut:200}),n.findGroup("main:bgm").findSound("main:background-music").fadeTo(1,2e3);break;case"LeaveStarSystemToGalaxyCompleted":n.findGroup("main:transitions").findSound("main:transitions:star-system-to-galaxy:end").play();break;case"EnterJumpPointStart":n.findGroup("main:transitions").findSound("main:transitions:jump-point:start").play(),n.findGroup("main:ambient:object").findSound("main:ambient:object:jump-point").stop({fadeOut:200});break;case"EnterJumpPointCompleted":n.findGroup("main:transitions").findSound("main:transitions:jump-point:end").play();break;case"ShowOrbitals":n.findGroup("main:sfx").findSound("main:sfx:orbitals:show").play();break;case"StartGalaxyAmbiance":n.findGroup("main:ambient").findSound("main:ambient:galaxy").play({fadeIn:1500});break;case"StartStarSystemAmbiance":n.findGroup("main:ambient").findSound("main:ambient:star-system").play({fadeIn:1500});break;case"HoverSystemIn":n.findGroup("main:sfx").findSound("main:sfx:star-system:hover:in").play();break;case"HoverSystemOut":n.findGroup("main:sfx").findSound("main:sfx:star-system:hover:out").play();break;case"HoverBodyIn":n.findGroup("main:sfx").findSound("main:sfx:object:hover:in").play();break;case"HoverBodyOut":n.findGroup("main:sfx").findSound("main:sfx:object:hover:out").play();break;case"HoverJumpPointIn":n.findGroup("main:sfx").findSound("main:sfx:jump-point:hover:in").play();break;case"HoverJumpPointOut":n.findGroup("main:sfx").findSound("main:sfx:jump-point:hover:out").play()}"cameraRotationSoundEvent"===t.type&&(this[m]?(clearTimeout(this[g]),this[g]=setTimeout((function(){n.findGroup("main:camera-sfx").findSound("main:camera:move").stop(),e[m]=!1}),500)):(this[m]=!0,n.findGroup("main:camera-sfx").findSound("main:camera:move").play(),this[g]=setTimeout((function(){n.findGroup("main:camera-sfx").findSound("main:camera:move").stop(),e[m]=!1}),500))),"cameraDollySoundEvent"===t.type&&(this[v]?(clearTimeout(this[y]),this[y]=setTimeout((function(){n.findGroup("main:camera-sfx").findSound("main:camera:dolly").stop(),e[v]=!1}),250)):(this[v]=!0,n.findGroup("main:camera-sfx").findSound("main:camera:dolly").play(),this[y]=setTimeout((function(){n.findGroup("main:camera-sfx").findSound("main:camera:dolly").stop(),e[v]=!1}),250)))}},{key:"loadMusic",value:function(){var t=this.get("resourcePath")+"/sounds",e=this._soundService,n="StarMapOdyssaeRemix1";return n+=d.default.formatSupported("ogg")?".ogg":d.default.formatSupported("mp3")?".mp3":".wav",l.all([e.load("main:background-music",t+"/"+n,"main:bgm",{loop:!0}),e.load("main:camera:move",t+"/CAM_FastMove_LOOP.wav","main:camera-sfx",{loop:!0}),e.load("main:camera:dolly",t+"/CAM_Dolly_LOOP.wav","main:camera-sfx",{loop:!0}),e.load("main:ambient:object:belt",t+"/SE_SelectBelt_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:object:jump-point",t+"/SE_SelectJumpPoint_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:object:moon",t+"/SE_SelectMoon_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:object:planet",t+"/SE_SelectPlanet_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:object:space-station",t+"/SE_SelectSpaceStation_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:object:star",t+"/SE_SelectStar_LOOP.wav","main:ambient:object",{loop:!0}),e.load("main:ambient:galaxy",t+"/SE_StartGalaxyAmbiance_LOOP.wav","main:ambient",{loop:!0}),e.load("main:ambient:star-system",t+"/SE_StartStarSystemAmbiance_LOOP.wav","main:ambient",{loop:!0}),e.load("main:sfx:select:nothing",t+"/SE_SelectNothing.wav","main:sfx"),e.load("main:sfx:heatmap:show",t+"/SE_ShowHeatmap.wav","main:sfx"),e.load("main:sfx:heatmap:hide",t+"/SE_HideHeatmap.wav","main:sfx"),e.load("main:sfx:heatmap:update",t+"/SE_UpdateHeatmap.wav","main:sfx"),e.load("main:sfx:scanner:show",t+"/SE_ShowLongRangeScanner.wav","main:sfx"),e.load("main:sfx:scanner:hide",t+"/SE_HideLongRangeScanner.wav","main:sfx"),e.load("main:sfx:route:search",t+"/UI_BB_RoutingSearchForRoute.wav","main:sfx"),e.load("main:sfx:route:found",t+"/UI_BB_RoutingRouteFound.wav","main:sfx"),e.load("main:sfx:button:activate",t+"/UI_BB_ToggleButtonActivate.wav","main:sfx"),e.load("main:sfx:button:deactivate",t+"/UI_BB_ToggleButtonDeactivate.wav","main:sfx"),e.load("main:sfx:orbitals:show",t+"/SE_ShowOrbitals.wav","main:sfx"),e.load("main:sfx:disc:show",t+"/UI_DiscOpen.wav","main:sfx"),e.load("main:sfx:disc:hide",t+"/UI_DiscClose.wav","main:sfx"),e.load("main:sfx:disc:activate",t+"/UI_DiscToggleActivate.wav","main:sfx"),e.load("main:sfx:disc:deactivate",t+"/UI_DiscToggleDeactivate.wav","main:sfx"),e.load("main:sfx:disc:click",t+"/UI_DiscClick.wav","main:sfx"),e.load("main:sfx:disc:label",t+"/SE_ControlDisk_Label.wav","main:sfx"),e.load("main:sfx:star-system:hover:in",t+"/SE_HoverSystemIn.wav","main:sfx"),e.load("main:sfx:star-system:hover:out",t+"/SE_HoverSystemOut.wav","main:sfx"),e.load("main:sfx:object:hover:in",t+"/SE_HoverBodyIn.wav","main:sfx"),e.load("main:sfx:object:hover:out",t+"/SE_HoverBodyOut.wav","main:sfx"),e.load("main:sfx:jump-point:hover:in",t+"/SE_HoverJumpPointIn.wav","main:sfx"),e.load("main:sfx:jump-point:hover:out",t+"/SE_HoverJumpPointOut.wav","main:sfx"),e.load("main:transitions:jump-point:start",t+"/SE_EnterJumpPointStart.wav","main:transitions"),e.load("main:transitions:jump-point:end",t+"/SE_EnterJumpPointCompleted.wav","main:transitions"),e.load("main:transitions:star-system:start",t+"/SE_EnterStarSystemStart.wav","main:transitions"),e.load("main:transitions:star-system:end",t+"/SE_EnterStarSystemCompleted.wav","main:transitions"),e.load("main:transitions:star-system-to-galaxy:start",t+"/SE_LeaveStarSystemToGalaxyStart.wav","main:transitions"),e.load("main:transitions:star-system-to-galaxy:end",t+"/SE_LeaveStarSystemToGalaxyCompleted.wav","main:transitions")]).then((function(t){e.findGroup("main:ambient").setAllowSimultaneous(!1).setFadeOut(1500),e.findGroup("main:ambient:object").setAllowSimultaneous(!1).setFadeOut(200)}))}},{key:"onChangeEnabled",value:function(){this._soundService.setMasterVolume(this.get("enabled")?1:0),this.savePreferences()}},{key:"_loadPreferences",value:function(){var t=localStorage.sm_sound_fx;if(t){try{t=JSON.parse(t)}catch(t){return void(localStorage.sm_sound_fx=null)}this.set(p.default.pick(t,"enabled"))}}},{key:"savePreferences",value:function(){localStorage.sm_sound_fx=JSON.stringify(p.default.pick(this.toJSON(),"enabled"))}},{key:"defaults",get:function(){return{api:void 0,resourcePath:void 0,enabled:!0,volume:1}}},{key:"api",get:function(){return this.get("api")},set:function(t){this.set("api",t)}}]),e}(u.default);e.default=b,t.exports=e.default},function(t,e,n){(function(t){"use strict";var i=n(93).default,r=n(96).default,o=n(82).default,a=n(87).default,s=n(19).default,l=n(159).default;Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(e,n){r(this,t),this._uri=e,this._buffer=n}return i(t,[{key:"getUri",value:function(){return this._uri}},{key:"getBuffer",value:function(){return this._buffer}}]),t}(),u=function(t){function e(t){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return a(e,t),e}(Error),h=function(){function e(){r(this,e),this._resourceCache=new l}return i(e,[{key:"load",value:function(e,n){var i=this;return this._resourceCache.has(e)?s.resolve(this._resourceCache.get(e)):t(n,{mode:"cors"}).then((function(t){return t.arrayBuffer()})).then((function(t){var n=new c(e,t);return i._resourceCache.set(e,n),n}))}},{key:"free",value:function(t){if(!this._resourceCache.has(t))throw new u("A resource with uri "+t+" was not found");this._resourceCache.delete(t)}},{key:"freeAll",value:function(){this._resourceCache.clear()}}]),e}();e.ResourceService=h;var d=function(t){function e(t){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return a(e,t),e}(Error),f=function(t){function e(t){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return a(e,t),e}(Error),p=function(t){function e(t){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return a(e,t),e}(Error),m=function(){function t(e,n,i,o){r(this,t),this._audioContext=e,this._gain=n,this._source=i,this._isPlaying=!1,this._uri=o}return i(t,[{key:"play",value:function(t){var e=t.fadeIn,n=void 0===e?0:e;0===n?this._source.start(0):(this._gain.gain.setValueAtTime(0,this._audioContext.currentTime),this._gain.gain.linearRampToValueAtTime(1,this._audioContext.currentTime+n/1e3),this._source.start(this._audioContext.currentTime)),this._isPlaying=!0}},{key:"stop",value:function(t){var e=t.fadeOut,n=void 0===e?0:e;this._isPlaying&&(0===n?this._source.stop(this._audioContext.currentTime):(this._gain.gain.setValueAtTime(this._gain.gain.value,this._audioContext.currentTime),this._gain.gain.linearRampToValueAtTime(0,this._audioContext.currentTime+n/1e3),this._source.stop(this._audioContext.currentTime+n/1e3)))}},{key:"disconnect",value:function(){this._gain.disconnect(),this._source.disconnect(),this._isPlaying=!1}},{key:"isPlaying",value:function(){return this._isPlaying}}]),t}(),v=function(){function t(e,n,i,o,a){r(this,t),this._uri=e,this._audioBuffer=n,this._audioContext=i,this._parentNode=o,this._loop=a,this._instances=[],this._subscriptions=new l}return i(t,[{key:"getUri",value:function(){return this._uri}},{key:"play",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this._loop&&this._instances.length>0)return this;var n=this._audioContext.createGain(),i=this._audioContext.createBufferSource();i.buffer=this._audioBuffer,i.loop=this._loop,n.connect(this._parentNode),i.connect(n);var r=new m(this._audioContext,n,i,this._uri);return this._instances=this._instances.concat([r]),i.addEventListener("ended",(function(e){r.disconnect(),t._instances=t._instances.filter((function(t){return t!==r})),t._dispatchEvent("stopped")})),r.play(e),this._dispatchEvent("started"),this}},{key:"stop",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this._instances.forEach((function(e){e.stop(t)}))}},{key:"fadeTo",value:function(t,e){var n=this;this._instances.forEach((function(i){i.isPlaying()&&(i._gain.gain.setValueAtTime(i._gain.gain.value,n._audioContext.currentTime),i._gain.gain.linearRampToValueAtTime(t,n._audioContext.currentTime+e/1e3))}))}},{key:"addEventListener",value:function(t,e){this._subscriptions.has(t)||this._subscriptions.set(t,[]);var n=this._subscriptions.get(t);this._subscriptions.set(t,n.concat([e]))}},{key:"removeEventListener",value:function(t,e){this._subscriptions.has(t)&&(this._subscriptions.get(t),this._subscriptions.set(t,currentSubscription.filter((function(t){return t!==e}))))}},{key:"getNumberOfInstances",value:function(){return this._instances.length}},{key:"_dispatchEvent",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this._subscriptions.has(t)&&this._subscriptions.get(t).forEach((function(i){return i({type:t,data:n,target:e})}))}}]),t}(),g=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]||arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2];r(this,t),this._name=e,this._allowSimultaneous=n,this._fadeOut=i,this._sounds=new l}return i(t,[{key:"getName",value:function(){return this._name}},{key:"getAllowSimultaneous",value:function(){return this._allowSimultaneous}},{key:"setAllowSimultaneous",value:function(t){return this._allowSimultaneous=t,this}},{key:"getFadeOut",value:function(){return this._fadeOut}},{key:"setFadeOut",value:function(t){return this._fadeOut=t,this}},{key:"add",value:function(t){var e=this,n=t.getUri();if(this._sounds.has(n))throw new d("A sound with the URI "+n+" already exist");t.addEventListener("started",(function(){e._allowSimultaneous||e._sounds.forEach((function(n,i){n.getUri()!==t.getUri()&&n.stop({fadeOut:e._fadeOut})}))})),this._sounds.set(n,t)}},{key:"stop",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this._sounds.forEach((function(e,n){return e.stop(t)}))}},{key:"findSound",value:function(t){if(!this._sounds.has(t))throw new f("A sound with the URI "+t+" does not exist in group "+this._name);return this._sounds.get(t)}}]),t}(),y="DEFAULT_GROUP",b=function(){function t(e,n){r(this,t),this._resourceService=e,this._audioContext=n,this._masterGain=this._audioContext.createGain(),this._masterGain.connect(this._audioContext.destination),this._groups=new l([[y,new g(y)]]),this._volume=1}return i(t,[{key:"getMasterVolume",value:function(){return this._masterGain.gain.value}},{key:"setMasterVolume",value:function(t){this._volume=t,this._masterGain.gain.value=t}},{key:"load",value:function(t,e){var n=this,i=arguments.length<=2||void 0===arguments[2]?y:arguments[2],r=(arguments.length<=3||void 0===arguments[3]?{}:arguments[3]).loop,o=void 0!==r&&r;return this._resourceService.load(t,e).then((function(t){return function(t,e){return new s((function(n,i){return t.decodeAudioData(e,n,i)}))}(n._audioContext,t.getBuffer())})).then((function(e){n._groups.has(i)||n._groups.set(i,new g(i));var r=new v(t,e,n._audioContext,n._masterGain,o);return n._groups.get(i).add(r),r}))}},{key:"findGroup",value:function(t){if(!this._groups.has(t))throw new p("A sound group named "+t+" does not exist");return this._groups.get(t)}}],[{key:"installWebkitShim",value:function(){window.AudioContext=window.webkitAudioContext}},{key:"formatSupported",value:function(t){var e={mp3:"audio/mpeg",ogg:"audio/ogg"}[t];if(!e)return!1;var n=document.createElement("audio");return!!n.canPlayType&&"no"!==n.canPlayType(e)&&""!==n.canPlayType(e)}},{key:"supported",get:function(){return"AudioContext"in window&&window.AudioContext}}]),t}();e.default=b}).call(e,n(158))},function(t,e){(function(){!function(){"use strict";function t(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function e(t){return"string"!=typeof t&&(t=t.toString()),t}function n(t){this.map={},t instanceof n?t.forEach((function(t,e){this.append(e,t)}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function i(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function r(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function o(t){var e=new FileReader;return e.readAsArrayBuffer(t),r(e)}function a(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(h.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(h.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},h.blob?(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(o)},this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader;return e.readAsText(t),r(e)}(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=i(this);return t||Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function s(t,e){if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new n(e.headers),this.method=function(t){var e=t.toUpperCase();return d.indexOf(e)>-1?e:t}(e.method||"GET"),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function l(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}})),e}function c(t){var e=new n;return t.getAllResponseHeaders().trim().split("\n").forEach((function(t){var n=t.trim().split(":"),i=n.shift().trim(),r=n.join(":").trim();e.append(i,r)})),e}function u(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof n?e.headers:new n(e.headers),this.url=e.url||""}if(!self.fetch){n.prototype.append=function(n,i){n=t(n),i=e(i);var r=this.map[n];r||(r=[],this.map[n]=r),r.push(i)},n.prototype.delete=function(e){delete this.map[t(e)]},n.prototype.get=function(e){var n=this.map[t(e)];return n?n[0]:null},n.prototype.getAll=function(e){return this.map[t(e)]||[]},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(n,i){this.map[t(n)]=[e(i)]},n.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach((function(n){this.map[n].forEach((function(i){t.call(e,i,n,this)}),this)}),this)};var h={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self},d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];a.call(s.prototype),a.call(u.prototype),self.Headers=n,self.Request=s,self.Response=u,self.fetch=function(t,e){var n;return n=s.prototype.isPrototypeOf(t)&&!e?t:new s(t,e),new Promise((function(t,e){var i=new XMLHttpRequest;i.onload=function(){var n=1223===i.status?204:i.status;if(100>n||n>599)e(new TypeError("Network request failed"));else{var r={status:n,statusText:i.statusText,headers:c(i),url:"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0},o="response"in i?i.response:i.responseText;t(new u(o,r))}},i.onerror=function(){e(new TypeError("Network request failed"))},i.open(n.method,n.url,!0),"include"===n.credentials&&(i.withCredentials=!0),"responseType"in i&&h.blob&&(i.responseType="blob"),n.headers.forEach((function(t,e){i.setRequestHeader(e,t)})),i.send(void 0===n._bodyInit?null:n._bodyInit)}))},self.fetch.polyfill=!0}}(),t.exports=window.fetch}).call(window)},function(t,e,n){t.exports={default:n(160),__esModule:!0}},function(t,e,n){n(21),n(22),n(46),n(161),n(164),t.exports=n(30).Map},[477,162,163],[478,35,34,71,31,57,25,58,26,49,45,39,55,72,37],function(t,e,n){"use strict";var i=n(35),r=n(29),o=n(28),a=n(38),s=n(34),l=n(71),c=n(58),u=n(57),h=n(55),d=n(42),f=n(37);t.exports=function(t,e,n,p,m,v){var g=r[t],y=g,b=m?"set":"add",x=y&&y.prototype,w={};return f&&"function"==typeof y&&(v||x.forEach&&!a((function(){(new y).entries().next()})))?(y=e((function(e,n){u(e,y,t),e._c=new g,null!=n&&c(n,m,e[b],e)})),i.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),(function(t){var e="add"==t||"set"==t;t in x&&(!v||"clear"!=t)&&s(y.prototype,t,(function(n,i){if(!e&&v&&!h(n))return"get"==t&&void 0;var r=this._c[t](0===n?0:n,i);return e?this:r}))})),"size"in x&&i.setDesc(y.prototype,"size",{get:function(){return this._c.size}})):(y=p.getConstructor(e,t,m,b),l(y.prototype,n)),d(y,t),w[t]=y,o(o.G+o.W+o.F,w),v||p.setStrong(y,t,m),y}},[479,28,165],[480,58,54],function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(19).default;Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(){r(this,t)}return i(t,[{key:"getUri",value:function(){return""+Date.now()}},{key:"play",value:function(){return this}},{key:"stop",value:function(){}},{key:"fadeTo",value:function(){}},{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"getNumberOfInstances",value:function(){return 0}}]),t}(),s=function(){function t(){r(this,t)}return i(t,[{key:"getName",value:function(){return""+Date.now()}},{key:"getAllowSimultaneous",value:function(){return!1}},{key:"setAllowSimultaneous",value:function(){return this}},{key:"getFadeOut",value:function(){return 0}},{key:"setFadeOut",value:function(){return this}},{key:"add",value:function(){}},{key:"stop",value:function(){}},{key:"findSound",value:function(t){return new a}}]),t}(),l=function(){function t(){r(this,t)}return i(t,[{key:"getMasterVolume",value:function(){return 1}},{key:"setMasterVolume",value:function(t){}},{key:"load",value:function(){return o.resolve(new a)}},{key:"findGroup",value:function(){return new s}}],[{key:"installWebkitShim",value:function(){}},{key:"formatSupported",value:function(){return!1}},{key:"supported",get:function(){return!0}}]),t}();e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(136)),c=s(n(168)),u=s(n(171)),h=s(n(173)),d=s(n(143)),f=s(n(174)),p=s(n(176)),m={search:"search",bookmarks:"bookmarks",routes:"routes",display:"display"},v=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.on("start",this.onStart),this.listenTo(this.get("bookmarks").fullCollection,"update",this.filterBookmarks),this.listenTo(this.get("bookmarkFilters"),"change",this.filterBookmarks),this.listenTo(this.get("searchFilters"),"change",this.searchObjects),this.listenTo(this.get("routingFilters"),"search",this.searchRoutes)}return r(e,t),o(e,[{key:"onStart",value:function(){var t=this;this.get("bookmarks").loadAll().then((function(){return t.filterBookmarks()}))}},{key:"filterBookmarks",value:function(){var t=this.get("bookmarkFilters").get("types").where({selected:!0}),e=(this.get("bookmarkFilters").get("query")||"").toLowerCase(),n=this.get("bookmarks");n.reset(n.fullCollection.filter((function(n){return(!e||n.get("name").toLowerCase().indexOf(e)>-1)&&t.indexOf(n.get("type"))>-1})))}},{key:"searchObjects",value:function(){var t=this.get("searchFilters"),e=this.get("searchResults");return t.hasQuery?e.fetch({data:t.toJSON()}):(e.reset(),!1)}},{key:"searchRoutes",value:function(){var t=this.get("routingFilters"),e=this.get("routingResults");return t.hasQuery?e.fetch({data:t.toJSON()}):(e.reset(),!1)}},{key:"defaults",get:function(){return{tab:m.display,fullscreen:!1,bookmarkFilters:new c.default,bookmarks:u.default.createWithFull(),searchFilters:new h.default,searchResults:new d.default,routingFilters:new f.default,routingResults:new p.default}}}],[{key:"TABS",get:function(){return m}}]),e}(l.default);e.default=v,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(136)),c=s(n(169)),u=function(t){function e(){a(this,e);for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.listenTo(this.get("types"),"change",this.onTypeChange)}return r(e,t),o(e,[{key:"onTypeChange",value:function(){this.trigger("change")}},{key:"defaults",get:function(){return{types:c.default.getWhere({avoid:!1,custom:!1}),query:""}}},{key:"hasQuery",get:function(){return!!this.get("query")}},{key:"allTypesSelected",get:function(){return this.get("types").where({selected:!0}).length===this.get("types").length}},{key:"isFilled",get:function(){return this.hasQuery||!this.allTypesSelected}}]),e}(l.default);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(136)),u=l(n(170)),h=l(n(142)),d=l(n(76)),f=s("cache"),p=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"idAttribute",get:function(){return"key"}},{key:"defaults",get:function(){return{key:null,name:null,custom:null,avoid:null,bodyType:null,selected:!0}}}],[{key:"getWhere",value:function(t){var n=e.all;return t?new u.default(n.where(t)):n.clone()}},{key:"getForObject",value:function(t){var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return e.all.findWhere({bodyType:t.get("type"),avoid:n})}},{key:"all",get:function(){return this[f]=this[f]||new u.default(d.default.chain(e.RAW_TYPES).pairs().map((function(t){return{key:t[0],name:(h.default.TYPE_INFO[t[1]]||{}).name||t[1],custom:t[0]===e.CUSTOM_TYPE,avoid:0===t[0].indexOf("A"),bodyType:t[1]}})).value())}},{key:"RAW_TYPES",get:function(){return{BS:"STAR_SYSTEM",BO:"BODY",BC:"Custom",AS:"STAR_SYSTEM",AO:"BODY"}}},{key:"CUSTOM_TYPE",get:function(){return"BC"}}]),e}(c.default);e.default=p,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(169)),u=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"model",get:function(){return c.default}}]),e}(l.Collection);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(144)),u=l(n(172)),h=l(n(169)),d=(l(n(116)),s("fullCollection")),f=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"findByObject",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!t)return null;var n=this.fullCollection.find((function(n){return(n.get("celestialObject")===t||n.get("code")===t.get("code"))&&n.get("type").get("avoid")===e}));return n&&n.set("celestialObject",t),n}},{key:"toggle",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=this.findByObject(t,e);return n?n.destroy({wait:!0}):this.fullCollection.create({celestialObject:t,type:h.default.getForObject(t,e),code:t.get("code"),name:t.get("name"),parentCode:t.get("system")?t.get("system").get("code"):null},{wait:!0})}},{key:"loadAll",value:function(){return this.fullCollection.fetch()}},{key:"model",get:function(){return u.default}},{key:"url",get:function(){return"/api/starmap/bookmarks/find"}},{key:"fullCollection",get:function(){return this[d]},set:function(t){this[d]=t}}],[{key:"createWithFull",value:function(){var t=new e;return t.fullCollection=new e,t}}]),e}(c.default);e.default=f,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(145)),c=s(n(169)),u=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"isNew",value:function(){return!1}},{key:"getUrl",value:function(t,e){var n=this.get("type").get("avoid")?"Avoid":"Bookmark";return"/api/starmap/bookmarks/"+this.get("code")+"/toggle"+n}},{key:"parse",value:function(t){var n=i(Object.getPrototypeOf(e.prototype),"parse",this).call(this,t);return n?(n.code=n.object_code||n.system_code||void 0,n.object_code&&(n.parentCode=n.system_code),delete n.object_code,delete n.system_code,n.type=c.default.all.get(n.type),n):n}},{key:"toServerObject",value:function(){return{}}},{key:"defaults",get:function(){return{id:void 0,type:void 0,name:void 0,code:void 0,parentCode:void 0,celestialObject:null}}}]),e}(l.default);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"defaults",get:function(){return{query:""}}},{key:"hasQuery",get:function(){return!!this.get("query")}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(136)),c=s(n(175)),u=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"search",value:function(){this.trigger("search")}},{key:"toJSON",value:function(){return{departure:this.get("departure").getCode(),destination:this.get("destination").getCode(),ship_size:this.get("shipSize")}}},{key:"defaults",get:function(){return{departure:new c.default,destination:new c.default,shipSize:void 0}}},{key:"hasQuery",get:function(){return this.get("departure").hasSelection&&this.get("destination").hasSelection&&!!e.SHIP_SIZES[this.get("shipSize")]}}],[{key:"SHIP_SIZES",get:function(){return{S:"Small",M:"Medium",L:"Large"}}}]),e}(l.default);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(136)),c=s(n(143)),u=function(t){function e(){a(this,e);for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.on("change:query",this.onChangeQuery)}return r(e,t),o(e,[{key:"onChangeQuery",value:function(){this.set("object",null),this.get("results").fetch({data:{query:this.get("query")}})}},{key:"getCode",value:function(){return this.get("object")&&this.get("object").get("code")}},{key:"defaults",get:function(){return{query:"",object:null,results:new c.default}}},{key:"hasSelection",get:function(){return!!this.get("object")}}]),e}(l.default);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(144)),c=s(n(177)),u=s(n(76)),h=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"parse",value:function(t){if(!t||!t.success||!t.data||!t.data.shortest&&!t.data.leastjumps)return[];var e=t.data,n=(e.shortest,e.leastjumps,u.default.chain(e).values().compact().map((function(t){return t.currentSegment=0,t.segmentCount=t.segments.length,t})).value());return n}},{key:"model",get:function(){return c.default}},{key:"url",get:function(){return"/api/starmap/routes/find"}}]),e}(l.default);e.default=h,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"goToSegment",value:function(t){var e=this.flightSegments;if(!e||!e.length)return!1;var n=e[t];return n&&this.set("selectedSegment",n),!!n}},{key:"changeSegment",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this.flightSegments;if(!e||!e.length)return!1;var n=t?-1:1,i=e.indexOf(this.get("selectedSegment"))+n;return this.goToSegment(i)}},{key:"previousSegment",value:function(){return this.changeSegment(!0)}},{key:"nextSegment",value:function(){return this.changeSegment(!1)}},{key:"clearSelection",value:function(){this.set({selected:!1,selectedSegment:null})}},{key:"defaults",get:function(){return{name:null,label:null,first_jump:null,flight_distance:null,jumps:null,segments:null,flightSegments:null,selectedSegment:null,selected:!1}}},{key:"flightSegments",get:function(){var t=this.get("flightSegments");t||(t=(this.get("segments")||[]).filter((function(t){return t.segment_type===e.SEGMENT_TYPES.FLIGHT&&t.segment_distance})),this.set("flightSegments",t));return t}}],[{key:"SEGMENT_TYPES",get:function(){return{JUMP:"J",FLIGHT:"F"}}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(179)),u=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"model",get:function(){return c.default}}]),e}(l.Collection);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"defaults",get:function(){return{id:null,name:"Unknown",code:"UNKNOWN",color:"#FFFFFF",selected:!0}}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(181)),u=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"model",get:function(){return c.default}}]),e}(l.Collection);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"idAttribute",get:function(){return"size"}},{key:"defaults",get:function(){return{size:void 0,selected:!1}}}],[{key:"SIZES",get:function(){return{SMALL:"small",MEDIUM:"medium",LARGE:"large"}}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(183)),u=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"model",get:function(){return c.default}}]),e}(l.Collection);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"idAttribute",get:function(){return"type"}},{key:"defaults",get:function(){return{type:void 0,selected:!1}}}],[{key:"TYPES",get:function(){return{LIFEFORMS:"lifeforms",ECONOMY:"economy",CRIME:"crime"}}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(75),c=s(n(185)),u=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"model",get:function(){return c.default}}]),e}(l.Collection);e.default=u,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"defaults",get:function(){return{code:"Unknown"}}}]),e}(s(n(136)).default);e.default=l,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(136)),c=s(n(76)),u={pitch:2,theta:2,radius:4,panX:7,panY:7},h=["pitch","theta","radius","panX","panY"],d=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"toURLParams",value:function(){var t=this,e=h.map((function(e){var n=Math.pow(10,u[e]);return Math.round(t.get(e)*n)/n}));return 0===c.default.compact(e).length?"":e.join(",")}},{key:"defaults",get:function(){return{pitch:0,theta:0,radius:0,panX:0,panY:0}}}],[{key:"parseURLParams",value:function(t){var e=t.split(","),n=c.default.object(c.default.compact(h.map((function(t,n){var i=parseFloat(e[n]);return c.default.isNaN(i)?null:[t,i]}))));return n}}]),e}(l.default);e.default=d,t.exports=e.default},function(t,e){
/*!
         * cookie
         * Copyright(c) 2012-2014 Roman Shtylman
         * Copyright(c) 2015 Douglas Christopher Wilson
         * MIT Licensed
         */
"use strict";function n(t,e){try{return e(t)}catch(e){return t}}e.parse=function(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");for(var r={},a=e||{},s=t.split(o),l=a.decode||i,c=0;c<s.length;c++){var u=s[c],h=u.indexOf("=");if(!(0>h)){var d=u.substr(0,h).trim(),f=u.substr(++h,u.length).trim();'"'==f[0]&&(f=f.slice(1,-1)),null==r[d]&&(r[d]=n(f,l))}}return r},e.serialize=function(t,e,n){var i=n||{},o=i.encode||r;if(!a.test(t))throw new TypeError("argument name is invalid");var s=o(e);if(s&&!a.test(s))throw new TypeError("argument val is invalid");var l=t+"="+s;if(null!=i.maxAge){var c=i.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");l+="; Max-Age="+Math.floor(c)}if(i.domain){if(!a.test(i.domain))throw new TypeError("option domain is invalid");l+="; Domain="+i.domain}if(i.path){if(!a.test(i.path))throw new TypeError("option path is invalid");l+="; Path="+i.path}return i.expires&&(l+="; Expires="+i.expires.toUTCString()),i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.firstPartyOnly&&(l+="; First-Party-Only"),l};var i=decodeURIComponent,r=encodeURIComponent,o=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(19).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=n(75),d=c(n(105)),f=n(189),p=c(n(76)),m=c(n(113)),v=c(n(116)),g=c(n(194)),y=c(n(393)),b=c(n(142)),x=c(n(396)),w={SINGLE_STAR:"Single star",BINARY:"Binary"},_={B:"Bidirectional",U:"Unidirectional"},S={S:"Small",M:"Medium",L:"Large"},M=s("events"),C=s("modelEvents"),T=s("regions"),E=n(398),k=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._disc=new g.default(this.model.get("resourcePath")),this._locationMarker=new y.default,this._locationMarker.title="Control Disc",this._locationMarker.position={x:200,y:400},window._lc=this._locationMarker,this._trackingDisc=!1,this._trackingMarker=!1,this._hoveredObject=null,this.layout=t.layout,this._disc.addEventListener("select",this._onDiscSelect.bind(this)),this._disc.addEventListener("show",this._onDiscShow.bind(this)),this._disc.addEventListener("shown",this._onDiscShown.bind(this)),this._disc.addEventListener("hide",this._onDiscHide.bind(this)),this._disc.addEventListener("hidden",this._onDiscHidden.bind(this)),this.model.api.addEventListener("select:starsystem",this._onSelectStarSystem.bind(this)),this.model.api.addEventListener("select:celestialobject",this._onSelectCelestialObject.bind(this)),this.model.api.addEventListener("select:jumppoint",this._onSelectJumpPoint.bind(this)),this.model.api.addEventListener("select:none",this._onSelectNone.bind(this)),this._longRangeScanner=this.model.api.longRangeScanner;var n=this._hoverObjectIn.bind(this),r=this._hoverObjectOut.bind(this);this.model.api.addEventListener("mouseenter:starsystem",n),this.model.api.addEventListener("mouseleave:starsystem",r),this.model.api.addEventListener("mouseenter:celestialobject",n),this.model.api.addEventListener("mouseleave:celestialobject",r),this.model.api.addEventListener("mouseenter:jumppoint",n),this.model.api.addEventListener("mouseleave:jumppoint",r),this._locationMarker.addEventListener("marker:click",this._onMarkerClick.bind(this),!1),this._locationMarker.addEventListener("marker:mouseenter",this._onMarkerMouseEnter.bind(this),!1),this._locationMarker.addEventListener("marker:mouseleave",this._onMarkerMouseLeave.bind(this),!1),this._jumpPointAnimation=l.resolve(),this._hoveringMarker=!1,this._hoverAnimationQueue=l.resolve(),this.model.on("change:location",this._onLocationChange.bind(this))}return r(e,t),o(e,[{key:"onInteraction",value:function(t){this.layout.interactiveUI="mousedown"!==t.type}},{key:"onAttach",value:function(){this.$el.find("#sm-map-map-region").append(this.model.canvas),this.$el.find("#sm-map-disc-region").append(this._disc.element),this.$el.find("#sm-map-location-marker-region").append(this._locationMarker.element),this.$el.find("#sm-map-disc-region").on("mousedown click",(function(t){t.stopPropagation()}))}},{key:"updateQueryString",value:function(){var t=d.default.getFragment({options:{removeQueryString:!0}}),e=this.model.toURLParams();e&&(e="?"+e),h.history.navigate(t+e,{replace:!0})}},{key:"_onDiscSelect",value:function(t){if(t.detail.type===g.default.Commands.INSPECT){var e=this.model.api.selectedLocation,n=this.model.get("location");e&&(n.type!==v.default.Types.JUMP_POINT?this.model.goToLocation(e):this.model.goThroughJumpPoint(e))}else if(t.detail.type===g.default.Commands.BOOKMARK)t.preventDefault(),this._addRemoveBookmark();else if(t.detail.type===g.default.Commands.INFORMATION)if(t.preventDefault(),this.info.currentView)this._closeInfo();else{this.info.show(new x.default({model:this.model})),this._moveDiscToSuitablePosition(500)}else t.detail.type===g.default.Commands.AVOID?(t.preventDefault(),this._addRemoveAvoidance()):t.detail.type===g.default.Commands.DEPARTURE?this._addDeparture():t.detail.type===g.default.Commands.DESTINATION&&this._addDestination();this.model.get("soundFX").discMenuSelection()}},{key:"_addRemoveBookmark",value:function(){var t=this.model.get("interface").get("bookmarks"),e=this.model.api.selectedLocation;if(e){var n=b.default.fromLocation(this.model,e);t.toggle(n),this._disc.bookmarked=!this._disc.bookmarked}}},{key:"_addRemoveAvoidance",value:function(){var t=this.model.get("interface").get("bookmarks"),e=this.model.api.selectedLocation;if(e){var n=b.default.fromLocation(this.model,e);t.toggle(n,!0),this._disc.avoided=!this._disc.avoided}}},{key:"_addDeparture",value:function(){var t=this.model.api.selectedLocation;if(t){this.model.get("interface").set("tab","routes");var e=b.default.fromLocation(this.model,t);this.model.get("interface").get("routingFilters").get("departure").set("object",e)}}},{key:"_addDestination",value:function(){var t=this.model.api.selectedLocation;if(t){this.model.get("interface").set("tab","routes");var e=b.default.fromLocation(this.model,t);this.model.get("interface").get("routingFilters").get("destination").set("object",e)}}},{key:"_onDiscShow",value:function(t){this.model.get("soundFX").openDisc();var e=this.model.get("interface").get("bookmarks"),n=this.model.api.selectedLocation;if(n){var i=b.default.fromLocation(this.model,n),r=e.findByObject(i);this._disc.bookmarked=!!r;var o=e.findByObject(i,!0);this._disc.avoided=!!o}this.model.removeStickyHoverLocation(n),this._hoveredObject=null,this._trackingMarker=!1,this._locationMarker.hidden=!0,this._initialHoverCancelable&&(this._initialHoverCancelable.cancel(),this._initialHoverCancelable=null),this._disc.inspectingJumpPoint=this.model.get("location").type===v.default.Types.JUMP_POINT,this._disc.inspectingDisabled=this.model.get("location").type===v.default.Types.CELESTIAL_OBJECT}},{key:"_onDiscShown",value:function(t){var e=this;this._trackingDisc=!0,function t(){if(e._trackingDisc){var n=e.model.api.selectedLocation;if(n){var i=e.model.getLocationCoordinates(n);e._disc.position=i,e._longRangeScanner.position=i}requestAnimationFrame(t)}}(),this._moveDiscToSuitablePosition()}},{key:"_moveDiscToSuitablePosition",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=this.model.api.selectedLocation,n=this.$el.find(".disc-root.starmap-disc"),i=this.$el.find("#sm-map-map-region"),r=n[0].getBoundingClientRect(),o=i[0].getBoundingClientRect(),a=o.width-t;if(e){var s=this.model.getLocationCoordinates(e),l=!1,c=s.x,u=s.y;r.left<0&&(l=!0,c=s.x+Math.abs(r.left)+30),r.left+r.width>a&&(l=!0,c=s.x-Math.abs(r.left+r.width-a)-30),r.top<0&&(l=!0,u=s.y+Math.abs(r.top)+80);var h=o.height-175;r.top+r.height>h&&(l=!0,u=s.y-Math.abs(r.top+r.height-h)),l&&this.model.moveSelectedElementAt(c,u)}}},{key:"_onDiscHide",value:function(t){this.model.get("soundFX").closeDisc(),this._longRangeScanner.hidden=!0,this._longRangeScanner.setValues({lifeform:0,economy:0,danger:0}),this.model.unselectLocation()}},{key:"_onDiscHidden",value:function(t){this._closeInfo()}},{key:"_onSelectStarSystem",value:function(t){if(!this._disc.hidden)return t.preventDefault(),this._disc.hidden=!0,void(this._trackingDisc=!1);if(t.detail.mouseButton===m.default.Mouse.LEFT_BUTTON)t.preventDefault(),this.model.goToLocation(t.detail.location);else{this.model.selectLocation(t.detail.location);var e=this.model.getLocationInfo(t.detail.location),n=e.name,i=e.raw.type,r=e.aggregated_population,o=e.aggregated_economy,a=e.aggregated_danger,s=e.aggregated_size,l=e.affiliation,c=this.model.getLocationCoordinates(t.detail.location);this._disc.position=c,this._disc.setObjectTitle(n),this._disc.setObjectType("starsystem"),this._disc.setObjectInfo({title:"Star System",definitions:[{name:"System Type",value:w[i]},{name:"Size",value:Math.round(s)+" au"},{name:"Affiliation",value:l.length>0?l[0].name:"Unknown"}]}),this._disc.indicators=!0,this._disc.hidden=!1,this._longRangeScanner.size={width:230,height:230},this._longRangeScanner.position=c,this._longRangeScanner.hidden=!1,this._longRangeScanner.setValues({lifeform:r||0,economy:o||0,danger:a||0})}}},{key:"_onSelectCelestialObject",value:function(t){var e=this;return this._disc.hidden?void(t.detail.mouseButton===m.default.Mouse.LEFT_BUTTON?(t.preventDefault(),this.model.goToLocation(t.detail.location)):this.model.goToLocation(t.detail.location,{size:170}).then((function(n){e.model.selectLocation(t.detail.location);var i=e.model.getLocationInfo(t.detail.location),r=i.name,o=(i.age,i.raw),a=o.type,s=o.habitable,l=i.subtype,c=i.affiliation,u=(i.size,e.model.getLocationCoordinates(t.detail.location));e._disc.position=u,e._disc.setObjectTitle(r),"STAR"===a?(e._disc.setObjectType("star"),e._disc.setObjectInfo({title:"Star",definitions:[{name:"Type",value:l?l.name:"Unknown"}]})):"PLANET"===a?(e._disc.setObjectType("planet"),e._disc.setObjectInfo({title:"Planet",definitions:[{name:"Type",value:l?l.name:"Unknown"},{name:"Habitable",value:"1"===s?"Yes":"No"},{name:"Affiliation",value:c.length>0?c[0].name:"Unknown"}]})):"BLACKHOLE"===a?(e._disc.setObjectType("celestialobject"),e._disc.setObjectInfo({title:"Black Hole",definitions:[{name:"Type",value:l?l.name:"Unknown"}]})):(e._disc.setObjectType("celestialobject"),e._disc.setObjectInfo({title:"Celestial Object",definitions:[{name:"Type",value:l?l.name:"Unknown"}]})),e._disc.indicators=!1,e._disc.hidden=!1}))):(t.preventDefault(),this._disc.hidden=!0,this._trackingDisc=!1,void this.model.unselectLocation())}},{key:"_onSelectJumpPoint",value:function(t){var e=this;return this._disc.hidden?void(t.detail.mouseButton===m.default.Mouse.LEFT_BUTTON?(t.preventDefault(),this.model.get("location").type===v.default.Types.STAR_SYSTEM?(this._jumpPointAnimation=this._jumpPointAnimation.then((function(n){return e.model.goToLocation(t.detail.location)})),setTimeout((function(){e._jumpPointAnimation=l.resolve()}),250)):this.model.get("location").type===v.default.Types.JUMP_POINT&&(this._jumpPointAnimation=this._jumpPointAnimation.then(this.model.goThroughJumpPoint(t.detail.location)).then((function(t){return e._jumpPointAnimation=l.resolve()})))):this.model.goToLocation(t.detail.location).then((function(n){e.model.selectLocation(t.detail.location);var i=e.model.getJumpTunnelInfo(t.detail.location),r=i.raw,o=r.direction,a=r.size,s=i.extra.destination,l=e.model.getLocationCoordinates(t.detail.location);e._disc.position=l,e._disc.setObjectTitle(name),e._disc.setObjectType("jumppoint"),e._disc.setObjectInfo({title:"Jump Gate",definitions:[{name:"Type",value:_[o]},{name:"Size",value:S[a]?S[a]:"Unknown"},{name:"Destination System",value:s.name}]}),e._disc.indicators=!1,e._disc.hidden=!1}))):(t.preventDefault(),this._disc.hidden=!0,this._trackingDisc=!1,void this.model.unselectLocation())}},{key:"_hoverObjectIn",value:function(t){var e=this,n=t.detail.location,i=this.model.get("location");this._disc.hidden&&i.type!==v.default.Types.CELESTIAL_OBJECT&&i.type!==v.default.Types.JUMP_POINT&&(this._hoverOutCancelable&&(this._hoverOutCancelable.cancel(),this._hoverOutCancelable=null,n.equals(this._hoveredObject)||(this._hoveredObject&&this.model.removeStickyHoverLocation(this._hoveredObject),this._hoveredObject=null,this._trackingMarker=!1,this._locationMarker.hidden=!0,this.model.get("soundFX").hoverObjectOut(),this._hoverAnimationQueue=this._hoverAnimationQueue.then((function(t){return f.delay(200)})))),n.equals(this._hoveredObject)||(this._initialHoverCancelable=f.cancelableDelay(500),this._initialHoverCancelable.then((function(t){var i=t.canceled;e._initialHoverCancelable=null,i||(e._hoverAnimationQueue=e._hoverAnimationQueue.then((function(t){e._hoveredObject=n;var i=e.model.getLocationCoordinates(n);e._locationMarker.position={x:i.x.toFixed(2),y:i.y.toFixed(2)},e._locationMarker.hidden=!1,e.model.get("soundFX").hoverObjectIn(),e._trackingMarker=!0,e.model.addStickyHoverLocation(e._hoveredObject);var r=e;!function t(){if(r._trackingMarker){var e=r.model.getLocationCoordinates(n);r._locationMarker.position=e,requestAnimationFrame(t)}}()})))}))))}},{key:"_hoverObjectOut",value:function(t){var e=this;this._initialHoverCancelable?(this._initialHoverCancelable.cancel(),this._initialHoverCancelable=null):(this._hoverOutCancelable=f.cancelableDelay(150),this._hoverOutCancelable.then((function(t){var n=t.canceled;e._hoverOutCancelable=null,n||(e._hoveredObject&&e.model.removeStickyHoverLocation(e._hoveredObject),e._hoveredObject=null,e._trackingMarker=!1,e._locationMarker.hidden=!0,e.model.get("soundFX").hoverObjectOut(),e._hoverAnimationQueue=e._hoverAnimationQueue.then((function(t){return f.delay(200)})))})))}},{key:"_onMarkerMouseEnter",value:function(){this._hoverOutCancelable&&(this._hoverOutCancelable.cancel(),this._hoverOutCancelable=null)}},{key:"_onMarkerMouseLeave",value:function(){var t=this;this._hoverOutCancelable=f.cancelableDelay(150),this._hoverOutCancelable.then((function(e){var n=e.canceled;t._hoverOutCancelable=null,n||(t._hoveredObject&&t.model.removeStickyHoverLocation(t._hoveredObject),t._hoveredObject=null,t._trackingMarker=!1,t._locationMarker.hidden=!0,t.model.get("soundFX").hoverObjectOut(),t._hoverAnimationQueue=t._hoverAnimationQueue.then((function(t){return f.delay(200)})))}))}},{key:"_onSelectNone",value:function(t){t.detail.mouseButton===m.default.Mouse.LEFT_BUTTON?this._disc.hidden?this.model.goToParentLocation(this.model.get("location")):(this._disc.hidden=!0,this._trackingDisc=!1,this.model.unselectLocation()):this._disc.hidden||(this._disc.hidden=!0,this._trackingDisc=!1,this.model.unselectLocation())}},{key:"_onLocationChange",value:function(){this._disc.hidden||(this._disc.hidden=!0,this._trackingDisc=!1,this.model.unselectLocation())}},{key:"_onMarkerClick",value:function(t){var e=this._hoveredObject;this.model.removeStickyHoverLocation(e),this._trackingMarker=!1,this._locationMarker.hidden=!0,e.type===v.default.Types.STAR_SYSTEM?this._onSelectStarSystem({detail:{location:e,mouseButton:2},preventDefault:function(){}}):e.type===v.default.Types.CELESTIAL_OBJECT?this._onSelectCelestialObject({detail:{location:e,mouseButton:2},preventDefault:function(){}}):e.type===v.default.Types.JUMP_POINT&&this._onSelectJumpPoint({detail:{location:e,mouseButton:2},preventDefault:function(){}})}},{key:"_closeInfo",value:function(){var t=this;this.info.currentView&&this.info.currentView.hide().then((function(){return t.info.empty()}))}},{key:"tagName",get:function(){return"section"}},{key:"className",get:function(){return"sm-starmap"}},{key:"template",get:function(){return E}},{key:"modelEvents",get:function(){return this[C]=this[C]||{"change:location":"updateQueryString",update_camera:"updateQueryString"}},set:function(t){this[C]=t}},{key:"events",get:function(){return this[M]=this[M]||{mouseup:"onInteraction",mousedown:"onInteraction",mouseout:"onInteraction"}},set:function(t){this[M]=t}},{key:"regions",get:function(){return this[T]=this[T]||{info:"#sm-map-info-region"}},set:function(t){this[T]=t}}]),e}(u.LayoutView);e.default=k,k.prototype.updateQueryString=p.default.debounce(k.prototype.updateQueryString,500),t.exports=e.default},function(t,e,n){"use strict";var i=n(19).default,r=n(190).default;Object.defineProperty(e,"__esModule",{value:!0});var o=function(t,e){return new i((function(n){return setTimeout(n.bind(null,e),t)}))};e.delay=o;e.cancelableDelay=function(t){var e=null,n=[new i((function(t){return e=t})),o(t,{canceled:!1})];return r(i.race(n),{cancel:function(){e({canceled:!0})}})}},function(t,e,n){t.exports={default:n(191),__esModule:!0}},function(t,e,n){n(192),t.exports=n(30).Object.assign},[481,28,193],[482,35,127,51,38],function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(195).default,a=n(97).default,s=n(19).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0}),n(197);var c=l(n(114)),u=l(n(128)),h=l(n(388)),d=n(389),f=l(n(106));n(390);var p="section",m="starmap-disc",v="div",g="svg-root",y=757,b=540,x="h1",w="div",_="Unknown Object",S=o("Disc._elements"),M=a("Disc._hidden"),C=a("Disc._lights"),T=a("Disc._position"),E=a("Disc._setInitialState"),k=(a("Disc._setObjectInfo"),a("Disc._objectTitle")),A=a("Disc._objectInfo"),P=a("Disc._eventTarget"),L=a("Disc._objectType"),O="#1A324E",R="#FEE5A1",F=function(){var t=c.default.createElement("div");return["matches","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector"].reduce((function(e,n){return!e&&n in t?n:e}),null)}(),B={INSPECT:"inspect",INFORMATION:"information",ROUTING:"routing",BOOKMARK:"bookmark",AVOID:"avoid",DEPARTURE:"departure",DESTINATION:"destination"},D=function(){function t(e){var n=this;r(this,t),this[P]=c.default.createDocumentFragment();var i=c.default.createElement(p);i.classList.add("disc-root"),this._rootElement=i;var o=c.default.createElement(v),a=c.default.createElement(x);a.classList.add("disc-root__title");var s=c.default.createElement(w);s.classList.add("disc-root__info"),i.classList.add(m),i.style.visibility="hidden",o.classList.add(g),o.style.width=y+"px",o.style.height=b+"px",this._degradedAnimations=-1!==f.default.navigator.userAgent.toLowerCase().indexOf("firefox");var l=c.default.createElement("object");l.type="image/svg+xml",i.appendChild(o),i.appendChild(a),i.appendChild(s),f.default._disc=this,this[k]=_,this[A]=null,this._bookmarked=!1,this._avoided=!1,this._inspectingJumpPoint=!1,this._inspectingDisabled=!1,o.appendChild(l),l.addEventListener("load",(function(){var t=l.contentDocument,e=c.default.createElement("ul");e.classList.add("disc-root__menu"),e.innerHTML='\n        <li data-order="0"><a data-type="inspect" href="#"><span class="inspect">Inspect</span><span class="go-through">Navigate</span></a></li>\n        <li data-order="1"><a data-type="information" href="#">Information</a></li>\n        <li data-order="2"><a data-type="routing" href="#">Routing</a></li>\n        <li data-order="3"><a data-type="bookmark" href="#">Bookmark</a></li>\n      ';var r=c.default.createElement("ul");r.classList.add("disc-root__extended-menu"),r.style.display="none",r.innerHTML='\n        <li data-order="0"><a data-type="back" href="#">Back<i class="back-icon"><span></span></i></a></li>\n        <li data-order="1"><a data-type="departure" href="#"><span>Set As:</span>Departure</a></li>\n        <li data-order="2"><a data-type="destination" href="#"><span>Set As:</span>Destination</a></li>\n        <li data-order="3"><a data-type="avoid" href="#">Avoid</a></li>\n      ';var o=c.default.createElement("ul");o.classList.add("disc-root__indicators"),o.style.opacity="0",o.innerHTML="\n        <li><span>Population</span></li>\n        <li><span>Economy</span></li>\n        <li><span>Threat</span></li>\n      ",n._selectedMainMenuItemIndex=0,n._selectedExtendedMainMenuItemIndex=0,i.appendChild(e),i.appendChild(r),i.appendChild(o),l.contentDocument,n[S]={root:i,title:a,info:s,menu:e,extendedMenu:r,indicators:o,disc:{root:t,mask:{shape:t.querySelector(".disc__mask-shape"),gradient:t.querySelector(".disc__mask-gradient")},background:{mask:t.querySelector(".disc__background-strokes--shape")},middleTop:{mask:t.querySelector(".disc__middle-top--mask-shape"),strokeMask:t.querySelector(".disc__middle-top--stroke-shape"),shape:t.querySelector(".disc__middle-top--shape")},circles:{bottomLeft:t.querySelector(".disc__highlights-bottom-left"),bottomRight:t.querySelector(".disc__highlights-bottom-right"),topLeft:t.querySelector(".disc__highlights-top-left"),topRight:t.querySelector(".disc__highlights-top-right")},smallLights:t.querySelector(".disc__small-lights"),menuMask:t.querySelector("#disc__menu-mask")}},n._showIndicators=!1,n[T]={x:0,y:0},n[C]=new h.default(n,t,{degraded:!0}),n[M]=!0,n._discDimensions=i.getBoundingClientRect(),n[E]()})),l.data=window.location.origin+"/rsi/static/svg/disc.svg"}return i(t,[{key:"_resetMainMenu",value:function(){for(var t=this[S].menu,e=0,n=0,i=t.children.length;i>e;e++)this._inspectingDisabled&&0===e||(t.children[e].setAttribute("data-order",n),n++);this._selectedMainMenuItemIndex=0}},{key:"_resetExtendedMainMenu",value:function(){for(var t=this[S].extendedMenu,e=0,n=t.children.length;n>e;e++)t.children[e].setAttribute("data-order",e);this._selectedExtendedMainMenuItemIndex=0}},{key:"addEventListener",value:function(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return this[P].addEventListener(t,e,n)}},{key:"removeEventListener",value:function(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return this[P].removeEventListener(t,e,n)}},{key:"dispatchEvent",value:function(t){return this[P].dispatchEvent(t)}},{key:"_showStandard",value:function(){var t=this,e=this[S].disc.mask,n=e.shape,i=e.gradient,r=this[S].disc.middleTop.shape,o=this[S].disc.middleTop.mask,a=this[S].disc.middleTop.strokeMask,s=this[S].disc.background.mask,l=this[S].disc.circles.bottomLeft,c=this[S].title,h=this[S].disc.smallLights,f=this[S].info,p=this[S].menu,m=(this[S].extendedMenu,this[S].disc.circles.bottomRight),v=this[S].disc.circles.topLeft,g=this[S].disc.circles.topRight,y=l.getBBox(),b=m.getBBox(),x=v.getBBox(),w=g.getBBox(),_=new CustomEvent("show",{cancelable:!0});if(this[S].menu.classList.add("inactive"),this[P].dispatchEvent(_)){this[S].root.style.pointerEvents="all";var M=new u.default;this._resetMainMenu(),M.tween({from:{radius:95},to:{radius:400},duration:150,step:function(t){n.setAttribute("r",t.radius),i.setAttribute("r",t.radius)}}),(new u.default).tween({from:{radius:110},to:{radius:300},delay:150,duration:450,step:function(t){o.setAttribute("r",t.radius)}}),(new u.default).tween({from:{opacity:100},to:{opacity:60},delay:660,duration:600,step:function(t){r.style.opacity=t.opacity/100}}),(new u.default).tween({from:{radius:110},to:{radius:300},duration:400,delay:400,step:function(t){a.setAttribute("r",t.radius)}}),(new u.default).tween({from:{radius:110},to:{radius:300},duration:530,step:function(t){s.setAttribute("r",t.radius)}});var T=new u.default,E=y.x+y.width/2,A=y.y+y.height/2;T.tween({from:{angle:0},to:{angle:360},duration:1500,delay:150,step:function(t){l.setAttribute("transform","rotate("+-t.angle+" "+E+" "+A+")")}});var L=new u.default,F=b.x+b.width/2,B=b.y+b.height/2;L.tween({from:{angle:0},to:{angle:360},duration:1500,delay:150,step:function(t){m.setAttribute("transform","rotate("+t.angle+" "+F+" "+B+")")}});var D=new u.default,I=x.x+x.width/2,N=x.y+x.height/2;D.tween({from:{angle:0},to:{angle:360},duration:1500,delay:150,step:function(t){v.setAttribute("transform","rotate("+t.angle+" "+I+" "+N+")")}});var j=new u.default,V=w.x+w.width/2,z=w.y+w.height/2;j.tween({from:{angle:0},to:{angle:360},duration:1500,delay:150,step:function(t){g.setAttribute("transform","rotate("+-t.angle+" "+V+" "+z+")")}}),d.delay(60).then((function(e){return t[C].hidden=!1})),d.delay(180).then((function(e){return t[C].on=!0})),c.style.color=O,c.innerHTML=this[k],c.style.opacity=1,c.style.display="block",d.delay(150).then((function(t){c.style.color="#7F7779"})).then((function(t){return d.delay(60)})).then((function(t){c.style.color=O})).then((function(t){return d.delay(50)})).then((function(t){c.classList.add("disc-root__title--shadow"),c.style.color=R})),(new u.default).tween({from:{opacity:0},to:{opacity:100},delay:60,duration:100,step:function(t){h.style.opacity=t.opacity/100}}),(new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){f.style.opacity=t.opacity/100}}),p.style.display="block";for(var U=p.querySelectorAll("a"),H=0,G=U.length;G>H;H++)U[H].style.transform="",U[H].style.opacity="1";(this[S].indicators,new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){p.style.opacity=t.opacity/100},finish:function(){t[S].menu.classList.remove("inactive")}}),this._showIndicators&&function(){var e=t[S].indicators;(new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){e.style.opacity=t.opacity/100}})}();var W=new CustomEvent("shown",{cancelable:!0});this[P].dispatchEvent(W)}}},{key:"_hideStandard",value:function(){var t=this,e=this[S].disc.mask,n=e.shape,i=e.gradient,r=this[S].disc.middleTop.shape,o=this[S].disc.middleTop.mask,a=this[S].disc.middleTop.strokeMask,s=this[S].disc.background.mask,l=this[S].disc.circles.bottomLeft,c=this[S].disc.circles.bottomRight,h=this[S].disc.circles.topLeft,f=this[S].disc.circles.topRight,p=this[S].title,m=this[S].disc.smallLights,v=this[S].info,g=this[S].menu,y=this[S].extendedMenu,b=new CustomEvent("hide",{cancelable:!0});if(this[P].dispatchEvent(b)){this[S].root.style.pointerEvents="none",(new u.default).tween({from:{radius:400},to:{radius:95},duration:100,step:function(t){n.setAttribute("r",t.radius),i.setAttribute("r",t.radius)},finish:function(){o.setAttribute("r",110),r.style.opacity=1,a.setAttribute("r",110),s.setAttribute("r",110),l.removeAttribute("transform"),c.removeAttribute("transform"),h.removeAttribute("transform"),f.removeAttribute("transform"),p.style.opacity=0,p.style.display="none",m.style.opacity=0,v.style.opacity=0,g.style.opacity=0,g.style.display="block",y.style.opacity=1,y.style.display="none";var e=g.querySelectorAll("a");t[S].indicators.style.opacity="0";for(var n=0,i=e.length;i>n;n++)e[n].style.transform="",e[n].style.opacity="1";for(var u=y.querySelectorAll("a"),d=(n=0,u.length);d>n;n++)u[n].style.textIndent="0px",u[n].style.opacity="1"}}),this[C].on=!1,d.delay(60).then((function(e){return t[C].hidden=!0})),d.delay(100).then((function(e){return t._resetMainMenu()}));var x=new CustomEvent("hidden",{cancelable:!0});this[P].dispatchEvent(x)}}},{key:"_showDegraded",value:function(){var t=this,e=this[S].disc.mask,n=(e.shape,e.gradient,this[S].disc.middleTop.shape),i=this[S].disc.middleTop.mask,r=this[S].disc.middleTop.strokeMask,o=this[S].disc.background.mask,a=this[S].disc.circles.bottomLeft,s=this[S].title,l=this[S].disc.smallLights,c=this[S].info,h=this[S].menu,f=(this[S].extendedMenu,this[S].disc.circles.bottomRight),p=this[S].disc.circles.topLeft,m=this[S].disc.circles.topRight,v=(a.getBBox(),f.getBBox(),p.getBBox(),m.getBBox(),new CustomEvent("show",{cancelable:!0}));if(this[S].menu.classList.add("inactive"),this[P].dispatchEvent(v)){this[S].root.style.pointerEvents="all",new u.default,this._resetMainMenu(),this[S].root.style.opacity=1,i.setAttribute("r",300),n.style.opacity=.6,r.setAttribute("r",300),o.setAttribute("r",300),d.delay(60).then((function(e){return t[C].hidden=!1})),d.delay(180).then((function(e){return t[C].on=!0})),s.style.color=O,s.innerHTML=this[k],s.style.opacity=1,s.style.display="block",d.delay(150).then((function(t){s.classList.add("disc-root__title--shadow"),s.style.color=R})),l.style.opacity=1,(new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){c.style.opacity=t.opacity/100}}),h.style.display="block";for(var g=h.querySelectorAll("a"),y=0,b=g.length;b>y;y++)g[y].style.transform="",g[y].style.opacity="1";(this[S].indicators,new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){h.style.opacity=t.opacity/100},finish:function(){t[S].menu.classList.remove("inactive")}}),this._showIndicators&&function(){var e=t[S].indicators;(new u.default).tween({from:{opacity:0},to:{opacity:100},delay:350,duration:300,step:function(t){e.style.opacity=t.opacity/100}})}();var x=new CustomEvent("shown",{cancelable:!0});this[P].dispatchEvent(x)}}},{key:"_hideStandard",value:function(){var t=this,e=this[S].disc.mask,n=e.shape,i=e.gradient,r=this[S].disc.middleTop.shape,o=this[S].disc.middleTop.mask,a=this[S].disc.middleTop.strokeMask,s=this[S].disc.background.mask,l=this[S].disc.circles.bottomLeft,c=this[S].disc.circles.bottomRight,h=this[S].disc.circles.topLeft,f=this[S].disc.circles.topRight,p=this[S].title,m=this[S].disc.smallLights,v=this[S].info,g=this[S].menu,y=this[S].extendedMenu,b=new CustomEvent("hide",{cancelable:!0});if(this[P].dispatchEvent(b)){this[S].root.style.pointerEvents="none",(new u.default).tween({from:{radius:400},to:{radius:95},duration:100,step:function(t){n.setAttribute("r",t.radius),i.setAttribute("r",t.radius)},finish:function(){o.setAttribute("r",110),r.style.opacity=1,a.setAttribute("r",110),s.setAttribute("r",110),l.removeAttribute("transform"),c.removeAttribute("transform"),h.removeAttribute("transform"),f.removeAttribute("transform"),p.style.opacity=0,p.style.display="none",m.style.opacity=0,v.style.opacity=0,g.style.opacity=0,g.style.display="block",y.style.opacity=1,y.style.display="none";var e=g.querySelectorAll("a");t[S].indicators.style.opacity="0";for(var n=0,i=e.length;i>n;n++)e[n].style.transform="",e[n].style.opacity="1";for(var u=y.querySelectorAll("a"),d=(n=0,u.length);d>n;n++)u[n].style.textIndent="0px",u[n].style.opacity="1"}}),this[C].on=!1,d.delay(60).then((function(e){return t[C].hidden=!0})),d.delay(100).then((function(e){return t._resetMainMenu()}));var x=new CustomEvent("hidden",{cancelable:!0});this[P].dispatchEvent(x)}}},{key:"_hideDegraded",value:function(){var t=this,e=this[S].disc.mask,n=(e.shape,e.gradient,this[S].disc.middleTop.shape),i=this[S].disc.middleTop.mask,r=this[S].disc.middleTop.strokeMask,o=this[S].disc.background.mask,a=this[S].disc.circles.bottomLeft,s=this[S].disc.circles.bottomRight,l=this[S].disc.circles.topLeft,c=this[S].disc.circles.topRight,u=this[S].title,h=this[S].disc.smallLights,f=this[S].info,p=this[S].menu,m=this[S].extendedMenu,v=new CustomEvent("hide",{cancelable:!0});if(this[P].dispatchEvent(v)){this[S].root.style.pointerEvents="none",this[S].root.style.opacity=0,i.setAttribute("r",110),n.style.opacity=1,r.setAttribute("r",110),o.setAttribute("r",110),a.removeAttribute("transform"),s.removeAttribute("transform"),l.removeAttribute("transform"),c.removeAttribute("transform"),u.style.opacity=0,u.style.display="none",h.style.opacity=0,f.style.opacity=0,p.style.opacity=0,p.style.display="block",m.style.opacity=1,m.style.display="none";var g=p.querySelectorAll("a");this[S].indicators.style.opacity="0";for(var y=0,b=g.length;b>y;y++)g[y].style.transform="",g[y].style.opacity="1";for(var x=m.querySelectorAll("a"),w=(y=0,x.length);w>y;y++)x[y].style.textIndent="0px",x[y].style.opacity="1";this[C].on=!1,d.delay(60).then((function(e){return t[C].hidden=!0})),d.delay(100).then((function(e){return t._resetMainMenu()}));var _=new CustomEvent("hidden",{cancelable:!0});this[P].dispatchEvent(_)}}},{key:"setObjectTitle",value:function(t){this[k]=t}},{key:"setObjectType",value:function(t){this[S].root.setAttribute("data-type",t),this[L]=t}},{key:"setObjectInfo",value:function(t){this[A]=t;var e=c.default.createElement("h2");e.appendChild(c.default.createTextNode(t.title));var n=c.default.createElement("dl");t.definitions.forEach((function(t){var e=c.default.createElement("dt");e.appendChild(c.default.createTextNode(t.name));var i=c.default.createElement("dd");i.appendChild(c.default.createTextNode(t.value)),n.appendChild(e),n.appendChild(i)}));var i=this[S].info;i.innerHTML="",i.appendChild(e),i.appendChild(n)}},{key:"_menuUp",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this[S].disc.menuMask,i=this[S].menu,r=new u.default;return 0===e?s.resolve():new s((function(e){r.tween({from:{translateY:0},to:{translateY:-30},duration:125,start:function(){t._selectedMainMenuItemIndex++;for(var e=-t._selectedMainMenuItemIndex,n=0,r=i.children.length;r>n;n++)i.children[n].setAttribute("data-order",e++)},step:function(t){var e=t.translateY;n.setAttribute("transform","translate(0 "+e+")")},finish:function(){n.removeAttribute("transform"),e()}})})).then((function(n){return t._menuUp(e-1)}))}},{key:"_extendedMenuUp",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this[S].disc.menuMask,i=this[S].extendedMenu,r=new u.default;return 0===e?s.resolve():new s((function(e){r.tween({from:{translateY:0},to:{translateY:-30},duration:125,start:function(){t._selectedExtendedMainMenuItemIndex++;for(var e=-t._selectedExtendedMainMenuItemIndex,n=0,r=i.children.length;r>n;n++)i.children[n].setAttribute("data-order",e++)},step:function(t){var e=t.translateY;n.setAttribute("transform","translate(0 "+e+")")},finish:function(){n.removeAttribute("transform"),e()}})})).then((function(n){return t._extendedMenuUp(e-1)}))}},{key:"_menuDown",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this[S].disc.menuMask,i=this[S].menu,r=new u.default;return 0===e?s.resolve():new s((function(e){r.tween({from:{translateY:0},to:{translateY:30},duration:125,start:function(){t._selectedMainMenuItemIndex--;for(var e=-t._selectedMainMenuItemIndex,n=0,r=i.children.length;r>n;n++)i.children[n].setAttribute("data-order",e++)},step:function(t){var e=t.translateY;n.setAttribute("transform","translate(0 "+e+")")},finish:function(){n.removeAttribute("transform"),e()}})})).then((function(n){return t._menuDown(e-1)}))}},{key:"_extendedMenuDown",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this[S].disc.menuMask,i=this[S].extendedMenu,r=new u.default;return 0===e?s.resolve():new s((function(e){r.tween({from:{translateY:0},to:{translateY:30},duration:125,start:function(){t._selectedExtendedMainMenuItemIndex--;for(var e=-t._selectedExtendedMainMenuItemIndex,n=0,r=i.children.length;r>n;n++)i.children[n].setAttribute("data-order",e++)},step:function(t){var e=t.translateY;n.setAttribute("transform","translate(0 "+e+")")},finish:function(){n.removeAttribute("transform"),e()}})})).then((function(n){return t._extendedMenuDown(e-1)}))}},{key:E,value:function(){var t=this,e=this[S].disc.mask,n=e.shape,i=e.gradient,r=this[S].title,o=this[S].info,a=this[S].menu,l=this[S].extendedMenu;r.style.opacity=0,o.style.opacity=0,a.style.opacity=0,this[S].root.style.pointerEvents="none",this._degradedAnimations?(i.setAttribute("r",500),n.setAttribute("r",500),this[S].root.style.opacity=0):(i.setAttribute("r",0),n.setAttribute("r",0)),this[S].root.style.visibility="visible",this[S].disc.smallLights.style.opacity=0;this[S].root.addEventListener("click",(function(t){t.stopPropagation()})),a.addEventListener("click",(function(e){for(var n=e.target,i=void 0;n&&n!==c.default&&!(i=n[F]("a"));)n=n.parentNode;i&&function(){var e=parseInt(n.parentNode.getAttribute("data-order"),10),i=s.resolve();(i=0>e?i.then((function(n){return t._menuDown(Math.abs(e))})):i.then((function(n){return t._menuUp(Math.abs(e))}))).then((function(e){var i=n.getAttribute("data-type");if("routing"!==i){var r=new CustomEvent("select",{detail:{type:i},cancelable:!0});!t[P].dispatchEvent(r)||(t.hidden=!0)}else{r=new CustomEvent("select",{detail:{type:i},cancelable:!0});t[P].dispatchEvent(r),t._showExtendedMenu()}}))}()}),!1),l.addEventListener("click",(function(e){for(var n=e.target,i=void 0;n&&n!==c.default&&!(i=n[F]("a"));)n=n.parentNode;i&&function(){var e=parseInt(n.parentNode.getAttribute("data-order"),10),i=s.resolve();(i=0>e?i.then((function(n){return t._extendedMenuDown(Math.abs(e))})):i.then((function(n){return t._extendedMenuUp(Math.abs(e))}))).then((function(e){var i=n.getAttribute("data-type");if("back"!==i){var r=new CustomEvent("select",{detail:{type:i},cancelable:!0});!t[P].dispatchEvent(r)||(t.hidden=!0)}else{r=new CustomEvent("select",{detail:{type:i},cancelable:!0});t[P].dispatchEvent(r),t._hideExtendedMenu()}}))}()}),!1)}},{key:"_showExtendedMenu",value:function(){var t=new u.default,e=this[S].menu,n=e.querySelectorAll("a");t.tween({from:{translateX:0,opacity:100},to:{translateX:250,opacity:0},duration:150,step:function(t){for(var e=t.translateX,i=t.opacity,r=0,o=n.length;o>r;r++)n[r].style.transform="translateX("+e+"px)",n[r].style.opacity=Math.max(0,i/100/2)},finish:function(){e.style.display="none"}});var i=new u.default,r=this[S].extendedMenu,o=r.querySelector("i span"),a=r.querySelectorAll("a");i.tween({from:{translateX:-250,opacity:0},to:{translateX:0,opacity:100},duration:150,delay:150,start:function(){for(var t=0,e=a.length;e>t;t++)a[t].style.textIndent="-250px",a[t].style.opacity=0;o.style.left="-250px",r.style.display="block"},step:function(t){for(var e=t.translateX,n=t.opacity,i=0,r=a.length;r>i;i++)a[i].style.textIndent=e+"px",a[i].style.opacity=Math.min(1,n/100*2);o.style.left=e+"px"}})}},{key:"_hideExtendedMenu",value:function(){var t=new u.default,e=this[S].extendedMenu,n=e.querySelector("i span"),i=e.querySelectorAll("a");t.tween({from:{translateX:0,opacity:10},to:{translateX:-250,opacity:0},duration:150,start:function(){for(var t=0,e=i.length;e>t;t++)i[t].style.textIndent="0px",i[t].style.opacity=1;n.style.left="0px"},step:function(t){for(var e=t.translateX,r=t.opacity,o=0,a=i.length;a>o;o++)i[o].style.textIndent=e+"px",i[o].style.opacity=Math.min(1,r/100*2);n.style.left=e+"px"},finish:function(){e.style.display="none"}});var r=new u.default,o=this[S].menu,a=o.querySelectorAll("a");r.tween({from:{translateX:250,opacity:0},to:{translateX:0,opacity:100},duration:150,delay:150,start:function(){o.style.display="block"},step:function(t){for(var e=t.translateX,n=t.opacity,i=0,r=a.length;r>i;i++)a[i].style.transform="translateX("+e+"px)",a[i].style.opacity=Math.max(1,n/100*2)},finish:function(){e.style.display="none"}})}},{key:"indicators",set:function(t){this._showIndicators=t},get:function(){return this._showIndicators}},{key:"element",get:function(){return this._rootElement}},{key:"hidden",get:function(){return this[M]},set:function(t){t!==this[M]&&(t?this._degradedAnimations?this._hideDegraded():this._hideStandard():this._degradedAnimations?this._showDegraded():this._showStandard(),this[M]=t)}},{key:"lights",get:function(){return this[C]}},{key:"position",get:function(){return this[T]},set:function(){var t=arguments.length<=0||void 0===arguments[0]?{x:0,y:0}:arguments[0],e=t.x,n=t.y;this[S].root.style.transform="translate("+(e-this._discDimensions.width/2).toFixed(2)+"px, "+(n-this._discDimensions.height/2).toFixed(2)+"px)",this[T]={x:e,y:n}}},{key:"bookmarked",set:function(t){t?this[S].menu.querySelector('[data-type="bookmark"]').classList.add("added"):this[S].menu.querySelector('[data-type="bookmark"]').classList.remove("added"),this._bookmarked=t},get:function(){return this._bookmarked}},{key:"avoided",set:function(t){t?this[S].extendedMenu.querySelector('[data-type="avoid"]').classList.add("added"):this[S].extendedMenu.querySelector('[data-type="avoid"]').classList.remove("added"),this._avoided=t},get:function(){return this._avoided}},{key:"inspectingJumpPoint",set:function(t){t?this[S].menu.querySelector('[data-type="inspect"]').classList.add("inspecting-jump-point"):this[S].menu.querySelector('[data-type="inspect"]').classList.remove("inspecting-jump-point"),this._inspectingJumpPoint=t},get:function(){this._inspectingJumpPoint}},{key:"inspectingDisabled",set:function(t){t?this[S].menu.querySelector('[data-type="inspect"]').classList.add("inspecting-disabled"):this[S].menu.querySelector('[data-type="inspect"]').classList.remove("inspecting-disabled"),this._inspectingDisabled=t},get:function(){this._inspectingDisabled}}],[{key:"Commands",get:function(){return B}}]),t}();e.default=D,t.exports=e.default},function(t,e,n){t.exports={default:n(196),__esModule:!0}},function(t,e,n){n(99),t.exports=n(30).Symbol.for},function(t,e,n){t.exports=n(198)},function(t,e,n){(function(t){"use strict";if(n(199),n(386),t._babelPolyfill)throw new Error("only one instance of babel/polyfill is allowed");t._babelPolyfill=!0}).call(e,function(){return this}())},function(t,e,n){n(200),n(233),n(239),n(241),n(243),n(245),n(247),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(263),n(264),n(265),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(275),n(276),n(277),n(279),n(280),n(281),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(301),n(302),n(306),n(307),n(309),n(310),n(315),n(316),n(319),n(321),n(323),n(325),n(326),n(327),n(329),n(330),n(332),n(333),n(334),n(335),n(342),n(345),n(346),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(361),n(362),n(363),n(364),n(365),n(366),n(368),n(369),n(370),n(371),n(373),n(374),n(376),n(377),n(379),n(380),n(381),n(384),n(385),t.exports=n(204)},function(t,e,n){"use strict";var i,r=n(201),o=n(202),a=n(207),s=n(206),l=n(213),c=n(214),u=n(216),h=n(217),d=n(218),f=n(208),p=n(219),m=n(212),v=n(215),g=n(220),y=n(222),b=n(224),x=n(225),w=n(226),_=n(223),S=n(210)("__proto__"),M=n(227),C=n(232)(!1),T=Object.prototype,E=Array.prototype,k=E.slice,A=E.join,P=r.setDesc,L=r.getDesc,O=r.setDescs,R={};a||(i=!f((function(){return 7!=P(c("div"),"a",{get:function(){return 7}}).a})),r.setDesc=function(t,e,n){if(i)try{return P(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(p(t)[e]=n.value),t},r.getDesc=function(t,e){if(i)try{return L(t,e)}catch(t){}return u(t,e)?s(!T.propertyIsEnumerable.call(t,e),t[e]):void 0},r.setDescs=O=function(t,e){p(t);for(var n,i=r.getKeys(e),o=i.length,a=0;o>a;)r.setDesc(t,n=i[a++],e[n]);return t}),o(o.S+o.F*!a,"Object",{getOwnPropertyDescriptor:r.getDesc,defineProperty:r.setDesc,defineProperties:O});var F="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),B=F.concat("length","prototype"),D=F.length,I=function(){var t,e=c("iframe"),n=D;for(e.style.display="none",l.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),I=t.F;n--;)delete I.prototype[F[n]];return I()},N=function(t,e){return function(n){var i,r=y(n),o=0,a=[];for(i in r)i!=S&&u(r,i)&&a.push(i);for(;e>o;)u(r,i=t[o++])&&(~C(a,i)||a.push(i));return a}},j=function(){};o(o.S,"Object",{getPrototypeOf:r.getProto=r.getProto||function(t){return t=g(t),u(t,S)?t[S]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?T:null},getOwnPropertyNames:r.getNames=r.getNames||N(B,B.length),create:r.create=r.create||function(t,e){var n;return null!==t?(j.prototype=p(t),n=new j,j.prototype=null,n[S]=t):n=I(),void 0===e?n:O(n,e)},keys:r.getKeys=r.getKeys||N(F,D)});var V=function(t,e,n){if(!(e in R)){for(var i=[],r=0;e>r;r++)i[r]="a["+r+"]";R[e]=Function("F,a","return new F("+i.join(",")+")")}return R[e](t,n)};o(o.P,"Function",{bind:function(t){var e=m(this),n=k.call(arguments,1),i=function(){var r=n.concat(k.call(arguments));return this instanceof i?V(e,r.length,r):d(e,r,t)};return v(e.prototype)&&(i.prototype=e.prototype),i}}),o(o.P+o.F*f((function(){l&&k.call(l)})),"Array",{slice:function(t,e){var n=w(this.length),i=h(this);if(e=void 0===e?n:e,"Array"==i)return k.call(this,t,e);for(var r=x(t,n),o=x(e,n),a=w(o-r),s=Array(a),l=0;a>l;l++)s[l]="String"==i?this.charAt(r+l):this[r+l];return s}}),o(o.P+o.F*(_!=Object),"Array",{join:function(t){return A.call(_(this),void 0===t?",":t)}}),o(o.S,"Array",{isArray:n(229)});var z=function(t){return function(e,n){m(e);var i=_(this),r=w(i.length),o=t?r-1:0,a=t?-1:1;if(arguments.length<2)for(;;){if(o in i){n=i[o],o+=a;break}if(o+=a,t?0>o:o>=r)throw TypeError("Reduce of empty array with no initial value")}for(;t?o>=0:r>o;o+=a)o in i&&(n=e(n,i[o],o,this));return n}},U=function(t){return function(e){return t(this,e,arguments[1])}};o(o.P,"Array",{forEach:r.each=r.each||U(M(0)),map:U(M(1)),filter:U(M(2)),some:U(M(3)),every:U(M(4)),reduce:z(!1),reduceRight:z(!0),indexOf:U(C),lastIndexOf:function(t,e){var n=y(this),i=w(n.length),r=i-1;for(arguments.length>1&&(r=Math.min(r,b(e))),0>r&&(r=w(i+r));r>=0;r--)if(r in n&&n[r]===t)return r;return-1}}),o(o.S,"Date",{now:function(){return+new Date}});var H=function(t){return t>9?t:"0"+t};o(o.P+o.F*(f((function(){return"0385-07-25T07:06:39.999Z"!=new Date(-50000000000001).toISOString()}))||!f((function(){new Date(NaN).toISOString()}))),"Date",{toISOString:function(){if(!isFinite(this))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=0>e?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+H(t.getUTCMonth()+1)+"-"+H(t.getUTCDate())+"T"+H(t.getUTCHours())+":"+H(t.getUTCMinutes())+":"+H(t.getUTCSeconds())+"."+(n>99?n:"0"+H(n))+"Z"}})},35,function(t,e,n){var i=n(203),r=n(204),o=n(205),a=n(209),s=n(211),l="prototype",c=function(t,e,n){var u,h,d,f,p=t&c.F,m=t&c.G,v=t&c.S,g=t&c.P,y=t&c.B,b=m?i:v?i[e]||(i[e]={}):(i[e]||{})[l],x=m?r:r[e]||(r[e]={}),w=x[l]||(x[l]={});for(u in m&&(n=e),n)d=((h=!p&&b&&u in b)?b:n)[u],f=y&&h?s(d,i):g&&"function"==typeof d?s(Function.call,d):d,b&&!h&&a(b,u,d),x[u]!=d&&o(x,u,f),g&&w[u]!=d&&(w[u]=d)};i.core=r,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,t.exports=c},29,30,[440,201,206,207],36,[441,208],38,function(t,e,n){var i=n(203),r=n(205),o=n(210)("src"),a="toString",s=Function[a],l=(""+s).split(a);n(204).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,a){"function"==typeof n&&(n.hasOwnProperty(o)||r(n,o,t[e]?""+t[e]:l.join(String(e))),n.hasOwnProperty("name")||r(n,"name",e)),t===i?t[e]=n:(a||delete t[e],r(t,e,n))})(Function.prototype,a,(function(){return"function"==typeof this&&this[o]||s.call(this)}))},45,[439,212],32,[461,203],[462,215,203],55,39,52,68,[451,215],[475,221],25,[447,223,221],[448,217],24,function(t,e,n){var i=n(224),r=Math.max,o=Math.min;t.exports=function(t,e){return 0>(t=i(t))?r(t+e,0):o(t,e)}},[455,224],function(t,e,n){var i=n(211),r=n(223),o=n(220),a=n(226),s=n(228);t.exports=function(t){var e=1==t,n=2==t,l=3==t,c=4==t,u=6==t,h=5==t||u;return function(d,f,p){for(var m,v,g=o(d),y=r(g),b=i(f,p,3),x=a(y.length),w=0,_=e?s(d,x):n?s(d,0):void 0;x>w;w++)if((h||w in y)&&(v=b(m=y[w],w,g),t))if(e)_[w]=v;else if(v)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:_.push(m)}else if(c)return!1;return u?-1:l||c?c:_}}},function(t,e,n){var i=n(215),r=n(229),o=n(230)("species");t.exports=function(t,e){var n;return r(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!r(n.prototype)||(n=void 0),i(n)&&(null===(n=n[o])&&(n=void 0))),new(void 0===n?Array:n)(e)}},[472,217],[444,231,210,203],[445,203],function(t,e,n){var i=n(222),r=n(226),o=n(225);t.exports=function(t){return function(e,n,a){var s,l=i(e),c=r(l.length),u=o(a,c);if(t&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u;return!t&&-1}}},[468,201,203,216,207,202,209,208,231,234,210,230,235,236,237,229,219,222,206,238],[443,201,216,230],[469,201,222],[470,222,201],[471,201],function(t,e){t.exports=!1},[481,202,240],[482,201,220,223,208],function(t,e,n){var i=n(202);i(i.S,"Object",{is:n(242)})},64,[467,202,244],[457,201,215,219,211],function(t,e,n){"use strict";var i=n(246),r={};r[n(230)("toStringTag")]="z",r+""!="[object z]"&&n(209)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},[450,217,230],[473,215,248],[466,202,204,208],function(t,e,n){var i=n(215);n(248)("seal",(function(t){return function(e){return t&&i(e)?t(e):e}}))},function(t,e,n){var i=n(215);n(248)("preventExtensions",(function(t){return function(e){return t&&i(e)?t(e):e}}))},function(t,e,n){var i=n(215);n(248)("isFrozen",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},function(t,e,n){var i=n(215);n(248)("isSealed",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},function(t,e,n){var i=n(215);n(248)("isExtensible",(function(t){return function(e){return!!i(e)&&(!t||t(e))}}))},[465,222,248],function(t,e,n){var i=n(220);n(248)("getPrototypeOf",(function(t){return function(e){return t(i(e))}}))},[476,220,248],function(t,e,n){n(248)("getOwnPropertyNames",(function(){return n(236).get}))},function(t,e,n){var i=n(201).setDesc,r=n(206),o=n(216),a=Function.prototype,s=/^\s*function ([^ (]*)/,l="name";l in a||n(207)&&i(a,l,{configurable:!0,get:function(){var t=(""+this).match(s),e=t?t[1]:"";return o(this,l)||i(this,l,r(5,e)),e}})},function(t,e,n){"use strict";var i=n(201),r=n(215),o=n(230)("hasInstance"),a=Function.prototype;o in a||i.setDesc(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i.getProto(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){"use strict";var i=n(201),r=n(203),o=n(216),a=n(217),s=n(261),l=n(208),c=n(262).trim,u="Number",h=r[u],d=h,f=h.prototype,p=a(i.create(f))==u,m="trim"in String.prototype,v=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,o=(e=m?e.trim():c(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var a,l=e.slice(2),u=0,h=l.length;h>u;u++)if(48>(a=l.charCodeAt(u))||a>r)return NaN;return parseInt(l,i)}}return+e};h(" 0o1")&&h("0b1")&&!h("+0x1")||(h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(p?l((function(){f.valueOf.call(n)})):a(n)!=u)?new d(v(e)):v(e)},i.each.call(n(207)?i.getNames(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),(function(t){o(d,t)&&!o(h,t)&&i.setDesc(h,t,i.getDesc(d,t))})),h.prototype=f,f.constructor=h,n(209)(r,u,h))},function(t,e,n){var i=n(215);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(202),r=n(221),o=n(208),a="\t\n\v\f\r \u2028\u2029\ufeff",s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(t,e){var n={};n[t]=e(h),i(i.P+i.F*o((function(){return!!a[t]()||""!=""[t]()})),"String",n)},h=u.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},function(t,e,n){var i=n(202);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(202),r=n(203).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var i=n(202);i(i.S,"Number",{isInteger:n(266)})},function(t,e,n){var i=n(215),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e,n){var i=n(202);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var i=n(202),r=n(266),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&o(t)<=9007199254740991}})},function(t,e,n){var i=n(202);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var i=n(202);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var i=n(202);i(i.S,"Number",{parseFloat:parseFloat})},function(t,e,n){var i=n(202);i(i.S,"Number",{parseInt:parseInt})},function(t,e,n){var i=n(202),r=n(274),o=Math.sqrt,a=Math.acosh;i(i.S+i.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+o(t-1)*o(t+1))}})},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&1e-8>t?t-t*t/2:Math.log(1+t)}},function(t,e,n){var i=n(202);i(i.S,"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?0>e?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var i=n(202);i(i.S,"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var i=n(202),r=n(278);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:0>t?-1:1}},function(t,e,n){var i=n(202);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var i=n(202),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},function(t,e,n){var i=n(202);i(i.S,"Math",{expm1:n(282)})},function(t,e){t.exports=Math.expm1||function(t){return 0==(t=+t)?t:t>-1e-6&&1e-6>t?t+t*t/2:Math.exp(t)-1}},function(t,e,n){var i=n(202),r=n(278),o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),c=o(2,-126);i(i.S,"Math",{fround:function(t){var e,n,i=Math.abs(t),o=r(t);return c>i?o*function(t){return t+1/a-1/a}(i/c/s)*c*s:(n=(e=(1+s/a)*i)-(e-i))>l||n!=n?o*(1/0):o*n}})},function(t,e,n){var i=n(202),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,o=0,a=0,s=arguments,l=s.length,c=0;l>a;)(n=r(s[a++]))>c?(o=o*(i=c/n)*i+1,c=n):n>0?o+=(i=n/c)*i:o+=n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(t,e,n){var i=n(202),r=Math.imul;i(i.S+i.F*n(208)((function(){return-5!=r(4294967295,5)||2!=r.length})),"Math",{imul:function(t,e){var n=65535,i=+t,r=+e,o=n&i,a=n&r;return 0|o*a+((n&i>>>16)*a+o*(n&r>>>16)<<16>>>0)}})},function(t,e,n){var i=n(202);i(i.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,e,n){var i=n(202);i(i.S,"Math",{log1p:n(274)})},function(t,e,n){var i=n(202);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var i=n(202);i(i.S,"Math",{sign:n(278)})},function(t,e,n){var i=n(202),r=n(282),o=Math.exp;i(i.S+i.F*n(208)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var i=n(202),r=n(282),o=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var i=n(202);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var i=n(202),r=n(225),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments,a=i.length,s=0;a>s;){if(e=+i[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(65536>e?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var i=n(202),r=n(222),o=n(226);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=o(e.length),i=arguments,a=i.length,s=[],l=0;n>l;)s.push(String(e[l++])),a>l&&s.push(String(i[l]));return s.join("")}})},function(t,e,n){"use strict";n(262)("trim",(function(t){return function(){return t(this,3)}}))},[436,297,298],[437,224,221],[438,238,202,209,205,216,299,300,234,201,230],40,[442,201,206,234,205,230],function(t,e,n){"use strict";var i=n(202),r=n(297)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(202),r=n(226),o=n(303),a="endsWith",s=""[a];i(i.P+i.F*n(305)(a),"String",{endsWith:function(t){var e=o(this,t,a),n=arguments,i=n.length>1?n[1]:void 0,l=r(e.length),c=void 0===i?l:Math.min(r(i),l),u=String(t);return s?s.call(e,u,c):e.slice(c-u.length,c)===u}})},function(t,e,n){var i=n(304),r=n(221);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},function(t,e,n){var i=n(215),r=n(217),o=n(230)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){var i=n(230)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){"use strict";var i=n(202),r=n(303),o="includes";i(i.P+i.F*n(305)(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(202);i(i.P,"String",{repeat:n(308)})},function(t,e,n){"use strict";var i=n(224),r=n(221);t.exports=function(t){var e=String(r(this)),n="",o=i(t);if(0>o||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){"use strict";var i=n(202),r=n(226),o=n(303),a="startsWith",s=""[a];i(i.P+i.F*n(305)(a),"String",{startsWith:function(t){var e=o(this,t,a),n=arguments,i=r(Math.min(n.length>1?n[1]:void 0,e.length)),l=String(t);return s?s.call(e,l,i):e.slice(i,i+l.length)===l}})},[474,211,202,220,311,312,226,313,314],[453,219],[454,299,230],[456,246,230,299,204],[464,230],function(t,e,n){"use strict";var i=n(202);i(i.S+i.F*n(208)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments,n=e.length,i=new("function"==typeof this?this:Array)(n);n>t;)i[t]=e[t++];return i.length=n,i}})},[446,317,318,299,222,298],function(t,e,n){var i=n(230)("unscopables"),r=Array.prototype;null==r[i]&&n(205)(r,i,{}),t.exports=function(t){r[i][t]=!0}},49,function(t,e,n){n(320)("Array")},function(t,e,n){"use strict";var i=n(203),r=n(201),o=n(207),a=n(230)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.setDesc(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(202);i(i.P,"Array",{copyWithin:n(322)}),n(317)("copyWithin")},function(t,e,n){"use strict";var i=n(220),r=n(225),o=n(226);t.exports=[].copyWithin||function(t,e){var n=i(this),a=o(n.length),s=r(t,a),l=r(e,a),c=arguments,u=c.length>2?c[2]:void 0,h=Math.min((void 0===u?a:r(u,a))-l,a-s),d=1;for(s>l&&l+h>s&&(d=-1,l+=h-1,s+=h-1);h-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(t,e,n){var i=n(202);i(i.P,"Array",{fill:n(324)}),n(317)("fill")},function(t,e,n){"use strict";var i=n(220),r=n(225),o=n(226);t.exports=[].fill||function(t){for(var e=i(this),n=o(e.length),a=arguments,s=a.length,l=r(s>1?a[1]:void 0,n),c=s>2?a[2]:void 0,u=void 0===c?n:r(c,n);u>l;)e[l++]=t;return e}},function(t,e,n){"use strict";var i=n(202),r=n(227)(5),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),i(i.P+i.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(317)(o)},function(t,e,n){"use strict";var i=n(202),r=n(227)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),i(i.P+i.F*a,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(317)(o)},function(t,e,n){var i=n(201),r=n(203),o=n(304),a=n(328),s=r.RegExp,l=s,c=s.prototype,u=/a/g,h=/a/g,d=new s(u)!==u;!n(207)||d&&!n(208)((function(){return h[n(230)("match")]=!1,s(u)!=u||s(h)==h||"/a/i"!=s(u,"i")}))||(s=function(t,e){var n=o(t),i=void 0===e;return this instanceof s||!n||t.constructor!==s||!i?d?new l(n&&!i?t.source:t,e):l((n=t instanceof s)?t.source:t,n&&i?a.call(t):e):t},i.each.call(i.getNames(l),(function(t){t in s||i.setDesc(s,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})})),c.constructor=s,s.prototype=c,n(209)(r,"RegExp",s)),n(320)("RegExp")},function(t,e,n){"use strict";var i=n(219);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(201);n(207)&&"g"!=/./g.flags&&i.setDesc(RegExp.prototype,"flags",{configurable:!0,get:n(328)})},function(t,e,n){n(331)("match",1,(function(t,e){return function(n){"use strict";var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))}}))},function(t,e,n){"use strict";var i=n(205),r=n(209),o=n(208),a=n(221),s=n(230);t.exports=function(t,e,n){var l=s(t),c=""[t];o((function(){var e={};return e[l]=function(){return 7},7!=""[t](e)}))&&(r(String.prototype,t,n(a,l,c)),i(RegExp.prototype,l,2==e?function(t,e){return c.call(t,this,e)}:function(t){return c.call(t,this)}))}},function(t,e,n){n(331)("replace",2,(function(t,e,n){return function(i,r){"use strict";var o=t(this),a=null==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}}))},function(t,e,n){n(331)("search",1,(function(t,e){return function(n){"use strict";var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))}}))},function(t,e,n){n(331)("split",2,(function(t,e,n){return function(i,r){"use strict";var o=t(this),a=null==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)}}))},[449,201,238,203,211,246,202,215,219,212,336,337,244,242,230,338,339,207,341,234,320,204,314],57,[452,211,311,312,219,226,313],[458,219,212,230],[459,203,340,217],[460,211,218,213,214,203,217],[463,209],[477,343,344],[478,201,205,341,211,336,221,337,298,318,210,216,215,320,207],function(t,e,n){"use strict";var i=n(203),r=n(202),o=n(209),a=n(341),s=n(337),l=n(336),c=n(215),u=n(208),h=n(314),d=n(234);t.exports=function(t,e,n,f,p,m){var v=i[t],g=v,y=p?"set":"add",b=g&&g.prototype,x={},w=function(t){var e=b[t];o(b,t,"delete"==t||"has"==t?function(t){return!(m&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof g&&(m||b.forEach&&!u((function(){(new g).entries().next()})))){var _,S=new g,M=S[y](m?{}:-0,1)!=S,C=u((function(){S.has(1)})),T=h((function(t){new g(t)}));T||(g=e((function(e,n){l(e,g,t);var i=new v;return null!=n&&s(n,p,i[y],i),i})),g.prototype=b,b.constructor=g),m||S.forEach((function(t,e){_=1/e==-1/0})),(C||_)&&(w("delete"),w("has"),p&&w("get")),(_||M)&&w(y),m&&b.clear&&delete b.clear}else g=f.getConstructor(e,t,p,y),a(g.prototype,n);return d(g,t),x[t]=g,r(r.G+r.W+r.F*(g!=v),x),m||f.setStrong(g,t,p),g}},function(t,e,n){"use strict";var i=n(343);n(344)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(this,t=0===t?0:t,t)}},i)},function(t,e,n){"use strict";var i=n(201),r=n(209),o=n(347),a=n(215),s=n(216),l=o.frozenStore,c=o.WEAK,u=Object.isExtensible||a,h={},d=n(344)("WeakMap",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){if(a(t)){if(!u(t))return l(this).get(t);if(s(t,c))return t[c][this._i]}},set:function(t,e){return o.def(this,t,e)}},o,!0,!0);7!=(new d).set((Object.freeze||Object)(h),7).get(h)&&i.each.call(["delete","has","get","set"],(function(t){var e=d.prototype,n=e[t];r(e,t,(function(e,i){if(a(e)&&!u(e)){var r=l(this)[t](e,i);return"set"==t?this:r}return n.call(this,e,i)}))}))},function(t,e,n){"use strict";var i=n(205),r=n(341),o=n(219),a=n(215),s=n(336),l=n(337),c=n(227),u=n(216),h=n(210)("weak"),d=Object.isExtensible||a,f=c(5),p=c(6),m=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},y=function(t,e){return f(t.a,(function(t){return t[0]===e}))};g.prototype={get:function(t){var e=y(this,t);return e?e[1]:void 0},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var o=t((function(t,r){s(t,o,e),t._i=m++,t._l=void 0,null!=r&&l(r,n,t[i],t)}));return r(o.prototype,{delete:function(t){return!!a(t)&&(d(t)?u(t,h)&&u(t[h],this._i)&&delete t[h][this._i]:v(this).delete(t))},has:function(t){return!!a(t)&&(d(t)?u(t,h)&&u(t[h],this._i):v(this).has(t))}}),o},def:function(t,e,n){return d(o(e))?(u(e,h)||i(e,h,{}),e[h][t._i]=n):v(t).set(e,n),t},frozenStore:v,WEAK:h}},function(t,e,n){"use strict";var i=n(347);n(344)("WeakSet",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(this,t,!0)}},i,!1,!0)},function(t,e,n){var i=n(202),r=Function.apply;i(i.S,"Reflect",{apply:function(t,e,n){return r.call(t,e,n)}})},function(t,e,n){var i=n(201),r=n(202),o=n(212),a=n(219),s=n(215),l=Function.bind||n(204).Function.prototype.bind;r(r.S+r.F*n(208)((function(){function t(){}return!(Reflect.construct((function(){}),[],t)instanceof t)})),"Reflect",{construct:function(t,e){o(t);var n=arguments.length<3?t:o(arguments[2]);if(t==n){if(null!=e)switch(a(e).length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(l.apply(t,r))}var c=n.prototype,u=i.create(s(c)?c:Object.prototype),h=Function.apply.call(t,u,e);return s(h)?h:u}})},function(t,e,n){var i=n(201),r=n(202),o=n(219);r(r.S+r.F*n(208)((function(){Reflect.defineProperty(i.setDesc({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,n){o(t);try{return i.setDesc(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var i=n(202),r=n(201).getDesc,o=n(219);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var i=n(202),r=n(219),o=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(300)(o,"Object",(function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}})),i(i.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var i=n(201),r=n(216),o=n(202),a=n(215),s=n(219);o(o.S,"Reflect",{get:function t(e,n){var o,l,c=arguments.length<3?e:arguments[2];return s(e)===c?e[n]:(o=i.getDesc(e,n))?r(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:a(l=i.getProto(e))?t(l,n,c):void 0}})},function(t,e,n){var i=n(201),r=n(202),o=n(219);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.getDesc(o(t),e)}})},function(t,e,n){var i=n(202),r=n(201).getProto,o=n(219);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(o(t))}})},function(t,e,n){var i=n(202);i(i.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var i=n(202),r=n(219),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),!o||o(t)}})},function(t,e,n){var i=n(202);i(i.S,"Reflect",{ownKeys:n(360)})},function(t,e,n){var i=n(201),r=n(219),o=n(203).Reflect;t.exports=o&&o.ownKeys||function(t){var e=i.getNames(r(t)),n=i.getSymbols;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(202),r=n(219),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var i=n(201),r=n(216),o=n(202),a=n(206),s=n(219),l=n(215);o(o.S,"Reflect",{set:function t(e,n,o){var c,u,h=arguments.length<4?e:arguments[3],d=i.getDesc(s(e),n);if(!d){if(l(u=i.getProto(e)))return t(u,n,o,h);d=a(0)}return r(d,"value")?!(!1===d.writable||!l(h))&&((c=i.getDesc(h,n)||a(0)).value=o,i.setDesc(h,n,c),!0):void 0!==d.set&&(d.set.call(h,o),!0)}})},function(t,e,n){var i=n(202),r=n(244);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var i=n(202),r=n(232)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(317)("includes")},function(t,e,n){"use strict";var i=n(202),r=n(297)(!0);i(i.P,"String",{at:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(202),r=n(367);i(i.P,"String",{padLeft:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){var i=n(226),r=n(308),o=n(221);t.exports=function(t,e,n,a){var s=String(o(t)),l=s.length,c=void 0===n?" ":String(n),u=i(e);if(l>=u)return s;""==c&&(c=" ");var h=u-l,d=r.call(c,Math.ceil(h/c.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},function(t,e,n){"use strict";var i=n(202),r=n(367);i(i.P,"String",{padRight:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(262)("trimLeft",(function(t){return function(){return t(this,1)}}))},function(t,e,n){"use strict";n(262)("trimRight",(function(t){return function(){return t(this,2)}}))},function(t,e,n){var i=n(202),r=n(372)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(t){return r(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){var i=n(201),r=n(202),o=n(360),a=n(222),s=n(206);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=a(t),l=i.setDesc,c=i.getDesc,u=o(r),h={},d=0;u.length>d;)n=c(r,e=u[d++]),e in h?l(h,e,s(0,n)):h[e]=n;return h}})},function(t,e,n){var i=n(202),r=n(375)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var i=n(201),r=n(222),o=i.isEnum;t.exports=function(t){return function(e){for(var n,a=r(e),s=i.getKeys(a),l=s.length,c=0,u=[];l>c;)o.call(a,n=s[c++])&&u.push(t?[n,a[n]]:a[n]);return u}}},function(t,e,n){var i=n(202),r=n(375)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},[479,202,378],[480,337,246],function(t,e,n){var i=n(202);i(i.P,"Set",{toJSON:n(378)("Set")})},function(t,e,n){var i=n(201),r=n(202),o=n(211),a=n(204).Array||Array,s={},l=function(t,e){i.each.call(t.split(","),(function(t){null==e&&t in a?s[t]=a[t]:t in[]&&(s[t]=o(Function.call,[][t],e))}))};l("pop,reverse,shift,keys,values,entries",1),l("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3),l("join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill"),r(r.S,"Array",s)},function(t,e,n){var i=n(203),r=n(202),o=n(218),a=n(382),s=i.navigator,l=!!s&&/MSIE .\./.test(s.userAgent),c=function(t){return l?function(e,n){return t(o(a,[].slice.call(arguments,2),"function"==typeof e?e:Function(e)),n)}:t};r(r.G+r.B+r.F*l,{setTimeout:c(i.setTimeout),setInterval:c(i.setInterval)})},function(t,e,n){"use strict";var i=n(383),r=n(218),o=n(212);t.exports=function(){for(var t=o(this),e=arguments.length,n=Array(e),a=0,s=i._,l=!1;e>a;)(n[a]=arguments[a++])===s&&(l=!0);return function(){var i,o=arguments,a=o.length,c=0,u=0;if(!l&&!a)return r(t,n,this);if(i=n.slice(),l)for(;e>c;c++)i[c]===s&&(i[c]=o[u++]);for(;a>u;)i.push(o[u++]);return r(t,i,this)}}},function(t,e,n){t.exports=n(203)},function(t,e,n){var i=n(202),r=n(340);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){n(316);var i=n(203),r=n(205),o=n(299),a=n(230)("iterator"),s=i.NodeList,l=i.HTMLCollection,c=s&&s.prototype,u=l&&l.prototype,h=o.NodeList=o.HTMLCollection=o.Array;c&&!c[a]&&r(c,a,h),u&&!u[a]&&r(u,a,h)},function(t,e,n){(function(e,n){!function(e){"use strict";function i(t,e,n,i){var r=Object.create((e||o).prototype),a=new p(i||[]);return r._invoke=h(t,n,a),r}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function o(){}function a(){}function s(){}function l(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function c(t){this.arg=t}function u(t){function e(e,n){var i=t[e](n),a=i.value;return a instanceof c?Promise.resolve(a.arg).then(r,o):Promise.resolve(a).then((function(t){return i.value=t,i}))}"object"==typeof n&&n.domain&&(e=n.domain.bind(e));var i,r=e.bind(t,"next"),o=e.bind(t,"throw");e.bind(t,"return"),this._invoke=function(t,n){function r(){return e(t,n)}return i=i?i.then(r,r):new Promise((function(t){t(r())}))}}function h(t,e,n){var i=_;return function(o,a){if(i===M)throw new Error("Generator is already running");if(i===C){if("throw"===o)throw a;return v()}for(;;){var s=n.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===g){n.delegate=null;var l=s.iterator.return;if(l)if("throw"===(c=r(l,s.iterator,a)).type){o="throw",a=c.arg;continue}if("return"===o)continue}var c;if("throw"===(c=r(s.iterator[o],s.iterator,a)).type){n.delegate=null,o="throw",a=c.arg;continue}if(o="next",a=g,!(u=c.arg).done)return i=S,u;n[s.resultName]=u.value,n.next=s.nextLoc,n.delegate=null}if("next"===o)n.sent=i===S?a:g;else if("throw"===o){if(i===_)throw i=C,a;n.dispatchException(a)&&(o="next",a=g)}else"return"===o&&n.abrupt("return",a);if(i=M,"normal"===(c=r(t,e,n)).type){i=n.done?C:S;var u={value:c.arg,done:n.done};if(c.arg!==T)return u;n.delegate&&"next"===o&&(a=g)}else"throw"===c.type&&(i=C,o="throw",a=c.arg)}}}function d(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(d,this),this.reset(!0)}function m(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(y.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=g,e.done=!0,e};return i.next=i}}return{next:v}}function v(){return{value:g,done:!0}}var g,y=Object.prototype.hasOwnProperty,b="function"==typeof Symbol&&Symbol.iterator||"@@iterator",x="object"==typeof t,w=e.regeneratorRuntime;if(w)x&&(t.exports=w);else{(w=e.regeneratorRuntime=x?t.exports:{}).wrap=i;var _="suspendedStart",S="suspendedYield",M="executing",C="completed",T={},E=s.prototype=o.prototype;a.prototype=E.constructor=s,s.constructor=a,a.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===a||"GeneratorFunction"===(e.displayName||e.name))},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):t.__proto__=s,t.prototype=Object.create(E),t},w.awrap=function(t){return new c(t)},l(u.prototype),w.async=function(t,e,n,r){var o=new u(i(t,e,n,r));return w.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},l(E),E[b]=function(){return this},E.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},w.values=m,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=g,this.done=!1,this.delegate=null,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=y.call(r,"catchLoc"),s=y.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&y.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?this.next=r.finallyLoc:this.complete(o),T},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),T}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;f(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:m(t),resultName:e,nextLoc:n},T}}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,function(){return this}(),n(387))},function(t,e){function n(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&i())}function i(){if(!h){var t=a(n);h=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,h=!1,s(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var a,s,l=t.exports={};!function(){try{a=setTimeout}catch(t){a=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(t){s=function(){throw new Error("clearTimeout is not defined")}}}();var c,u=[],h=!1,d=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new r(t,e)),1!==u.length||h||a(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=o,l.addListener=o,l.once=o,l.off=o,l.removeListener=o,l.removeAllListeners=o,l.emit=o,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(97).default,a=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var s=(a(n(128)),n(389)),l="#1A324E",c="#3B97A6",u="#42EDF8",h=o("Lights._disc"),d=o("Lights._elements"),f=o("Lights._hidden"),p=o("Lights._on"),m=o("Lights._elements"),v=function(){function t(e,n){var i=arguments.length<=2||void 0===arguments[2]?{degraded:!1}:arguments[2];r(this,t),this[h]=e,this[m]={root:n,lights:{main:{lights:n.querySelector(".lights__main-lights"),glows:n.querySelector(".lights__main-glows")},selector:{light:n.querySelector(".lights__selector-light"),glow:n.querySelector(".lights__selector-glow")}}},this._degradedAnimations=i.degraded,this[f]=!0,this[p]=!1,this[d]()}return i(t,[{key:d,value:function(){var t=this[m].lights.main.lights,e=this[m].lights.main.glows,n=this[m].lights.selector.light,i=this[m].lights.selector.glow;t.style.opacity=0,t.style.stroke=l,e.style.opacity=0,n.style.opacity=0,n.style.fill=l,i.style.opacity=0}},{key:"hidden",get:function(){return this[f]},set:function(t){if(t!==this[f]){var e=this[m].lights.main.lights,n=this[m].lights.selector.light;t?(e.style.opacity=0,n.style.opacity=0):(e.style.opacity=1,n.style.opacity=1),this[f]=t}}},{key:"on",get:function(){return this[p]},set:function(t){if(t!==this[p]){var e=this[m].lights.main.lights,n=this[m].lights.main.glows,i=this[m].lights.selector.light,r=this[m].lights.selector.glow,o=function(){e.style.stroke=u,n.style.opacity=1,i.style.fill=u,r.style.opacity=1},a=function(){e.style.stroke=l,n.style.opacity=0,i.style.fill=l,r.style.opacity=0},h=function(){e.style.stroke=c,n.style.opacity=1,i.style.fill=c,r.style.opacity=1};t?(h(),this._degradedAnimations?s.delay(50).then(o):s.delay(50).then(a).then((function(t){return s.delay(50)})).then(h).then((function(t){return s.delay(50)})).then(a).then((function(t){return s.delay(50)})).then(o)):a(),this[p]=t}}}]),t}();e.default=v,t.exports=e.default},function(t,e,n){"use strict";var i=n(19).default;Object.defineProperty(e,"__esModule",{value:!0});e.delay=function(t){return new i((function(e){return setTimeout(e,t)}))}},function(t,e){},,,function(t,e,n){"use strict";var i=n(93).default,r=n(96).default,o=n(19).default,a=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var s=a(n(128));n(394);var l=function(){function t(){var e=this;r(this,t),this._position={x:0,y:0};var n=document.createElement("section");n.classList.add("location-marker"),this._eventTarget=document.createDocumentFragment(),this._elements={root:n,link:document.createElement("a"),title:document.createElement("h1")},this._elements.link.href="#",this._elements.link.appendChild(this._elements.title),n.appendChild(this._elements.link),this._elements.root.style.display="none",this._hidden=!0,this._animationQueue=o.resolve(),this._elements.link.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e._eventTarget.dispatchEvent(new CustomEvent("marker:click"))}),!1),this._elements.link.addEventListener("mouseenter",(function(t){t.stopPropagation(),t.preventDefault(),e._eventTarget.dispatchEvent(new CustomEvent("marker:mouseenter"))}),!1),this._elements.link.addEventListener("mouseleave",(function(t){t.stopPropagation(),t.preventDefault(),e._eventTarget.dispatchEvent(new CustomEvent("marker:mouseleave"))}),!1)}return i(t,[{key:"_showMarker",value:function(){var t=this;return new o((function(e){(new s.default).tween({from:{opacity:0},to:{opacity:100},duration:150,start:function(){t._elements.root.style.opacity=0,t._elements.root.style.display="block"},step:function(e){var n=e.opacity;t._elements.root.style.opacity=n/100},finish:function(){e()}})}))}},{key:"_hideMarker",value:function(){var t=this;return new o((function(e){(new s.default).tween({from:{opacity:100},to:{opacity:0},duration:150,step:function(e){var n=e.opacity;t._elements.root.style.opacity=n/100},finish:function(){t._elements.root.style.opacity=0,t._elements.root.style.display="none",e()}})}))}},{key:"addEventListener",value:function(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return this._eventTarget.addEventListener(t,e,n)}},{key:"removeEventListener",value:function(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return this._eventTarget.removeEventListener(t,e,n)}},{key:"dispatchEvent",value:function(t){return this._eventTarget.dispatchEvent(t)}},{key:"position",set:function(t){this._position=t,this._elements.root.style.transform="translate("+this._position.x+"px, "+this._position.y+"px)"},get:function(){return this._position}},{key:"element",get:function(){return this._elements.root}},{key:"hidden",set:function(t){var e=this;t!==this._hidden&&(this._animationQueue=t?this._animationQueue.then((function(t){return e._hideMarker()})):this._animationQueue.then((function(t){return e._showMarker()})),this._hidden=t)},get:function(){return this._hidden}},{key:"title",set:function(t){this._elements.title.innerHTML=t,this._title=t},get:function(){return this._title}}]),t}();e.default=l,t.exports=e.default},390,,function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(19).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=c(n(76)),d=c(n(116)),f=c(n(142)),p=n(397),m=s("ui"),v=s("events"),g={SINGLE_STAR:"Single star",BINARY:"Binary"},y={B:"Bidirectional",U:"Unidirectional"},b={S:"Small",M:"Medium",L:"Large"},x=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"onShow",value:function(){var t=this;setTimeout((function(){return t.$el.addClass("sm-active")}))}},{key:"serializeData",value:function(){var t=h.default.pick(this._getInfo(),"designation","name","type","habitable","subtype","affiliation","description","info_url","jumpInfo","aggregated_size","fairchanceact","thumbnail","children"),e=t.type,n=f.default.SUB_TYPE_INFO[e]||{};if(t.type=(e||"").toLowerCase(),t.typeText=n.name,t.subtype=h.default.pick(t.subtype,"name"),t.habitable="1"===String(t.habitable),t.affiliation=(t.affiliation||[]).length?h.default.pick(t.affiliation[0],"name","code","color"):{},t.affiliation.code=(t.affiliation.code||"").toLowerCase(),t.description=(t.description||"").trim(),t.jumpInfo){var i=t.jumpInfo.raw;delete t.jumpInfo,t.subtype={name:y[i.direction]},t.size=b[i.size],t.description||(t.description=(i.extra.destination.raw.description||"").trim())}return this.model.api.selectedLocation.type===d.default.Types.STAR_SYSTEM&&(t.subtype={name:g[e]},t.type="star_system",t.typeText="Star System",t.size=Math.round(parseFloat(t.aggregated_size))+" AU",delete t.habitable),t.hasHabitability=h.default.has(t,"habitable"),t.protected="1"===t.fairchanceact,t.children&&(this._landingZones=t.landingZones=t.children.filter((function(t){return t.type===f.default.SUB_TYPES.LANDING_ZONE})),delete t.children),t}},{key:"_getInfo",value:function(){var t=this,e=this._locationInfo,n=this.model.get("currentAnimation"),i=this.model.api.selectedLocation;if(this._location=i,!e)if(n)n.then((function(){t._locationInfo=t.model.getLocationInfo(i),t.render()}));else try{e=this.model.getLocationInfo(i)}catch(t){console.error("get location info threw error even without animation",t)}return this._locationInfo=null,e&&e.raw}},{key:"onShowLandingZoneClick",value:function(t){t.preventDefault();var e=this.ui.showLandingZone.filter((function(e,n){return n===t.currentTarget})),n=e.parent().index(),i=this._landingZones[n];this._clearLandingZoneHighlight(),this.model.landingZoneHighlight(this._location,i);var r=this.ui.landingZoneInfo.filter((function(t){return t===n}));r.addClass("sm-active"),this.ui.allInfo.addClass("sm-lz-open")}},{key:"onBackLandingZoneClick",value:function(t){t.preventDefault(),this._clearLandingZoneHighlight(),this.ui.landingZoneInfo.removeClass("sm-active"),this.ui.allInfo.removeClass("sm-lz-open")}},{key:"_clearLandingZoneHighlight",value:function(){var t=this;this._landingZones&&this._location&&this._landingZones.map((function(e){return t.model.landingZoneClear(t._location,e)}))}},{key:"hide",value:function(){return this._clearLandingZoneHighlight(),this.$el.removeClass("sm-active"),new l((function(t){return setTimeout(t,500)}))}},{key:"template",get:function(){return p}},{key:"tagName",get:function(){return"article"}},{key:"className",get:function(){return"sm-disc-info"}},{key:"ui",get:function(){return this[m]=this[m]||{showLandingZone:".sm-show-lz",allInfo:".sm-all-info",landingZoneInfo:".sm-lz-info",backLandingZone:".sm-back-lz"}},set:function(t){this[m]=t}},{key:"events",get:function(){return this[v]=this[v]||{"click @ui.showLandingZone":"onShowLandingZoneClick","click @ui.backLandingZone":"onBackLandingZoneClick"}},set:function(t){this[v]=t}}]),e}(u.ItemView);e.default=x,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{if(o+='<h1>\n  <span class="sm-name">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"name")||i.contextOrFrameLookup(e,n,"designation"),t.opts.autoescape),o+="</span>\n  ",i.contextOrFrameLookup(e,n,"designation")&&i.contextOrFrameLookup(e,n,"name")&&(o+='\n    <span class="sm-designation">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"designation"),t.opts.autoescape),o+="</span>\n  "),o+='\n</h1>\n\n<ul class="sm-summary">\n  <li class="sm-type sm-type-',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"type"),t.opts.autoescape),o+='">\n    <strong>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"typeText"),t.opts.autoescape),o+="</strong>\n  </li>",i.contextOrFrameLookup(e,n,"hasHabitability")?(o+='<li class="sm-habitable">\n      <label>Habitable</label>\n      <strong>',o+=i.contextOrFrameLookup(e,n,"habitable")?"Yes":"No",o+="</strong>\n    </li>"):(o+='<li class="sm-size">\n      <label>Size</label>\n      <strong>\n        <span>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"size"),t.opts.autoescape),o+="</span>\n      </strong>\n    </li>"),o+='<li class="sm-subtype">\n    <label>Type</label>\n    <strong>',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subtype"),"name",t.opts.autoescape),t.opts.autoescape),o+="</strong>\n  </li>",i.memberLookup(i.contextOrFrameLookup(e,n,"affiliation"),"name",t.opts.autoescape)?(o+='<li class="sm-affiliation">\n      <label>Affiliation</label>\n      <strong class="sm-affiliation-',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"affiliation"),"code",t.opts.autoescape),t.opts.autoescape),o+='" style="color: ',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"affiliation"),"color",t.opts.autoescape),t.opts.autoescape),o+=';">\n        <span>',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"affiliation"),"name",t.opts.autoescape),t.opts.autoescape),o+="</span>\n      </strong>\n    </li>"):(o+='<li class="sm-size">\n      <label>Size</label>\n      <strong>\n        <span>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"size"),t.opts.autoescape),o+="</span>\n      </strong>\n    </li>"),o+='</ul>\n\n<div class="sm-all-info-container">\n  <div class="sm-all-info">\n    <div class="sm-object-info">',i.contextOrFrameLookup(e,n,"landingZones")&&i.memberLookup(i.contextOrFrameLookup(e,n,"landingZones"),"length",t.opts.autoescape)){o+='<div class="sm-lz-list">\n          <label>Landing zones: <span>',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"landingZones"),"length",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n\n          <ul>",n=n.push();var a=i.contextOrFrameLookup(e,n,"landingZones");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("lz",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+='<li><button class="sm-show-lz" type="button">',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape)||i.memberLookup(c,"designation",t.opts.autoescape),t.opts.autoescape),o+="</button></li>"}n=n.pop(),o+="\n          </ul>\n        </div>"}if(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(e,n,"thumbnail"),"images",t.opts.autoescape),"post",t.opts.autoescape)&&(o+='<div class="sm-image" style="background-image: url(\'',o+=i.suppressValue(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(e,n,"thumbnail"),"images",t.opts.autoescape),"post",t.opts.autoescape),t.opts.autoescape),o+="');\"></div>"),i.contextOrFrameLookup(e,n,"protected")&&(o+='<p class="sm-protected">Protected under the fair chance act</p>'),o+='<div class="sm-description">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"description"),t.opts.autoescape),o+="</div>\n    </div>",i.contextOrFrameLookup(e,n,"landingZones")){o+='<ul class="sm-lz-info-list">',n=n.push();var u=i.contextOrFrameLookup(e,n,"landingZones");if(u)for(var h=u.length,d=0;d<u.length;d++){var f=u[d];n.set("lz",f),n.set("loop.index",d+1),n.set("loop.index0",d),n.set("loop.revindex",h-d),n.set("loop.revindex0",h-d-1),n.set("loop.first",0===d),n.set("loop.last",d===h-1),n.set("loop.length",h),o+='<li class="sm-lz-info">\n            <button type="button" class="sm-back-lz">Back</button>\n\n            <article>\n              <header>\n                <h1>',o+=i.suppressValue(i.memberLookup(f,"name",t.opts.autoescape)||i.memberLookup(f,"designation",t.opts.autoescape),t.opts.autoescape),o+='</h1>\n                <p>Landing zone</p>\n              </header>\n              <div class="sm-description">',o+=i.suppressValue(i.memberLookup(f,"description",t.opts.autoescape),t.opts.autoescape),o+="</div>\n            </article>\n          </li>"}n=n.pop(),o+="\n      </ul>"}o+='</div>\n</div>\n\n<div class="sm-guide-container">\n  ',i.contextOrFrameLookup(e,n,"info_url")&&(o+='\n    <a href="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"info_url"),t.opts.autoescape),o+='" target="_blank" class="sm-guide">\n      <span>View Galactic Guide</span>\n    </a>\n  '),r(null,o+="\n</div>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{r(null,o+='<div id="sm-map-map-region"></div>\n<div id="sm-map-location-marker-region"></div>\n<div id="sm-map-disc-region"></div>\n<div id="sm-map-info-region"></div>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(400)),h=l(n(402)),d=l(n(404)),f=l(n(406)),p=l(n(413)),m=l(n(425)),v=l(n(146)),g=n(431),y=s("regions"),b={search:f.default,routes:p.default,bookmarks:m.default,display:{dependsOnSelection:!0,selection:{GALAXY:h.default,STAR_SYSTEM:d.default,CELESTIAL_OBJECT:d.default,JUMP_POINT:d.default}}},x=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.model.get("interface"),"change:tab",this.renderTab),this.listenTo(this.model,"change:location",this.renderTab)}return r(e,t),o(e,[{key:"onShow",value:function(){var t=this;this.tabs.show(new u.default({model:this.model})),v.default.bind("/",(function(e){e.preventDefault(),t.model.get("interface").set("tab","search")})),v.default.bind("r",(function(e){e.preventDefault(),t.model.get("interface").set("tab","routes")})),v.default.bind("d",(function(e){e.preventDefault(),t.model.get("interface").set("tab","display")})),v.default.bind("b",(function(e){e.preventDefault(),t.model.get("interface").set("tab","bookmarks")})),this.renderTab()}},{key:"renderTab",value:function(){var t=this.model.get("interface").get("tab"),e=b[t];e&&e.dependsOnSelection&&(e=e.selection[this.model.get("location").type]),e?this.tabContent.show(new e({model:this.model})):this.tabContent.empty()}},{key:"template",get:function(){return g}},{key:"tagName",get:function(){return"section"}},{key:"className",get:function(){return"sm-controls"}},{key:"regions",get:function(){return this[y]=this[y]||{tabs:"#sm-controls-tabs-region",tabContent:"#sm-controls-tab-content-region"},this[y]},set:function(t){this[y]=t}}]),e}(c.LayoutView);e.default=x,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(139).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=l(n(167)),u=l(n(111)),h=n(78),d=n(75),f=(l(n(116)),n(401)),p={search:"Search",bookmarks:"Bookmarks",routes:"Routes",display:"Display"},m=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.interface,"change:tab",this.render)}return r(e,t),o(e,[{key:"serializeData",value:function(){var t=this.interface.get("tab");return{tabs:s(c.default.TABS).map((function(e){var n=u.default.ROUTES[e],i=""+d.history.root+n;return n||(i=d.history.root.substring(0,d.history.root.length-1)),{url:i,name:p[e],active:t===e}}))}}},{key:"template",get:function(){return f}},{key:"tagName",get:function(){return"ul"}},{key:"className",get:function(){return"sm-tabs"}},{key:"interface",get:function(){return this.model.get("interface")}}]),e}(h.ItemView);e.default=m,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{n=n.push();var a=i.contextOrFrameLookup(e,n,"tabs");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("tab",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+="<li ",i.memberLookup(c,"active",t.opts.autoescape)&&(o+='class="sm-active"'),o+=">",o+='<a href="',o+=i.suppressValue(i.memberLookup(c,"url",t.opts.autoescape),t.opts.autoescape),o+='">\n      <span>',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+="</span>\n      ",o+="\n    </a>",o+="</li>"}n=n.pop(),r(null,o+="\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(78),c=n(403),u=s("ui"),h=s("events"),d={lifeforms:"Population",economy:"Economy",crime:"Threat"},f=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.model.get("affiliations"),"change:selected",this.onAffiliationSelectionChange),this.listenTo(this.model.get("routeSizes"),"change:selected",this.onRouteSizeSelectionChange),this.listenTo(this.model.get("scanners"),"change:selected",this.onScannerSelectionChange)}return r(e,t),o(e,[{key:"serializeData",value:function(){var t={affiliations:this.model.get("affiliations").map((function(t){var e=t.toJSON();return e.code=(e.code||"").toLowerCase(),e})),routeSizes:this.model.get("routeSizes").toJSON(),scanners:this.model.get("scanners").map((function(t){var e=t.toJSON();return e.name=d[e.type],e})),camera_views:[{name:"3D",selected:!this.model.get("camera2d"),value:!1},{name:"2D",selected:this.model.get("camera2d"),value:!0}]};return t}},{key:"onAffiliationSelectionChange",value:function(t,e){this.ui.affiliationItems.filter('[value="'+t.get("id")+'"]').prop("checked",e)}},{key:"onAffiliationClick",value:function(t){var e=t.currentTarget;this.model.get("soundFX").toggleButton(e.checked),this.model.get("affiliations").get(e.value).set("selected",e.checked)}},{key:"onRouteSizeSelectionChange",value:function(t,e){this.ui.routeSizeItems.filter('[value="'+t.get("size")+'"]').prop("checked",e)}},{key:"onRouteSizeClick",value:function(t){var e=t.currentTarget;this.model.get("soundFX").toggleButton(e.checked),this.model.get("routeSizes").get(e.value).set("selected",e.checked)}},{key:"onScannerSelectionChange",value:function(t,e){this.ui.scannerItems.filter('[value="'+t.get("type")+'"]').prop("checked",e)}},{key:"onScannerClick",value:function(t){var e=t.currentTarget,n=this.model.get("scanners"),i=n.findWhere({selected:!0}),r=i&&i.get("type")===e.value;i&&(i.set("selected",!1),r&&(e.checked=!1,this.model.get("soundFX").toggleButton(!1))),i&&r||(this.model.get("soundFX").toggleButton(e.checked),n.get(e.value).set("selected",e.checked))}},{key:"onCamera2dChange",value:function(t,e){this.ui.camera.filter('[value="'+e+'"]').prop("checked",!0)}},{key:"onCameraClick",value:function(t){var e=t.currentTarget;this.model.get("camera2d")!==("true"===e.value)&&this.model.get("soundFX").toggleButton(!0),this.model.set("camera2d","true"===e.value)}},{key:"modelEvents",get:function(){return{"change:camera2d":"onCamera2dChange"}}},{key:"template",get:function(){return c}},{key:"className",get:function(){return"sm-galaxy-display-tab"}},{key:"ui",get:function(){return this[u]=this[u]||{affiliationItems:'input[name="affiliations"]',routeSizeItems:'input[name="route_sizes"]',scannerItems:'input[name="scanners"]',camera:'input[name="camera_view"]'}},set:function(t){this[u]=t}},{key:"events",get:function(){return this[h]=this[h]||{"click @ui.affiliationItems":"onAffiliationClick","click @ui.routeSizeItems":"onRouteSizeClick","click @ui.scannerItems":"onScannerClick","click @ui.camera":"onCameraClick"}},set:function(t){this[h]=t}}]),e}(l.ItemView);e.default=f,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<div class="sm-affiliations">\n  <label>Factions</label>\n  <ul>\n    ',n=n.push();var a=i.contextOrFrameLookup(e,n,"affiliations");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("item",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+='<li>\n        <input\n          id="affiliation-',o+=i.suppressValue(i.memberLookup(c,"code",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="affiliations"\n          type="checkbox"\n          value="',o+=i.suppressValue(i.memberLookup(c,"id",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(c,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="affiliation-',o+=i.suppressValue(i.memberLookup(c,"code",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+='" style="color: ',o+=i.suppressValue(i.memberLookup(c,"color",t.opts.autoescape),t.opts.autoescape),o+=';"><span>',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-route-sizes">\n  <label>Jump tunnels</label>\n  <ul>\n    ',n=n.push();var u=i.contextOrFrameLookup(e,n,"routeSizes");if(u)for(var h=u.length,d=0;d<u.length;d++){var f=u[d];n.set("item",f),n.set("loop.index",d+1),n.set("loop.index0",d),n.set("loop.revindex",h-d),n.set("loop.revindex0",h-d-1),n.set("loop.first",0===d),n.set("loop.last",d===h-1),n.set("loop.length",h),o+='<li>\n        <input\n          id="route-size-',o+=i.suppressValue(i.memberLookup(f,"size",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="route_sizes"\n          type="checkbox"\n          value="',o+=i.suppressValue(i.memberLookup(f,"size",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(f,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="route-size-',o+=i.suppressValue(i.memberLookup(f,"size",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(f,"size",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(f,"size",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-scanners">\n  <label>Sensors</label>\n  <ul>\n    ',n=n.push();var p=i.contextOrFrameLookup(e,n,"scanners");if(p)for(var m=p.length,v=0;v<p.length;v++){var g=p[v];n.set("item",g),n.set("loop.index",v+1),n.set("loop.index0",v),n.set("loop.revindex",m-v),n.set("loop.revindex0",m-v-1),n.set("loop.first",0===v),n.set("loop.last",v===m-1),n.set("loop.length",m),o+='<li>\n        <input\n          id="sensor-',o+=i.suppressValue(i.memberLookup(g,"type",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="scanners"\n          type="radio"\n          value="',o+=i.suppressValue(i.memberLookup(g,"type",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(g,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="sensor-',o+=i.suppressValue(i.memberLookup(g,"type",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(g,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(g,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-camera-views">\n  <label>Camera</label>\n  <ul>\n    ',n=n.push();var y=i.contextOrFrameLookup(e,n,"camera_views");if(y)for(var b=y.length,x=0;x<y.length;x++){var w=y[x];n.set("item",w),n.set("loop.index",x+1),n.set("loop.index0",x),n.set("loop.revindex",b-x),n.set("loop.revindex0",b-x-1),n.set("loop.first",0===x),n.set("loop.last",x===b-1),n.set("loop.length",b),o+='<li>\n        <input\n          id="camera-view-',o+=i.suppressValue(i.memberLookup(w,"value",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="camera_view"\n          type="radio"\n          value="',o+=i.suppressValue(i.memberLookup(w,"value",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(w,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="camera-view-',o+=i.suppressValue(i.memberLookup(w,"value",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(w,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(w,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),r(null,o+="\n  </ul>\n</div>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(78),c=n(405),u=s("ui"),h=s("events"),d={lifeforms:"Population",economy:"Economy",crime:"Threat"},f=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.model.get("systemScanners"),"change:selected",this.onScannerSelectionChange)}return r(e,t),o(e,[{key:"serializeData",value:function(){var t={scanners:this.model.get("systemScanners").map((function(t){var e=t.toJSON();return e.name=d[e.type],e})),camera_views:[{name:"3D",selected:!this.model.get("camera2d"),value:!1},{name:"2D",selected:this.model.get("camera2d"),value:!0}]};return t}},{key:"onScannerSelectionChange",value:function(t,e){this.ui.scannerItems.filter('[value="'+t.get("type")+'"]').prop("checked",e)}},{key:"onScannerClick",value:function(t){var e=t.currentTarget,n=this.model.get("systemScanners"),i=n.findWhere({selected:!0}),r=i&&i.get("type")===e.value;i&&(i.set("selected",!1),r&&(e.checked=!1,this.model.get("soundFX").toggleButton(!1))),i&&r||(this.model.get("soundFX").toggleButton(e.checked),n.get(e.value).set("selected",e.checked))}},{key:"onCamera2dChange",value:function(t,e){this.ui.camera.filter('[value="'+e+'"]').prop("checked",!0)}},{key:"onCameraClick",value:function(t){var e=t.currentTarget;this.model.get("camera2d")!==("true"===e.value)&&this.model.get("soundFX").toggleButton(!0),this.model.set("camera2d","true"===e.value)}},{key:"modelEvents",get:function(){return{"change:camera2d":"onCamera2dChange"}}},{key:"template",get:function(){return c}},{key:"className",get:function(){return"sm-system-display-tab"}},{key:"ui",get:function(){return this[u]=this[u]||{scannerItems:'input[name="scanners"]',camera:'input[name="camera_view"]'}},set:function(t){this[u]=t}},{key:"events",get:function(){return this[h]=this[h]||{"click @ui.scannerItems":"onScannerClick","click @ui.camera":"onCameraClick"}},set:function(t){this[h]=t}}]),e}(l.ItemView);e.default=f,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<div class="sm-scanners">\n  <label>Sensors</label>\n  <ul>\n    ',n=n.push();var a=i.contextOrFrameLookup(e,n,"scanners");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("item",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+='<li>\n        <input\n          id="sensor-',o+=i.suppressValue(i.memberLookup(c,"type",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="scanners"\n          type="radio"\n          value="',o+=i.suppressValue(i.memberLookup(c,"type",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(c,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="sensor-',o+=i.suppressValue(i.memberLookup(c,"type",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-camera-views">\n  <label>Camera</label>\n  <ul>\n    ',n=n.push();var u=i.contextOrFrameLookup(e,n,"camera_views");if(u)for(var h=u.length,d=0;d<u.length;d++){var f=u[d];n.set("item",f),n.set("loop.index",d+1),n.set("loop.index0",d),n.set("loop.revindex",h-d),n.set("loop.revindex0",h-d-1),n.set("loop.first",0===d),n.set("loop.last",d===h-1),n.set("loop.length",h),o+='<li>\n        <input\n          id="camera-view-',o+=i.suppressValue(i.memberLookup(f,"value",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="camera_view"\n          type="radio"\n          value="',o+=i.suppressValue(i.memberLookup(f,"value",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(f,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="camera-view-',o+=i.suppressValue(i.memberLookup(f,"value",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(f,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(f,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),r(null,o+="\n  </ul>\n</div>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(407)),h=l(n(409)),d=n(75),f=(l(n(76)),n(411)),p=(l(f),n(116)),m=l(p),v=n(412),g=s("ui"),y=s("events"),b=function(t){function e(t){a(this,e);var n=t.model;t.model=t.model.get("interface"),t.collection=t.model.get("searchResults"),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._api=n._api,this._starmapApi=n,this.listenTo(this.collection,"request",this.onCollectionRequest),this.listenTo(this.collection,"sync",this.onCollectionSync),this.listenTo(this.collection,"update",this.onCollectionUpdate),this.on("childview:bookmark",this.onChildViewBookmark),this.on("childview:goto",this.onChildViewGoto)}return r(e,t),o(e,[{key:"isEmpty",value:function(){return this.collection.isLoading||0===this.collection.length}},{key:"onSubmit",value:function(t){t.preventDefault(),this._canSubmit()&&(this.model.get("searchFilters").set("query",this.ui.query.val()),this.isDirty=!1,this._updateListState())}},{key:"serializeData",value:function(){return this.model.get("searchFilters").toJSON()}},{key:"onShow",value:function(){this.ui.query.focus()}},{key:"onRender",value:function(){this._updateEnabled(),this._updateListState(),this.onCollectionUpdate()}},{key:"onChildViewGoto",value:function(t,e){var n=e.model,i=n.parent?"&system="+n.parent.get("code"):"";if(d.history.navigate("/?selection="+n.get("code")+i,{trigger:!0}),n.parent){var r="JUMPPOINT"===n.get("subType");this._starmapApi.goToLocation(new m.default(r?m.default.Types.JUMP_POINT:m.default.Types.CELESTIAL_OBJECT,n.get("system").get("code"),n.get("code")))}else this._starmapApi.goToLocation(new m.default(m.default.Types.STAR_SYSTEM,n.get("code")))}},{key:"onChildViewBookmark",value:function(t,e){var n=e.model;this.model.get("bookmarks").toggle(n)}},{key:"onCollectionRequest",value:function(){this.collection.trigger("reset")}},{key:"onCollectionSync",value:function(){this.collection.trigger("reset")}},{key:"onCollectionUpdate",value:function(){var t=1===this.collection.length?"item":"items",e=this.collection.length>0?this.collection.length+" "+t+" found":"";this.ui.count.text(e)}},{key:"_updateListState",value:function(){this.ui.list.toggleClass("sm-active",!this.isDirty&&this.model.get("searchFilters").hasQuery)}},{key:"_updateEnabled",value:function(){var t=this._canSubmit();this.ui.field.toggleClass("sm-active",t),this.ui.submit.prop("disabled",!t)}},{key:"_updateQueryState",value:function(){this.isDirty=this.ui.query.val()!==this.model.get("searchFilters").get("query"),this._updateEnabled(),this._updateListState()}},{key:"_canSubmit",value:function(){return this.ui.query.val().length>=3}},{key:"template",get:function(){return v}},{key:"childView",get:function(){return u.default}},{key:"childViewOptions",get:function(){return{bookmarks:this.model.get("bookmarks")}}},{key:"emptyView",get:function(){return h.default}},{key:"emptyViewOptions",get:function(){return{collection:this.collection}}},{key:"childViewContainer",get:function(){return"tbody"}},{key:"className",get:function(){return"sm-search-tab"}},{key:"ui",get:function(){return this[g]=this[g]||{list:".sm-list",field:".sm-field",query:'input[name="query"]',submit:"form button",form:"form.sm-search",count:".sm-count-label"}},set:function(t){this[g]=t}},{key:"events",get:function(){return this[y]=this[y]||{"input @ui.query":"_updateQueryState","submit @ui.form":"onSubmit"}},set:function(t){this[y]=t}}]),e}(c.CompositeView);e.default=b,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(142)),h=l(n(76)),d=n(408),f=s("ui"),p=s("triggers"),m=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.bookmarks=t.bookmarks,this.onBookmarksUpdate(),this.listenTo(this.bookmarks.fullCollection,"update",this.onBookmarksUpdate)}return r(e,t),o(e,[{key:"serializeData",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"serializeData",this).apply(this,n);o.bookmarked=this.bookmarked,o.type={key:o.type.toLowerCase(),name:u.default.TYPE_INFO[o.type].name};var a=u.default.SUB_TYPE_INFO[o.subType];return a&&(o.subType={key:o.subType.toLowerCase(),name:a.name}),o}},{key:"onBookmarksUpdate",value:function(){var t=this.bookmarked;this.bookmarked=!!this.bookmarks.findByObject(this.model),h.default.isUndefined(t)||t===this.bookmarked||this.render()}},{key:"template",get:function(){return d}},{key:"tagName",get:function(){return"tr"}},{key:"ui",get:function(){return this[f]=this[f]||{bookmark:".sm-bookmark",go:".sm-go"}},set:function(t){this[f]=t}},{key:"triggers",get:function(){return this[p]=this[p]||{"click @ui.bookmark":"bookmark","click @ui.go":"goto",click:"goto"}}}]),e}(c.ItemView);e.default=m,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td class="sm-name">\n  <strong>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"name")||i.contextOrFrameLookup(e,n,"designation"),t.opts.autoescape),o+="</strong>\n",o+="\n  ",i.contextOrFrameLookup(e,n,"system")&&(o+="\n    <em>in ",o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"system"),"name",t.opts.autoescape),t.opts.autoescape),o+="</em>\n  "),o+='\n</td>\n<td class="sm-type sm-type-',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subType"),"key",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"type"),"key",t.opts.autoescape),t.opts.autoescape),o+='">',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subType"),"name",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"type"),"name",t.opts.autoescape),t.opts.autoescape),o+='</td>\n<td class="sm-bookmark-container"><button class="sm-bookmark ',i.contextOrFrameLookup(e,n,"bookmarked")&&(o+="sm-active"),o+='" title="',o+=i.contextOrFrameLookup(e,n,"bookmarked")?"Remove bookmark":"Bookmark",o+='"><span>',o+=i.contextOrFrameLookup(e,n,"bookmarked")?"Remove bookmark":"Bookmark",r(null,o+='</span></button></td>\n<td class="sm-go-container"><button class="sm-go" title="Go"><span>Go</span></button></td>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default;Object.defineProperty(e,"__esModule",{value:!0});var s=n(78),l=n(410),c=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"serializeData",value:function(){return{loading:this.collection.isLoading}}},{key:"onRender",value:function(){this.$el.toggleClass("sm-is-loading",this.collection.isLoading)}},{key:"template",get:function(){return l}},{key:"tagName",get:function(){return"tr"}}]),e}(s.ItemView);e.default=c,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td colspan="4">\n  ',o+=i.contextOrFrameLookup(e,n,"loading")?"\n    Loading...\n  ":"\n    No objects found with filters.\n  ",r(null,o+="\n</td>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(96).default,a=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(t){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),e}(a(n(136)).default);e.default=s,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<section class="sm-list">\n  <div class="sm-table-container">\n    <table>\n      <thead>\n        <tr>\n          <th class="sm-name">Name</th>\n          <th class="sm-type">Type</th>\n          <th class="sm-bookmark-container"><span class="sm-count-label"></span></th>\n          <th class="sm-go-container"></th>\n        </tr>\n      </thead>\n      <tbody>\n      </tbody>\n    </table>\n  </div>\n</section>\n\n<form class="sm-search">\n  <div class="sm-field">\n    <label for="query">Search</label>\n\n    <div class="sm-input-container">\n      <input type="search" id="query" name="query" placeholder="" value="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"query"),t.opts.autoescape),r(null,o+='">\n    </div>\n\n    <button><span>Search</span></button>\n  </div>\n</form>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(139).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=c(n(414)),d=c(n(420)),f=c(n(174)),p=(c(n(76)),n(424)),m=s("ui"),v=s("regions"),g=s("events"),y=function(t){function e(t){a(this,e);var n=t.model;t.model=t.model.get("interface"),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._api=n,this.listenTo(this.model.get("routingFilters"),"change:shipSize",this.onChangeShipSize),this.listenTo(this.model.get("routingFilters").get("departure"),"change:object",this._updateUIState),this.listenTo(this.model.get("routingFilters").get("destination"),"change:object",this._updateUIState)}return r(e,t),o(e,[{key:"onShow",value:function(){var t=this.model.get("routingResults");this.list.show(new h.default({collection:t,model:this._api}));var e=this.model.get("routingFilters");this.departure.show(new d.default({key:"departure",label:"Departure",model:e.get("departure")})),this.destination.show(new d.default({key:"destination",label:"Destination",model:e.get("destination")})),this.onChangeShipSize()}},{key:"serializeData",value:function(){var t={shipSize:this.model.get("routingFilters").get("shipSize")};return t.sizes=l(f.default.SHIP_SIZES).map((function(t){return{key:t,name:f.default.SHIP_SIZES[t]}})),t}},{key:"onRender",value:function(){this._updateListState(),this._updateUIState()}},{key:"onSizeItemsClick",value:function(t){var e=this.model.get("routingFilters").get("shipSize");t.currentTarget.checked=e!==t.currentTarget.value,this._api.get("soundFX").toggleButton(!0),this.model.get("routingFilters").set("shipSize",t.currentTarget.value),this._updateUIState()}},{key:"onChangeShipSize",value:function(){var t=this.model.get("routingFilters").get("shipSize");this.ui.sizeItems.filter('[value="'+t+'"]').prop("checked",!0)}},{key:"onSubmit",value:function(t){t.preventDefault(),this.model.get("routingFilters").search(),this._updateListState(),this._updateUIState()}},{key:"_updateUIState",value:function(){var t=this.model.get("routingFilters").hasQuery;this.ui.button.prop("disabled",!t),this.ui.actions.toggleClass("sm-active",t)}},{key:"_updateListState",value:function(){this.ui.listRegion.toggleClass("sm-active",this.model.get("routingFilters").hasQuery)}},{key:"template",get:function(){return p}},{key:"className",get:function(){return"sm-routes-tab"}},{key:"ui",get:function(){return this[m]=this[m]||{listRegion:".sm-list-region",departureRegion:".sm-departure-region",destinationRegion:".sm-destination-region",sizeItems:'input[name="ship-size"]',form:"form.sm-routes",actions:".sm-actions",button:".sm-actions button"}},set:function(t){this[m]=t}},{key:"regions",get:function(){return this[v]=this[v]||{list:"@ui.listRegion",departure:"@ui.departureRegion",destination:"@ui.destinationRegion"},this[v]},set:function(t){this[v]=t}},{key:"events",get:function(){return this[g]=this[g]||{"click @ui.sizeItems":"onSizeItemsClick","submit @ui.form":"onSubmit"}},set:function(t){this[g]=t}}]),e}(u.LayoutView);e.default=y,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var l=n(78),c=s(n(415)),u=s(n(417)),h=(s(n(177)),n(419)),d=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.collection,"change:selectedSegment",this.onChangeSelectedSegment),this.listenTo(this.collection,"request",this.onCollectionRequest),this.listenTo(this.collection,"sync",this.onCollectionSync),this.on("childview:deselect",this.onChildViewDeselect),this.on("childview:select",this.onChildViewSelect)}return r(e,t),o(e,[{key:"isEmpty",value:function(){return this.collection.isLoading||0===this.collection.length}},{key:"onChangeSelectedSegment",value:function(t,e){e&&this.model.routingGoToSegment(e)}},{key:"onChildViewDeselect",value:function(t,e){e.model.set("selected",!1),this.model.routingHide(),this._updateSelectionState()}},{key:"onChildViewSelect",value:function(t,e){var n=e.model;this.collection.invoke("clearSelection"),this.model.routingShow(n.get("segments")),n.set("selected",!0),n.goToSegment(0),this._updateSelectionState()}},{key:"onRender",value:function(){this._updateSelectionState()}},{key:"onCollectionRequest",value:function(){this.collection.trigger("reset")}},{key:"onCollectionSync",value:function(){0===this.collection.length&&this.collection.trigger("reset")}},{key:"onCollectionRequest",value:function(){this.collection.trigger("reset")}},{key:"onCollectionSync",value:function(){0===this.collection.length&&this.collection.trigger("reset")}},{key:"_updateSelectionState",value:function(){this.$el.toggleClass("sm-has-selection",this.collection.where({selected:!0}).length>0)}},{key:"template",get:function(){return h}},{key:"childView",get:function(){return c.default}},{key:"emptyView",get:function(){return u.default}},{key:"emptyViewOptions",get:function(){return{collection:this.collection}}},{key:"childViewContainer",get:function(){return"tbody"}},{key:"className",get:function(){return"sm-table-container"}}]),e}(l.CompositeView);e.default=d,t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(139).default,c=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var u=n(78),h=(c(n(142)),n(76)),d=(c(h),n(416)),f=s("ui"),p=s("events"),m=s("triggers"),v=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.listenTo(this.model,"change",this.onModelChange)}return r(e,t),o(e,[{key:"serializeData",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"serializeData",this).apply(this,n);return o.shortestLabel=o.isShortest?"Yes":"No",o.leastJumpsLabel=o.isLeastJumps?"Yes":"No",o.flight_distance=Math.round(100*o.flight_distance)/100,o.segmentCount=this.model.flightSegments.length,o.currentSegment=this.model.flightSegments.indexOf(o.selectedSegment)+1,o}},{key:"onRender",value:function(){this._updateSelection()}},{key:"onModelChange",value:function(){var t=l(this.model.changed),e=-1!==t.indexOf("selected"),n=-1!==t.indexOf("selectedSegment");(e||n)&&this.render()}},{key:"onPreviousSegmentClick",value:function(){this.model.previousSegment()}},{key:"onNextSegmentClick",value:function(){this.model.nextSegment()}},{key:"_updateSelection",value:function(){this.$el.toggleClass("sm-active",this.model.get("selected"))}},{key:"template",get:function(){return d}},{key:"tagName",get:function(){return"tr"}},{key:"ui",get:function(){return this[f]=this[f]||{prevSegment:".sm-prev-segment",nextSegment:".sm-next-segment",select:".sm-select",deselect:".sm-deselect"}},set:function(t){this[f]=t}},{key:"events",get:function(){return this[p]=this[p]||{"click @ui.prevSegment":"onPreviousSegmentClick","click @ui.nextSegment":"onNextSegmentClick"}},set:function(t){this[p]=t}},{key:"triggers",get:function(){return this[m]=this[m]||{"click @ui.select":"select","click @ui.deselect":"deselect"}}}]),e}(u.ItemView);e.default=v,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td class="sm-label">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"label"),t.opts.autoescape),o+='</td>\n<td class="sm-jumps">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"jumps"),t.opts.autoescape),o+='</td>\n<td class="sm-distance">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"flight_distance"),t.opts.autoescape),o+=" AU</td>\n",o+="\n",o+='\n<td class="sm-selection">\n  ',o+=i.contextOrFrameLookup(e,n,"selected")?'\n    <button class="sm-deselect">\n      <span>Exit route</span>\n    </button>\n  ':'\n    <button class="sm-select">\n      <span>View route</span>\n    </button>\n  ',o+='\n</td>\n<td class="sm-navigation">\n  <button class="sm-prev-segment"',(!i.contextOrFrameLookup(e,n,"selected")||i.contextOrFrameLookup(e,n,"currentSegment")<2)&&(o+=" disabled"),o+='><span>Previous segment</span></button>\n  <label class="sm-current-segment">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"currentSegment"),t.opts.autoescape),o+='</label>\n  <label class="sm-segment-count">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"segmentCount"),t.opts.autoescape),o+='</label>\n  <button class="sm-next-segment"',i.contextOrFrameLookup(e,n,"selected")&&i.contextOrFrameLookup(e,n,"currentSegment")!=i.contextOrFrameLookup(e,n,"segmentCount")||(o+=" disabled"),r(null,o+="><span>Next segment</span></button>\n</td>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default;Object.defineProperty(e,"__esModule",{value:!0});var s=n(78),l=n(418),c=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"serializeData",value:function(){return{loading:this.collection.isLoading}}},{key:"onRender",value:function(){this.$el.toggleClass("sm-is-loading",this.collection.isLoading)}},{key:"template",get:function(){return l}},{key:"tagName",get:function(){return"tr"}}]),e}(s.ItemView);e.default=c,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td colspan="5">\n  ',o+=i.contextOrFrameLookup(e,n,"loading")?"\n    Loading...\n  ":"\n    No routes found with filters.\n  ",r(null,o+="\n</td>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<table>\n  <thead>\n    <tr>\n      <th class="sm-label">Route</th>\n      <th class="sm-jumps">Jumps</th>\n      <th class="sm-distance">Flight distance</th>\n      ',o+="\n      ",r(null,o+='\n      <th class="sm-selection">Show segment</th>\n      <th class="sm-navigation"></th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(421)),h=(l(n(142)),n(76)),d=l(h),f=n(423),p=s("ui"),m=s("modelEvents"),v=s("events"),g=function(t){function e(t){a(this,e),t.collection=t.model.get("results"),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.key=t.key,this.label=t.label,this.listenTo(this.model,"change:query",this._updateQuery),this.listenTo(this.model,"change:object",this._updateResultsState),this.listenTo(this.collection,"update",this._updateResultsState),this.on("childview:select",this.onChildViewSelect)}return r(e,t),o(e,[{key:"serializeData",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"serializeData",this).apply(this,n);return o.key=this.key,o.label=this.label,o}},{key:"onRender",value:function(){this._updateResultsState(),this.onObjectChange()}},{key:"onQueryKeyup",value:function(t){this.model.set("query",t.currentTarget.value)}},{key:"_updateQuery",value:function(){this.ui.query.val(this.model.get("query"))}},{key:"_updateResultsState",value:function(){var t=!!this.model.get("object");this.ui.field.toggleClass("sm-active",t),this.ui.resultsRegion.toggleClass("sm-position-top",this.collection.length>2),this.ui.resultsRegion.toggleClass("sm-active",!t)}},{key:"onChildViewSelect",value:function(t,e){var n=e.model;this.model.set("object",n)}},{key:"onObjectChange",value:function(){var t=this.model.get("object"),e=t?t.get("name")||t.get("designation"):"";this.model.set("query",e,{silent:!0}),this._updateQuery()}},{key:"template",get:function(){return f}},{key:"childView",get:function(){return u.default}},{key:"childViewContainer",get:function(){return"@ui.resultsRegion"}},{key:"ui",get:function(){return this[p]=this[p]||{field:".sm-field",query:'input[type="search"]',resultsRegion:".sm-results-region"}},set:function(t){this[p]=t}},{key:"events",get:function(){return this[v]=this[v]||{"keyup @ui.query":"onQueryKeyup"}},set:function(t){this[v]=t}},{key:"modelEvents",get:function(){return this[m]=this[m]||{"change:object":"onObjectChange"}},set:function(t){this[m]=t}}]),e}(c.CompositeView);e.default=g,g.prototype.onQueryKeyup=d.default.debounce(g.prototype.onQueryKeyup,300),t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(142)),h=(l(n(76)),n(422)),d=s("ui"),f=(s("events"),s("triggers")),p=function(t){function e(t){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return r(e,t),o(e,[{key:"serializeData",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"serializeData",this).apply(this,n);o.type={key:o.type,name:u.default.TYPE_INFO[o.type].name};var a=u.default.SUB_TYPE_INFO[o.subType];return a&&(o.subType={key:o.subType,name:a.name}),o}},{key:"template",get:function(){return h}},{key:"tagName",get:function(){return"li"}},{key:"ui",get:function(){return this[d]=this[d]||{button:"button"}},set:function(t){this[d]=t}},{key:"triggers",get:function(){return this[f]=this[f]||{"click @ui.button":"select"}}}]),e}(c.ItemView);e.default=p,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<button type="button">\n  <span>\n    <strong>',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"name")||i.contextOrFrameLookup(e,n,"designation"),t.opts.autoescape),o+="</strong>\n    ",i.contextOrFrameLookup(e,n,"subType")&&(o+="\n      <small>",o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subType"),"name",t.opts.autoescape),t.opts.autoescape),o+="</small>\n    "),o+="\n    ",i.contextOrFrameLookup(e,n,"system")&&(o+="\n      <em>in ",o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"system"),"name",t.opts.autoescape),t.opts.autoescape),o+="</em>\n    "),r(null,o+="\n  </span>\n</button>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<div class="sm-field">\n  <label for="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"key"),t.opts.autoescape),o+='-query">',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"label"),t.opts.autoescape),o+='</label>\n\n  <div class="sm-input-container">\n    <input type="search" id="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"key"),t.opts.autoescape),o+='-query" name="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"key"),t.opts.autoescape),o+='-query" placeholder="" value="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"query"),t.opts.autoescape),r(null,o+='">\n  </div>\n\n  <button type="button" class="sm-search-autocomplete"><span>Search</span></button>\n</div>\n\n<ul class="sm-results-region"></ul>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<section class="sm-list-region"></section>\n\n<form class="sm-routes">\n  <div class="sm-departure-region"></div>',o+='<div class="sm-destination-region"></div>',o+='<div class="sm-ship-size">\n    <label>Ship size</label>\n    <ul>\n      ',n=n.push();var a=i.contextOrFrameLookup(e,n,"sizes");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("item",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+='<li>\n          <input\n            id="size-',o+=i.suppressValue(i.memberLookup(c,"key",t.opts.autoescape),t.opts.autoescape),o+='"\n            name="ship-size"\n            type="radio"\n            value="',o+=i.suppressValue(i.memberLookup(c,"key",t.opts.autoescape),t.opts.autoescape),o+='"\n            ',i.memberLookup(c,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n            >\n          <label for="size-',o+=i.suppressValue(i.memberLookup(c,"key",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n        </li>"}n=n.pop(),o+="\n    </ul>\n  </div>",r(null,o+='<div class="sm-actions">\n    <button><span>Calculate</span></button>\n  </div>\n</form>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(426)),h=l(n(428)),d=n(75),f=l(n(76)),p=l(n(116)),m=n(430),v=s("ui"),g=s("events"),y=function(t){function e(t){a(this,e);var n=t.model;t.model=t.model.get("interface"),t.collection=t.model.get("bookmarks"),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._starmapApi=n,this._api=n._api,this.listenTo(this.model.get("bookmarkFilters").get("types"),"change:selected",this.onTypeSelectionChange),this.listenTo(this.collection,"reset update",this.onCollectionUpdate),this.on("childview:goto",this.onChildViewGoTo)}return r(e,t),o(e,[{key:"onShow",value:function(){this.ui.query.focus(),this.onCollectionUpdate()}},{key:"onTypeSelectionChange",value:function(t,e){this.ui.typeItems.filter('[value="'+t.get("key")+'"]').prop("checked",e)}},{key:"onTypeClick",value:function(t){var e=t.currentTarget;this._starmapApi.get("soundFX").toggleButton(e.checked),this.model.get("bookmarkFilters").get("types").get(e.value).set("selected",e.checked)}},{key:"onQueryKeyup",value:function(t){this.model.get("bookmarkFilters").set("query",t.currentTarget.value)}},{key:"serializeData",value:function(){var t=this.model.get("bookmarkFilters"),e=t.toJSON();return e.types=t.get("types").map((function(t){var e=t.toJSON();return e.lowerKey=(e.key||"").toLowerCase(),e})),e}},{key:"onChildViewGoTo",value:function(t,e){var n=e.model,i=n.parent?"&system="+n.parent.get("code"):"";if(d.history.navigate("/?selection="+n.get("code")+i,{trigger:!0}),n.get("parentCode")){var r="JUMPPOINT"===n.get("subType");this._starmapApi.goToLocation(new p.default(r?p.default.Types.JUMP_POINT:p.default.Types.CELESTIAL_OBJECT,n.get("parentCode"),n.get("code")))}else this._starmapApi.goToLocation(new p.default(p.default.Types.STAR_SYSTEM,n.get("code")))}},{key:"onCollectionUpdate",value:function(){var t=1===this.collection.length?"item":"items",e=this.collection.length>0?this.collection.length+" "+t+" found":"";this.ui.count.text(e)}},{key:"template",get:function(){return m}},{key:"childView",get:function(){return u.default}},{key:"emptyView",get:function(){return h.default}},{key:"emptyViewOptions",get:function(){return{model:this.model.get("bookmarkFilters")}}},{key:"childViewContainer",get:function(){return"tbody"}},{key:"className",get:function(){return"sm-bookmarks-tab"}},{key:"ui",get:function(){return this[v]=this[v]||{typeItems:'input[name="types"]',query:'input[name="query"]',count:".sm-count-label"}},set:function(t){this[v]=t}},{key:"events",get:function(){return this[g]=this[g]||{"click @ui.typeItems":"onTypeClick","keyup @ui.query":"onQueryKeyup"}},set:function(t){this[g]=t}}]),e}(c.CompositeView);e.default=y,y.prototype.onQueryKeyup=f.default.debounce(y.prototype.onQueryKeyup,300),t.exports=e.default},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default,s=n(97).default,l=n(74).default;Object.defineProperty(e,"__esModule",{value:!0});var c=n(78),u=l(n(142)),h=n(427),d=s("ui"),f=s("events"),p=s("triggers"),m=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"serializeData",value:function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=i(Object.getPrototypeOf(e.prototype),"serializeData",this).apply(this,n),a=o.celestialObject;a&&(o.system=a.system||a,o.object=a.system?a:null,o.object&&(o.object.type=a.subType)),o.type={key:o.type.bodyType.toLowerCase(),name:u.default.TYPE_INFO[o.type.bodyType].name};var s=o.object&&o.object.type,l=u.default.SUB_TYPE_INFO[s];return l&&(o.subType={key:s.toLowerCase(),name:l.name}),o}},{key:"onRemoveClick",value:function(t){t.stopPropagation(),this.model.destroy({wait:!0})}},{key:"template",get:function(){return h}},{key:"tagName",get:function(){return"tr"}},{key:"ui",get:function(){return this[d]=this[d]||{remove:".sm-remove",go:".sm-go"}},set:function(t){this[d]=t}},{key:"events",get:function(){return this[f]=this[f]||{"click @ui.remove":"onRemoveClick"}},set:function(t){this[f]=t}},{key:"triggers",get:function(){return this[p]=this[p]||{"click @ui.go":"goto",click:"goto"}}}]),e}(c.ItemView);e.default=m,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td class="sm-name">\n  <strong>',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"object"),"name",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"object"),"designation",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"system"),"name",t.opts.autoescape),t.opts.autoescape),o+="</strong>\n  ",i.contextOrFrameLookup(e,n,"object")&&(o+="\n    <em>in ",o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"system"),"name",t.opts.autoescape),t.opts.autoescape),o+="</em>\n  "),o+='\n</td>\n<td class="sm-type sm-type-',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subType"),"key",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"type"),"key",t.opts.autoescape),t.opts.autoescape),o+='">',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(e,n,"subType"),"name",t.opts.autoescape)||i.memberLookup(i.contextOrFrameLookup(e,n,"type"),"name",t.opts.autoescape),t.opts.autoescape),r(null,o+='</td>\n<td class="sm-bookmark-container"><button class="sm-remove"><span>Remove</span></button></td>\n<td class="sm-go-container"><button class="sm-go"><span>Go</span></button></td>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i=n(82).default,r=n(87).default,o=n(93).default,a=n(96).default;Object.defineProperty(e,"__esModule",{value:!0});var s=n(78),l=n(429),c=function(t){function e(){a(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),o(e,[{key:"serializeData",value:function(){return{filtered:this.model.isFilled}}},{key:"template",get:function(){return l}},{key:"tagName",get:function(){return"tr"}}]),e}(s.ItemView);e.default=c,t.exports=e.default},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<td colspan="4">\n  ',o+=i.contextOrFrameLookup(e,n,"filtered")?"\n    No bookmarks found with filters.\n  ":"\n    You have no bookmarks yet.\n  ",r(null,o+="\n</td>\n")}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{o+='<section class="sm-list sm-active">\n  <div class="sm-table-container">\n    <table>\n      <thead>\n        <tr>\n          <th class="sm-name">Name</th>\n          <th class="sm-type">Type</th>\n          <th class="sm-bookmark-container"><span class="sm-count-label"></span></th>\n          <th class="sm-go-container"></th>\n        </tr>\n      </thead>\n      <tbody>\n      </tbody>\n    </table>\n  </div>\n</section>\n\n<div class="sm-types">\n  <label>Filters</label>\n  <ul>\n    ',n=n.push();var a=i.contextOrFrameLookup(e,n,"types");if(a)for(var s=a.length,l=0;l<a.length;l++){var c=a[l];n.set("item",c),n.set("loop.index",l+1),n.set("loop.index0",l),n.set("loop.revindex",s-l),n.set("loop.revindex0",s-l-1),n.set("loop.first",0===l),n.set("loop.last",l===s-1),n.set("loop.length",s),o+='<li>\n        <input\n          id="type-',o+=i.suppressValue(i.memberLookup(c,"lowerKey",t.opts.autoescape),t.opts.autoescape),o+='"\n          name="types"\n          type="checkbox"\n          value="',o+=i.suppressValue(i.memberLookup(c,"key",t.opts.autoescape),t.opts.autoescape),o+='"\n          ',i.memberLookup(c,"selected",t.opts.autoescape)&&(o+="checked"),o+='\n          >\n        <label for="type-',o+=i.suppressValue(i.memberLookup(c,"lowerKey",t.opts.autoescape),t.opts.autoescape),o+='" title="',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+='"><span>',o+=i.suppressValue(i.memberLookup(c,"name",t.opts.autoescape),t.opts.autoescape),o+="</span></label>\n      </li>"}n=n.pop(),o+='\n  </ul>\n</div>\n\n<div class="sm-search">\n  <label for="bookmark-query">Search</label>\n\n  <div class="sm-input-container">\n    <input type="search" id="bookmark-query" name="query" placeholder="" value="',o+=i.suppressValue(i.contextOrFrameLookup(e,n,"query"),t.opts.autoescape),r(null,o+='">\n  </div>\n\n  <button><span>Search</span></button>\n</div>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){var i=n(108),r=i.webpackDependencies||(i.webpackDependencies={}),o=new i.Environment([],{autoescape:!0}),a=(n(109)(o),n(110)),s={root:function(t,e,n,i,r){var o="";try{r(null,o+='<div id="sm-controls-tabs-region"></div>\n\n<div id="sm-controls-tab-content-region"></div>\n\n<a class="sm-website" href="/">Back to RSI website</a>\n')}catch(t){r(i.handleError(t,null,null))}}};t.exports=a(i,o,s,r)},function(t,e,n){"use strict";var i={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},addGetWebGLMessage:function(t){var e,n,r;e=void 0!==(t=t||{}).parent?t.parent:document.body,n=void 0!==t.id?t.id:"oldie",(r=i.getWebGLErrorMessage()).id=n,e.appendChild(r)}};t.exports=i},390,,function(t,e){try{new window.CustomEvent("test")}catch(t){var n=function(t,e){var n;return e=e||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};n.prototype=window.Event.prototype,window.CustomEvent=n}},function(t,e,n,i,r){"use strict";var o=n(i)(!0);n(r)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=o(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n,i,r){var o=n(i),a=n(r);t.exports=function(t){return function(e,n){var i,r,s=String(a(e)),l=o(n),c=s.length;return 0>l||l>=c?t?"":void 0:55296>(i=s.charCodeAt(l))||i>56319||l+1===c||(r=s.charCodeAt(l+1))<56320||r>57343?t?s.charAt(l):i:t?s.slice(l,l+2):r-56320+(i-55296<<10)+65536}}},function(t,e,n,i,r,o,a,s,l,c,u,h,d){"use strict";var f=n(i),p=n(r),m=n(o),v=n(a),g=n(s),y=n(l),b=n(c),x=n(u),w=n(h).getProto,_=n(d)("iterator"),S=!([].keys&&"next"in[].keys()),M="@@iterator",C="keys",T="values",E=function(){return this};t.exports=function(t,e,n,i,r,o,a){b(n,e,i);var s,l,c=function(t){if(!S&&t in k)return k[t];switch(t){case C:case T:return function(){return new n(this,t)}}return function(){return new n(this,t)}},u=e+" Iterator",h=r==T,d=!1,k=t.prototype,A=k[_]||k[M]||r&&k[r],P=A||c(r);if(A){var L=w(P.call(new t));x(L,u,!0),!f&&g(k,M)&&v(L,_,E),h&&A.name!==T&&(d=!0,P=function(){return A.call(this)})}if(f&&!a||!S&&!d&&k[_]||v(k,_,P),y[e]=P,y[u]=E,r)if(s={values:h?P:c(T),keys:o?P:c(C),entries:h?c("entries"):P},a)for(l in s)l in k||m(k,l,s[l]);else p(p.P+p.F*(S||d),e,s);return s}},function(t,e,n,i){var r=n(i);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n,i,r,o){var a=n(i),s=n(r);t.exports=n(o)?function(t,e,n){return a.setDesc(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n,i){t.exports=!n(i)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n,i,r,o,a,s){"use strict";var l=n(i),c=n(r),u=n(o),h={};n(a)(h,n(s)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=l.create(h,{next:c(1,n)}),u(t,e+" Iterator")}},function(t,e,n,i,r,o){var a=n(i).setDesc,s=n(r),l=n(o)("toStringTag");t.exports=function(t,e,n){t&&!s(t=n?t:t.prototype,l)&&a(t,l,{configurable:!0,value:e})}},function(t,e,n,i,r,o){var a=n(i)("wks"),s=n(r),l=n(o).Symbol;t.exports=function(t){return a[t]||(a[t]=l&&l[t]||(l||s)("Symbol."+t))}},function(t,e,n,i){var r=n(i),o="__core-js_shared__",a=r[o]||(r[o]={});t.exports=function(t){return a[t]||(a[t]={})}},function(t,e,n,i,r,o,a,s){"use strict";var l=n(i),c=n(r),u=n(o),h=n(a);t.exports=n(s)(Array,"Array",(function(t,e){this._t=h(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,c(1)):c(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),u.Arguments=u.Array,l("keys"),l("values"),l("entries")},function(t,e,n,i,r){var o=n(i),a=n(r);t.exports=function(t){return o(a(t))}},function(t,e,n,i){var r=n(i);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n,i,r,o,a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w,_,S,M){"use strict";var C,T=n(i),E=n(r),k=n(o),A=n(a),P=n(s),L=n(l),O=n(c),R=n(u),F=n(h),B=n(d),D=n(f),I=n(p).set,N=n(m),j=n(v)("species"),V=n(g),z=n(y),U="Promise",H=k.process,G="process"==P(H),W=k[U],q=function(t){var e=new W((function(){}));return t&&(e.constructor=Object),W.resolve(e)===e},X=function(){function t(e){var n=new W(e);return I(n,t.prototype),n}var e=!1;try{if(e=W&&W.resolve&&q(),I(t,W),t.prototype=T.create(W.prototype,{constructor:{value:t}}),t.resolve(5).then((function(){}))instanceof t||(e=!1),e&&n(b)){var i=!1;W.resolve(T.setDesc({},"then",{get:function(){i=!0}})),e=i}}catch(t){e=!1}return e}(),Y=function(t){var e=R(t)[j];return null!=e?e:t},J=function(t){var e;return!(!O(t)||"function"!=typeof(e=t.then))&&e},Z=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=F(e),this.reject=F(n)},Q=function(t){try{t()}catch(t){return{error:t}}},K=function(t,e){if(!t.n){t.n=!0;var n=t.c;z((function(){for(var i=t.v,r=1==t.s,o=0,a=function(e){var n,o,a=r?e.ok:e.fail,s=e.resolve,l=e.reject;try{a?(r||(t.h=!0),(n=!0===a?i:a(i))===e.promise?l(TypeError("Promise-chain cycle")):(o=J(n))?o.call(n,s,l):s(n)):l(i)}catch(t){l(t)}};n.length>o;)a(n[o++]);n.length=0,t.n=!1,e&&setTimeout((function(){var e,n,r=t.p;$(r)&&(G?H.emit("unhandledRejection",i,r):(e=k.onunhandledrejection)?e({promise:r,reason:i}):(n=k.console)&&n.error&&n.error("Unhandled promise rejection",i)),t.a=void 0}),1)}))}},$=function(t){var e,n=t._d,i=n.a||n.c,r=0;if(n.h)return!1;for(;i.length>r;)if((e=i[r++]).fail||!$(e.promise))return!1;return!0},tt=function(t){var e=this;e.d||(e.d=!0,(e=e.r||e).v=t,e.s=2,e.a=e.c.slice(),K(e,!0))},et=function(t){var e,n=this;if(!n.d){n.d=!0,n=n.r||n;try{if(n.p===t)throw TypeError("Promise can't be resolved itself");(e=J(t))?z((function(){var i={r:n,d:!1};try{e.call(t,A(et,i,1),A(tt,i,1))}catch(t){tt.call(i,t)}})):(n.v=t,n.s=1,K(n,!1))}catch(t){tt.call({r:n,d:!1},t)}}};X||(W=function(t){F(t);var e=this._d={p:B(this,W,U),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{t(A(et,e,1),A(tt,e,1))}catch(t){tt.call(e,t)}},n(x)(W.prototype,{then:function(t,e){var n=new Z(V(this,W)),i=n.promise,r=this._d;return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,r.c.push(n),r.a&&r.a.push(n),r.s&&K(r,!1),i},catch:function(t){return this.then(void 0,t)}})),L(L.G+L.W+L.F*!X,{Promise:W}),n(w)(W,U),n(_)(U),C=n(S)[U],L(L.S+L.F*!X,U,{reject:function(t){var e=new Z(this);return(0,e.reject)(t),e.promise}}),L(L.S+L.F*(!X||q(!0)),U,{resolve:function(t){if(t instanceof W&&function(t,e){return!(!E||t!==W||e!==C)||N(t,e)}(t.constructor,this))return t;var e=new Z(this);return(0,e.resolve)(t),e.promise}}),L(L.S+L.F*!(X&&n(M)((function(t){W.all(t).catch((function(){}))}))),U,{all:function(t){var e=Y(this),n=new Z(e),i=n.resolve,r=n.reject,o=[],a=Q((function(){D(t,!1,o.push,o);var n=o.length,a=Array(n);n?T.each.call(o,(function(t,o){var s=!1;e.resolve(t).then((function(t){s||(s=!0,a[o]=t,--n||i(a))}),r)})):i(a)}));return a&&r(a.error),n.promise},race:function(t){var e=Y(this),n=new Z(e),i=n.reject,r=Q((function(){D(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r&&i(r.error),n.promise}})},function(t,e,n,i,r){var o=n(i),a=n(r)("toStringTag"),s="Arguments"==o(function(){return arguments}());t.exports=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=(e=Object(t))[a])?n:s?o(e):"Object"==(i=o(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,n,i){var r=n(i);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n,i,r,o,a,s,l){var c=n(i),u=n(r),h=n(o),d=n(a),f=n(s),p=n(l);t.exports=function(t,e,n,i){var r,o,a,s=p(t),l=c(n,i,e?2:1),m=0;if("function"!=typeof s)throw TypeError(t+" is not iterable!");if(h(s))for(r=f(t.length);r>m;m++)e?l(d(o=t[m])[0],o[1]):l(t[m]);else for(a=s.call(t);!(o=a.next()).done;)u(a,l,o.value,e)}},function(t,e,n,i){var r=n(i);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n,i,r){var o=n(i),a=n(r)("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||s[a]===t)}},function(t,e,n,i){var r=n(i),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n,i,r,o,a){var s=n(i),l=n(r)("iterator"),c=n(o);t.exports=n(a).getIteratorMethod=function(t){return null!=t?t[l]||t["@@iterator"]||c[s(t)]:void 0}},function(t,e,n,i,r,o,a){var s=n(i).getDesc,l=n(r),c=n(o),u=function(t,e){if(c(t),!l(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(a)(Function.call,s(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return u(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:u}},function(t,e,n,i,r,o){var a=n(i),s=n(r),l=n(o)("species");t.exports=function(t,e){var n,i=a(t).constructor;return void 0===i||null==(n=a(i)[l])?e:s(n)}},function(t,e,n,i,r,o){var a,s,l,c=n(i),u=n(r).set,h=c.MutationObserver||c.WebKitMutationObserver,d=c.process,f=c.Promise,p="process"==n(o)(d),m=function(){var t,e,n;for(p&&(t=d.domain)&&(d.domain=null,t.exit());a;)e=a.domain,n=a.fn,e&&e.enter(),n(),e&&e.exit(),a=a.next;s=void 0,t&&t.enter()};if(p)l=function(){d.nextTick(m)};else if(h){var v=1,g=document.createTextNode("");new h(m).observe(g,{characterData:!0}),l=function(){g.data=v=-v}}else l=f&&f.resolve?function(){f.resolve().then(m)}:function(){u.call(c,m)};t.exports=function(t){var e={fn:t,next:void 0,domain:p&&d.domain};s&&(s.next=e),a||(a=e,l()),s=e}},function(t,e,n,i,r,o,a,s,l){var c,u,h,d=n(i),f=n(r),p=n(o),m=n(a),v=n(s),g=v.process,y=v.setImmediate,b=v.clearImmediate,x=v.MessageChannel,w=0,_={},S="onreadystatechange",M=function(){var t=+this;if(_.hasOwnProperty(t)){var e=_[t];delete _[t],e()}},C=function(t){M.call(t.data)};y&&b||(y=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return _[++w]=function(){f("function"==typeof t?t:Function(t),e)},c(w),w},b=function(t){delete _[t]},"process"==n(l)(g)?c=function(t){g.nextTick(d(M,t,1))}:x?(h=(u=new x).port2,u.port1.onmessage=C,c=d(h.postMessage,h,1)):v.addEventListener&&"function"==typeof postMessage&&!v.importScripts?(c=function(t){v.postMessage(t+"","*")},v.addEventListener("message",C,!1)):c=S in m("script")?function(t){p.appendChild(m("script"))[S]=function(){p.removeChild(this),M.call(t)}}:function(t){setTimeout(d(M,t,1),0)}),t.exports={set:y,clear:b}},function(t,e,n,i){t.exports=n(i).document&&document.documentElement},function(t,e,n,i,r){var o=n(i),a=n(r).document,s=o(a)&&o(a.createElement);t.exports=function(t){return s?a.createElement(t):{}}},function(t,e,n,i){var r=n(i);t.exports=function(t,e){for(var n in e)r(t,n,e[n]);return t}},function(t,e,n,i){var r=n(i)("iterator"),o=!1;try{var a=[7][r]();a.return=function(){o=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){n=!0},i[r]=function(){return a},t(i)}catch(t){}return n}},function(t,e,n,i,r){var o=n(i);n(r)("getOwnPropertyDescriptor",(function(t){return function(e,n){return t(o(e),n)}}))},function(t,e,n,i,r,o){var a=n(i),s=n(r),l=n(o);t.exports=function(t,e){var n=(s.Object||{})[t]||Object[t],i={};i[t]=e(n),a(a.S+a.F*l((function(){n(1)})),"Object",i)}},function(t,e,n,i,r){var o=n(i);o(o.S,"Object",{setPrototypeOf:n(r).set})},function(t,e,n,i,r,o,a,s,l,c,u,h,d,f,p,m,v,g,y,b,x,w){"use strict";var _=n(i),S=n(r),M=n(o),C=n(a),T=n(s),E=n(l),k=n(c),A=n(u),P=n(h),L=n(d),O=n(f),R=n(p),F=n(m),B=n(v),D=n(g),I=n(y),N=n(b),j=n(x),V=_.getDesc,z=_.setDesc,U=_.create,H=F.get,G=S.Symbol,W=S.JSON,q=W&&W.stringify,X=!1,Y=O("_hidden"),J=_.isEnum,Z=A("symbol-registry"),Q=A("symbols"),K="function"==typeof G,$=Object.prototype,tt=C&&k((function(){return 7!=U(z({},"a",{get:function(){return z(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=V($,e);i&&delete $[e],z(t,e,n),i&&t!==$&&z($,e,i)}:z,et=function(t){var e=Q[t]=U(G.prototype);return e._k=t,C&&X&&tt($,t,{configurable:!0,set:function(e){M(this,Y)&&M(this[Y],t)&&(this[Y][t]=!1),tt(this,t,j(1,e))}}),e},nt=function(t){return"symbol"==typeof t},it=function(t,e,n){return n&&M(Q,e)?(n.enumerable?(M(t,Y)&&t[Y][e]&&(t[Y][e]=!1),n=U(n,{enumerable:j(0,!1)})):(M(t,Y)||z(t,Y,j(1,{})),t[Y][e]=!0),tt(t,e,n)):z(t,e,n)},rt=function(t,e){I(t);for(var n,i=B(e=N(e)),r=0,o=i.length;o>r;)it(t,n=i[r++],e[n]);return t},ot=function(t,e){return void 0===e?U(t):rt(U(t),e)},at=function(t){var e=J.call(this,t);return!(e||!M(this,t)||!M(Q,t)||M(this,Y)&&this[Y][t])||e},st=function(t,e){var n=V(t=N(t),e);return!n||!M(Q,e)||M(t,Y)&&t[Y][e]||(n.enumerable=!0),n},lt=function(t){for(var e,n=H(N(t)),i=[],r=0;n.length>r;)M(Q,e=n[r++])||e==Y||i.push(e);return i},ct=function(t){for(var e,n=H(N(t)),i=[],r=0;n.length>r;)M(Q,e=n[r++])&&i.push(Q[e]);return i},ut=k((function(){var t=G();return"[null]"!=q([t])||"{}"!=q({a:t})||"{}"!=q(Object(t))}));K||(G=function(){if(nt(this))throw TypeError("Symbol is not a constructor");return et(L(arguments.length>0?arguments[0]:void 0))},E(G.prototype,"toString",(function(){return this._k})),nt=function(t){return t instanceof G},_.create=ot,_.isEnum=at,_.getDesc=st,_.setDesc=it,_.setDescs=rt,_.getNames=F.get=lt,_.getSymbols=ct,C&&!n(w)&&E($,"propertyIsEnumerable",at,!0));var ht={for:function(t){return M(Z,t+="")?Z[t]:Z[t]=G(t)},keyFor:function(t){return R(Z,t)},useSetter:function(){X=!0},useSimple:function(){X=!1}};_.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),(function(t){var e=O(t);ht[t]=K?e:et(e)})),X=!0,T(T.G+T.W,{Symbol:G}),T(T.S,"Symbol",ht),T(T.S+T.F*!K,"Object",{create:ot,defineProperty:it,defineProperties:rt,getOwnPropertyDescriptor:st,getOwnPropertyNames:lt,getOwnPropertySymbols:ct}),W&&T(T.S+T.F*(!K||ut),"JSON",{stringify:function(t){if(void 0!==t&&!nt(t)){for(var e,n,i=[t],r=1,o=arguments;o.length>r;)i.push(o[r++]);return"function"==typeof(e=i[1])&&(n=e),(n||!D(e))&&(e=function(t,e){return n&&(e=n.call(this,t,e)),nt(e)?void 0:e}),i[1]=e,q.apply(W,i)}}}),P(G,"Symbol"),P(Math,"Math",!0),P(S.JSON,"JSON",!0)},function(t,e,n,i,r){var o=n(i),a=n(r);t.exports=function(t,e){for(var n,i=a(t),r=o.getKeys(i),s=r.length,l=0;s>l;)if(i[n=r[l++]]===e)return n}},function(t,e,n,i,r){var o=n(i),a=n(r).getNames,s={}.toString,l="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.get=function(t){return l&&"[object Window]"==s.call(t)?function(t){try{return a(t)}catch(t){return l.slice()}}(t):a(o(t))}},function(t,e,n,i){var r=n(i);t.exports=function(t){var e=r.getKeys(t),n=r.getSymbols;if(n)for(var i,o=n(t),a=r.isEnum,s=0;o.length>s;)a.call(t,i=o[s++])&&e.push(i);return e}},function(t,e,n,i){var r=n(i);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n,i,r){var o=n(i);n(r)("freeze",(function(t){return function(e){return t&&o(e)?t(e):e}}))},function(t,e,n,i,r,o,a,s,l,c,u){"use strict";var h=n(i),d=n(r),f=n(o),p=n(a),m=n(s),v=n(l),g=n(c);d(d.S+d.F*!n(u)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,r,o=f(t),a="function"==typeof this?this:Array,s=arguments,l=s.length,c=l>1?s[1]:void 0,u=void 0!==c,d=0,y=g(o);if(u&&(c=h(c,l>2?s[2]:void 0,2)),null==y||a==Array&&m(y))for(n=new a(e=v(o.length));e>d;d++)n[d]=u?c(o[d],d):o[d];else for(r=y.call(o),n=new a;!(i=r.next()).done;d++)n[d]=u?p(r,c,[i.value,d],!0):i.value;return n.length=d,n}})},function(t,e,n,i){var r=n(i);t.exports=function(t){return Object(r(t))}},function(t,e,n,i,r){var o=n(i);n(r)("keys",(function(t){return function(e){return t(o(e))}}))},function(t,e,n,i,r){"use strict";var o=n(i);n(r)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=o.getEntry(this,t);return e&&e.v},set:function(t,e){return o.def(this,0===t?0:t,e)}},o,!0)},function(t,e,n,i,r,o,a,s,l,c,u,h,d,f,p,m,v){"use strict";var g=n(i),y=n(r),b=n(o),x=n(a),w=n(s),_=n(l),S=n(c),M=n(u),C=n(h),T=n(d)("id"),E=n(f),k=n(p),A=n(m),P=n(v),L=Object.isExtensible||k,O=P?"_s":"size",R=0,F=function(t,e){if(!k(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!E(t,T)){if(!L(t))return"F";if(!e)return"E";y(t,T,++R)}return"O"+t[T]},B=function(t,e){var n,i=F(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,i){var r=t((function(t,o){w(t,r,e),t._i=g.create(null),t._f=void 0,t._l=void 0,t[O]=0,null!=o&&S(o,n,t[i],t)}));return b(r.prototype,{clear:function(){for(var t=this,e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[O]=0},delete:function(t){var e=this,n=B(e,t);if(n){var i=n.n,r=n.p;delete e._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),e._f==n&&(e._f=i),e._l==n&&(e._l=r),e[O]--}return!!n},forEach:function(t){for(var e,n=x(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(n(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!B(this,t)}}),P&&g.setDesc(r.prototype,"size",{get:function(){return _(this[O])}}),r},def:function(t,e,n){var i,r,o=B(t,e);return o?o.v=n:(t._l=o={i:r=F(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[O]++,"F"!==r&&(t._i[r]=o)),t},getEntry:B,setStrong:function(t,e,n){M(t,e,(function(t,e){this._t=t,this._k=e,this._l=void 0}),(function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?C(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,C(1))}),n?"entries":"values",!n,!0),A(e)}}},function(t,e,n,i,r){var o=n(i);o(o.P,"Map",{toJSON:n(r)("Map")})},function(t,e,n,i,r){var o=n(i),a=n(r);t.exports=function(t){return function(){if(a(this)!=t)throw TypeError(t+"#toJSON isn't generic");var e=[];return o(this,!1,e.push,e),e}}},function(t,e,n,i,r){var o=n(i);o(o.S+o.F,"Object",{assign:n(r)})},function(t,e,n,i,r,o,a){var s=n(i),l=n(r),c=n(o);t.exports=n(a)((function(){var t=Object.assign,e={},n={},i=Symbol(),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach((function(t){n[t]=t})),7!=t({},e)[i]||Object.keys(t({},n)).join("")!=r}))?function(t,e){for(var n=l(t),i=arguments,r=i.length,o=1,a=s.getKeys,u=s.getSymbols,h=s.isEnum;r>o;)for(var d,f=c(i[o++]),p=u?a(f).concat(u(f)):a(f),m=p.length,v=0;m>v;)h.call(f,d=p[v++])&&(n[d]=f[d]);return n}:Object.assign}]));